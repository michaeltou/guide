function uiUploader(a){"use strict";function b(a){for(var b=0;b<a.length;b++)i.files.push(a[b])}function c(){return i.files}function d(a){i.options=a;for(var b=0;b<i.files.length&&i.activeUploads!=i.options.concurrency;b++)i.files[b].active||h(i.files[b],i.options.url)}function e(a){i.files.splice(i.files.indexOf(a),1)}function f(){i.files.splice(0,i.files.length)}function g(a){var b=["n/a","bytes","KiB","MiB","GiB","TB","PB","EiB","ZiB","YiB"],c=+Math.floor(Math.log(a)/Math.log(1024));return(a/Math.pow(1024,c)).toFixed(c?1:0)+" "+b[isNaN(a)?0:c+1]}function h(a,b){var c,e,f,h="",j="file";if(i.activeUploads+=1,a.active=!0,c=new window.XMLHttpRequest,e=new window.FormData,c.open("POST",b),c.upload.onloadstart=function(){},c.upload.onprogress=function(b){b.lengthComputable&&(a.loaded=b.loaded,a.humanSize=g(b.loaded),i.options.onProgress(a))},c.onload=function(){i.activeUploads-=1,d(i.options),i.options.onCompleted(a,c.responseText)},c.onerror=function(){},h)for(f in h)h.hasOwnProperty(f)&&e.append(f,h[f]);return e.append(j,a,a.name),c.send(e),c}var i=this;return i.files=[],i.options={},i.activeUploads=0,a.info("uiUploader loaded"),{addFiles:b,getFiles:c,files:i.files,startUpload:d,removeFile:e,removeAll:f}}!function(a,b,c){"use strict";function d(a,b){return b=b||Error,function(){var c,d,e=arguments[0],f="["+(a?a+":":"")+e+"] ",g=arguments[1],h=arguments;for(c=f+g.replace(/\{\d+\}/g,function(a){var b=+a.slice(1,-1);return b+2<h.length?ma(h[b+2]):a}),c=c+"\nhttp://errors.angularjs.org/1.3.16/"+(a?a+"/":"")+e,d=2;d<arguments.length;d++)c=c+(2==d?"?":"&")+"p"+(d-2)+"="+encodeURIComponent(ma(arguments[d]));return new b(c)}}function e(a){if(null==a||z(a))return!1;var b="length"in Object(a)&&a.length;return a.nodeType===sd&&b?!0:u(a)||ld(a)||0===b||"number"==typeof b&&b>0&&b-1 in a}function f(a,b,c){var d,g;if(a)if(x(a))for(d in a)"prototype"==d||"length"==d||"name"==d||a.hasOwnProperty&&!a.hasOwnProperty(d)||b.call(c,a[d],d,a);else if(ld(a)||e(a)){var h="object"!=typeof a;for(d=0,g=a.length;g>d;d++)(h||d in a)&&b.call(c,a[d],d,a)}else if(a.forEach&&a.forEach!==f)a.forEach(b,c,a);else for(d in a)a.hasOwnProperty(d)&&b.call(c,a[d],d,a);return a}function g(a){return Object.keys(a).sort()}function h(a,b,c){for(var d=g(a),e=0;e<d.length;e++)b.call(c,a[d[e]],d[e]);return d}function i(a){return function(b,c){a(c,b)}}function j(){return++jd}function k(a,b){b?a.$$hashKey=b:delete a.$$hashKey}function l(a){for(var b=a.$$hashKey,c=1,d=arguments.length;d>c;c++){var e=arguments[c];if(e)for(var f=Object.keys(e),g=0,h=f.length;h>g;g++){var i=f[g];a[i]=e[i]}}return k(a,b),a}function m(a){return parseInt(a,10)}function n(a,b){return l(Object.create(a),b)}function o(){}function p(a){return a}function q(a){return function(){return a}}function r(a){return"undefined"==typeof a}function s(a){return"undefined"!=typeof a}function t(a){return null!==a&&"object"==typeof a}function u(a){return"string"==typeof a}function v(a){return"number"==typeof a}function w(a){return"[object Date]"===gd.call(a)}function x(a){return"function"==typeof a}function y(a){return"[object RegExp]"===gd.call(a)}function z(a){return a&&a.window===a}function A(a){return a&&a.$evalAsync&&a.$watch}function B(a){return"[object File]"===gd.call(a)}function C(a){return"[object FormData]"===gd.call(a)}function D(a){return"[object Blob]"===gd.call(a)}function E(a){return"boolean"==typeof a}function F(a){return a&&x(a.then)}function G(a){return!(!a||!(a.nodeName||a.prop&&a.attr&&a.find))}function H(a){var b,c={},d=a.split(",");for(b=0;b<d.length;b++)c[d[b]]=!0;return c}function I(a){return Wc(a.nodeName||a[0]&&a[0].nodeName)}function J(a,b){var c=a.indexOf(b);return c>=0&&a.splice(c,1),b}function K(a,b,c,d){if(z(a)||A(a))throw hd("cpws","Can't copy! Making copies of Window or Scope instances is not supported.");if(b){if(a===b)throw hd("cpi","Can't copy! Source and destination are identical.");if(c=c||[],d=d||[],t(a)){var e=c.indexOf(a);if(-1!==e)return d[e];c.push(a),d.push(b)}var g;if(ld(a)){b.length=0;for(var h=0;h<a.length;h++)g=K(a[h],null,c,d),t(a[h])&&(c.push(a[h]),d.push(g)),b.push(g)}else{var i=b.$$hashKey;ld(b)?b.length=0:f(b,function(a,c){delete b[c]});for(var j in a)a.hasOwnProperty(j)&&(g=K(a[j],null,c,d),t(a[j])&&(c.push(a[j]),d.push(g)),b[j]=g);k(b,i)}}else if(b=a,a)if(ld(a))b=K(a,[],c,d);else if(w(a))b=new Date(a.getTime());else if(y(a))b=new RegExp(a.source,a.toString().match(/[^\/]*$/)[0]),b.lastIndex=a.lastIndex;else if(t(a)){var l=Object.create(Object.getPrototypeOf(a));b=K(a,l,c,d)}return b}function L(a,b){if(ld(a)){b=b||[];for(var c=0,d=a.length;d>c;c++)b[c]=a[c]}else if(t(a)){b=b||{};for(var e in a)"$"===e.charAt(0)&&"$"===e.charAt(1)||(b[e]=a[e])}return b||a}function M(a,b){if(a===b)return!0;if(null===a||null===b)return!1;if(a!==a&&b!==b)return!0;var d,e,f,g=typeof a,h=typeof b;if(g==h&&"object"==g){if(!ld(a)){if(w(a))return w(b)?M(a.getTime(),b.getTime()):!1;if(y(a))return y(b)?a.toString()==b.toString():!1;if(A(a)||A(b)||z(a)||z(b)||ld(b)||w(b)||y(b))return!1;f={};for(e in a)if("$"!==e.charAt(0)&&!x(a[e])){if(!M(a[e],b[e]))return!1;f[e]=!0}for(e in b)if(!f.hasOwnProperty(e)&&"$"!==e.charAt(0)&&b[e]!==c&&!x(b[e]))return!1;return!0}if(!ld(b))return!1;if((d=a.length)==b.length){for(e=0;d>e;e++)if(!M(a[e],b[e]))return!1;return!0}}return!1}function N(a,b,c){return a.concat(dd.call(b,c))}function O(a,b){return dd.call(a,b||0)}function P(a,b){var c=arguments.length>2?O(arguments,2):[];return!x(b)||b instanceof RegExp?b:c.length?function(){return arguments.length?b.apply(a,N(c,arguments,0)):b.apply(a,c)}:function(){return arguments.length?b.apply(a,arguments):b.call(a)}}function Q(a,d){var e=d;return"string"==typeof a&&"$"===a.charAt(0)&&"$"===a.charAt(1)?e=c:z(d)?e="$WINDOW":d&&b===d?e="$DOCUMENT":A(d)&&(e="$SCOPE"),e}function R(a,b){return"undefined"==typeof a?c:(v(b)||(b=b?2:null),JSON.stringify(a,Q,b))}function S(a){return u(a)?JSON.parse(a):a}function T(a){a=ad(a).clone();try{a.empty()}catch(b){}var c=ad("<div>").append(a).html();try{return a[0].nodeType===ud?Wc(c):c.match(/^(<[^>]+>)/)[1].replace(/^<([\w\-]+)/,function(a,b){return"<"+Wc(b)})}catch(b){return Wc(c)}}function U(a){try{return decodeURIComponent(a)}catch(b){}}function V(a){var b,c,d={};return f((a||"").split("&"),function(a){if(a&&(b=a.replace(/\+/g,"%20").split("="),c=U(b[0]),s(c))){var e=s(b[1])?U(b[1]):!0;Xc.call(d,c)?ld(d[c])?d[c].push(e):d[c]=[d[c],e]:d[c]=e}}),d}function W(a){var b=[];return f(a,function(a,c){ld(a)?f(a,function(a){b.push(Y(c,!0)+(a===!0?"":"="+Y(a,!0)))}):b.push(Y(c,!0)+(a===!0?"":"="+Y(a,!0)))}),b.length?b.join("&"):""}function X(a){return Y(a,!0).replace(/%26/gi,"&").replace(/%3D/gi,"=").replace(/%2B/gi,"+")}function Y(a,b){return encodeURIComponent(a).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%3B/gi,";").replace(/%20/g,b?"%20":"+")}function Z(a,b){var c,d,e=pd.length;for(a=ad(a),d=0;e>d;++d)if(c=pd[d]+b,u(c=a.attr(c)))return c;return null}function $(a,b){var c,d,e={};f(pd,function(b){var e=b+"app";!c&&a.hasAttribute&&a.hasAttribute(e)&&(c=a,d=a.getAttribute(e))}),f(pd,function(b){var e,f=b+"app";!c&&(e=a.querySelector("["+f.replace(":","\\:")+"]"))&&(c=e,d=e.getAttribute(f))}),c&&(e.strictDi=null!==Z(c,"strict-di"),b(c,d?[d]:[],e))}function _(c,d,e){t(e)||(e={});var g={strictDi:!1};e=l(g,e);var h=function(){if(c=ad(c),c.injector()){var a=c[0]===b?"document":T(c);throw hd("btstrpd","App Already Bootstrapped with this Element '{0}'",a.replace(/</,"&lt;").replace(/>/,"&gt;"))}d=d||[],d.unshift(["$provide",function(a){a.value("$rootElement",c)}]),e.debugInfoEnabled&&d.push(["$compileProvider",function(a){a.debugInfoEnabled(!0)}]),d.unshift("ng");var f=Sa(d,e.strictDi);return f.invoke(["$rootScope","$rootElement","$compile","$injector",function(a,b,c,d){a.$apply(function(){b.data("$injector",d),c(b)(a)})}]),f},i=/^NG_ENABLE_DEBUG_INFO!/,j=/^NG_DEFER_BOOTSTRAP!/;return a&&i.test(a.name)&&(e.debugInfoEnabled=!0,a.name=a.name.replace(i,"")),a&&!j.test(a.name)?h():(a.name=a.name.replace(j,""),id.resumeBootstrap=function(a){return f(a,function(a){d.push(a)}),h()},void(x(id.resumeDeferredBootstrap)&&id.resumeDeferredBootstrap()))}function aa(){a.name="NG_ENABLE_DEBUG_INFO!"+a.name,a.location.reload()}function ba(a){var b=id.element(a).injector();if(!b)throw hd("test","no injector found for element argument to getTestability");return b.get("$$testability")}function ca(a,b){return b=b||"_",a.replace(qd,function(a,c){return(c?b:"")+a.toLowerCase()})}function da(){var b;rd||(bd=a.jQuery,bd&&bd.fn.on?(ad=bd,l(bd.fn,{scope:Md.scope,isolateScope:Md.isolateScope,controller:Md.controller,injector:Md.injector,inheritedData:Md.inheritedData}),b=bd.cleanData,bd.cleanData=function(a){var c;if(kd)kd=!1;else for(var d,e=0;null!=(d=a[e]);e++)c=bd._data(d,"events"),c&&c.$destroy&&bd(d).triggerHandler("$destroy");b(a)}):ad=ua,id.element=ad,rd=!0)}function ea(a,b,c){if(!a)throw hd("areq","Argument '{0}' is {1}",b||"?",c||"required");return a}function fa(a,b,c){return c&&ld(a)&&(a=a[a.length-1]),ea(x(a),b,"not a function, got "+(a&&"object"==typeof a?a.constructor.name||"Object":typeof a)),a}function ga(a,b){if("hasOwnProperty"===a)throw hd("badname","hasOwnProperty is not a valid {0} name",b)}function ha(a,b,c){if(!b)return a;for(var d,e=b.split("."),f=a,g=e.length,h=0;g>h;h++)d=e[h],a&&(a=(f=a)[d]);return!c&&x(a)?P(f,a):a}function ia(a){var b=a[0],c=a[a.length-1],d=[b];do{if(b=b.nextSibling,!b)break;d.push(b)}while(b!==c);return ad(d)}function ja(){return Object.create(null)}function ka(a){function b(a,b,c){return a[b]||(a[b]=c())}var c=d("$injector"),e=d("ng"),f=b(a,"angular",Object);return f.$$minErr=f.$$minErr||d,b(f,"module",function(){var a={};return function(d,f,g){var h=function(a,b){if("hasOwnProperty"===a)throw e("badname","hasOwnProperty is not a valid {0} name",b)};return h(d,"module"),f&&a.hasOwnProperty(d)&&(a[d]=null),b(a,d,function(){function a(a,c,d,e){return e||(e=b),function(){return e[d||"push"]([a,c,arguments]),j}}if(!f)throw c("nomod","Module '{0}' is not available! You either misspelled the module name or forgot to load it. If registering a module ensure that you specify the dependencies as the second argument.",d);var b=[],e=[],h=[],i=a("$injector","invoke","push",e),j={_invokeQueue:b,_configBlocks:e,_runBlocks:h,requires:f,name:d,provider:a("$provide","provider"),factory:a("$provide","factory"),service:a("$provide","service"),value:a("$provide","value"),constant:a("$provide","constant","unshift"),animation:a("$animateProvider","register"),filter:a("$filterProvider","register"),controller:a("$controllerProvider","register"),directive:a("$compileProvider","directive"),config:i,run:function(a){return h.push(a),this}};return g&&i(g),j})}})}function la(a){var b=[];return JSON.stringify(a,function(a,c){if(c=Q(a,c),t(c)){if(b.indexOf(c)>=0)return"<<already seen>>";b.push(c)}return c})}function ma(a){return"function"==typeof a?a.toString().replace(/ \{[\s\S]*$/,""):"undefined"==typeof a?"undefined":"string"!=typeof a?la(a):a}function na(b){l(b,{bootstrap:_,copy:K,extend:l,equals:M,element:ad,forEach:f,injector:Sa,noop:o,bind:P,toJson:R,fromJson:S,identity:p,isUndefined:r,isDefined:s,isString:u,isFunction:x,isObject:t,isNumber:v,isElement:G,isArray:ld,version:yd,isDate:w,lowercase:Wc,uppercase:Yc,callbacks:{counter:0},getTestability:ba,$$minErr:d,$$csp:od,reloadWithDebugInfo:aa}),cd=ka(a);try{cd("ngLocale")}catch(c){cd("ngLocale",[]).provider("$locale",qb)}cd("ng",["ngLocale"],["$provide",function(a){a.provider({$$sanitizeUri:Wb}),a.provider("$compile",Za).directive({a:Ee,input:Ve,textarea:Ve,form:Je,script:Lf,select:Of,style:Qf,option:Pf,ngBind:Ye,ngBindHtml:$e,ngBindTemplate:Ze,ngClass:af,ngClassEven:cf,ngClassOdd:bf,ngCloak:df,ngController:ef,ngForm:Ke,ngHide:Ff,ngIf:hf,ngInclude:jf,ngInit:lf,ngNonBindable:zf,ngPluralize:Af,ngRepeat:Bf,ngShow:Ef,ngStyle:Gf,ngSwitch:Hf,ngSwitchWhen:If,ngSwitchDefault:Jf,ngOptions:Nf,ngTransclude:Kf,ngModel:wf,ngList:mf,ngChange:_e,pattern:Sf,ngPattern:Sf,required:Rf,ngRequired:Rf,minlength:Uf,ngMinlength:Uf,maxlength:Tf,ngMaxlength:Tf,ngValue:Xe,ngModelOptions:yf}).directive({ngInclude:kf}).directive(Fe).directive(ff),a.provider({$anchorScroll:Ta,$animate:Wd,$browser:Wa,$cacheFactory:Xa,$controller:bb,$document:cb,$exceptionHandler:db,$filter:gc,$interpolate:ob,$interval:pb,$http:kb,$httpBackend:mb,$location:Eb,$log:Fb,$parse:Qb,$rootScope:Vb,$q:Rb,$$q:Sb,$sce:$b,$sceDelegate:Zb,$sniffer:_b,$templateCache:Ya,$templateRequest:ac,$$testability:bc,$timeout:cc,$window:fc,$$rAF:Ub,$$asyncCallback:Ua,$$jqLite:Na})}])}function oa(){return++Ad}function pa(a){return a.replace(Dd,function(a,b,c,d){return d?c.toUpperCase():c}).replace(Ed,"Moz$1")}function qa(a){return!Id.test(a)}function ra(a){var b=a.nodeType;return b===sd||!b||b===wd}function sa(a,b){var c,d,e,g,h=b.createDocumentFragment(),i=[];if(qa(a))i.push(b.createTextNode(a));else{for(c=c||h.appendChild(b.createElement("div")),d=(Jd.exec(a)||["",""])[1].toLowerCase(),e=Ld[d]||Ld._default,c.innerHTML=e[1]+a.replace(Kd,"<$1></$2>")+e[2],g=e[0];g--;)c=c.lastChild;i=N(i,c.childNodes),c=h.firstChild,c.textContent=""}return h.textContent="",h.innerHTML="",f(i,function(a){h.appendChild(a)}),h}function ta(a,c){c=c||b;var d;return(d=Hd.exec(a))?[c.createElement(d[1])]:(d=sa(a,c))?d.childNodes:[]}function ua(a){if(a instanceof ua)return a;var b;if(u(a)&&(a=md(a),b=!0),!(this instanceof ua)){if(b&&"<"!=a.charAt(0))throw Gd("nosel","Looking up elements via selectors is not supported by jqLite! See: http://docs.angularjs.org/api/angular.element");return new ua(a)}b?Ea(this,ta(a)):Ea(this,a)}function va(a){return a.cloneNode(!0)}function wa(a,b){if(b||ya(a),a.querySelectorAll)for(var c=a.querySelectorAll("*"),d=0,e=c.length;e>d;d++)ya(c[d])}function xa(a,b,c,d){if(s(d))throw Gd("offargs","jqLite#off() does not support the `selector` argument");var e=za(a),g=e&&e.events,h=e&&e.handle;if(h)if(b)f(b.split(" "),function(b){if(s(c)){var d=g[b];if(J(d||[],c),d&&d.length>0)return}Cd(a,b,h),delete g[b]});else for(b in g)"$destroy"!==b&&Cd(a,b,h),delete g[b]}function ya(a,b){var d=a.ng339,e=d&&zd[d];if(e){if(b)return void delete e.data[b];e.handle&&(e.events.$destroy&&e.handle({},"$destroy"),xa(a)),delete zd[d],a.ng339=c}}function za(a,b){var d=a.ng339,e=d&&zd[d];return b&&!e&&(a.ng339=d=oa(),e=zd[d]={events:{},data:{},handle:c}),e}function Aa(a,b,c){if(ra(a)){var d=s(c),e=!d&&b&&!t(b),f=!b,g=za(a,!e),h=g&&g.data;if(d)h[b]=c;else{if(f)return h;if(e)return h&&h[b];l(h,b)}}}function Ba(a,b){return a.getAttribute?(" "+(a.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ").indexOf(" "+b+" ")>-1:!1}function Ca(a,b){b&&a.setAttribute&&f(b.split(" "),function(b){a.setAttribute("class",md((" "+(a.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ").replace(" "+md(b)+" "," ")))})}function Da(a,b){if(b&&a.setAttribute){var c=(" "+(a.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ");f(b.split(" "),function(a){a=md(a),-1===c.indexOf(" "+a+" ")&&(c+=a+" ")}),a.setAttribute("class",md(c))}}function Ea(a,b){if(b)if(b.nodeType)a[a.length++]=b;else{var c=b.length;if("number"==typeof c&&b.window!==b){if(c)for(var d=0;c>d;d++)a[a.length++]=b[d]}else a[a.length++]=b}}function Fa(a,b){return Ga(a,"$"+(b||"ngController")+"Controller")}function Ga(a,b,d){a.nodeType==wd&&(a=a.documentElement);for(var e=ld(b)?b:[b];a;){for(var f=0,g=e.length;g>f;f++)if((d=ad.data(a,e[f]))!==c)return d;a=a.parentNode||a.nodeType===xd&&a.host}}function Ha(a){for(wa(a,!0);a.firstChild;)a.removeChild(a.firstChild)}function Ia(a,b){b||wa(a);var c=a.parentNode;c&&c.removeChild(a)}function Ja(b,c){c=c||a,"complete"===c.document.readyState?c.setTimeout(b):ad(c).on("load",b)}function Ka(a,b){var c=Nd[b.toLowerCase()];return c&&Od[I(a)]&&c}function La(a,b){var c=a.nodeName;return("INPUT"===c||"TEXTAREA"===c)&&Pd[b]}function Ma(a,b){var c=function(c,d){c.isDefaultPrevented=function(){return c.defaultPrevented};var e=b[d||c.type],f=e?e.length:0;if(f){if(r(c.immediatePropagationStopped)){var g=c.stopImmediatePropagation;c.stopImmediatePropagation=function(){c.immediatePropagationStopped=!0,c.stopPropagation&&c.stopPropagation(),g&&g.call(c)}}c.isImmediatePropagationStopped=function(){return c.immediatePropagationStopped===!0},f>1&&(e=L(e));for(var h=0;f>h;h++)c.isImmediatePropagationStopped()||e[h].call(a,c)}};return c.elem=a,c}function Na(){this.$get=function(){return l(ua,{hasClass:function(a,b){return a.attr&&(a=a[0]),Ba(a,b)},addClass:function(a,b){return a.attr&&(a=a[0]),Da(a,b)},removeClass:function(a,b){return a.attr&&(a=a[0]),Ca(a,b)}})}}function Oa(a,b){var c=a&&a.$$hashKey;if(c)return"function"==typeof c&&(c=a.$$hashKey()),c;var d=typeof a;return c="function"==d||"object"==d&&null!==a?a.$$hashKey=d+":"+(b||j)():d+":"+a}function Pa(a,b){if(b){var c=0;this.nextUid=function(){return++c}}f(a,this.put,this)}function Qa(a){var b=a.toString().replace(Td,""),c=b.match(Qd);return c?"function("+(c[1]||"").replace(/[\s\r\n]+/," ")+")":"fn"}function Ra(a,b,c){var d,e,g,h;if("function"==typeof a){if(!(d=a.$inject)){if(d=[],a.length){if(b)throw u(c)&&c||(c=a.name||Qa(a)),Ud("strictdi","{0} is not using explicit annotation and cannot be invoked in strict mode",c);e=a.toString().replace(Td,""),g=e.match(Qd),f(g[1].split(Rd),function(a){a.replace(Sd,function(a,b,c){d.push(c)})})}a.$inject=d}}else ld(a)?(h=a.length-1,fa(a[h],"fn"),d=a.slice(0,h)):fa(a,"fn",!0);return d}function Sa(a,b){function d(a){return function(b,c){return t(b)?void f(b,i(a)):a(b,c)}}function e(a,b){if(ga(a,"service"),(x(b)||ld(b))&&(b=A.instantiate(b)),!b.$get)throw Ud("pget","Provider '{0}' must define $get factory method.",a);return z[a+v]=b}function g(a,b){return function(){var c=C.invoke(b,this);if(r(c))throw Ud("undef","Provider '{0}' must return a value from $get factory method.",a);return c}}function h(a,b,c){return e(a,{$get:c!==!1?g(a,b):b})}function j(a,b){return h(a,["$injector",function(a){return a.instantiate(b)}])}function k(a,b){return h(a,q(b),!1)}function l(a,b){ga(a,"constant"),z[a]=b,B[a]=b}function m(a,b){var c=A.get(a+v),d=c.$get;c.$get=function(){var a=C.invoke(d,c);return C.invoke(b,null,{$delegate:a})}}function n(a){var b,c=[];return f(a,function(a){function d(a){var b,c;for(b=0,c=a.length;c>b;b++){var d=a[b],e=A.get(d[0]);e[d[1]].apply(e,d[2])}}if(!y.get(a)){y.put(a,!0);try{u(a)?(b=cd(a),c=c.concat(n(b.requires)).concat(b._runBlocks),d(b._invokeQueue),d(b._configBlocks)):x(a)?c.push(A.invoke(a)):ld(a)?c.push(A.invoke(a)):fa(a,"module")}catch(e){throw ld(a)&&(a=a[a.length-1]),e.message&&e.stack&&-1==e.stack.indexOf(e.message)&&(e=e.message+"\n"+e.stack),Ud("modulerr","Failed to instantiate module {0} due to:\n{1}",a,e.stack||e.message||e)}}}),c}function p(a,c){function d(b,d){if(a.hasOwnProperty(b)){if(a[b]===s)throw Ud("cdep","Circular dependency found: {0}",b+" <- "+w.join(" <- "));return a[b]}try{return w.unshift(b),a[b]=s,a[b]=c(b,d)}catch(e){throw a[b]===s&&delete a[b],e}finally{w.shift()}}function e(a,c,e,f){"string"==typeof e&&(f=e,e=null);var g,h,i,j=[],k=Sa.$$annotate(a,b,f);for(h=0,g=k.length;g>h;h++){if(i=k[h],"string"!=typeof i)throw Ud("itkn","Incorrect injection token! Expected service name as string, got {0}",i);j.push(e&&e.hasOwnProperty(i)?e[i]:d(i,f))}return ld(a)&&(a=a[g]),a.apply(c,j)}function f(a,b,c){var d=Object.create((ld(a)?a[a.length-1]:a).prototype||null),f=e(a,d,b,c);return t(f)||x(f)?f:d}return{invoke:e,instantiate:f,get:d,annotate:Sa.$$annotate,has:function(b){return z.hasOwnProperty(b+v)||a.hasOwnProperty(b)}}}b=b===!0;var s={},v="Provider",w=[],y=new Pa([],!0),z={$provide:{provider:d(e),factory:d(h),service:d(j),value:d(k),constant:d(l),decorator:m}},A=z.$injector=p(z,function(a,b){throw id.isString(b)&&w.push(b),Ud("unpr","Unknown provider: {0}",w.join(" <- "))}),B={},C=B.$injector=p(B,function(a,b){var d=A.get(a+v,b);return C.invoke(d.$get,d,c,a)});return f(n(a),function(a){C.invoke(a||o)}),C}function Ta(){var a=!0;this.disableAutoScrolling=function(){a=!1},this.$get=["$window","$location","$rootScope",function(b,c,d){function e(a){var b=null;return Array.prototype.some.call(a,function(a){return"a"===I(a)?(b=a,!0):void 0}),b}function f(){var a=h.yOffset;if(x(a))a=a();else if(G(a)){var c=a[0],d=b.getComputedStyle(c);a="fixed"!==d.position?0:c.getBoundingClientRect().bottom}else v(a)||(a=0);return a}function g(a){if(a){a.scrollIntoView();var c=f();if(c){var d=a.getBoundingClientRect().top;b.scrollBy(0,d-c)}}else b.scrollTo(0,0)}function h(){var a,b=c.hash();b?(a=i.getElementById(b))?g(a):(a=e(i.getElementsByName(b)))?g(a):"top"===b&&g(null):g(null)}var i=b.document;return a&&d.$watch(function(){return c.hash()},function(a,b){a===b&&""===a||Ja(function(){d.$evalAsync(h)})}),h}]}function Ua(){this.$get=["$$rAF","$timeout",function(a,b){return a.supported?function(b){return a(b)}:function(a){return b(a,0,!1)}}]}function Va(a,b,d,e){function g(a){try{a.apply(null,O(arguments,1))}finally{if(y--,0===y)for(;z.length;)try{z.pop()()}catch(b){d.error(b)}}}function h(a){var b=a.indexOf("#");return-1===b?"":a.substr(b+1)}function i(a,b){!function c(){f(B,function(a){a()}),A=b(c,a)}()}function j(){l(),m()}function k(){try{return t.state}catch(a){}}function l(){C=k(),C=r(C)?null:C,M(C,J)&&(C=J),J=C}function m(){E===p.url()&&D===C||(E=p.url(),D=C,f(H,function(a){a(p.url(),C)}))}function n(a){try{return decodeURIComponent(a)}catch(b){return a}}var p=this,q=b[0],s=a.location,t=a.history,v=a.setTimeout,w=a.clearTimeout,x={};p.isMock=!1;var y=0,z=[];p.$$completeOutstandingRequest=g,p.$$incOutstandingRequestCount=function(){y++},p.notifyWhenNoOutstandingRequests=function(a){f(B,function(a){a()}),0===y?a():z.push(a)};var A,B=[];p.addPollFn=function(a){return r(A)&&i(100,v),B.push(a),a};var C,D,E=s.href,F=b.find("base"),G=null;l(),D=C,p.url=function(b,c,d){if(r(d)&&(d=null),s!==a.location&&(s=a.location),t!==a.history&&(t=a.history),b){var f=D===d;if(E===b&&(!e.history||f))return p;var g=E&&vb(E)===vb(b);return E=b,D=d,!e.history||g&&f?(g||(G=b),c?s.replace(b):g?s.hash=h(b):s.href=b):(t[c?"replaceState":"pushState"](d,"",b),l(),D=C),p}return G||s.href.replace(/%27/g,"'")},p.state=function(){return C};var H=[],I=!1,J=null;p.onUrlChange=function(b){return I||(e.history&&ad(a).on("popstate",j),ad(a).on("hashchange",j),I=!0),H.push(b),b},p.$$checkUrlChange=m,p.baseHref=function(){var a=F.attr("href");return a?a.replace(/^(https?\:)?\/\/[^\/]*/,""):""};var K={},L="",N=p.baseHref();p.cookies=function(a,b){var e,f,g,h,i;if(!a){if(q.cookie!==L)for(L=q.cookie,f=L.split("; "),K={},h=0;h<f.length;h++)g=f[h],i=g.indexOf("="),i>0&&(a=n(g.substring(0,i)),K[a]===c&&(K[a]=n(g.substring(i+1))));return K}b===c?q.cookie=encodeURIComponent(a)+"=;path="+N+";expires=Thu, 01 Jan 1970 00:00:00 GMT":u(b)&&(e=(q.cookie=encodeURIComponent(a)+"="+encodeURIComponent(b)+";path="+N).length+1,e>4096&&d.warn("Cookie '"+a+"' possibly not set or overflowed because it was too large ("+e+" > 4096 bytes)!"))},p.defer=function(a,b){var c;return y++,c=v(function(){delete x[c],g(a)},b||0),x[c]=!0,c},p.defer.cancel=function(a){return x[a]?(delete x[a],w(a),g(o),!0):!1}}function Wa(){this.$get=["$window","$log","$sniffer","$document",function(a,b,c,d){return new Va(a,d,b,c)}]}function Xa(){this.$get=function(){function a(a,c){function e(a){a!=m&&(n?n==a&&(n=a.n):n=a,f(a.n,a.p),f(a,m),m=a,m.n=null)}function f(a,b){a!=b&&(a&&(a.p=b),b&&(b.n=a))}if(a in b)throw d("$cacheFactory")("iid","CacheId '{0}' is already taken!",a);var g=0,h=l({},c,{id:a}),i={},j=c&&c.capacity||Number.MAX_VALUE,k={},m=null,n=null;return b[a]={put:function(a,b){if(j<Number.MAX_VALUE){var c=k[a]||(k[a]={key:a});e(c)}if(!r(b))return a in i||g++,i[a]=b,g>j&&this.remove(n.key),b},get:function(a){if(j<Number.MAX_VALUE){var b=k[a];if(!b)return;e(b)}return i[a]},remove:function(a){if(j<Number.MAX_VALUE){var b=k[a];if(!b)return;b==m&&(m=b.p),b==n&&(n=b.n),f(b.n,b.p),delete k[a]}delete i[a],g--},removeAll:function(){i={},g=0,k={},m=n=null},destroy:function(){i=null,h=null,k=null,delete b[a]},info:function(){return l({},h,{size:g})}}}var b={};return a.info=function(){var a={};return f(b,function(b,c){a[c]=b.info()}),a},a.get=function(a){return b[a]},a}}function Ya(){this.$get=["$cacheFactory",function(a){return a("templates")}]}function Za(a,d){function e(a,b){var c=/^\s*([@&]|=(\*?))(\??)\s*(\w*)\s*$/,d={};return f(a,function(a,e){var f=a.match(c);if(!f)throw Xd("iscp","Invalid isolate scope definition for directive '{0}'. Definition: {... {1}: '{2}' ...}",b,e,a);d[e]={mode:f[1][0],collection:"*"===f[2],optional:"?"===f[3],attrName:f[4]||e}}),d}function g(a){var b=a.charAt(0);if(!b||b!==Wc(b))throw Xd("baddir","Directive name '{0}' is invalid. The first character must be a lowercase letter",a);return a}var h={},j="Directive",k=/^\s*directive\:\s*([\w\-]+)\s+(.*)$/,m=/(([\w\-]+)(?:\:([^;]+))?;?)/,r=H("ngSrc,ngSrcset,src,srcset"),v=/^(?:(\^\^?)?(\?)?(\^\^?)?)?/,w=/^(on[a-z]+|formaction)$/;this.directive=function z(b,c){return ga(b,"directive"),u(b)?(g(b),ea(c,"directiveFactory"),h.hasOwnProperty(b)||(h[b]=[],a.factory(b+j,["$injector","$exceptionHandler",function(a,c){var d=[];return f(h[b],function(f,g){try{var h=a.invoke(f);x(h)?h={compile:q(h)}:!h.compile&&h.link&&(h.compile=q(h.link)),h.priority=h.priority||0,h.index=g,h.name=h.name||b,h.require=h.require||h.controller&&h.name,h.restrict=h.restrict||"EA",t(h.scope)&&(h.$$isolateBindings=e(h.scope,h.name)),d.push(h)}catch(i){c(i)}}),d}])),h[b].push(c)):f(b,i(z)),this},this.aHrefSanitizationWhitelist=function(a){return s(a)?(d.aHrefSanitizationWhitelist(a),this):d.aHrefSanitizationWhitelist()},this.imgSrcSanitizationWhitelist=function(a){return s(a)?(d.imgSrcSanitizationWhitelist(a),this):d.imgSrcSanitizationWhitelist()};var y=!0;this.debugInfoEnabled=function(a){return s(a)?(y=a,this):y},this.$get=["$injector","$interpolate","$exceptionHandler","$templateRequest","$parse","$controller","$rootScope","$document","$sce","$animate","$$sanitizeUri",function(a,d,e,g,i,q,s,z,B,C,D){function E(a,b){try{a.addClass(b)}catch(c){}}function F(a,b,c,d,e){a instanceof ad||(a=ad(a)),f(a,function(b,c){b.nodeType==ud&&b.nodeValue.match(/\S+/)&&(a[c]=ad(b).wrap("<span></span>").parent()[0])});var g=H(a,b,a,c,d,e);F.$$addScopeClass(a);var h=null;return function(b,c,d){ea(b,"scope"),d=d||{};var e=d.parentBoundTranscludeFn,f=d.transcludeControllers,i=d.futureParentElement;e&&e.$$boundTransclude&&(e=e.$$boundTransclude),h||(h=G(i));var j;if(j="html"!==h?ad($(h,ad("<div>").append(a).html())):c?Md.clone.call(a):a,f)for(var k in f)j.data("$"+k+"Controller",f[k].instance);return F.$$addScopeInfo(j,b),c&&c(j,b),g&&g(b,j,j,e),j}}function G(a){var b=a&&a[0];return b&&"foreignobject"!==I(b)&&b.toString().match(/SVG/)?"svg":"html"}function H(a,b,d,e,f,g){function h(a,d,e,f){var g,h,i,j,k,l,m,n,q;if(o){var r=d.length;for(q=new Array(r),k=0;k<p.length;k+=3)m=p[k],q[m]=d[m]}else q=d;for(k=0,l=p.length;l>k;)i=q[p[k++]],g=p[k++],h=p[k++],g?(g.scope?(j=a.$new(),F.$$addScopeInfo(ad(i),j)):j=a,n=g.transcludeOnThisElement?K(a,g.transclude,f,g.elementTranscludeOnThisElement):!g.templateOnThisElement&&f?f:!f&&b?K(a,b):null,g(h,j,i,e,n)):h&&h(a,i.childNodes,c,f)}for(var i,j,k,l,m,n,o,p=[],q=0;q<a.length;q++)i=new ga,j=L(a[q],[],i,0===q?e:c,f),k=j.length?Q(j,a[q],i,b,d,null,[],[],g):null,k&&k.scope&&F.$$addScopeClass(i.$$element),m=k&&k.terminal||!(l=a[q].childNodes)||!l.length?null:H(l,k?(k.transcludeOnThisElement||!k.templateOnThisElement)&&k.transclude:b),(k||m)&&(p.push(q,k,m),n=!0,o=o||k),g=null;return n?h:null}function K(a,b,c,d){var e=function(d,e,f,g,h){return d||(d=a.$new(!1,h),d.$$transcluded=!0),b(d,e,{parentBoundTranscludeFn:c,transcludeControllers:f,futureParentElement:g})};return e}function L(a,b,c,d,e){var f,g,h=a.nodeType,i=c.$attr;switch(h){case sd:S(b,$a(I(a)),"E",d,e);for(var j,l,n,o,p,q,r=a.attributes,s=0,v=r&&r.length;v>s;s++){var w=!1,x=!1;j=r[s],l=j.name,p=md(j.value),o=$a(l),(q=la.test(o))&&(l=l.replace(Yd,"").substr(8).replace(/_(.)/g,function(a,b){return b.toUpperCase()}));var y=o.replace(/(Start|End)$/,"");U(y)&&o===y+"Start"&&(w=l,x=l.substr(0,l.length-5)+"end",l=l.substr(0,l.length-6)),n=$a(l.toLowerCase()),i[n]=l,!q&&c.hasOwnProperty(n)||(c[n]=p,Ka(a,n)&&(c[n]=!0)),aa(a,b,p,n,q),S(b,n,"A",d,e,w,x)}if(g=a.className,t(g)&&(g=g.animVal),u(g)&&""!==g)for(;f=m.exec(g);)n=$a(f[2]),S(b,n,"C",d,e)&&(c[n]=md(f[3])),g=g.substr(f.index+f[0].length);break;case ud:Z(b,a.nodeValue);break;case vd:try{f=k.exec(a.nodeValue),f&&(n=$a(f[1]),S(b,n,"M",d,e)&&(c[n]=md(f[2])))}catch(z){}}return b.sort(X),b}function N(a,b,c){var d=[],e=0;if(b&&a.hasAttribute&&a.hasAttribute(b)){do{if(!a)throw Xd("uterdir","Unterminated attribute, found '{0}' but no matching '{1}' found.",b,c);a.nodeType==sd&&(a.hasAttribute(b)&&e++,a.hasAttribute(c)&&e--),d.push(a),a=a.nextSibling}while(e>0)}else d.push(a);return ad(d)}function P(a,b,c){return function(d,e,f,g,h){return e=N(e[0],b,c),a(d,e,f,g,h)}}function Q(a,g,h,j,k,l,m,n,o){function p(a,b,c,d){a&&(c&&(a=P(a,c,d)),a.require=z.require,a.directiveName=B,(I===z||z.$$isolateScope)&&(a=da(a,{isolateScope:!0})),m.push(a)),b&&(c&&(b=P(b,c,d)),b.require=z.require,b.directiveName=B,(I===z||z.$$isolateScope)&&(b=da(b,{isolateScope:!0})),n.push(b))}function r(a,b,c,d){var e,g,h="data",i=!1,j=c;if(u(b)){if(g=b.match(v),b=b.substring(g[0].length),g[3]&&(g[1]?g[3]=null:g[1]=g[3]),"^"===g[1]?h="inheritedData":"^^"===g[1]&&(h="inheritedData",j=c.parent()),"?"===g[2]&&(i=!0),e=null,d&&"data"===h&&(e=d[b])&&(e=e.instance),e=e||j[h]("$"+b+"Controller"),!e&&!i)throw Xd("ctreq","Controller '{0}', required by directive '{1}', can't be found!",b,a);return e||null}return ld(b)&&(e=[],f(b,function(b){e.push(r(a,b,c,d))})),e}function s(a,b,e,j,k){function l(a,b,d){var e;return A(a)||(d=b,b=a,a=c),U&&(e=v),d||(d=U?x.parent():x),k(a,b,e,d,D)}var o,p,s,t,u,v,w,x,z;if(g===e?(z=h,x=h.$$element):(x=ad(e),z=new ga(x,h)),I&&(u=b.$new(!0)),k&&(w=l,w.$$boundTransclude=k),H&&(y={},v={},f(H,function(a){var c,d={$scope:a===I||a.$$isolateScope?u:b,$element:x,$attrs:z,$transclude:w};t=a.controller,"@"==t&&(t=z[a.name]),c=q(t,d,!0,a.controllerAs),v[a.name]=c,U||x.data("$"+a.name+"Controller",c.instance),y[a.name]=c})),I){F.$$addScopeInfo(x,u,!0,!(J&&(J===I||J===I.$$originalDirective))),F.$$addScopeClass(x,!0);var B=y&&y[I.name],C=u;B&&B.identifier&&I.bindToController===!0&&(C=B.instance),f(u.$$isolateBindings=I.$$isolateBindings,function(a,c){var e,f,g,h,j=a.attrName,k=a.optional,l=a.mode;switch(l){case"@":z.$observe(j,function(a){C[c]=a}),z.$$observers[j].$$scope=b,z[j]&&(C[c]=d(z[j])(b));break;case"=":if(k&&!z[j])return;f=i(z[j]),h=f.literal?M:function(a,b){return a===b||a!==a&&b!==b},g=f.assign||function(){throw e=C[c]=f(b),Xd("nonassign","Expression '{0}' used with directive '{1}' is non-assignable!",z[j],I.name)},e=C[c]=f(b);var m=function(a){return h(a,C[c])||(h(a,e)?g(b,a=C[c]):C[c]=a),e=a};m.$stateful=!0;var n;n=a.collection?b.$watchCollection(z[j],m):b.$watch(i(z[j],m),null,f.literal),u.$on("$destroy",n);break;case"&":f=i(z[j]),C[c]=function(a){return f(b,a)}}})}for(y&&(f(y,function(a){a()}),y=null),o=0,p=m.length;p>o;o++)s=m[o],fa(s,s.isolateScope?u:b,x,z,s.require&&r(s.directiveName,s.require,x,v),w);var D=b;for(I&&(I.template||null===I.templateUrl)&&(D=u),a&&a(D,e.childNodes,c,k),o=n.length-1;o>=0;o--)s=n[o],fa(s,s.isolateScope?u:b,x,z,s.require&&r(s.directiveName,s.require,x,v),w)}o=o||{};for(var w,y,z,B,C,D,E,G=-Number.MAX_VALUE,H=o.controllerDirectives,I=o.newIsolateScopeDirective,J=o.templateDirective,K=o.nonTlbTranscludeDirective,Q=!1,S=!1,U=o.hasElementTranscludeDirective,X=h.$$element=ad(g),Z=l,_=j,aa=0,ca=a.length;ca>aa;aa++){z=a[aa];var ea=z.$$start,ha=z.$$end;if(ea&&(X=N(g,ea,ha)),C=c,G>z.priority)break;if((E=z.scope)&&(z.templateUrl||(t(E)?(Y("new/isolated scope",I||w,z,X),I=z):Y("new/isolated scope",I,z,X)),w=w||z),B=z.name,!z.templateUrl&&z.controller&&(E=z.controller,H=H||{},Y("'"+B+"' controller",H[B],z,X),H[B]=z),(E=z.transclude)&&(Q=!0,z.$$tlb||(Y("transclusion",K,z,X),K=z),"element"==E?(U=!0,G=z.priority,C=X,X=h.$$element=ad(b.createComment(" "+B+": "+h[B]+" ")),
g=X[0],ba(k,O(C),g),_=F(C,j,G,Z&&Z.name,{nonTlbTranscludeDirective:K})):(C=ad(va(g)).contents(),X.empty(),_=F(C,j))),z.template)if(S=!0,Y("template",J,z,X),J=z,E=x(z.template)?z.template(X,h):z.template,E=ka(E),z.replace){if(Z=z,C=qa(E)?[]:ab($(z.templateNamespace,md(E))),g=C[0],1!=C.length||g.nodeType!==sd)throw Xd("tplrt","Template for directive '{0}' must have exactly one root element. {1}",B,"");ba(k,X,g);var ia={$attr:{}},ja=L(g,[],ia),la=a.splice(aa+1,a.length-(aa+1));I&&R(ja),a=a.concat(ja).concat(la),V(h,ia),ca=a.length}else X.html(E);if(z.templateUrl)S=!0,Y("template",J,z,X),J=z,z.replace&&(Z=z),s=W(a.splice(aa,a.length-aa),X,h,k,Q&&_,m,n,{controllerDirectives:H,newIsolateScopeDirective:I,templateDirective:J,nonTlbTranscludeDirective:K}),ca=a.length;else if(z.compile)try{D=z.compile(X,h,_),x(D)?p(null,D,ea,ha):D&&p(D.pre,D.post,ea,ha)}catch(ma){e(ma,T(X))}z.terminal&&(s.terminal=!0,G=Math.max(G,z.priority))}return s.scope=w&&w.scope===!0,s.transcludeOnThisElement=Q,s.elementTranscludeOnThisElement=U,s.templateOnThisElement=S,s.transclude=_,o.hasElementTranscludeDirective=U,s}function R(a){for(var b=0,c=a.length;c>b;b++)a[b]=n(a[b],{$$isolateScope:!0})}function S(b,d,f,g,i,k,l){if(d===i)return null;var m=null;if(h.hasOwnProperty(d))for(var o,p=a.get(d+j),q=0,r=p.length;r>q;q++)try{o=p[q],(g===c||g>o.priority)&&-1!=o.restrict.indexOf(f)&&(k&&(o=n(o,{$$start:k,$$end:l})),b.push(o),m=o)}catch(s){e(s)}return m}function U(b){if(h.hasOwnProperty(b))for(var c,d=a.get(b+j),e=0,f=d.length;f>e;e++)if(c=d[e],c.multiElement)return!0;return!1}function V(a,b){var c=b.$attr,d=a.$attr,e=a.$$element;f(a,function(d,e){"$"!=e.charAt(0)&&(b[e]&&b[e]!==d&&(d+=("style"===e?";":" ")+b[e]),a.$set(e,d,!0,c[e]))}),f(b,function(b,f){"class"==f?(E(e,b),a["class"]=(a["class"]?a["class"]+" ":"")+b):"style"==f?(e.attr("style",e.attr("style")+";"+b),a.style=(a.style?a.style+";":"")+b):"$"==f.charAt(0)||a.hasOwnProperty(f)||(a[f]=b,d[f]=c[f])})}function W(a,b,c,d,e,h,i,j){var k,l,m=[],o=b[0],p=a.shift(),q=n(p,{templateUrl:null,transclude:null,replace:null,$$originalDirective:p}),r=x(p.templateUrl)?p.templateUrl(b,c):p.templateUrl,s=p.templateNamespace;return b.empty(),g(B.getTrustedResourceUrl(r)).then(function(g){var n,u,v,w;if(g=ka(g),p.replace){if(v=qa(g)?[]:ab($(s,md(g))),n=v[0],1!=v.length||n.nodeType!==sd)throw Xd("tplrt","Template for directive '{0}' must have exactly one root element. {1}",p.name,r);u={$attr:{}},ba(d,b,n);var x=L(n,[],u);t(p.scope)&&R(x),a=x.concat(a),V(c,u)}else n=o,b.html(g);for(a.unshift(q),k=Q(a,n,c,e,b,p,h,i,j),f(d,function(a,c){a==n&&(d[c]=b[0])}),l=H(b[0].childNodes,e);m.length;){var y=m.shift(),z=m.shift(),A=m.shift(),B=m.shift(),C=b[0];if(!y.$$destroyed){if(z!==o){var D=z.className;j.hasElementTranscludeDirective&&p.replace||(C=va(n)),ba(A,ad(z),C),E(ad(C),D)}w=k.transcludeOnThisElement?K(y,k.transclude,B):B,k(l,y,C,d,w)}}m=null}),function(a,b,c,d,e){var f=e;b.$$destroyed||(m?m.push(b,c,d,f):(k.transcludeOnThisElement&&(f=K(b,k.transclude,e)),k(l,b,c,d,f)))}}function X(a,b){var c=b.priority-a.priority;return 0!==c?c:a.name!==b.name?a.name<b.name?-1:1:a.index-b.index}function Y(a,b,c,d){if(b)throw Xd("multidir","Multiple directives [{0}, {1}] asking for {2} on: {3}",b.name,c.name,a,T(d))}function Z(a,b){var c=d(b,!0);c&&a.push({priority:0,compile:function(a){var b=a.parent(),d=!!b.length;return d&&F.$$addBindingClass(b),function(a,b){var e=b.parent();d||F.$$addBindingClass(e),F.$$addBindingInfo(e,c.expressions),a.$watch(c,function(a){b[0].nodeValue=a})}}})}function $(a,c){switch(a=Wc(a||"html")){case"svg":case"math":var d=b.createElement("div");return d.innerHTML="<"+a+">"+c+"</"+a+">",d.childNodes[0].childNodes;default:return c}}function _(a,b){if("srcdoc"==b)return B.HTML;var c=I(a);return"xlinkHref"==b||"form"==c&&"action"==b||"img"!=c&&("src"==b||"ngSrc"==b)?B.RESOURCE_URL:void 0}function aa(a,b,c,e,f){var g=_(a,e);f=r[e]||f;var h=d(c,!0,g,f);if(h){if("multiple"===e&&"select"===I(a))throw Xd("selmulti","Binding to the 'multiple' attribute is not supported. Element: {0}",T(a));b.push({priority:100,compile:function(){return{pre:function(a,b,i){var j=i.$$observers||(i.$$observers={});if(w.test(e))throw Xd("nodomevents","Interpolations for HTML DOM event attributes are disallowed.  Please use the ng- versions (such as ng-click instead of onclick) instead.");var k=i[e];k!==c&&(h=k&&d(k,!0,g,f),c=k),h&&(i[e]=h(a),(j[e]||(j[e]=[])).$$inter=!0,(i.$$observers&&i.$$observers[e].$$scope||a).$watch(h,function(a,b){"class"===e&&a!=b?i.$updateClass(a,b):i.$set(e,a)}))}}}})}}function ba(a,c,d){var e,f,g=c[0],h=c.length,i=g.parentNode;if(a)for(e=0,f=a.length;f>e;e++)if(a[e]==g){a[e++]=d;for(var j=e,k=j+h-1,l=a.length;l>j;j++,k++)l>k?a[j]=a[k]:delete a[j];a.length-=h-1,a.context===g&&(a.context=d);break}i&&i.replaceChild(d,g);var m=b.createDocumentFragment();m.appendChild(g),ad(d).data(ad(g).data()),bd?(kd=!0,bd.cleanData([g])):delete ad.cache[g[ad.expando]];for(var n=1,o=c.length;o>n;n++){var p=c[n];ad(p).remove(),m.appendChild(p),delete c[n]}c[0]=d,c.length=1}function da(a,b){return l(function(){return a.apply(null,arguments)},a,b)}function fa(a,b,c,d,f,g){try{a(b,c,d,f,g)}catch(h){e(h,T(c))}}var ga=function(a,b){if(b){var c,d,e,f=Object.keys(b);for(c=0,d=f.length;d>c;c++)e=f[c],this[e]=b[e]}else this.$attr={};this.$$element=a};ga.prototype={$normalize:$a,$addClass:function(a){a&&a.length>0&&C.addClass(this.$$element,a)},$removeClass:function(a){a&&a.length>0&&C.removeClass(this.$$element,a)},$updateClass:function(a,b){var c=_a(a,b);c&&c.length&&C.addClass(this.$$element,c);var d=_a(b,a);d&&d.length&&C.removeClass(this.$$element,d)},$set:function(a,b,d,g){var h,i=this.$$element[0],j=Ka(i,a),k=La(i,a),l=a;if(j?(this.$$element.prop(a,b),g=j):k&&(this[k]=b,l=k),this[a]=b,g?this.$attr[a]=g:(g=this.$attr[a],g||(this.$attr[a]=g=ca(a,"-"))),h=I(this.$$element),"a"===h&&"href"===a||"img"===h&&"src"===a)this[a]=b=D(b,"src"===a);else if("img"===h&&"srcset"===a){for(var m="",n=md(b),o=/(\s+\d+x\s*,|\s+\d+w\s*,|\s+,|,\s+)/,p=/\s/.test(n)?o:/(,)/,q=n.split(p),r=Math.floor(q.length/2),s=0;r>s;s++){var t=2*s;m+=D(md(q[t]),!0),m+=" "+md(q[t+1])}var u=md(q[2*s]).split(/\s/);m+=D(md(u[0]),!0),2===u.length&&(m+=" "+md(u[1])),this[a]=b=m}d!==!1&&(null===b||b===c?this.$$element.removeAttr(g):this.$$element.attr(g,b));var v=this.$$observers;v&&f(v[l],function(a){try{a(b)}catch(c){e(c)}})},$observe:function(a,b){var c=this,d=c.$$observers||(c.$$observers=ja()),e=d[a]||(d[a]=[]);return e.push(b),s.$evalAsync(function(){!e.$$inter&&c.hasOwnProperty(a)&&b(c[a])}),function(){J(e,b)}}};var ha=d.startSymbol(),ia=d.endSymbol(),ka="{{"==ha||"}}"==ia?p:function(a){return a.replace(/\{\{/g,ha).replace(/}}/g,ia)},la=/^ngAttr[A-Z]/;return F.$$addBindingInfo=y?function(a,b){var c=a.data("$binding")||[];ld(b)?c=c.concat(b):c.push(b),a.data("$binding",c)}:o,F.$$addBindingClass=y?function(a){E(a,"ng-binding")}:o,F.$$addScopeInfo=y?function(a,b,c,d){var e=c?d?"$isolateScopeNoTemplate":"$isolateScope":"$scope";a.data(e,b)}:o,F.$$addScopeClass=y?function(a,b){E(a,b?"ng-isolate-scope":"ng-scope")}:o,F}]}function $a(a){return pa(a.replace(Yd,""))}function _a(a,b){var c="",d=a.split(/\s+/),e=b.split(/\s+/);a:for(var f=0;f<d.length;f++){for(var g=d[f],h=0;h<e.length;h++)if(g==e[h])continue a;c+=(c.length>0?" ":"")+g}return c}function ab(a){a=ad(a);var b=a.length;if(1>=b)return a;for(;b--;){var c=a[b];c.nodeType===vd&&ed.call(a,b,1)}return a}function bb(){var a={},b=!1,e=/^(\S+)(\s+as\s+(\w+))?$/;this.register=function(b,c){ga(b,"controller"),t(b)?l(a,b):a[b]=c},this.allowGlobals=function(){b=!0},this.$get=["$injector","$window",function(f,g){function h(a,b,c,e){if(!a||!t(a.$scope))throw d("$controller")("noscp","Cannot export controller '{0}' as '{1}'! No $scope object provided via `locals`.",e,b);a.$scope[b]=c}return function(d,i,j,k){var m,n,o,p;if(j=j===!0,k&&u(k)&&(p=k),u(d)){if(n=d.match(e),!n)throw Zd("ctrlfmt","Badly formed controller string '{0}'. Must match `__name__ as __id__` or `__name__`.",d);o=n[1],p=p||n[3],d=a.hasOwnProperty(o)?a[o]:ha(i.$scope,o,!0)||(b?ha(g,o,!0):c),fa(d,o,!0)}if(j){var q=(ld(d)?d[d.length-1]:d).prototype;return m=Object.create(q||null),p&&h(i,p,m,o||d.name),l(function(){return f.invoke(d,m,i,o),m},{instance:m,identifier:p})}return m=f.instantiate(d,i,o),p&&h(i,p,m,o||d.name),m}}]}function cb(){this.$get=["$window",function(a){return ad(a.document)}]}function db(){this.$get=["$log",function(a){return function(b,c){a.error.apply(a,arguments)}}]}function eb(a,b){if(u(a)){var c=a.replace(ce,"").trim();if(c){var d=b("Content-Type");(d&&0===d.indexOf($d)||fb(c))&&(a=S(c))}}return a}function fb(a){var b=a.match(ae);return b&&be[b[0]].test(a)}function gb(a){var b,c,d,e=ja();return a?(f(a.split("\n"),function(a){d=a.indexOf(":"),b=Wc(md(a.substr(0,d))),c=md(a.substr(d+1)),b&&(e[b]=e[b]?e[b]+", "+c:c)}),e):e}function hb(a){var b=t(a)?a:c;return function(c){if(b||(b=gb(a)),c){var d=b[Wc(c)];return void 0===d&&(d=null),d}return b}}function ib(a,b,c,d){return x(d)?d(a,b,c):(f(d,function(d){a=d(a,b,c)}),a)}function jb(a){return a>=200&&300>a}function kb(){var a=this.defaults={transformResponse:[eb],transformRequest:[function(a){return!t(a)||B(a)||D(a)||C(a)?a:R(a)}],headers:{common:{Accept:"application/json, text/plain, */*"},post:L(_d),put:L(_d),patch:L(_d)},xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN"},b=!1;this.useApplyAsync=function(a){return s(a)?(b=!!a,this):b};var e=this.interceptors=[];this.$get=["$httpBackend","$browser","$cacheFactory","$rootScope","$q","$injector",function(g,i,j,k,m,n){function o(b){function e(a){var b=l({},a);return a.data?b.data=ib(a.data,a.headers,a.status,i.transformResponse):b.data=a.data,jb(a.status)?b:m.reject(b)}function g(a){var b,c={};return f(a,function(a,d){x(a)?(b=a(),null!=b&&(c[d]=b)):c[d]=a}),c}function h(b){var c,d,e,f=a.headers,h=l({},b.headers);f=l({},f.common,f[Wc(b.method)]);a:for(c in f){d=Wc(c);for(e in h)if(Wc(e)===d)continue a;h[c]=f[c]}return g(h)}if(!id.isObject(b))throw d("$http")("badreq","Http request configuration must be an object.  Received: {0}",b);var i=l({method:"get",transformRequest:a.transformRequest,transformResponse:a.transformResponse},b);i.headers=h(b),i.method=Yc(i.method);var j=function(b){var d=b.headers,g=ib(b.data,hb(d),c,b.transformRequest);return r(g)&&f(d,function(a,b){"content-type"===Wc(b)&&delete d[b]}),r(b.withCredentials)&&!r(a.withCredentials)&&(b.withCredentials=a.withCredentials),v(b,g).then(e,e)},k=[j,c],n=m.when(i);for(f(A,function(a){(a.request||a.requestError)&&k.unshift(a.request,a.requestError),(a.response||a.responseError)&&k.push(a.response,a.responseError)});k.length;){var o=k.shift(),p=k.shift();n=n.then(o,p)}return n.success=function(a){return fa(a,"fn"),n.then(function(b){a(b.data,b.status,b.headers,i)}),n},n.error=function(a){return fa(a,"fn"),n.then(null,function(b){a(b.data,b.status,b.headers,i)}),n},n}function p(a){f(arguments,function(a){o[a]=function(b,c){return o(l(c||{},{method:a,url:b}))}})}function q(a){f(arguments,function(a){o[a]=function(b,c,d){return o(l(d||{},{method:a,url:b,data:c}))}})}function v(d,e){function f(a,c,d,e){function f(){h(c,a,d,e)}n&&(jb(a)?n.put(w,[a,c,gb(d),e]):n.remove(w)),b?k.$applyAsync(f):(f(),k.$$phase||k.$apply())}function h(a,b,c,e){b=Math.max(b,0),(jb(b)?q.resolve:q.reject)({data:a,status:b,headers:hb(c),config:d,statusText:e})}function j(a){h(a.data,a.status,L(a.headers()),a.statusText)}function l(){var a=o.pendingRequests.indexOf(d);-1!==a&&o.pendingRequests.splice(a,1)}var n,p,q=m.defer(),u=q.promise,v=d.headers,w=y(d.url,d.params);if(o.pendingRequests.push(d),u.then(l,l),!d.cache&&!a.cache||d.cache===!1||"GET"!==d.method&&"JSONP"!==d.method||(n=t(d.cache)?d.cache:t(a.cache)?a.cache:z),n&&(p=n.get(w),s(p)?F(p)?p.then(j,j):ld(p)?h(p[1],p[0],L(p[2]),p[3]):h(p,200,{},"OK"):n.put(w,u)),r(p)){var x=ec(d.url)?i.cookies()[d.xsrfCookieName||a.xsrfCookieName]:c;x&&(v[d.xsrfHeaderName||a.xsrfHeaderName]=x),g(d.method,w,e,f,v,d.timeout,d.withCredentials,d.responseType)}return u}function y(a,b){if(!b)return a;var c=[];return h(b,function(a,b){null===a||r(a)||(ld(a)||(a=[a]),f(a,function(a){t(a)&&(a=w(a)?a.toISOString():R(a)),c.push(Y(b)+"="+Y(a))}))}),c.length>0&&(a+=(-1==a.indexOf("?")?"?":"&")+c.join("&")),a}var z=j("$http"),A=[];return f(e,function(a){A.unshift(u(a)?n.get(a):n.invoke(a))}),o.pendingRequests=[],p("get","delete","head","jsonp"),q("post","put","patch"),o.defaults=a,o}]}function lb(){return new a.XMLHttpRequest}function mb(){this.$get=["$browser","$window","$document",function(a,b,c){return nb(a,lb,a.defer,b.angular.callbacks,c[0])}]}function nb(a,b,d,e,g){function h(a,b,c){var d=g.createElement("script"),f=null;return d.type="text/javascript",d.src=a,d.async=!0,f=function(a){Cd(d,"load",f),Cd(d,"error",f),g.body.removeChild(d),d=null;var h=-1,i="unknown";a&&("load"!==a.type||e[b].called||(a={type:"error"}),i=a.type,h="error"===a.type?404:200),c&&c(h,i)},Bd(d,"load",f),Bd(d,"error",f),g.body.appendChild(d),f}return function(g,i,j,k,l,m,n,p){function q(){u&&u(),v&&v.abort()}function r(b,e,f,g,h){y!==c&&d.cancel(y),u=v=null,b(e,f,g,h),a.$$completeOutstandingRequest(o)}if(a.$$incOutstandingRequestCount(),i=i||a.url(),"jsonp"==Wc(g)){var t="_"+(e.counter++).toString(36);e[t]=function(a){e[t].data=a,e[t].called=!0};var u=h(i.replace("JSON_CALLBACK","angular.callbacks."+t),t,function(a,b){r(k,a,e[t].data,"",b),e[t]=o})}else{var v=b();v.open(g,i,!0),f(l,function(a,b){s(a)&&v.setRequestHeader(b,a)}),v.onload=function(){var a=v.statusText||"",b="response"in v?v.response:v.responseText,c=1223===v.status?204:v.status;0===c&&(c=b?200:"file"==dc(i).protocol?404:0),r(k,c,b,v.getAllResponseHeaders(),a)};var w=function(){r(k,-1,null,null,"")};if(v.onerror=w,v.onabort=w,n&&(v.withCredentials=!0),p)try{v.responseType=p}catch(x){if("json"!==p)throw x}v.send(j||null)}if(m>0)var y=d(q,m);else F(m)&&m.then(q)}}function ob(){var a="{{",b="}}";this.startSymbol=function(b){return b?(a=b,this):a},this.endSymbol=function(a){return a?(b=a,this):b},this.$get=["$parse","$exceptionHandler","$sce",function(c,d,e){function f(a){return"\\\\\\"+a}function g(f,g,m,n){function o(c){return c.replace(j,a).replace(k,b)}function p(a){try{return a=D(a),n&&!s(a)?a:E(a)}catch(b){var c=de("interr","Can't interpolate: {0}\n{1}",f,b.toString());d(c)}}n=!!n;for(var q,t,u,v=0,w=[],y=[],z=f.length,A=[],B=[];z>v;){if(-1==(q=f.indexOf(a,v))||-1==(t=f.indexOf(b,q+h))){v!==z&&A.push(o(f.substring(v)));break}v!==q&&A.push(o(f.substring(v,q))),u=f.substring(q+h,t),w.push(u),y.push(c(u,p)),v=t+i,B.push(A.length),A.push("")}if(m&&A.length>1)throw de("noconcat","Error while interpolating: {0}\nStrict Contextual Escaping disallows interpolations that concatenate multiple expressions when a trusted value is required.  See http://docs.angularjs.org/api/ng.$sce",f);if(!g||w.length){var C=function(a){for(var b=0,c=w.length;c>b;b++){if(n&&r(a[b]))return;A[B[b]]=a[b]}return A.join("")},D=function(a){return m?e.getTrusted(m,a):e.valueOf(a)},E=function(a){if(null==a)return"";switch(typeof a){case"string":break;case"number":a=""+a;break;default:a=R(a)}return a};return l(function(a){var b=0,c=w.length,e=new Array(c);try{for(;c>b;b++)e[b]=y[b](a);return C(e)}catch(g){var h=de("interr","Can't interpolate: {0}\n{1}",f,g.toString());d(h)}},{exp:f,expressions:w,$$watchDelegate:function(a,b,c){var d;return a.$watchGroup(y,function(c,e){var f=C(c);x(b)&&b.call(this,f,c!==e?d:f,a),d=f},c)}})}}var h=a.length,i=b.length,j=new RegExp(a.replace(/./g,f),"g"),k=new RegExp(b.replace(/./g,f),"g");return g.startSymbol=function(){return a},g.endSymbol=function(){return b},g}]}function pb(){this.$get=["$rootScope","$window","$q","$$q",function(a,b,c,d){function e(e,g,h,i){var j=b.setInterval,k=b.clearInterval,l=0,m=s(i)&&!i,n=(m?d:c).defer(),o=n.promise;return h=s(h)?h:0,o.then(null,null,e),o.$$intervalId=j(function(){n.notify(l++),h>0&&l>=h&&(n.resolve(l),k(o.$$intervalId),delete f[o.$$intervalId]),m||a.$apply()},g),f[o.$$intervalId]=n,o}var f={};return e.cancel=function(a){return a&&a.$$intervalId in f?(f[a.$$intervalId].reject("canceled"),b.clearInterval(a.$$intervalId),delete f[a.$$intervalId],!0):!1},e}]}function qb(){this.$get=function(){return{id:"en-us",NUMBER_FORMATS:{DECIMAL_SEP:".",GROUP_SEP:",",PATTERNS:[{minInt:1,minFrac:0,maxFrac:3,posPre:"",posSuf:"",negPre:"-",negSuf:"",gSize:3,lgSize:3},{minInt:1,minFrac:2,maxFrac:2,posPre:"¤",posSuf:"",negPre:"(¤",negSuf:")",gSize:3,lgSize:3}],CURRENCY_SYM:"$"},DATETIME_FORMATS:{MONTH:"January,February,March,April,May,June,July,August,September,October,November,December".split(","),SHORTMONTH:"Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec".split(","),DAY:"Sunday,Monday,Tuesday,Wednesday,Thursday,Friday,Saturday".split(","),SHORTDAY:"Sun,Mon,Tue,Wed,Thu,Fri,Sat".split(","),AMPMS:["AM","PM"],medium:"MMM d, y h:mm:ss a","short":"M/d/yy h:mm a",fullDate:"EEEE, MMMM d, y",longDate:"MMMM d, y",mediumDate:"MMM d, y",shortDate:"M/d/yy",mediumTime:"h:mm:ss a",shortTime:"h:mm a",ERANAMES:["Before Christ","Anno Domini"],ERAS:["BC","AD"]},pluralCat:function(a){return 1===a?"one":"other"}}}}function rb(a){for(var b=a.split("/"),c=b.length;c--;)b[c]=X(b[c]);return b.join("/")}function sb(a,b){var c=dc(a);b.$$protocol=c.protocol,b.$$host=c.hostname,b.$$port=m(c.port)||fe[c.protocol]||null}function tb(a,b){var c="/"!==a.charAt(0);c&&(a="/"+a);var d=dc(a);b.$$path=decodeURIComponent(c&&"/"===d.pathname.charAt(0)?d.pathname.substring(1):d.pathname),b.$$search=V(d.search),b.$$hash=decodeURIComponent(d.hash),b.$$path&&"/"!=b.$$path.charAt(0)&&(b.$$path="/"+b.$$path)}function ub(a,b){return 0===b.indexOf(a)?b.substr(a.length):void 0}function vb(a){var b=a.indexOf("#");return-1==b?a:a.substr(0,b)}function wb(a){return a.replace(/(#.+)|#$/,"$1")}function xb(a){return a.substr(0,vb(a).lastIndexOf("/")+1)}function yb(a){return a.substring(0,a.indexOf("/",a.indexOf("//")+2))}function zb(a,b){this.$$html5=!0,b=b||"";var d=xb(a);sb(a,this),this.$$parse=function(a){var b=ub(d,a);if(!u(b))throw ge("ipthprfx",'Invalid url "{0}", missing path prefix "{1}".',a,d);tb(b,this),this.$$path||(this.$$path="/"),this.$$compose()},this.$$compose=function(){var a=W(this.$$search),b=this.$$hash?"#"+X(this.$$hash):"";this.$$url=rb(this.$$path)+(a?"?"+a:"")+b,this.$$absUrl=d+this.$$url.substr(1)},this.$$parseLinkUrl=function(e,f){if(f&&"#"===f[0])return this.hash(f.slice(1)),!0;var g,h,i;return(g=ub(a,e))!==c?(h=g,i=(g=ub(b,g))!==c?d+(ub("/",g)||g):a+h):(g=ub(d,e))!==c?i=d+g:d==e+"/"&&(i=d),i&&this.$$parse(i),!!i}}function Ab(a,b){var c=xb(a);sb(a,this),this.$$parse=function(d){function e(a,b,c){var d,e=/^\/[A-Z]:(\/.*)/;return 0===b.indexOf(c)&&(b=b.replace(c,"")),e.exec(b)?a:(d=e.exec(a),d?d[1]:a)}var f,g=ub(a,d)||ub(c,d);"#"===g.charAt(0)?(f=ub(b,g),r(f)&&(f=g)):f=this.$$html5?g:"",tb(f,this),this.$$path=e(this.$$path,f,a),this.$$compose()},this.$$compose=function(){var c=W(this.$$search),d=this.$$hash?"#"+X(this.$$hash):"";this.$$url=rb(this.$$path)+(c?"?"+c:"")+d,this.$$absUrl=a+(this.$$url?b+this.$$url:"")},this.$$parseLinkUrl=function(b,c){return vb(a)==vb(b)?(this.$$parse(b),!0):!1}}function Bb(a,b){this.$$html5=!0,Ab.apply(this,arguments);var c=xb(a);this.$$parseLinkUrl=function(d,e){if(e&&"#"===e[0])return this.hash(e.slice(1)),!0;var f,g;return a==vb(d)?f=d:(g=ub(c,d))?f=a+b+g:c===d+"/"&&(f=c),f&&this.$$parse(f),!!f},this.$$compose=function(){var c=W(this.$$search),d=this.$$hash?"#"+X(this.$$hash):"";this.$$url=rb(this.$$path)+(c?"?"+c:"")+d,this.$$absUrl=a+b+this.$$url}}function Cb(a){return function(){return this[a]}}function Db(a,b){return function(c){return r(c)?this[a]:(this[a]=b(c),this.$$compose(),this)}}function Eb(){var a="",b={enabled:!1,requireBase:!0,rewriteLinks:!0};this.hashPrefix=function(b){return s(b)?(a=b,this):a},this.html5Mode=function(a){return E(a)?(b.enabled=a,this):t(a)?(E(a.enabled)&&(b.enabled=a.enabled),E(a.requireBase)&&(b.requireBase=a.requireBase),E(a.rewriteLinks)&&(b.rewriteLinks=a.rewriteLinks),this):b},this.$get=["$rootScope","$browser","$sniffer","$rootElement","$window",function(c,d,e,f,g){function h(a,b,c){var e=j.url(),f=j.$$state;try{d.url(a,b,c),j.$$state=d.state()}catch(g){throw j.url(e),j.$$state=f,g}}function i(a,b){c.$broadcast("$locationChangeSuccess",j.absUrl(),a,j.$$state,b)}var j,k,l,m=d.baseHref(),n=d.url();if(b.enabled){if(!m&&b.requireBase)throw ge("nobase","$location in HTML5 mode requires a <base> tag to be present!");l=yb(n)+(m||"/"),k=e.history?zb:Bb}else l=vb(n),k=Ab;j=new k(l,"#"+a),j.$$parseLinkUrl(n,n),j.$$state=d.state();var o=/^\s*(javascript|mailto):/i;f.on("click",function(a){if(b.rewriteLinks&&!a.ctrlKey&&!a.metaKey&&!a.shiftKey&&2!=a.which&&2!=a.button){for(var e=ad(a.target);"a"!==I(e[0]);)if(e[0]===f[0]||!(e=e.parent())[0])return;var h=e.prop("href"),i=e.attr("href")||e.attr("xlink:href");t(h)&&"[object SVGAnimatedString]"===h.toString()&&(h=dc(h.animVal).href),o.test(h)||!h||e.attr("target")||a.isDefaultPrevented()||j.$$parseLinkUrl(h,i)&&(a.preventDefault(),j.absUrl()!=d.url()&&(c.$apply(),g.angular["ff-684208-preventDefault"]=!0))}}),wb(j.absUrl())!=wb(n)&&d.url(j.absUrl(),!0);var p=!0;return d.onUrlChange(function(a,b){c.$evalAsync(function(){var d,e=j.absUrl(),f=j.$$state;j.$$parse(a),j.$$state=b,d=c.$broadcast("$locationChangeStart",a,e,b,f).defaultPrevented,j.absUrl()===a&&(d?(j.$$parse(e),j.$$state=f,h(e,!1,f)):(p=!1,i(e,f)))}),c.$$phase||c.$digest()}),c.$watch(function(){var a=wb(d.url()),b=wb(j.absUrl()),f=d.state(),g=j.$$replace,k=a!==b||j.$$html5&&e.history&&f!==j.$$state;(p||k)&&(p=!1,c.$evalAsync(function(){var b=j.absUrl(),d=c.$broadcast("$locationChangeStart",b,a,j.$$state,f).defaultPrevented;j.absUrl()===b&&(d?(j.$$parse(a),j.$$state=f):(k&&h(b,g,f===j.$$state?null:j.$$state),i(a,f)))})),j.$$replace=!1}),j}]}function Fb(){var a=!0,b=this;this.debugEnabled=function(b){return s(b)?(a=b,this):a},this.$get=["$window",function(c){function d(a){return a instanceof Error&&(a.stack?a=a.message&&-1===a.stack.indexOf(a.message)?"Error: "+a.message+"\n"+a.stack:a.stack:a.sourceURL&&(a=a.message+"\n"+a.sourceURL+":"+a.line)),a}function e(a){var b=c.console||{},e=b[a]||b.log||o,g=!1;try{g=!!e.apply}catch(h){}return g?function(){var a=[];return f(arguments,function(b){a.push(d(b))}),e.apply(b,a)}:function(a,b){e(a,null==b?"":b)}}return{log:e("log"),info:e("info"),warn:e("warn"),error:e("error"),debug:function(){var c=e("debug");return function(){a&&c.apply(b,arguments)}}()}}]}function Gb(a,b){if("__defineGetter__"===a||"__defineSetter__"===a||"__lookupGetter__"===a||"__lookupSetter__"===a||"__proto__"===a)throw ie("isecfld","Attempting to access a disallowed field in Angular expressions! Expression: {0}",b);return a}function Hb(a,b){if(a){if(a.constructor===a)throw ie("isecfn","Referencing Function in Angular expressions is disallowed! Expression: {0}",b);if(a.window===a)throw ie("isecwindow","Referencing the Window in Angular expressions is disallowed! Expression: {0}",b);if(a.children&&(a.nodeName||a.prop&&a.attr&&a.find))throw ie("isecdom","Referencing DOM nodes in Angular expressions is disallowed! Expression: {0}",b);if(a===Object)throw ie("isecobj","Referencing Object in Angular expressions is disallowed! Expression: {0}",b)}return a}function Ib(a,b){if(a){if(a.constructor===a)throw ie("isecfn","Referencing Function in Angular expressions is disallowed! Expression: {0}",b);if(a===je||a===ke||a===le)throw ie("isecff","Referencing call, apply or bind in Angular expressions is disallowed! Expression: {0}",b)}}function Jb(a){return a.constant}function Kb(a,b,c,d,e){Hb(a,e),Hb(b,e);for(var f,g=c.split("."),h=0;g.length>1;h++){f=Gb(g.shift(),e);var i=0===h&&b&&b[f]||a[f];i||(i={},a[f]=i),a=Hb(i,e)}return f=Gb(g.shift(),e),Hb(a[f],e),a[f]=d,d}function Lb(a){return"constructor"==a}function Mb(a,b,d,e,f,g,h){Gb(a,g),Gb(b,g),Gb(d,g),Gb(e,g),Gb(f,g);var i=function(a){return Hb(a,g)},j=h||Lb(a)?i:p,k=h||Lb(b)?i:p,l=h||Lb(d)?i:p,m=h||Lb(e)?i:p,n=h||Lb(f)?i:p;return function(g,h){var i=h&&h.hasOwnProperty(a)?h:g;return null==i?i:(i=j(i[a]),b?null==i?c:(i=k(i[b]),d?null==i?c:(i=l(i[d]),e?null==i?c:(i=m(i[e]),f?null==i?c:i=n(i[f]):i):i):i):i)}}function Nb(a,b){return function(c,d){return a(c,d,Hb,b)}}function Ob(a,b,d){var e=b.expensiveChecks,g=e?se:re,h=g[a];if(h)return h;var i=a.split("."),j=i.length;if(b.csp)h=6>j?Mb(i[0],i[1],i[2],i[3],i[4],d,e):function(a,b){var f,g=0;do f=Mb(i[g++],i[g++],i[g++],i[g++],i[g++],d,e)(a,b),b=c,a=f;while(j>g);return f};else{var k="";e&&(k+="s = eso(s, fe);\nl = eso(l, fe);\n");var l=e;f(i,function(a,b){Gb(a,d);var c=(b?"s":'((l&&l.hasOwnProperty("'+a+'"))?l:s)')+"."+a;(e||Lb(a))&&(c="eso("+c+", fe)",l=!0),k+="if(s == null) return undefined;\ns="+c+";\n"}),k+="return s;";var m=new Function("s","l","eso","fe",k);m.toString=q(k),l&&(m=Nb(m,d)),h=m}return h.sharedGetter=!0,h.assign=function(b,c,d){return Kb(b,d,a,c,a)},g[a]=h,h}function Pb(a){return x(a.valueOf)?a.valueOf():te.call(a)}function Qb(){var a=ja(),b=ja();this.$get=["$filter","$sniffer",function(c,d){function e(a){var b=a;return a.sharedGetter&&(b=function(b,c){return a(b,c)},b.literal=a.literal,b.constant=a.constant,b.assign=a.assign),b}function g(a,b){for(var c=0,d=a.length;d>c;c++){var e=a[c];e.constant||(e.inputs?g(e.inputs,b):-1===b.indexOf(e)&&b.push(e))}return b}function h(a,b){return null==a||null==b?a===b:"object"==typeof a&&(a=Pb(a),"object"==typeof a)?!1:a===b||a!==a&&b!==b}function i(a,b,c,d){var e,f=d.$$inputs||(d.$$inputs=g(d.inputs,[]));if(1===f.length){var i=h;return f=f[0],a.$watch(function(a){var b=f(a);return h(b,i)||(e=d(a),i=b&&Pb(b)),e},b,c)}for(var j=[],k=0,l=f.length;l>k;k++)j[k]=h;return a.$watch(function(a){for(var b=!1,c=0,g=f.length;g>c;c++){var i=f[c](a);(b||(b=!h(i,j[c])))&&(j[c]=i&&Pb(i))}return b&&(e=d(a)),e},b,c)}function j(a,b,c,d){var e,f;return e=a.$watch(function(a){return d(a)},function(a,c,d){f=a,x(b)&&b.apply(this,arguments),s(a)&&d.$$postDigest(function(){s(f)&&e()})},c)}function k(a,b,c,d){function e(a){var b=!0;return f(a,function(a){s(a)||(b=!1)}),b}var g,h;return g=a.$watch(function(a){return d(a)},function(a,c,d){h=a,x(b)&&b.call(this,a,c,d),e(a)&&d.$$postDigest(function(){e(h)&&g()})},c)}function l(a,b,c,d){var e;return e=a.$watch(function(a){return d(a)},function(a,c,d){x(b)&&b.apply(this,arguments),e()},c)}function m(a,b){if(!b)return a;var c=a.$$watchDelegate,d=c!==k&&c!==j,e=d?function(c,d){var e=a(c,d);return b(e,c,d)}:function(c,d){var e=a(c,d),f=b(e,c,d);return s(e)?f:e};return a.$$watchDelegate&&a.$$watchDelegate!==i?e.$$watchDelegate=a.$$watchDelegate:b.$stateful||(e.$$watchDelegate=i,e.inputs=[a]),e}var n={csp:d.csp,expensiveChecks:!1},p={csp:d.csp,expensiveChecks:!0};return function(d,f,g){var h,q,r;switch(typeof d){case"string":r=d=d.trim();var s=g?b:a;if(h=s[r],!h){":"===d.charAt(0)&&":"===d.charAt(1)&&(q=!0,d=d.substring(2));var t=g?p:n,u=new pe(t),v=new qe(u,c,t);h=v.parse(d),h.constant?h.$$watchDelegate=l:q?(h=e(h),h.$$watchDelegate=h.literal?k:j):h.inputs&&(h.$$watchDelegate=i),s[r]=h}return m(h,f);case"function":return m(d,f);default:return m(o,f)}}}]}function Rb(){this.$get=["$rootScope","$exceptionHandler",function(a,b){return Tb(function(b){a.$evalAsync(b)},b)}]}function Sb(){this.$get=["$browser","$exceptionHandler",function(a,b){return Tb(function(b){a.defer(b)},b)}]}function Tb(a,b){function e(a,b,c){function d(b){return function(c){e||(e=!0,b.call(a,c))}}var e=!1;return[d(b),d(c)]}function g(){this.$$state={status:0}}function h(a,b){return function(c){b.call(a,c)}}function i(a){var d,e,f;f=a.pending,a.processScheduled=!1,a.pending=c;for(var g=0,h=f.length;h>g;++g){e=f[g][0],d=f[g][a.status];try{x(d)?e.resolve(d(a.value)):1===a.status?e.resolve(a.value):e.reject(a.value)}catch(i){e.reject(i),b(i)}}}function j(b){!b.processScheduled&&b.pending&&(b.processScheduled=!0,a(function(){i(b)}))}function k(){this.promise=new g,this.resolve=h(this,this.resolve),this.reject=h(this,this.reject),this.notify=h(this,this.notify)}function l(a){var b=new k,c=0,d=ld(a)?[]:{};return f(a,function(a,e){c++,r(a).then(function(a){d.hasOwnProperty(e)||(d[e]=a,--c||b.resolve(d))},function(a){d.hasOwnProperty(e)||b.reject(a)})}),0===c&&b.resolve(d),b.promise}var m=d("$q",TypeError),n=function(){return new k};g.prototype={then:function(a,b,c){var d=new k;return this.$$state.pending=this.$$state.pending||[],this.$$state.pending.push([d,a,b,c]),this.$$state.status>0&&j(this.$$state),d.promise},"catch":function(a){return this.then(null,a)},"finally":function(a,b){return this.then(function(b){return q(b,!0,a)},function(b){return q(b,!1,a)},b)}},k.prototype={resolve:function(a){this.promise.$$state.status||(a===this.promise?this.$$reject(m("qcycle","Expected promise to be resolved with value other than itself '{0}'",a)):this.$$resolve(a))},$$resolve:function(a){var c,d;d=e(this,this.$$resolve,this.$$reject);try{(t(a)||x(a))&&(c=a&&a.then),x(c)?(this.promise.$$state.status=-1,c.call(a,d[0],d[1],this.notify)):(this.promise.$$state.value=a,this.promise.$$state.status=1,j(this.promise.$$state))}catch(f){d[1](f),b(f)}},reject:function(a){this.promise.$$state.status||this.$$reject(a)},$$reject:function(a){this.promise.$$state.value=a,this.promise.$$state.status=2,j(this.promise.$$state)},notify:function(c){var d=this.promise.$$state.pending;this.promise.$$state.status<=0&&d&&d.length&&a(function(){for(var a,e,f=0,g=d.length;g>f;f++){e=d[f][0],a=d[f][3];try{e.notify(x(a)?a(c):c)}catch(h){b(h)}}})}};var o=function(a){var b=new k;return b.reject(a),b.promise},p=function(a,b){var c=new k;return b?c.resolve(a):c.reject(a),c.promise},q=function(a,b,c){var d=null;try{x(c)&&(d=c())}catch(e){return p(e,!1)}return F(d)?d.then(function(){return p(a,b)},function(a){return p(a,!1)}):p(a,b)},r=function(a,b,c,d){var e=new k;return e.resolve(a),e.promise.then(b,c,d)},s=function u(a){function b(a){d.resolve(a)}function c(a){d.reject(a)}if(!x(a))throw m("norslvr","Expected resolverFn, got '{0}'",a);if(!(this instanceof u))return new u(a);var d=new k;return a(b,c),d.promise};return s.defer=n,s.reject=o,s.when=r,s.all=l,s}function Ub(){this.$get=["$window","$timeout",function(a,b){function c(){for(var a=0;a<k.length;a++){var b=k[a];b&&(k[a]=null,b())}j=k.length=0}function d(a){var b=k.length;return j++,k.push(a),0===b&&(i=h(c)),function(){b>=0&&(k[b]=null,b=null,0===--j&&i&&(i(),i=null,k.length=0))}}var e=a.requestAnimationFrame||a.webkitRequestAnimationFrame,f=a.cancelAnimationFrame||a.webkitCancelAnimationFrame||a.webkitCancelRequestAnimationFrame,g=!!e,h=g?function(a){var b=e(a);return function(){f(b)}}:function(a){var c=b(a,16.66,!1);return function(){b.cancel(c)}};d.supported=g;var i,j=0,k=[];return d}]}function Vb(){function a(a){function b(){this.$$watchers=this.$$nextSibling=this.$$childHead=this.$$childTail=null,this.$$listeners={},this.$$listenerCount={},this.$id=j(),this.$$ChildScope=null}return b.prototype=a,b}var b=10,c=d("$rootScope"),g=null,h=null;this.digestTtl=function(a){return arguments.length&&(b=a),b},this.$get=["$injector","$exceptionHandler","$parse","$browser",function(d,i,k,l){function m(a){a.currentScope.$$destroyed=!0}function n(){this.$id=j(),this.$$phase=this.$parent=this.$$watchers=this.$$nextSibling=this.$$prevSibling=this.$$childHead=this.$$childTail=null,this.$root=this,this.$$destroyed=!1,this.$$listeners={},this.$$listenerCount={},this.$$isolateBindings=null}function p(a){if(y.$$phase)throw c("inprog","{0} already in progress",y.$$phase);y.$$phase=a}function q(){y.$$phase=null}function s(a,b,c){do a.$$listenerCount[c]-=b,0===a.$$listenerCount[c]&&delete a.$$listenerCount[c];while(a=a.$parent)}function u(){}function v(){for(;B.length;)try{B.shift()()}catch(a){i(a)}h=null}function w(){null===h&&(h=l.defer(function(){y.$apply(v)}))}n.prototype={constructor:n,$new:function(b,c){var d;return c=c||this,b?(d=new n,d.$root=this.$root):(this.$$ChildScope||(this.$$ChildScope=a(this)),d=new this.$$ChildScope),d.$parent=c,d.$$prevSibling=c.$$childTail,c.$$childHead?(c.$$childTail.$$nextSibling=d,c.$$childTail=d):c.$$childHead=c.$$childTail=d,
(b||c!=this)&&d.$on("$destroy",m),d},$watch:function(a,b,c){var d=k(a);if(d.$$watchDelegate)return d.$$watchDelegate(this,b,c,d);var e=this,f=e.$$watchers,h={fn:b,last:u,get:d,exp:a,eq:!!c};return g=null,x(b)||(h.fn=o),f||(f=e.$$watchers=[]),f.unshift(h),function(){J(f,h),g=null}},$watchGroup:function(a,b){function c(){i=!1,j?(j=!1,b(e,e,h)):b(e,d,h)}var d=new Array(a.length),e=new Array(a.length),g=[],h=this,i=!1,j=!0;if(!a.length){var k=!0;return h.$evalAsync(function(){k&&b(e,e,h)}),function(){k=!1}}return 1===a.length?this.$watch(a[0],function(a,c,f){e[0]=a,d[0]=c,b(e,a===c?e:d,f)}):(f(a,function(a,b){var f=h.$watch(a,function(a,f){e[b]=a,d[b]=f,i||(i=!0,h.$evalAsync(c))});g.push(f)}),function(){for(;g.length;)g.shift()()})},$watchCollection:function(a,b){function c(a){f=a;var b,c,d,h,i;if(!r(f)){if(t(f))if(e(f)){g!==n&&(g=n,q=g.length=0,l++),b=f.length,q!==b&&(l++,g.length=q=b);for(var j=0;b>j;j++)i=g[j],h=f[j],d=i!==i&&h!==h,d||i===h||(l++,g[j]=h)}else{g!==o&&(g=o={},q=0,l++),b=0;for(c in f)f.hasOwnProperty(c)&&(b++,h=f[c],i=g[c],c in g?(d=i!==i&&h!==h,d||i===h||(l++,g[c]=h)):(q++,g[c]=h,l++));if(q>b){l++;for(c in g)f.hasOwnProperty(c)||(q--,delete g[c])}}else g!==f&&(g=f,l++);return l}}function d(){if(p?(p=!1,b(f,f,i)):b(f,h,i),j)if(t(f))if(e(f)){h=new Array(f.length);for(var a=0;a<f.length;a++)h[a]=f[a]}else{h={};for(var c in f)Xc.call(f,c)&&(h[c]=f[c])}else h=f}c.$stateful=!0;var f,g,h,i=this,j=b.length>1,l=0,m=k(a,c),n=[],o={},p=!0,q=0;return this.$watch(m,d)},$digest:function(){var a,d,e,f,j,k,m,n,o,r,s=b,t=this,w=[];p("$digest"),l.$$checkUrlChange(),this===y&&null!==h&&(l.defer.cancel(h),v()),g=null;do{for(k=!1,n=t;z.length;){try{r=z.shift(),r.scope.$eval(r.expression,r.locals)}catch(B){i(B)}g=null}a:do{if(f=n.$$watchers)for(j=f.length;j--;)try{if(a=f[j])if((d=a.get(n))===(e=a.last)||(a.eq?M(d,e):"number"==typeof d&&"number"==typeof e&&isNaN(d)&&isNaN(e))){if(a===g){k=!1;break a}}else k=!0,g=a,a.last=a.eq?K(d,null):d,a.fn(d,e===u?d:e,n),5>s&&(o=4-s,w[o]||(w[o]=[]),w[o].push({msg:x(a.exp)?"fn: "+(a.exp.name||a.exp.toString()):a.exp,newVal:d,oldVal:e}))}catch(B){i(B)}if(!(m=n.$$childHead||n!==t&&n.$$nextSibling))for(;n!==t&&!(m=n.$$nextSibling);)n=n.$parent}while(n=m);if((k||z.length)&&!s--)throw q(),c("infdig","{0} $digest() iterations reached. Aborting!\nWatchers fired in the last 5 iterations: {1}",b,w)}while(k||z.length);for(q();A.length;)try{A.shift()()}catch(B){i(B)}},$destroy:function(){if(!this.$$destroyed){var a=this.$parent;if(this.$broadcast("$destroy"),this.$$destroyed=!0,this!==y){for(var b in this.$$listenerCount)s(this,this.$$listenerCount[b],b);a.$$childHead==this&&(a.$$childHead=this.$$nextSibling),a.$$childTail==this&&(a.$$childTail=this.$$prevSibling),this.$$prevSibling&&(this.$$prevSibling.$$nextSibling=this.$$nextSibling),this.$$nextSibling&&(this.$$nextSibling.$$prevSibling=this.$$prevSibling),this.$destroy=this.$digest=this.$apply=this.$evalAsync=this.$applyAsync=o,this.$on=this.$watch=this.$watchGroup=function(){return o},this.$$listeners={},this.$parent=this.$$nextSibling=this.$$prevSibling=this.$$childHead=this.$$childTail=this.$root=this.$$watchers=null}}},$eval:function(a,b){return k(a)(this,b)},$evalAsync:function(a,b){y.$$phase||z.length||l.defer(function(){z.length&&y.$digest()}),z.push({scope:this,expression:a,locals:b})},$$postDigest:function(a){A.push(a)},$apply:function(a){try{return p("$apply"),this.$eval(a)}catch(b){i(b)}finally{q();try{y.$digest()}catch(b){throw i(b),b}}},$applyAsync:function(a){function b(){c.$eval(a)}var c=this;a&&B.push(b),w()},$on:function(a,b){var c=this.$$listeners[a];c||(this.$$listeners[a]=c=[]),c.push(b);var d=this;do d.$$listenerCount[a]||(d.$$listenerCount[a]=0),d.$$listenerCount[a]++;while(d=d.$parent);var e=this;return function(){var d=c.indexOf(b);-1!==d&&(c[d]=null,s(e,1,a))}},$emit:function(a,b){var c,d,e,f=[],g=this,h=!1,j={name:a,targetScope:g,stopPropagation:function(){h=!0},preventDefault:function(){j.defaultPrevented=!0},defaultPrevented:!1},k=N([j],arguments,1);do{for(c=g.$$listeners[a]||f,j.currentScope=g,d=0,e=c.length;e>d;d++)if(c[d])try{c[d].apply(null,k)}catch(l){i(l)}else c.splice(d,1),d--,e--;if(h)return j.currentScope=null,j;g=g.$parent}while(g);return j.currentScope=null,j},$broadcast:function(a,b){var c=this,d=c,e=c,f={name:a,targetScope:c,preventDefault:function(){f.defaultPrevented=!0},defaultPrevented:!1};if(!c.$$listenerCount[a])return f;for(var g,h,j,k=N([f],arguments,1);d=e;){for(f.currentScope=d,g=d.$$listeners[a]||[],h=0,j=g.length;j>h;h++)if(g[h])try{g[h].apply(null,k)}catch(l){i(l)}else g.splice(h,1),h--,j--;if(!(e=d.$$listenerCount[a]&&d.$$childHead||d!==c&&d.$$nextSibling))for(;d!==c&&!(e=d.$$nextSibling);)d=d.$parent}return f.currentScope=null,f}};var y=new n,z=y.$$asyncQueue=[],A=y.$$postDigestQueue=[],B=y.$$applyAsyncQueue=[];return y}]}function Wb(){var a=/^\s*(https?|ftp|mailto|tel|file):/,b=/^\s*((https?|ftp|file|blob):|data:image\/)/;this.aHrefSanitizationWhitelist=function(b){return s(b)?(a=b,this):a},this.imgSrcSanitizationWhitelist=function(a){return s(a)?(b=a,this):b},this.$get=function(){return function(c,d){var e,f=d?b:a;return e=dc(c).href,""===e||e.match(f)?c:"unsafe:"+e}}}function Xb(a){if("self"===a)return a;if(u(a)){if(a.indexOf("***")>-1)throw ue("iwcard","Illegal sequence *** in string matcher.  String: {0}",a);return a=nd(a).replace("\\*\\*",".*").replace("\\*","[^:/.?&;]*"),new RegExp("^"+a+"$")}if(y(a))return new RegExp("^"+a.source+"$");throw ue("imatcher",'Matchers may only be "self", string patterns or RegExp objects')}function Yb(a){var b=[];return s(a)&&f(a,function(a){b.push(Xb(a))}),b}function Zb(){this.SCE_CONTEXTS=ve;var a=["self"],b=[];this.resourceUrlWhitelist=function(b){return arguments.length&&(a=Yb(b)),a},this.resourceUrlBlacklist=function(a){return arguments.length&&(b=Yb(a)),b},this.$get=["$injector",function(d){function e(a,b){return"self"===a?ec(b):!!a.exec(b.href)}function f(c){var d,f,g=dc(c.toString()),h=!1;for(d=0,f=a.length;f>d;d++)if(e(a[d],g)){h=!0;break}if(h)for(d=0,f=b.length;f>d;d++)if(e(b[d],g)){h=!1;break}return h}function g(a){var b=function(a){this.$$unwrapTrustedValue=function(){return a}};return a&&(b.prototype=new a),b.prototype.valueOf=function(){return this.$$unwrapTrustedValue()},b.prototype.toString=function(){return this.$$unwrapTrustedValue().toString()},b}function h(a,b){var d=m.hasOwnProperty(a)?m[a]:null;if(!d)throw ue("icontext","Attempted to trust a value in invalid context. Context: {0}; Value: {1}",a,b);if(null===b||b===c||""===b)return b;if("string"!=typeof b)throw ue("itype","Attempted to trust a non-string value in a content requiring a string: Context: {0}",a);return new d(b)}function i(a){return a instanceof l?a.$$unwrapTrustedValue():a}function j(a,b){if(null===b||b===c||""===b)return b;var d=m.hasOwnProperty(a)?m[a]:null;if(d&&b instanceof d)return b.$$unwrapTrustedValue();if(a===ve.RESOURCE_URL){if(f(b))return b;throw ue("insecurl","Blocked loading resource from url not allowed by $sceDelegate policy.  URL: {0}",b.toString())}if(a===ve.HTML)return k(b);throw ue("unsafe","Attempting to use an unsafe value in a safe context.")}var k=function(a){throw ue("unsafe","Attempting to use an unsafe value in a safe context.")};d.has("$sanitize")&&(k=d.get("$sanitize"));var l=g(),m={};return m[ve.HTML]=g(l),m[ve.CSS]=g(l),m[ve.URL]=g(l),m[ve.JS]=g(l),m[ve.RESOURCE_URL]=g(m[ve.URL]),{trustAs:h,getTrusted:j,valueOf:i}}]}function $b(){var a=!0;this.enabled=function(b){return arguments.length&&(a=!!b),a},this.$get=["$parse","$sceDelegate",function(b,c){if(a&&8>_c)throw ue("iequirks","Strict Contextual Escaping does not support Internet Explorer version < 11 in quirks mode.  You can fix this by adding the text <!doctype html> to the top of your HTML document.  See http://docs.angularjs.org/api/ng.$sce for more information.");var d=L(ve);d.isEnabled=function(){return a},d.trustAs=c.trustAs,d.getTrusted=c.getTrusted,d.valueOf=c.valueOf,a||(d.trustAs=d.getTrusted=function(a,b){return b},d.valueOf=p),d.parseAs=function(a,c){var e=b(c);return e.literal&&e.constant?e:b(c,function(b){return d.getTrusted(a,b)})};var e=d.parseAs,g=d.getTrusted,h=d.trustAs;return f(ve,function(a,b){var c=Wc(b);d[pa("parse_as_"+c)]=function(b){return e(a,b)},d[pa("get_trusted_"+c)]=function(b){return g(a,b)},d[pa("trust_as_"+c)]=function(b){return h(a,b)}}),d}]}function _b(){this.$get=["$window","$document",function(a,b){var c,d,e={},f=m((/android (\d+)/.exec(Wc((a.navigator||{}).userAgent))||[])[1]),g=/Boxee/i.test((a.navigator||{}).userAgent),h=b[0]||{},i=/^(Moz|webkit|ms)(?=[A-Z])/,j=h.body&&h.body.style,k=!1,l=!1;if(j){for(var n in j)if(d=i.exec(n)){c=d[0],c=c.substr(0,1).toUpperCase()+c.substr(1);break}c||(c="WebkitOpacity"in j&&"webkit"),k=!!("transition"in j||c+"Transition"in j),l=!!("animation"in j||c+"Animation"in j),!f||k&&l||(k=u(h.body.style.webkitTransition),l=u(h.body.style.webkitAnimation))}return{history:!(!a.history||!a.history.pushState||4>f||g),hasEvent:function(a){if("input"===a&&11>=_c)return!1;if(r(e[a])){var b=h.createElement("div");e[a]="on"+a in b}return e[a]},csp:od(),vendorPrefix:c,transitions:k,animations:l,android:f}}]}function ac(){this.$get=["$templateCache","$http","$q",function(a,b,c){function d(e,f){function g(a){if(!f)throw Xd("tpload","Failed to load template: {0}",e);return c.reject(a)}d.totalPendingRequests++;var h=b.defaults&&b.defaults.transformResponse;ld(h)?h=h.filter(function(a){return a!==eb}):h===eb&&(h=null);var i={cache:a,transformResponse:h};return b.get(e,i)["finally"](function(){d.totalPendingRequests--}).then(function(a){return a.data},g)}return d.totalPendingRequests=0,d}]}function bc(){this.$get=["$rootScope","$browser","$location",function(a,b,c){var d={};return d.findBindings=function(a,b,c){var d=a.getElementsByClassName("ng-binding"),e=[];return f(d,function(a){var d=id.element(a).data("$binding");d&&f(d,function(d){if(c){var f=new RegExp("(^|\\s)"+nd(b)+"(\\s|\\||$)");f.test(d)&&e.push(a)}else-1!=d.indexOf(b)&&e.push(a)})}),e},d.findModels=function(a,b,c){for(var d=["ng-","data-ng-","ng\\:"],e=0;e<d.length;++e){var f=c?"=":"*=",g="["+d[e]+"model"+f+'"'+b+'"]',h=a.querySelectorAll(g);if(h.length)return h}},d.getLocation=function(){return c.url()},d.setLocation=function(b){b!==c.url()&&(c.url(b),a.$digest())},d.whenStable=function(a){b.notifyWhenNoOutstandingRequests(a)},d}]}function cc(){this.$get=["$rootScope","$browser","$q","$$q","$exceptionHandler",function(a,b,c,d,e){function f(f,h,i){var j,k=s(i)&&!i,l=(k?d:c).defer(),m=l.promise;return j=b.defer(function(){try{l.resolve(f())}catch(b){l.reject(b),e(b)}finally{delete g[m.$$timeoutId]}k||a.$apply()},h),m.$$timeoutId=j,g[j]=l,m}var g={};return f.cancel=function(a){return a&&a.$$timeoutId in g?(g[a.$$timeoutId].reject("canceled"),delete g[a.$$timeoutId],b.defer.cancel(a.$$timeoutId)):!1},f}]}function dc(a){var b=a;return _c&&(we.setAttribute("href",b),b=we.href),we.setAttribute("href",b),{href:we.href,protocol:we.protocol?we.protocol.replace(/:$/,""):"",host:we.host,search:we.search?we.search.replace(/^\?/,""):"",hash:we.hash?we.hash.replace(/^#/,""):"",hostname:we.hostname,port:we.port,pathname:"/"===we.pathname.charAt(0)?we.pathname:"/"+we.pathname}}function ec(a){var b=u(a)?dc(a):a;return b.protocol===xe.protocol&&b.host===xe.host}function fc(){this.$get=q(a)}function gc(a){function b(d,e){if(t(d)){var g={};return f(d,function(a,c){g[c]=b(c,a)}),g}return a.factory(d+c,e)}var c="Filter";this.register=b,this.$get=["$injector",function(a){return function(b){return a.get(b+c)}}],b("currency",kc),b("date",xc),b("filter",hc),b("json",yc),b("limitTo",zc),b("lowercase",Ce),b("number",lc),b("orderBy",Ac),b("uppercase",De)}function hc(){return function(a,b,c){if(!ld(a))return a;var d,e,f=null!==b?typeof b:"null";switch(f){case"function":d=b;break;case"boolean":case"null":case"number":case"string":e=!0;case"object":d=ic(b,c,e);break;default:return a}return a.filter(d)}}function ic(a,b,c){var d,e=t(a)&&"$"in a;return b===!0?b=M:x(b)||(b=function(a,b){return r(a)?!1:null===a||null===b?a===b:t(a)||t(b)?!1:(a=Wc(""+a),b=Wc(""+b),-1!==a.indexOf(b))}),d=function(d){return e&&!t(d)?jc(d,a.$,b,!1):jc(d,a,b,c)}}function jc(a,b,c,d,e){var f=null!==a?typeof a:"null",g=null!==b?typeof b:"null";if("string"===g&&"!"===b.charAt(0))return!jc(a,b.substring(1),c,d);if(ld(a))return a.some(function(a){return jc(a,b,c,d)});switch(f){case"object":var h;if(d){for(h in a)if("$"!==h.charAt(0)&&jc(a[h],b,c,!0))return!0;return e?!1:jc(a,b,c,!1)}if("object"===g){for(h in b){var i=b[h];if(!x(i)&&!r(i)){var j="$"===h,k=j?a:a[h];if(!jc(k,i,c,j,j))return!1}}return!0}return c(a,b);case"function":return!1;default:return c(a,b)}}function kc(a){var b=a.NUMBER_FORMATS;return function(a,c,d){return r(c)&&(c=b.CURRENCY_SYM),r(d)&&(d=b.PATTERNS[1].maxFrac),null==a?a:mc(a,b.PATTERNS[1],b.GROUP_SEP,b.DECIMAL_SEP,d).replace(/\u00A4/g,c)}}function lc(a){var b=a.NUMBER_FORMATS;return function(a,c){return null==a?a:mc(a,b.PATTERNS[0],b.GROUP_SEP,b.DECIMAL_SEP,c)}}function mc(a,b,c,d,e){if(!isFinite(a)||t(a))return"";var f=0>a;a=Math.abs(a);var g=a+"",h="",i=[],j=!1;if(-1!==g.indexOf("e")){var k=g.match(/([\d\.]+)e(-?)(\d+)/);k&&"-"==k[2]&&k[3]>e+1?a=0:(h=g,j=!0)}if(j)e>0&&1>a&&(h=a.toFixed(e),a=parseFloat(h));else{var l=(g.split(ye)[1]||"").length;r(e)&&(e=Math.min(Math.max(b.minFrac,l),b.maxFrac)),a=+(Math.round(+(a.toString()+"e"+e)).toString()+"e"+-e);var m=(""+a).split(ye),n=m[0];m=m[1]||"";var o,p=0,q=b.lgSize,s=b.gSize;if(n.length>=q+s)for(p=n.length-q,o=0;p>o;o++)(p-o)%s===0&&0!==o&&(h+=c),h+=n.charAt(o);for(o=p;o<n.length;o++)(n.length-o)%q===0&&0!==o&&(h+=c),h+=n.charAt(o);for(;m.length<e;)m+="0";e&&"0"!==e&&(h+=d+m.substr(0,e))}return 0===a&&(f=!1),i.push(f?b.negPre:b.posPre,h,f?b.negSuf:b.posSuf),i.join("")}function nc(a,b,c){var d="";for(0>a&&(d="-",a=-a),a=""+a;a.length<b;)a="0"+a;return c&&(a=a.substr(a.length-b)),d+a}function oc(a,b,c,d){return c=c||0,function(e){var f=e["get"+a]();return(c>0||f>-c)&&(f+=c),0===f&&-12==c&&(f=12),nc(f,b,d)}}function pc(a,b){return function(c,d){var e=c["get"+a](),f=Yc(b?"SHORT"+a:a);return d[f][e]}}function qc(a){var b=-1*a.getTimezoneOffset(),c=b>=0?"+":"";return c+=nc(Math[b>0?"floor":"ceil"](b/60),2)+nc(Math.abs(b%60),2)}function rc(a){var b=new Date(a,0,1).getDay();return new Date(a,0,(4>=b?5:12)-b)}function sc(a){return new Date(a.getFullYear(),a.getMonth(),a.getDate()+(4-a.getDay()))}function tc(a){return function(b){var c=rc(b.getFullYear()),d=sc(b),e=+d-+c,f=1+Math.round(e/6048e5);return nc(f,a)}}function uc(a,b){return a.getHours()<12?b.AMPMS[0]:b.AMPMS[1]}function vc(a,b){return a.getFullYear()<=0?b.ERAS[0]:b.ERAS[1]}function wc(a,b){return a.getFullYear()<=0?b.ERANAMES[0]:b.ERANAMES[1]}function xc(a){function b(a){var b;if(b=a.match(c)){var d=new Date(0),e=0,f=0,g=b[8]?d.setUTCFullYear:d.setFullYear,h=b[8]?d.setUTCHours:d.setHours;b[9]&&(e=m(b[9]+b[10]),f=m(b[9]+b[11])),g.call(d,m(b[1]),m(b[2])-1,m(b[3]));var i=m(b[4]||0)-e,j=m(b[5]||0)-f,k=m(b[6]||0),l=Math.round(1e3*parseFloat("0."+(b[7]||0)));return h.call(d,i,j,k,l),d}return a}var c=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/;return function(c,d,e){var g,h,i="",j=[];if(d=d||"mediumDate",d=a.DATETIME_FORMATS[d]||d,u(c)&&(c=Be.test(c)?m(c):b(c)),v(c)&&(c=new Date(c)),!w(c))return c;for(;d;)h=Ae.exec(d),h?(j=N(j,h,1),d=j.pop()):(j.push(d),d=null);return e&&"UTC"===e&&(c=new Date(c.getTime()),c.setMinutes(c.getMinutes()+c.getTimezoneOffset())),f(j,function(b){g=ze[b],i+=g?g(c,a.DATETIME_FORMATS):b.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),i}}function yc(){return function(a,b){return r(b)&&(b=2),R(a,b)}}function zc(){return function(a,b){return v(a)&&(a=a.toString()),ld(a)||u(a)?(b=Math.abs(Number(b))===1/0?Number(b):m(b),b?b>0?a.slice(0,b):a.slice(b):u(a)?"":[]):a}}function Ac(a){return function(b,c,d){function f(a,b){for(var d=0;d<c.length;d++){var e=c[d](a,b);if(0!==e)return e}return 0}function g(a,b){return b?function(b,c){return a(c,b)}:a}function h(a){switch(typeof a){case"number":case"boolean":case"string":return!0;default:return!1}}function i(a){return null===a?"null":"function"==typeof a.valueOf&&(a=a.valueOf(),h(a))?a:"function"==typeof a.toString&&(a=a.toString(),h(a))?a:""}function j(a,b){var c=typeof a,d=typeof b;return c===d&&"object"===c&&(a=i(a),b=i(b)),c===d?("string"===c&&(a=a.toLowerCase(),b=b.toLowerCase()),a===b?0:b>a?-1:1):d>c?-1:1}return e(b)?(c=ld(c)?c:[c],0===c.length&&(c=["+"]),c=c.map(function(b){var c=!1,d=b||p;if(u(b)){if("+"!=b.charAt(0)&&"-"!=b.charAt(0)||(c="-"==b.charAt(0),b=b.substring(1)),""===b)return g(j,c);if(d=a(b),d.constant){var e=d();return g(function(a,b){return j(a[e],b[e])},c)}}return g(function(a,b){return j(d(a),d(b))},c)}),dd.call(b).sort(g(f,d))):b}}function Bc(a){return x(a)&&(a={link:a}),a.restrict=a.restrict||"AC",q(a)}function Cc(a,b){a.$name=b}function Dc(a,b,d,e,g){var h=this,i=[],j=h.$$parentForm=a.parent().controller("form")||Ge;h.$error={},h.$$success={},h.$pending=c,h.$name=g(b.name||b.ngForm||"")(d),h.$dirty=!1,h.$pristine=!0,h.$valid=!0,h.$invalid=!1,h.$submitted=!1,j.$addControl(h),h.$rollbackViewValue=function(){f(i,function(a){a.$rollbackViewValue()})},h.$commitViewValue=function(){f(i,function(a){a.$commitViewValue()})},h.$addControl=function(a){ga(a.$name,"input"),i.push(a),a.$name&&(h[a.$name]=a)},h.$$renameControl=function(a,b){var c=a.$name;h[c]===a&&delete h[c],h[b]=a,a.$name=b},h.$removeControl=function(a){a.$name&&h[a.$name]===a&&delete h[a.$name],f(h.$pending,function(b,c){h.$setValidity(c,null,a)}),f(h.$error,function(b,c){h.$setValidity(c,null,a)}),f(h.$$success,function(b,c){h.$setValidity(c,null,a)}),J(i,a)},Sc({ctrl:this,$element:a,set:function(a,b,c){var d=a[b];if(d){var e=d.indexOf(c);-1===e&&d.push(c)}else a[b]=[c]},unset:function(a,b,c){var d=a[b];d&&(J(d,c),0===d.length&&delete a[b])},parentForm:j,$animate:e}),h.$setDirty=function(){e.removeClass(a,pf),e.addClass(a,qf),h.$dirty=!0,h.$pristine=!1,j.$setDirty()},h.$setPristine=function(){e.setClass(a,pf,qf+" "+He),h.$dirty=!1,h.$pristine=!0,h.$submitted=!1,f(i,function(a){a.$setPristine()})},h.$setUntouched=function(){f(i,function(a){a.$setUntouched()})},h.$setSubmitted=function(){e.addClass(a,He),h.$submitted=!0,j.$setSubmitted()}}function Ec(a){a.$formatters.push(function(b){return a.$isEmpty(b)?b:b.toString()})}function Fc(a,b,c,d,e,f){Gc(a,b,c,d,e,f),Ec(d)}function Gc(a,b,c,d,e,f){var g=Wc(b[0].type);if(!e.android){var h=!1;b.on("compositionstart",function(a){h=!0}),b.on("compositionend",function(){h=!1,i()})}var i=function(a){if(j&&(f.defer.cancel(j),j=null),!h){var e=b.val(),i=a&&a.type;"password"===g||c.ngTrim&&"false"===c.ngTrim||(e=md(e)),(d.$viewValue!==e||""===e&&d.$$hasNativeValidators)&&d.$setViewValue(e,i)}};if(e.hasEvent("input"))b.on("input",i);else{var j,k=function(a,b,c){j||(j=f.defer(function(){j=null,b&&b.value===c||i(a)}))};b.on("keydown",function(a){var b=a.keyCode;91===b||b>15&&19>b||b>=37&&40>=b||k(a,this,this.value)}),e.hasEvent("paste")&&b.on("paste cut",k)}b.on("change",i),d.$render=function(){b.val(d.$isEmpty(d.$viewValue)?"":d.$viewValue)}}function Hc(a,b){if(w(a))return a;if(u(a)){Re.lastIndex=0;var c=Re.exec(a);if(c){var d=+c[1],e=+c[2],f=0,g=0,h=0,i=0,j=rc(d),k=7*(e-1);return b&&(f=b.getHours(),g=b.getMinutes(),h=b.getSeconds(),i=b.getMilliseconds()),new Date(d,0,j.getDate()+k,f,g,h,i)}}return NaN}function Ic(a,b){return function(c,d){var e,g;if(w(c))return c;if(u(c)){if('"'==c.charAt(0)&&'"'==c.charAt(c.length-1)&&(c=c.substring(1,c.length-1)),Le.test(c))return new Date(c);if(a.lastIndex=0,e=a.exec(c))return e.shift(),g=d?{yyyy:d.getFullYear(),MM:d.getMonth()+1,dd:d.getDate(),HH:d.getHours(),mm:d.getMinutes(),ss:d.getSeconds(),sss:d.getMilliseconds()/1e3}:{yyyy:1970,MM:1,dd:1,HH:0,mm:0,ss:0,sss:0},f(e,function(a,c){c<b.length&&(g[b[c]]=+a)}),new Date(g.yyyy,g.MM-1,g.dd,g.HH,g.mm,g.ss||0,1e3*g.sss||0)}return NaN}}function Jc(a,b,d,e){return function(f,g,h,i,j,k,l){function m(a){return a&&!(a.getTime&&a.getTime()!==a.getTime())}function n(a){return s(a)?w(a)?a:d(a):c}Kc(f,g,h,i),Gc(f,g,h,i,j,k);var o,p=i&&i.$options&&i.$options.timezone;if(i.$$parserName=a,i.$parsers.push(function(a){if(i.$isEmpty(a))return null;if(b.test(a)){var e=d(a,o);return"UTC"===p&&e.setMinutes(e.getMinutes()-e.getTimezoneOffset()),e}return c}),i.$formatters.push(function(a){if(a&&!w(a))throw uf("datefmt","Expected `{0}` to be a date",a);if(m(a)){if(o=a,o&&"UTC"===p){var b=6e4*o.getTimezoneOffset();o=new Date(o.getTime()+b)}return l("date")(a,e,p)}return o=null,""}),s(h.min)||h.ngMin){var q;i.$validators.min=function(a){return!m(a)||r(q)||d(a)>=q},h.$observe("min",function(a){q=n(a),i.$validate()})}if(s(h.max)||h.ngMax){var t;i.$validators.max=function(a){return!m(a)||r(t)||d(a)<=t},h.$observe("max",function(a){t=n(a),i.$validate()})}}}function Kc(a,b,d,e){var f=b[0],g=e.$$hasNativeValidators=t(f.validity);g&&e.$parsers.push(function(a){var d=b.prop(Vc)||{};return d.badInput&&!d.typeMismatch?c:a})}function Lc(a,b,d,e,f,g){if(Kc(a,b,d,e),Gc(a,b,d,e,f,g),e.$$parserName="number",e.$parsers.push(function(a){return e.$isEmpty(a)?null:Oe.test(a)?parseFloat(a):c}),e.$formatters.push(function(a){if(!e.$isEmpty(a)){if(!v(a))throw uf("numfmt","Expected `{0}` to be a number",a);a=a.toString()}return a}),s(d.min)||d.ngMin){var h;e.$validators.min=function(a){return e.$isEmpty(a)||r(h)||a>=h},d.$observe("min",function(a){s(a)&&!v(a)&&(a=parseFloat(a,10)),h=v(a)&&!isNaN(a)?a:c,e.$validate()})}if(s(d.max)||d.ngMax){var i;e.$validators.max=function(a){return e.$isEmpty(a)||r(i)||i>=a},d.$observe("max",function(a){s(a)&&!v(a)&&(a=parseFloat(a,10)),i=v(a)&&!isNaN(a)?a:c,e.$validate()})}}function Mc(a,b,c,d,e,f){Gc(a,b,c,d,e,f),Ec(d),d.$$parserName="url",d.$validators.url=function(a,b){var c=a||b;return d.$isEmpty(c)||Me.test(c)}}function Nc(a,b,c,d,e,f){Gc(a,b,c,d,e,f),Ec(d),d.$$parserName="email",d.$validators.email=function(a,b){var c=a||b;return d.$isEmpty(c)||Ne.test(c)}}function Oc(a,b,c,d){r(c.name)&&b.attr("name",j());var e=function(a){b[0].checked&&d.$setViewValue(c.value,a&&a.type)};b.on("click",e),d.$render=function(){var a=c.value;b[0].checked=a==d.$viewValue},c.$observe("value",d.$render)}function Pc(a,b,c,e,f){var g;if(s(e)){if(g=a(e),!g.constant)throw d("ngModel")("constexpr","Expected constant expression for `{0}`, but saw `{1}`.",c,e);return g(b)}return f}function Qc(a,b,c,d,e,f,g,h){var i=Pc(h,a,"ngTrueValue",c.ngTrueValue,!0),j=Pc(h,a,"ngFalseValue",c.ngFalseValue,!1),k=function(a){d.$setViewValue(b[0].checked,a&&a.type)};b.on("click",k),d.$render=function(){b[0].checked=d.$viewValue},d.$isEmpty=function(a){return a===!1},d.$formatters.push(function(a){return M(a,i)}),d.$parsers.push(function(a){return a?i:j})}function Rc(a,b){return a="ngClass"+a,["$animate",function(c){function d(a,b){var c=[];a:for(var d=0;d<a.length;d++){for(var e=a[d],f=0;f<b.length;f++)if(e==b[f])continue a;c.push(e)}return c}function e(a){if(ld(a))return a;if(u(a))return a.split(" ");if(t(a)){var b=[];return f(a,function(a,c){a&&(b=b.concat(c.split(" ")))}),b}return a}return{restrict:"AC",link:function(g,h,i){function j(a){var b=l(a,1);i.$addClass(b)}function k(a){var b=l(a,-1);i.$removeClass(b)}function l(a,b){var c=h.data("$classCounts")||{},d=[];return f(a,function(a){(b>0||c[a])&&(c[a]=(c[a]||0)+b,c[a]===+(b>0)&&d.push(a))}),h.data("$classCounts",c),d.join(" ")}function m(a,b){var e=d(b,a),f=d(a,b);e=l(e,1),f=l(f,-1),e&&e.length&&c.addClass(h,e),f&&f.length&&c.removeClass(h,f)}function n(a){if(b===!0||g.$index%2===b){var c=e(a||[]);if(o){if(!M(a,o)){var d=e(o);m(d,c)}}else j(c)}o=L(a)}var o;g.$watch(i[a],n,!0),i.$observe("class",function(b){n(g.$eval(i[a]))}),"ngClass"!==a&&g.$watch("$index",function(c,d){var f=1&c;if(f!==(1&d)){var h=e(g.$eval(i[a]));f===b?j(h):k(h)}})}}}]}function Sc(a){function b(a,b,i){b===c?d("$pending",a,i):e("$pending",a,i),E(b)?b?(l(h.$error,a,i),k(h.$$success,a,i)):(k(h.$error,a,i),l(h.$$success,a,i)):(l(h.$error,a,i),l(h.$$success,a,i)),h.$pending?(f(tf,!0),h.$valid=h.$invalid=c,g("",null)):(f(tf,!1),h.$valid=Tc(h.$error),h.$invalid=!h.$valid,g("",h.$valid));var j;j=h.$pending&&h.$pending[a]?c:h.$error[a]?!1:h.$$success[a]?!0:null,g(a,j),m.$setValidity(a,j,h)}function d(a,b,c){h[a]||(h[a]={}),k(h[a],b,c)}function e(a,b,d){h[a]&&l(h[a],b,d),Tc(h[a])&&(h[a]=c)}function f(a,b){b&&!j[a]?(n.addClass(i,a),j[a]=!0):!b&&j[a]&&(n.removeClass(i,a),j[a]=!1)}function g(a,b){a=a?"-"+ca(a,"-"):"",f(nf+a,b===!0),f(of+a,b===!1)}var h=a.ctrl,i=a.$element,j={},k=a.set,l=a.unset,m=a.parentForm,n=a.$animate;j[of]=!(j[nf]=i.hasClass(nf)),h.$setValidity=b}function Tc(a){if(a)for(var b in a)return!1;return!0}var Uc=/^\/(.+)\/([a-z]*)$/,Vc="validity",Wc=function(a){return u(a)?a.toLowerCase():a},Xc=Object.prototype.hasOwnProperty,Yc=function(a){return u(a)?a.toUpperCase():a},Zc=function(a){return u(a)?a.replace(/[A-Z]/g,function(a){return String.fromCharCode(32|a.charCodeAt(0))}):a},$c=function(a){return u(a)?a.replace(/[a-z]/g,function(a){return String.fromCharCode(-33&a.charCodeAt(0))}):a};"i"!=="I".toLowerCase()&&(Wc=Zc,Yc=$c);var _c,ad,bd,cd,dd=[].slice,ed=[].splice,fd=[].push,gd=Object.prototype.toString,hd=d("ng"),id=a.angular||(a.angular={}),jd=0;_c=b.documentMode,o.$inject=[],p.$inject=[];var kd,ld=Array.isArray,md=function(a){return u(a)?a.trim():a},nd=function(a){return a.replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08")},od=function(){if(s(od.isActive_))return od.isActive_;var a=!(!b.querySelector("[ng-csp]")&&!b.querySelector("[data-ng-csp]"));if(!a)try{new Function("")}catch(c){a=!0}return od.isActive_=a},pd=["ng-","data-ng-","ng:","x-ng-"],qd=/[A-Z]/g,rd=!1,sd=1,td=2,ud=3,vd=8,wd=9,xd=11,yd={full:"1.3.16",major:1,minor:3,dot:16,codeName:"cookie-oatmealification"};ua.expando="ng339";var zd=ua.cache={},Ad=1,Bd=function(a,b,c){a.addEventListener(b,c,!1)},Cd=function(a,b,c){a.removeEventListener(b,c,!1)};ua._data=function(a){return this.cache[a[this.expando]]||{}};var Dd=/([\:\-\_]+(.))/g,Ed=/^moz([A-Z])/,Fd={mouseleave:"mouseout",mouseenter:"mouseover"},Gd=d("jqLite"),Hd=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,Id=/<|&#?\w+;/,Jd=/<([\w:]+)/,Kd=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,Ld={option:[1,'<select multiple="multiple">',"</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};Ld.optgroup=Ld.option,Ld.tbody=Ld.tfoot=Ld.colgroup=Ld.caption=Ld.thead,Ld.th=Ld.td;var Md=ua.prototype={ready:function(c){function d(){e||(e=!0,c())}var e=!1;"complete"===b.readyState?setTimeout(d):(this.on("DOMContentLoaded",d),ua(a).on("load",d))},toString:function(){var a=[];return f(this,function(b){a.push(""+b)}),"["+a.join(", ")+"]"},eq:function(a){return ad(a>=0?this[a]:this[this.length+a])},length:0,push:fd,sort:[].sort,splice:[].splice},Nd={};f("multiple,selected,checked,disabled,readOnly,required,open".split(","),function(a){Nd[Wc(a)]=a});var Od={};f("input,select,option,textarea,button,form,details".split(","),function(a){Od[a]=!0});var Pd={ngMinlength:"minlength",ngMaxlength:"maxlength",ngMin:"min",ngMax:"max",ngPattern:"pattern"};f({data:Aa,removeData:ya},function(a,b){ua[b]=a}),f({data:Aa,inheritedData:Ga,scope:function(a){return ad.data(a,"$scope")||Ga(a.parentNode||a,["$isolateScope","$scope"])},isolateScope:function(a){return ad.data(a,"$isolateScope")||ad.data(a,"$isolateScopeNoTemplate")},controller:Fa,injector:function(a){return Ga(a,"$injector")},removeAttr:function(a,b){a.removeAttribute(b)},hasClass:Ba,css:function(a,b,c){return b=pa(b),s(c)?void(a.style[b]=c):a.style[b]},attr:function(a,b,d){var e=a.nodeType;if(e!==ud&&e!==td&&e!==vd){var f=Wc(b);if(Nd[f]){if(!s(d))return a[b]||(a.attributes.getNamedItem(b)||o).specified?f:c;d?(a[b]=!0,a.setAttribute(b,f)):(a[b]=!1,a.removeAttribute(f))}else if(s(d))a.setAttribute(b,d);else if(a.getAttribute){var g=a.getAttribute(b,2);return null===g?c:g}}},prop:function(a,b,c){return s(c)?void(a[b]=c):a[b]},text:function(){function a(a,b){if(r(b)){var c=a.nodeType;return c===sd||c===ud?a.textContent:""}a.textContent=b}return a.$dv="",a}(),val:function(a,b){if(r(b)){if(a.multiple&&"select"===I(a)){var c=[];return f(a.options,function(a){a.selected&&c.push(a.value||a.text)}),0===c.length?null:c}return a.value}a.value=b},html:function(a,b){return r(b)?a.innerHTML:(wa(a,!0),void(a.innerHTML=b))},empty:Ha},function(a,b){ua.prototype[b]=function(b,d){var e,f,g=this.length;if(a!==Ha&&(2==a.length&&a!==Ba&&a!==Fa?b:d)===c){if(t(b)){for(e=0;g>e;e++)if(a===Aa)a(this[e],b);else for(f in b)a(this[e],f,b[f]);return this}for(var h=a.$dv,i=h===c?Math.min(g,1):g,j=0;i>j;j++){var k=a(this[j],b,d);h=h?h+k:k}return h}for(e=0;g>e;e++)a(this[e],b,d);return this}}),f({removeData:ya,on:function Vf(a,b,c,d){if(s(d))throw Gd("onargs","jqLite#on() does not support the `selector` or `eventData` parameters");if(ra(a)){var e=za(a,!0),f=e.events,g=e.handle;g||(g=e.handle=Ma(a,f));for(var h=b.indexOf(" ")>=0?b.split(" "):[b],i=h.length;i--;){b=h[i];var j=f[b];j||(f[b]=[],"mouseenter"===b||"mouseleave"===b?Vf(a,Fd[b],function(a){var c=this,d=a.relatedTarget;d&&(d===c||c.contains(d))||g(a,b)}):"$destroy"!==b&&Bd(a,b,g),j=f[b]),j.push(c)}}},off:xa,one:function(a,b,c){a=ad(a),a.on(b,function d(){a.off(b,c),a.off(b,d)}),a.on(b,c)},replaceWith:function(a,b){var c,d=a.parentNode;wa(a),f(new ua(b),function(b){c?d.insertBefore(b,c.nextSibling):d.replaceChild(b,a),c=b})},children:function(a){var b=[];return f(a.childNodes,function(a){a.nodeType===sd&&b.push(a)}),b},contents:function(a){return a.contentDocument||a.childNodes||[]},append:function(a,b){var c=a.nodeType;if(c===sd||c===xd){b=new ua(b);for(var d=0,e=b.length;e>d;d++){var f=b[d];a.appendChild(f)}}},prepend:function(a,b){if(a.nodeType===sd){var c=a.firstChild;f(new ua(b),function(b){a.insertBefore(b,c)})}},wrap:function(a,b){b=ad(b).eq(0).clone()[0];var c=a.parentNode;c&&c.replaceChild(b,a),b.appendChild(a)},remove:Ia,detach:function(a){Ia(a,!0)},after:function(a,b){var c=a,d=a.parentNode;b=new ua(b);for(var e=0,f=b.length;f>e;e++){var g=b[e];d.insertBefore(g,c.nextSibling),c=g}},addClass:Da,removeClass:Ca,toggleClass:function(a,b,c){b&&f(b.split(" "),function(b){var d=c;r(d)&&(d=!Ba(a,b)),(d?Da:Ca)(a,b)})},parent:function(a){var b=a.parentNode;return b&&b.nodeType!==xd?b:null},next:function(a){return a.nextElementSibling},find:function(a,b){return a.getElementsByTagName?a.getElementsByTagName(b):[]},clone:va,triggerHandler:function(a,b,c){var d,e,g,h=b.type||b,i=za(a),j=i&&i.events,k=j&&j[h];k&&(d={preventDefault:function(){this.defaultPrevented=!0},isDefaultPrevented:function(){return this.defaultPrevented===!0},stopImmediatePropagation:function(){this.immediatePropagationStopped=!0},isImmediatePropagationStopped:function(){return this.immediatePropagationStopped===!0},stopPropagation:o,type:h,target:a},b.type&&(d=l(d,b)),e=L(k),g=c?[d].concat(c):[d],f(e,function(b){d.isImmediatePropagationStopped()||b.apply(a,g)}))}},function(a,b){ua.prototype[b]=function(b,c,d){for(var e,f=0,g=this.length;g>f;f++)r(e)?(e=a(this[f],b,c,d),s(e)&&(e=ad(e))):Ea(e,a(this[f],b,c,d));return s(e)?e:this},ua.prototype.bind=ua.prototype.on,ua.prototype.unbind=ua.prototype.off}),Pa.prototype={put:function(a,b){this[Oa(a,this.nextUid)]=b},get:function(a){return this[Oa(a,this.nextUid)]},remove:function(a){var b=this[a=Oa(a,this.nextUid)];return delete this[a],b}};var Qd=/^function\s*[^\(]*\(\s*([^\)]*)\)/m,Rd=/,/,Sd=/^\s*(_?)(\S+?)\1\s*$/,Td=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm,Ud=d("$injector");Sa.$$annotate=Ra;var Vd=d("$animate"),Wd=["$provide",function(a){this.$$selectors={},this.register=function(b,c){var d=b+"-animation";if(b&&"."!=b.charAt(0))throw Vd("notcsel","Expecting class selector starting with '.' got '{0}'.",b);this.$$selectors[b.substr(1)]=d,a.factory(d,c)},this.classNameFilter=function(a){return 1===arguments.length&&(this.$$classNameFilter=a instanceof RegExp?a:null),
this.$$classNameFilter},this.$get=["$$q","$$asyncCallback","$rootScope",function(a,b,c){function d(b){var d,e=a.defer();return e.promise.$$cancelFn=function(){d&&d()},c.$$postDigest(function(){d=b(function(){e.resolve()})}),e.promise}function e(a,b){var c=[],d=[],e=ja();return f((a.attr("class")||"").split(/\s+/),function(a){e[a]=!0}),f(b,function(a,b){var f=e[b];a===!1&&f?d.push(b):a!==!0||f||c.push(b)}),c.length+d.length>0&&[c.length?c:null,d.length?d:null]}function g(a,b,c){for(var d=0,e=b.length;e>d;++d){var f=b[d];a[f]=c}}function h(){return j||(j=a.defer(),b(function(){j.resolve(),j=null})),j.promise}function i(a,b){if(id.isObject(b)){var c=l(b.from||{},b.to||{});a.css(c)}}var j;return{animate:function(a,b,c){return i(a,{from:b,to:c}),h()},enter:function(a,b,c,d){return i(a,d),c?c.after(a):b.prepend(a),h()},leave:function(a,b){return i(a,b),a.remove(),h()},move:function(a,b,c,d){return this.enter(a,b,c,d)},addClass:function(a,b,c){return this.setClass(a,b,[],c)},$$addClassImmediately:function(a,b,c){return a=ad(a),b=u(b)?b:ld(b)?b.join(" "):"",f(a,function(a){Da(a,b)}),i(a,c),h()},removeClass:function(a,b,c){return this.setClass(a,[],b,c)},$$removeClassImmediately:function(a,b,c){return a=ad(a),b=u(b)?b:ld(b)?b.join(" "):"",f(a,function(a){Ca(a,b)}),i(a,c),h()},setClass:function(a,b,c,f){var h=this,i="$$animateClasses",j=!1;a=ad(a);var k=a.data(i);k?f&&k.options&&(k.options=id.extend(k.options||{},f)):(k={classes:{},options:f},j=!0);var l=k.classes;return b=ld(b)?b:b.split(" "),c=ld(c)?c:c.split(" "),g(l,b,!0),g(l,c,!1),j&&(k.promise=d(function(b){var c=a.data(i);if(a.removeData(i),c){var d=e(a,c.classes);d&&h.$$setClassImmediately(a,d[0],d[1],c.options)}b()}),a.data(i,k)),k.promise},$$setClassImmediately:function(a,b,c,d){return b&&this.$$addClassImmediately(a,b),c&&this.$$removeClassImmediately(a,c),i(a,d),h()},enabled:o,cancel:o}}]}],Xd=d("$compile");Za.$inject=["$provide","$$sanitizeUriProvider"];var Yd=/^((?:x|data)[\:\-_])/i,Zd=d("$controller"),$d="application/json",_d={"Content-Type":$d+";charset=utf-8"},ae=/^\[|^\{(?!\{)/,be={"[":/]$/,"{":/}$/},ce=/^\)\]\}',?\n/,de=d("$interpolate"),ee=/^([^\?#]*)(\?([^#]*))?(#(.*))?$/,fe={http:80,https:443,ftp:21},ge=d("$location"),he={$$html5:!1,$$replace:!1,absUrl:Cb("$$absUrl"),url:function(a){if(r(a))return this.$$url;var b=ee.exec(a);return(b[1]||""===a)&&this.path(decodeURIComponent(b[1])),(b[2]||b[1]||""===a)&&this.search(b[3]||""),this.hash(b[5]||""),this},protocol:Cb("$$protocol"),host:Cb("$$host"),port:Cb("$$port"),path:Db("$$path",function(a){return a=null!==a?a.toString():"","/"==a.charAt(0)?a:"/"+a}),search:function(a,b){switch(arguments.length){case 0:return this.$$search;case 1:if(u(a)||v(a))a=a.toString(),this.$$search=V(a);else{if(!t(a))throw ge("isrcharg","The first argument of the `$location#search()` call must be a string or an object.");a=K(a,{}),f(a,function(b,c){null==b&&delete a[c]}),this.$$search=a}break;default:r(b)||null===b?delete this.$$search[a]:this.$$search[a]=b}return this.$$compose(),this},hash:Db("$$hash",function(a){return null!==a?a.toString():""}),replace:function(){return this.$$replace=!0,this}};f([Bb,Ab,zb],function(a){a.prototype=Object.create(he),a.prototype.state=function(b){if(!arguments.length)return this.$$state;if(a!==zb||!this.$$html5)throw ge("nostate","History API state support is available only in HTML5 mode and only in browsers supporting HTML5 History API");return this.$$state=r(b)?null:b,this}});var ie=d("$parse"),je=Function.prototype.call,ke=Function.prototype.apply,le=Function.prototype.bind,me=ja();f({"null":function(){return null},"true":function(){return!0},"false":function(){return!1},undefined:function(){}},function(a,b){a.constant=a.literal=a.sharedGetter=!0,me[b]=a}),me["this"]=function(a){return a},me["this"].sharedGetter=!0;var ne=l(ja(),{"+":function(a,b,d,e){return d=d(a,b),e=e(a,b),s(d)?s(e)?d+e:d:s(e)?e:c},"-":function(a,b,c,d){return c=c(a,b),d=d(a,b),(s(c)?c:0)-(s(d)?d:0)},"*":function(a,b,c,d){return c(a,b)*d(a,b)},"/":function(a,b,c,d){return c(a,b)/d(a,b)},"%":function(a,b,c,d){return c(a,b)%d(a,b)},"===":function(a,b,c,d){return c(a,b)===d(a,b)},"!==":function(a,b,c,d){return c(a,b)!==d(a,b)},"==":function(a,b,c,d){return c(a,b)==d(a,b)},"!=":function(a,b,c,d){return c(a,b)!=d(a,b)},"<":function(a,b,c,d){return c(a,b)<d(a,b)},">":function(a,b,c,d){return c(a,b)>d(a,b)},"<=":function(a,b,c,d){return c(a,b)<=d(a,b)},">=":function(a,b,c,d){return c(a,b)>=d(a,b)},"&&":function(a,b,c,d){return c(a,b)&&d(a,b)},"||":function(a,b,c,d){return c(a,b)||d(a,b)},"!":function(a,b,c){return!c(a,b)},"=":!0,"|":!0}),oe={n:"\n",f:"\f",r:"\r",t:"	",v:"\x0B","'":"'",'"':'"'},pe=function(a){this.options=a};pe.prototype={constructor:pe,lex:function(a){for(this.text=a,this.index=0,this.tokens=[];this.index<this.text.length;){var b=this.text.charAt(this.index);if('"'===b||"'"===b)this.readString(b);else if(this.isNumber(b)||"."===b&&this.isNumber(this.peek()))this.readNumber();else if(this.isIdent(b))this.readIdent();else if(this.is(b,"(){}[].,;:?"))this.tokens.push({index:this.index,text:b}),this.index++;else if(this.isWhitespace(b))this.index++;else{var c=b+this.peek(),d=c+this.peek(2),e=ne[b],f=ne[c],g=ne[d];if(e||f||g){var h=g?d:f?c:b;this.tokens.push({index:this.index,text:h,operator:!0}),this.index+=h.length}else this.throwError("Unexpected next character ",this.index,this.index+1)}}return this.tokens},is:function(a,b){return-1!==b.indexOf(a)},peek:function(a){var b=a||1;return this.index+b<this.text.length?this.text.charAt(this.index+b):!1},isNumber:function(a){return a>="0"&&"9">=a&&"string"==typeof a},isWhitespace:function(a){return" "===a||"\r"===a||"	"===a||"\n"===a||"\x0B"===a||" "===a},isIdent:function(a){return a>="a"&&"z">=a||a>="A"&&"Z">=a||"_"===a||"$"===a},isExpOperator:function(a){return"-"===a||"+"===a||this.isNumber(a)},throwError:function(a,b,c){c=c||this.index;var d=s(b)?"s "+b+"-"+this.index+" ["+this.text.substring(b,c)+"]":" "+c;throw ie("lexerr","Lexer Error: {0} at column{1} in expression [{2}].",a,d,this.text)},readNumber:function(){for(var a="",b=this.index;this.index<this.text.length;){var c=Wc(this.text.charAt(this.index));if("."==c||this.isNumber(c))a+=c;else{var d=this.peek();if("e"==c&&this.isExpOperator(d))a+=c;else if(this.isExpOperator(c)&&d&&this.isNumber(d)&&"e"==a.charAt(a.length-1))a+=c;else{if(!this.isExpOperator(c)||d&&this.isNumber(d)||"e"!=a.charAt(a.length-1))break;this.throwError("Invalid exponent")}}this.index++}this.tokens.push({index:b,text:a,constant:!0,value:Number(a)})},readIdent:function(){for(var a=this.index;this.index<this.text.length;){var b=this.text.charAt(this.index);if(!this.isIdent(b)&&!this.isNumber(b))break;this.index++}this.tokens.push({index:a,text:this.text.slice(a,this.index),identifier:!0})},readString:function(a){var b=this.index;this.index++;for(var c="",d=a,e=!1;this.index<this.text.length;){var f=this.text.charAt(this.index);if(d+=f,e){if("u"===f){var g=this.text.substring(this.index+1,this.index+5);g.match(/[\da-f]{4}/i)||this.throwError("Invalid unicode escape [\\u"+g+"]"),this.index+=4,c+=String.fromCharCode(parseInt(g,16))}else{var h=oe[f];c+=h||f}e=!1}else if("\\"===f)e=!0;else{if(f===a)return this.index++,void this.tokens.push({index:b,text:d,constant:!0,value:c});c+=f}this.index++}this.throwError("Unterminated quote",b)}};var qe=function(a,b,c){this.lexer=a,this.$filter=b,this.options=c};qe.ZERO=l(function(){return 0},{sharedGetter:!0,constant:!0}),qe.prototype={constructor:qe,parse:function(a){this.text=a,this.tokens=this.lexer.lex(a);var b=this.statements();return 0!==this.tokens.length&&this.throwError("is an unexpected token",this.tokens[0]),b.literal=!!b.literal,b.constant=!!b.constant,b},primary:function(){var a;this.expect("(")?(a=this.filterChain(),this.consume(")")):this.expect("[")?a=this.arrayDeclaration():this.expect("{")?a=this.object():this.peek().identifier&&this.peek().text in me?a=me[this.consume().text]:this.peek().identifier?a=this.identifier():this.peek().constant?a=this.constant():this.throwError("not a primary expression",this.peek());for(var b,c;b=this.expect("(","[",".");)"("===b.text?(a=this.functionCall(a,c),c=null):"["===b.text?(c=a,a=this.objectIndex(a)):"."===b.text?(c=a,a=this.fieldAccess(a)):this.throwError("IMPOSSIBLE");return a},throwError:function(a,b){throw ie("syntax","Syntax Error: Token '{0}' {1} at column {2} of the expression [{3}] starting at [{4}].",b.text,a,b.index+1,this.text,this.text.substring(b.index))},peekToken:function(){if(0===this.tokens.length)throw ie("ueoe","Unexpected end of expression: {0}",this.text);return this.tokens[0]},peek:function(a,b,c,d){return this.peekAhead(0,a,b,c,d)},peekAhead:function(a,b,c,d,e){if(this.tokens.length>a){var f=this.tokens[a],g=f.text;if(g===b||g===c||g===d||g===e||!b&&!c&&!d&&!e)return f}return!1},expect:function(a,b,c,d){var e=this.peek(a,b,c,d);return e?(this.tokens.shift(),e):!1},consume:function(a){if(0===this.tokens.length)throw ie("ueoe","Unexpected end of expression: {0}",this.text);var b=this.expect(a);return b||this.throwError("is unexpected, expecting ["+a+"]",this.peek()),b},unaryFn:function(a,b){var c=ne[a];return l(function(a,d){return c(a,d,b)},{constant:b.constant,inputs:[b]})},binaryFn:function(a,b,c,d){var e=ne[b];return l(function(b,d){return e(b,d,a,c)},{constant:a.constant&&c.constant,inputs:!d&&[a,c]})},identifier:function(){for(var a=this.consume().text;this.peek(".")&&this.peekAhead(1).identifier&&!this.peekAhead(2,"(");)a+=this.consume().text+this.consume().text;return Ob(a,this.options,this.text)},constant:function(){var a=this.consume().value;return l(function(){return a},{constant:!0,literal:!0})},statements:function(){for(var a=[];;)if(this.tokens.length>0&&!this.peek("}",")",";","]")&&a.push(this.filterChain()),!this.expect(";"))return 1===a.length?a[0]:function(b,c){for(var d,e=0,f=a.length;f>e;e++)d=a[e](b,c);return d}},filterChain:function(){for(var a,b=this.expression();a=this.expect("|");)b=this.filter(b);return b},filter:function(a){var b,d,e=this.$filter(this.consume().text);if(this.peek(":"))for(b=[],d=[];this.expect(":");)b.push(this.expression());var f=[a].concat(b||[]);return l(function(f,g){var h=a(f,g);if(d){d[0]=h;for(var i=b.length;i--;)d[i+1]=b[i](f,g);return e.apply(c,d)}return e(h)},{constant:!e.$stateful&&f.every(Jb),inputs:!e.$stateful&&f})},expression:function(){return this.assignment()},assignment:function(){var a,b,c=this.ternary();return(b=this.expect("="))?(c.assign||this.throwError("implies assignment but ["+this.text.substring(0,b.index)+"] can not be assigned to",b),a=this.ternary(),l(function(b,d){return c.assign(b,a(b,d),d)},{inputs:[c,a]})):c},ternary:function(){var a,b,c=this.logicalOR();if((b=this.expect("?"))&&(a=this.assignment(),this.consume(":"))){var d=this.assignment();return l(function(b,e){return c(b,e)?a(b,e):d(b,e)},{constant:c.constant&&a.constant&&d.constant})}return c},logicalOR:function(){for(var a,b=this.logicalAND();a=this.expect("||");)b=this.binaryFn(b,a.text,this.logicalAND(),!0);return b},logicalAND:function(){for(var a,b=this.equality();a=this.expect("&&");)b=this.binaryFn(b,a.text,this.equality(),!0);return b},equality:function(){for(var a,b=this.relational();a=this.expect("==","!=","===","!==");)b=this.binaryFn(b,a.text,this.relational());return b},relational:function(){for(var a,b=this.additive();a=this.expect("<",">","<=",">=");)b=this.binaryFn(b,a.text,this.additive());return b},additive:function(){for(var a,b=this.multiplicative();a=this.expect("+","-");)b=this.binaryFn(b,a.text,this.multiplicative());return b},multiplicative:function(){for(var a,b=this.unary();a=this.expect("*","/","%");)b=this.binaryFn(b,a.text,this.unary());return b},unary:function(){var a;return this.expect("+")?this.primary():(a=this.expect("-"))?this.binaryFn(qe.ZERO,a.text,this.unary()):(a=this.expect("!"))?this.unaryFn(a.text,this.unary()):this.primary()},fieldAccess:function(a){var b=this.identifier();return l(function(d,e,f){var g=f||a(d,e);return null==g?c:b(g)},{assign:function(c,d,e){var f=a(c,e);return f||a.assign(c,f={},e),b.assign(f,d)}})},objectIndex:function(a){var b=this.text,d=this.expression();return this.consume("]"),l(function(e,f){var g,h=a(e,f),i=d(e,f);return Gb(i,b),h?g=Hb(h[i],b):c},{assign:function(c,e,f){var g=Gb(d(c,f),b),h=Hb(a(c,f),b);return h||a.assign(c,h={},f),h[g]=e}})},functionCall:function(a,b){var d=[];if(")"!==this.peekToken().text)do d.push(this.expression());while(this.expect(","));this.consume(")");var e=this.text,f=d.length?[]:null;return function(g,h){var i=b?b(g,h):s(b)?c:g,j=a(g,h,i)||o;if(f)for(var k=d.length;k--;)f[k]=Hb(d[k](g,h),e);Hb(i,e),Ib(j,e);var l=j.apply?j.apply(i,f):j(f[0],f[1],f[2],f[3],f[4]);return f&&(f.length=0),Hb(l,e)}},arrayDeclaration:function(){var a=[];if("]"!==this.peekToken().text)do{if(this.peek("]"))break;a.push(this.expression())}while(this.expect(","));return this.consume("]"),l(function(b,c){for(var d=[],e=0,f=a.length;f>e;e++)d.push(a[e](b,c));return d},{literal:!0,constant:a.every(Jb),inputs:a})},object:function(){var a=[],b=[];if("}"!==this.peekToken().text)do{if(this.peek("}"))break;var c=this.consume();c.constant?a.push(c.value):c.identifier?a.push(c.text):this.throwError("invalid key",c),this.consume(":"),b.push(this.expression())}while(this.expect(","));return this.consume("}"),l(function(c,d){for(var e={},f=0,g=b.length;g>f;f++)e[a[f]]=b[f](c,d);return e},{literal:!0,constant:b.every(Jb),inputs:b})}};var re=ja(),se=ja(),te=Object.prototype.valueOf,ue=d("$sce"),ve={HTML:"html",CSS:"css",URL:"url",RESOURCE_URL:"resourceUrl",JS:"js"},Xd=d("$compile"),we=b.createElement("a"),xe=dc(a.location.href);gc.$inject=["$provide"],kc.$inject=["$locale"],lc.$inject=["$locale"];var ye=".",ze={yyyy:oc("FullYear",4),yy:oc("FullYear",2,0,!0),y:oc("FullYear",1),MMMM:pc("Month"),MMM:pc("Month",!0),MM:oc("Month",2,1),M:oc("Month",1,1),dd:oc("Date",2),d:oc("Date",1),HH:oc("Hours",2),H:oc("Hours",1),hh:oc("Hours",2,-12),h:oc("Hours",1,-12),mm:oc("Minutes",2),m:oc("Minutes",1),ss:oc("Seconds",2),s:oc("Seconds",1),sss:oc("Milliseconds",3),EEEE:pc("Day"),EEE:pc("Day",!0),a:uc,Z:qc,ww:tc(2),w:tc(1),G:vc,GG:vc,GGG:vc,GGGG:wc},Ae=/((?:[^yMdHhmsaZEwG']+)|(?:'(?:[^']|'')*')|(?:E+|y+|M+|d+|H+|h+|m+|s+|a|Z|G+|w+))(.*)/,Be=/^\-?\d+$/;xc.$inject=["$locale"];var Ce=q(Wc),De=q(Yc);Ac.$inject=["$parse"];var Ee=q({restrict:"E",compile:function(a,b){return b.href||b.xlinkHref||b.name?void 0:function(a,b){if("a"===b[0].nodeName.toLowerCase()){var c="[object SVGAnimatedString]"===gd.call(b.prop("href"))?"xlink:href":"href";b.on("click",function(a){b.attr(c)||a.preventDefault()})}}}}),Fe={};f(Nd,function(a,b){if("multiple"!=a){var c=$a("ng-"+b);Fe[c]=function(){return{restrict:"A",priority:100,link:function(a,d,e){a.$watch(e[c],function(a){e.$set(b,!!a)})}}}}}),f(Pd,function(a,b){Fe[b]=function(){return{priority:100,link:function(a,c,d){if("ngPattern"===b&&"/"==d.ngPattern.charAt(0)){var e=d.ngPattern.match(Uc);if(e)return void d.$set("ngPattern",new RegExp(e[1],e[2]))}a.$watch(d[b],function(a){d.$set(b,a)})}}}}),f(["src","srcset","href"],function(a){var b=$a("ng-"+a);Fe[b]=function(){return{priority:99,link:function(c,d,e){var f=a,g=a;"href"===a&&"[object SVGAnimatedString]"===gd.call(d.prop("href"))&&(g="xlinkHref",e.$attr[g]="xlink:href",f=null),e.$observe(b,function(b){return b?(e.$set(g,b),void(_c&&f&&d.prop(f,e[g]))):void("href"===a&&e.$set(g,null))})}}}});var Ge={$addControl:o,$$renameControl:Cc,$removeControl:o,$setValidity:o,$setDirty:o,$setPristine:o,$setSubmitted:o},He="ng-submitted";Dc.$inject=["$element","$attrs","$scope","$animate","$interpolate"];var Ie=function(a){return["$timeout",function(b){var d={name:"form",restrict:a?"EAC":"E",controller:Dc,compile:function(d,e){d.addClass(pf).addClass(nf);var f=e.name?"name":a&&e.ngForm?"ngForm":!1;return{pre:function(a,d,e,g){if(!("action"in e)){var h=function(b){a.$apply(function(){g.$commitViewValue(),g.$setSubmitted()}),b.preventDefault()};Bd(d[0],"submit",h),d.on("$destroy",function(){b(function(){Cd(d[0],"submit",h)},0,!1)})}var i=g.$$parentForm;f&&(Kb(a,null,g.$name,g,g.$name),e.$observe(f,function(b){g.$name!==b&&(Kb(a,null,g.$name,c,g.$name),i.$$renameControl(g,b),Kb(a,null,g.$name,g,g.$name))})),d.on("$destroy",function(){i.$removeControl(g),f&&Kb(a,null,e[f],c,g.$name),l(g,Ge)})}}}};return d}]},Je=Ie(),Ke=Ie(!0),Le=/\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z)/,Me=/^(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/,Ne=/^[a-z0-9!#$%&'*+\/=?^_`{|}~.-]+@[a-z0-9]([a-z0-9-]*[a-z0-9])?(\.[a-z0-9]([a-z0-9-]*[a-z0-9])?)*$/i,Oe=/^\s*(\-|\+)?(\d+|(\d*(\.\d*)))\s*$/,Pe=/^(\d{4})-(\d{2})-(\d{2})$/,Qe=/^(\d{4})-(\d\d)-(\d\d)T(\d\d):(\d\d)(?::(\d\d)(\.\d{1,3})?)?$/,Re=/^(\d{4})-W(\d\d)$/,Se=/^(\d{4})-(\d\d)$/,Te=/^(\d\d):(\d\d)(?::(\d\d)(\.\d{1,3})?)?$/,Ue={text:Fc,date:Jc("date",Pe,Ic(Pe,["yyyy","MM","dd"]),"yyyy-MM-dd"),"datetime-local":Jc("datetimelocal",Qe,Ic(Qe,["yyyy","MM","dd","HH","mm","ss","sss"]),"yyyy-MM-ddTHH:mm:ss.sss"),time:Jc("time",Te,Ic(Te,["HH","mm","ss","sss"]),"HH:mm:ss.sss"),week:Jc("week",Re,Hc,"yyyy-Www"),month:Jc("month",Se,Ic(Se,["yyyy","MM"]),"yyyy-MM"),number:Lc,url:Mc,email:Nc,radio:Oc,checkbox:Qc,hidden:o,button:o,submit:o,reset:o,file:o},Ve=["$browser","$sniffer","$filter","$parse",function(a,b,c,d){return{restrict:"E",require:["?ngModel"],link:{pre:function(e,f,g,h){h[0]&&(Ue[Wc(g.type)]||Ue.text)(e,f,g,h[0],b,a,c,d)}}}}],We=/^(true|false|\d+)$/,Xe=function(){return{restrict:"A",priority:100,compile:function(a,b){return We.test(b.ngValue)?function(a,b,c){c.$set("value",a.$eval(c.ngValue))}:function(a,b,c){a.$watch(c.ngValue,function(a){c.$set("value",a)})}}}},Ye=["$compile",function(a){return{restrict:"AC",compile:function(b){return a.$$addBindingClass(b),function(b,d,e){a.$$addBindingInfo(d,e.ngBind),d=d[0],b.$watch(e.ngBind,function(a){d.textContent=a===c?"":a})}}}}],Ze=["$interpolate","$compile",function(a,b){return{compile:function(d){return b.$$addBindingClass(d),function(d,e,f){var g=a(e.attr(f.$attr.ngBindTemplate));b.$$addBindingInfo(e,g.expressions),e=e[0],f.$observe("ngBindTemplate",function(a){e.textContent=a===c?"":a})}}}}],$e=["$sce","$parse","$compile",function(a,b,c){return{restrict:"A",compile:function(d,e){var f=b(e.ngBindHtml),g=b(e.ngBindHtml,function(a){return(a||"").toString()});return c.$$addBindingClass(d),function(b,d,e){c.$$addBindingInfo(d,e.ngBindHtml),b.$watch(g,function(){d.html(a.getTrustedHtml(f(b))||"")})}}}}],_e=q({restrict:"A",require:"ngModel",link:function(a,b,c,d){d.$viewChangeListeners.push(function(){a.$eval(c.ngChange)})}}),af=Rc("",!0),bf=Rc("Odd",0),cf=Rc("Even",1),df=Bc({compile:function(a,b){b.$set("ngCloak",c),a.removeClass("ng-cloak")}}),ef=[function(){return{restrict:"A",scope:!0,controller:"@",priority:500}}],ff={},gf={blur:!0,focus:!0};f("click dblclick mousedown mouseup mouseover mouseout mousemove mouseenter mouseleave keydown keyup keypress submit focus blur copy cut paste".split(" "),function(a){var b=$a("ng-"+a);ff[b]=["$parse","$rootScope",function(c,d){return{restrict:"A",compile:function(e,f){var g=c(f[b],null,!0);return function(b,c){c.on(a,function(c){var e=function(){g(b,{$event:c})};gf[a]&&d.$$phase?b.$evalAsync(e):b.$apply(e)})}}}}]});var hf=["$animate",function(a){return{multiElement:!0,transclude:"element",priority:600,terminal:!0,restrict:"A",$$tlb:!0,link:function(c,d,e,f,g){var h,i,j;c.$watch(e.ngIf,function(c){c?i||g(function(c,f){i=f,c[c.length++]=b.createComment(" end ngIf: "+e.ngIf+" "),h={clone:c},a.enter(c,d.parent(),d)}):(j&&(j.remove(),j=null),i&&(i.$destroy(),i=null),h&&(j=ia(h.clone),a.leave(j).then(function(){j=null}),h=null))})}}}],jf=["$templateRequest","$anchorScroll","$animate","$sce",function(a,b,c,d){return{restrict:"ECA",priority:400,terminal:!0,transclude:"element",controller:id.noop,compile:function(e,f){var g=f.ngInclude||f.src,h=f.onload||"",i=f.autoscroll;return function(e,f,j,k,l){var m,n,o,p=0,q=function(){n&&(n.remove(),n=null),m&&(m.$destroy(),m=null),o&&(c.leave(o).then(function(){n=null}),n=o,o=null)};e.$watch(d.parseAsResourceUrl(g),function(d){var g=function(){!s(i)||i&&!e.$eval(i)||b()},j=++p;d?(a(d,!0).then(function(a){if(j===p){var b=e.$new();k.template=a;var i=l(b,function(a){q(),c.enter(a,null,f).then(g)});m=b,o=i,m.$emit("$includeContentLoaded",d),e.$eval(h)}},function(){j===p&&(q(),e.$emit("$includeContentError",d))}),e.$emit("$includeContentRequested",d)):(q(),k.template=null)})}}}}],kf=["$compile",function(a){return{restrict:"ECA",priority:-400,require:"ngInclude",link:function(c,d,e,f){return/SVG/.test(d[0].toString())?(d.empty(),void a(sa(f.template,b).childNodes)(c,function(a){d.append(a)},{futureParentElement:d})):(d.html(f.template),void a(d.contents())(c))}}}],lf=Bc({priority:450,compile:function(){return{pre:function(a,b,c){a.$eval(c.ngInit)}}}}),mf=function(){return{restrict:"A",priority:100,require:"ngModel",link:function(a,b,d,e){var g=b.attr(d.$attr.ngList)||", ",h="false"!==d.ngTrim,i=h?md(g):g,j=function(a){if(!r(a)){var b=[];return a&&f(a.split(i),function(a){a&&b.push(h?md(a):a)}),b}};e.$parsers.push(j),e.$formatters.push(function(a){return ld(a)?a.join(g):c}),e.$isEmpty=function(a){return!a||!a.length}}}},nf="ng-valid",of="ng-invalid",pf="ng-pristine",qf="ng-dirty",rf="ng-untouched",sf="ng-touched",tf="ng-pending",uf=new d("ngModel"),vf=["$scope","$exceptionHandler","$attrs","$element","$parse","$animate","$timeout","$rootScope","$q","$interpolate",function(a,b,d,e,g,h,i,j,k,l){this.$viewValue=Number.NaN,this.$modelValue=Number.NaN,this.$$rawModelValue=c,this.$validators={},this.$asyncValidators={},this.$parsers=[],this.$formatters=[],this.$viewChangeListeners=[],this.$untouched=!0,this.$touched=!1,this.$pristine=!0,this.$dirty=!1,this.$valid=!0,this.$invalid=!1,this.$error={},this.$$success={},this.$pending=c,this.$name=l(d.name||"",!1)(a);var m,n=g(d.ngModel),p=n.assign,q=n,t=p,u=null,w=this;this.$$setOptions=function(a){if(w.$options=a,a&&a.getterSetter){var b=g(d.ngModel+"()"),c=g(d.ngModel+"($$$p)");q=function(a){var c=n(a);return x(c)&&(c=b(a)),c},t=function(a,b){x(n(a))?c(a,{$$$p:w.$modelValue}):p(a,w.$modelValue)}}else if(!n.assign)throw uf("nonassign","Expression '{0}' is non-assignable. Element: {1}",d.ngModel,T(e))},this.$render=o,this.$isEmpty=function(a){return r(a)||""===a||null===a||a!==a};var y=e.inheritedData("$formController")||Ge,z=0;Sc({ctrl:this,$element:e,set:function(a,b){a[b]=!0},unset:function(a,b){delete a[b]},parentForm:y,$animate:h}),this.$setPristine=function(){w.$dirty=!1,w.$pristine=!0,h.removeClass(e,qf),h.addClass(e,pf)},this.$setDirty=function(){w.$dirty=!0,w.$pristine=!1,h.removeClass(e,pf),h.addClass(e,qf),y.$setDirty()},this.$setUntouched=function(){w.$touched=!1,w.$untouched=!0,h.setClass(e,rf,sf)},this.$setTouched=function(){w.$touched=!0,w.$untouched=!1,h.setClass(e,sf,rf)},this.$rollbackViewValue=function(){i.cancel(u),w.$viewValue=w.$$lastCommittedViewValue,w.$render()},this.$validate=function(){if(!v(w.$modelValue)||!isNaN(w.$modelValue)){var a=w.$$lastCommittedViewValue,b=w.$$rawModelValue,d=w.$valid,e=w.$modelValue,f=w.$options&&w.$options.allowInvalid;w.$$runValidators(b,a,function(a){f||d===a||(w.$modelValue=a?b:c,w.$modelValue!==e&&w.$$writeModelToScope())})}},this.$$runValidators=function(a,b,d){function e(){var a=w.$$parserName||"parse";return m!==c?(m||(f(w.$validators,function(a,b){i(b,null)}),f(w.$asyncValidators,function(a,b){i(b,null)})),i(a,m),m):(i(a,null),!0)}function g(){var c=!0;return f(w.$validators,function(d,e){var f=d(a,b);c=c&&f,i(e,f)}),c?!0:(f(w.$asyncValidators,function(a,b){i(b,null)}),!1)}function h(){var d=[],e=!0;f(w.$asyncValidators,function(f,g){var h=f(a,b);if(!F(h))throw uf("$asyncValidators","Expected asynchronous validator to return a promise but got '{0}' instead.",h);i(g,c),d.push(h.then(function(){i(g,!0)},function(a){e=!1,i(g,!1)}))}),d.length?k.all(d).then(function(){j(e)},o):j(!0)}function i(a,b){l===z&&w.$setValidity(a,b)}function j(a){l===z&&d(a)}z++;var l=z;return e()&&g()?void h():void j(!1)},this.$commitViewValue=function(){var a=w.$viewValue;i.cancel(u),(w.$$lastCommittedViewValue!==a||""===a&&w.$$hasNativeValidators)&&(w.$$lastCommittedViewValue=a,w.$pristine&&this.$setDirty(),this.$$parseAndValidate())},this.$$parseAndValidate=function(){function b(){w.$modelValue!==g&&w.$$writeModelToScope()}var d=w.$$lastCommittedViewValue,e=d;if(m=r(e)?c:!0)for(var f=0;f<w.$parsers.length;f++)if(e=w.$parsers[f](e),r(e)){m=!1;break}v(w.$modelValue)&&isNaN(w.$modelValue)&&(w.$modelValue=q(a));var g=w.$modelValue,h=w.$options&&w.$options.allowInvalid;w.$$rawModelValue=e,h&&(w.$modelValue=e,b()),w.$$runValidators(e,w.$$lastCommittedViewValue,function(a){h||(w.$modelValue=a?e:c,b())})},this.$$writeModelToScope=function(){t(a,w.$modelValue),f(w.$viewChangeListeners,function(a){try{a()}catch(c){b(c)}})},this.$setViewValue=function(a,b){w.$viewValue=a,w.$options&&!w.$options.updateOnDefault||w.$$debounceViewValueCommit(b)},this.$$debounceViewValueCommit=function(b){var c,d=0,e=w.$options;e&&s(e.debounce)&&(c=e.debounce,v(c)?d=c:v(c[b])?d=c[b]:v(c["default"])&&(d=c["default"])),i.cancel(u),d?u=i(function(){w.$commitViewValue()},d):j.$$phase?w.$commitViewValue():a.$apply(function(){w.$commitViewValue()})},a.$watch(function(){var b=q(a);if(b!==w.$modelValue&&(w.$modelValue===w.$modelValue||b===b)){w.$modelValue=w.$$rawModelValue=b,m=c;for(var d=w.$formatters,e=d.length,f=b;e--;)f=d[e](f);w.$viewValue!==f&&(w.$viewValue=w.$$lastCommittedViewValue=f,w.$render(),w.$$runValidators(b,f,o))}return b})}],wf=["$rootScope",function(a){return{restrict:"A",require:["ngModel","^?form","^?ngModelOptions"],controller:vf,priority:1,compile:function(b){return b.addClass(pf).addClass(rf).addClass(nf),{pre:function(a,b,c,d){var e=d[0],f=d[1]||Ge;e.$$setOptions(d[2]&&d[2].$options),f.$addControl(e),c.$observe("name",function(a){e.$name!==a&&f.$$renameControl(e,a)}),a.$on("$destroy",function(){f.$removeControl(e)})},post:function(b,c,d,e){var f=e[0];f.$options&&f.$options.updateOn&&c.on(f.$options.updateOn,function(a){f.$$debounceViewValueCommit(a&&a.type)}),c.on("blur",function(c){f.$touched||(a.$$phase?b.$evalAsync(f.$setTouched):b.$apply(f.$setTouched))})}}}}}],xf=/(\s+|^)default(\s+|$)/,yf=function(){return{restrict:"A",controller:["$scope","$attrs",function(a,b){var d=this;this.$options=a.$eval(b.ngModelOptions),this.$options.updateOn!==c?(this.$options.updateOnDefault=!1,this.$options.updateOn=md(this.$options.updateOn.replace(xf,function(){return d.$options.updateOnDefault=!0," "}))):this.$options.updateOnDefault=!0}]}},zf=Bc({terminal:!0,priority:1e3}),Af=["$locale","$interpolate",function(a,b){var c=/{}/g,d=/^when(Minus)?(.+)$/;return{restrict:"EA",link:function(e,g,h){function i(a){g.text(a||"")}var j,k=h.count,l=h.$attr.when&&g.attr(h.$attr.when),m=h.offset||0,n=e.$eval(l)||{},o={},p=b.startSymbol(),q=b.endSymbol(),r=p+k+"-"+m+q,s=id.noop;f(h,function(a,b){var c=d.exec(b);if(c){var e=(c[1]?"-":"")+Wc(c[2]);n[e]=g.attr(h.$attr[b])}}),f(n,function(a,d){o[d]=b(a.replace(c,r))}),e.$watch(k,function(b){var c=parseFloat(b),d=isNaN(c);d||c in n||(c=a.pluralCat(c-m)),c===j||d&&isNaN(j)||(s(),s=e.$watch(o[c],i),j=c)})}}}],Bf=["$parse","$animate",function(a,g){var h="$$NG_REMOVED",i=d("ngRepeat"),j=function(a,b,c,d,e,f,g){a[c]=d,e&&(a[e]=f),a.$index=b,a.$first=0===b,a.$last=b===g-1,a.$middle=!(a.$first||a.$last),a.$odd=!(a.$even=0===(1&b))},k=function(a){return a.clone[0]},l=function(a){return a.clone[a.clone.length-1]};return{restrict:"A",multiElement:!0,transclude:"element",priority:1e3,terminal:!0,$$tlb:!0,compile:function(d,m){var n=m.ngRepeat,o=b.createComment(" end ngRepeat: "+n+" "),p=n.match(/^\s*([\s\S]+?)\s+in\s+([\s\S]+?)(?:\s+as\s+([\s\S]+?))?(?:\s+track\s+by\s+([\s\S]+?))?\s*$/);if(!p)throw i("iexp","Expected expression in form of '_item_ in _collection_[ track by _id_]' but got '{0}'.",n);var q=p[1],r=p[2],s=p[3],t=p[4];if(p=q.match(/^(?:(\s*[\$\w]+)|\(\s*([\$\w]+)\s*,\s*([\$\w]+)\s*\))$/),!p)throw i("iidexp","'_item_' in '_item_ in _collection_' should be an identifier or '(_key_, _value_)' expression, but got '{0}'.",q);var u=p[3]||p[1],v=p[2];if(s&&(!/^[$a-zA-Z_][$a-zA-Z0-9_]*$/.test(s)||/^(null|undefined|this|\$index|\$first|\$middle|\$last|\$even|\$odd|\$parent|\$root|\$id)$/.test(s)))throw i("badident","alias '{0}' is invalid --- must be a valid JS identifier which is not a reserved name.",s);var w,x,y,z,A={$id:Oa};return t?w=a(t):(y=function(a,b){return Oa(b)},z=function(a){return a}),function(a,b,d,m,p){w&&(x=function(b,c,d){return v&&(A[v]=b),A[u]=c,A.$index=d,w(a,A)});var q=ja();a.$watchCollection(r,function(d){var m,r,t,w,A,B,C,D,E,F,G,H,I=b[0],J=ja();if(s&&(a[s]=d),e(d))E=d,D=x||y;else{D=x||z,E=[];for(var K in d)d.hasOwnProperty(K)&&"$"!=K.charAt(0)&&E.push(K);E.sort()}for(w=E.length,G=new Array(w),m=0;w>m;m++)if(A=d===E?m:E[m],B=d[A],C=D(A,B,m),q[C])F=q[C],delete q[C],J[C]=F,G[m]=F;else{if(J[C])throw f(G,function(a){a&&a.scope&&(q[a.id]=a)}),i("dupes","Duplicates in a repeater are not allowed. Use 'track by' expression to specify unique keys. Repeater: {0}, Duplicate key: {1}, Duplicate value: {2}",n,C,B);G[m]={id:C,scope:c,clone:c},J[C]=!0}for(var L in q){if(F=q[L],H=ia(F.clone),g.leave(H),H[0].parentNode)for(m=0,r=H.length;r>m;m++)H[m][h]=!0;F.scope.$destroy()}for(m=0;w>m;m++)if(A=d===E?m:E[m],B=d[A],F=G[m],F.scope){t=I;do t=t.nextSibling;while(t&&t[h]);k(F)!=t&&g.move(ia(F.clone),null,ad(I)),I=l(F),j(F.scope,m,u,B,v,A,w)}else p(function(a,b){F.scope=b;var c=o.cloneNode(!1);a[a.length++]=c,g.enter(a,null,ad(I)),I=c,F.clone=a,J[F.id]=F,j(F.scope,m,u,B,v,A,w)});q=J})}}}}],Cf="ng-hide",Df="ng-hide-animate",Ef=["$animate",function(a){return{restrict:"A",multiElement:!0,link:function(b,c,d){b.$watch(d.ngShow,function(b){a[b?"removeClass":"addClass"](c,Cf,{tempClasses:Df})})}}}],Ff=["$animate",function(a){return{restrict:"A",multiElement:!0,link:function(b,c,d){b.$watch(d.ngHide,function(b){a[b?"addClass":"removeClass"](c,Cf,{tempClasses:Df})})}}}],Gf=Bc(function(a,b,c){a.$watch(c.ngStyle,function(a,c){c&&a!==c&&f(c,function(a,c){b.css(c,"")}),a&&b.css(a)},!0)}),Hf=["$animate",function(a){return{restrict:"EA",require:"ngSwitch",controller:["$scope",function(){this.cases={}}],link:function(c,d,e,g){var h=e.ngSwitch||e.on,i=[],j=[],k=[],l=[],m=function(a,b){return function(){a.splice(b,1)}};c.$watch(h,function(c){var d,e;for(d=0,e=k.length;e>d;++d)a.cancel(k[d]);for(k.length=0,d=0,e=l.length;e>d;++d){var h=ia(j[d].clone);l[d].$destroy();var n=k[d]=a.leave(h);n.then(m(k,d))}j.length=0,l.length=0,(i=g.cases["!"+c]||g.cases["?"])&&f(i,function(c){c.transclude(function(d,e){l.push(e);var f=c.element;d[d.length++]=b.createComment(" end ngSwitchWhen: ");var g={clone:d};j.push(g),a.enter(d,f.parent(),f)})})})}}}],If=Bc({transclude:"element",priority:1200,require:"^ngSwitch",multiElement:!0,link:function(a,b,c,d,e){d.cases["!"+c.ngSwitchWhen]=d.cases["!"+c.ngSwitchWhen]||[],d.cases["!"+c.ngSwitchWhen].push({transclude:e,element:b})}}),Jf=Bc({transclude:"element",priority:1200,require:"^ngSwitch",multiElement:!0,link:function(a,b,c,d,e){d.cases["?"]=d.cases["?"]||[],d.cases["?"].push({transclude:e,element:b})}}),Kf=Bc({restrict:"EAC",link:function(a,b,c,e,f){if(!f)throw d("ngTransclude")("orphan","Illegal use of ngTransclude directive in the template! No parent directive that requires a transclusion found. Element: {0}",T(b));f(function(a){b.empty(),b.append(a)})}}),Lf=["$templateCache",function(a){return{restrict:"E",terminal:!0,compile:function(b,c){if("text/ng-template"==c.type){var d=c.id,e=b[0].text;a.put(d,e)}}}}],Mf=d("ngOptions"),Nf=q({restrict:"A",terminal:!0}),Of=["$compile","$parse",function(a,d){var e=/^\s*([\s\S]+?)(?:\s+as\s+([\s\S]+?))?(?:\s+group\s+by\s+([\s\S]+?))?\s+for\s+(?:([\$\w][\$\w]*)|(?:\(\s*([\$\w][\$\w]*)\s*,\s*([\$\w][\$\w]*)\s*\)))\s+in\s+([\s\S]+?)(?:\s+track\s+by\s+([\s\S]+?))?$/,h={$setViewValue:o};return{restrict:"E",require:["select","?ngModel"],controller:["$element","$scope","$attrs",function(a,b,c){
var d,e,f=this,g={},i=h;f.databound=c.ngModel,f.init=function(a,b,c){i=a,d=b,e=c},f.addOption=function(b,c){ga(b,'"option value"'),g[b]=!0,i.$viewValue==b&&(a.val(b),e.parent()&&e.remove()),c&&c[0].hasAttribute("selected")&&(c[0].selected=!0)},f.removeOption=function(a){this.hasOption(a)&&(delete g[a],i.$viewValue===a&&this.renderUnknownOption(a))},f.renderUnknownOption=function(b){var c="? "+Oa(b)+" ?";e.val(c),a.prepend(e),a.val(c),e.prop("selected",!0)},f.hasOption=function(a){return g.hasOwnProperty(a)},b.$on("$destroy",function(){f.renderUnknownOption=o})}],link:function(h,i,j,k){function l(a,b,c,d){c.$render=function(){var a=c.$viewValue;d.hasOption(a)?(y.parent()&&y.remove(),b.val(a),""===a&&o.prop("selected",!0)):null==a&&o?b.val(""):d.renderUnknownOption(a)},b.on("change",function(){a.$apply(function(){y.parent()&&y.remove(),c.$setViewValue(b.val())})})}function m(a,b,c){var d;c.$render=function(){var a=new Pa(c.$viewValue);f(b.find("option"),function(b){b.selected=s(a.get(b.value))})},a.$watch(function(){M(d,c.$viewValue)||(d=L(c.$viewValue),c.$render())}),b.on("change",function(){a.$apply(function(){var a=[];f(b.find("option"),function(b){b.selected&&a.push(b.value)}),c.$setViewValue(a)})})}function n(b,h,i){function j(a,c,d){return M[B]=d,E&&(M[E]=c),a(b,M)}function k(){b.$apply(function(){var a,c=H(b)||[];if(r)a=[],f(h.val(),function(b){b=J?K[b]:b,a.push(l(b,c[b]))});else{var d=J?K[h.val()]:h.val();a=l(d,c[d])}i.$setViewValue(a),y()})}function l(a,b){if("?"===a)return c;if(""===a)return null;var d=D?D:G;return j(d,a,b)}function m(){var a,c=H(b);if(c&&ld(c)){a=new Array(c.length);for(var d=0,e=c.length;e>d;d++)a[d]=j(A,d,c[d]);return a}if(c){a={};for(var f in c)c.hasOwnProperty(f)&&(a[f]=j(A,f,c[f]))}return a}function n(a){var b;if(r)if(J&&ld(a)){b=new Pa([]);for(var c=0;c<a.length;c++)b.put(j(J,null,a[c]),!0)}else b=new Pa(a);else J&&(a=j(J,null,a));return function(c,d){var e;return e=J?J:D?D:G,r?s(b.remove(j(e,c,d))):a===j(e,c,d)}}function o(){v||(b.$$postDigest(y),v=!0)}function q(a,b,c){a[b]=a[b]||0,a[b]+=c?1:-1}function y(){v=!1;var a,c,d,e,k,l,m,o,t,y,z,B,C,D,G,I,N,O={"":[]},P=[""],Q=i.$viewValue,R=H(b)||[],S=E?g(R):R,T={},U=n(Q),V=!1;for(K={},B=0;y=S.length,y>B;B++)m=B,E&&(m=S[B],"$"===m.charAt(0))||(o=R[m],a=j(F,m,o)||"",(c=O[a])||(c=O[a]=[],P.push(a)),C=U(m,o),V=V||C,I=j(A,m,o),I=s(I)?I:"",N=J?J(b,M):E?S[B]:B,J&&(K[N]=m),c.push({id:N,label:I,selected:C}));for(r||(u||null===Q?O[""].unshift({id:"",label:"",selected:!V}):V||O[""].unshift({id:"?",label:"",selected:!0})),z=0,t=P.length;t>z;z++){for(a=P[z],c=O[a],L.length<=z?(e={element:x.clone().attr("label",a),label:c.label},k=[e],L.push(k),h.append(e.element)):(k=L[z],e=k[0],e.label!=a&&e.element.attr("label",e.label=a)),D=null,B=0,y=c.length;y>B;B++)d=c[B],(l=k[B+1])?(D=l.element,l.label!==d.label&&(q(T,l.label,!1),q(T,d.label,!0),D.text(l.label=d.label),D.prop("label",l.label)),l.id!==d.id&&D.val(l.id=d.id),D[0].selected!==d.selected&&(D.prop("selected",l.selected=d.selected),_c&&D.prop("selected",l.selected))):(""===d.id&&u?G=u:(G=w.clone()).val(d.id).prop("selected",d.selected).attr("selected",d.selected).prop("label",d.label).text(d.label),k.push(l={element:G,label:d.label,id:d.id,selected:d.selected}),q(T,d.label,!0),D?D.after(G):e.element.append(G),D=G);for(B++;k.length>B;)d=k.pop(),q(T,d.label,!1),d.element.remove()}for(;L.length>z;){for(c=L.pop(),B=1;B<c.length;++B)q(T,c[B].label,!1);c[0].element.remove()}f(T,function(a,b){a>0?p.addOption(b):0>a&&p.removeOption(b)})}var z;if(!(z=t.match(e)))throw Mf("iexp","Expected expression in form of '_select_ (as _label_)? for (_key_,)?_value_ in _collection_' but got '{0}'. Element: {1}",t,T(h));var A=d(z[2]||z[1]),B=z[4]||z[6],C=/ as /.test(z[0])&&z[1],D=C?d(C):null,E=z[5],F=d(z[3]||""),G=d(z[2]?z[1]:B),H=d(z[7]),I=z[8],J=I?d(z[8]):null,K={},L=[[{element:h,label:""}]],M={};u&&(a(u)(b),u.removeClass("ng-scope"),u.remove()),h.empty(),h.on("change",k),i.$render=y,b.$watchCollection(H,o),b.$watchCollection(m,o),r&&b.$watchCollection(function(){return i.$modelValue},o)}if(k[1]){for(var o,p=k[0],q=k[1],r=j.multiple,t=j.ngOptions,u=!1,v=!1,w=ad(b.createElement("option")),x=ad(b.createElement("optgroup")),y=w.clone(),z=0,A=i.children(),B=A.length;B>z;z++)if(""===A[z].value){o=u=A.eq(z);break}p.init(q,u,y),r&&(q.$isEmpty=function(a){return!a||0===a.length}),t?n(h,i,q):r?m(h,i,q):l(h,i,q,p)}}}}],Pf=["$interpolate",function(a){var b={addOption:o,removeOption:o};return{restrict:"E",priority:100,compile:function(c,d){if(r(d.value)){var e=a(c.text(),!0);e||d.$set("value",c.text())}return function(a,c,d){var f="$selectController",g=c.parent(),h=g.data(f)||g.parent().data(f);h&&h.databound||(h=b),e?a.$watch(e,function(a,b){d.$set("value",a),b!==a&&h.removeOption(b),h.addOption(a,c)}):h.addOption(d.value,c),c.on("$destroy",function(){h.removeOption(d.value)})}}}}],Qf=q({restrict:"E",terminal:!1}),Rf=function(){return{restrict:"A",require:"?ngModel",link:function(a,b,c,d){d&&(c.required=!0,d.$validators.required=function(a,b){return!c.required||!d.$isEmpty(b)},c.$observe("required",function(){d.$validate()}))}}},Sf=function(){return{restrict:"A",require:"?ngModel",link:function(a,b,e,f){if(f){var g,h=e.ngPattern||e.pattern;e.$observe("pattern",function(a){if(u(a)&&a.length>0&&(a=new RegExp("^"+a+"$")),a&&!a.test)throw d("ngPattern")("noregexp","Expected {0} to be a RegExp but was {1}. Element: {2}",h,a,T(b));g=a||c,f.$validate()}),f.$validators.pattern=function(a){return f.$isEmpty(a)||r(g)||g.test(a)}}}}},Tf=function(){return{restrict:"A",require:"?ngModel",link:function(a,b,c,d){if(d){var e=-1;c.$observe("maxlength",function(a){var b=m(a);e=isNaN(b)?-1:b,d.$validate()}),d.$validators.maxlength=function(a,b){return 0>e||d.$isEmpty(b)||b.length<=e}}}}},Uf=function(){return{restrict:"A",require:"?ngModel",link:function(a,b,c,d){if(d){var e=0;c.$observe("minlength",function(a){e=m(a)||0,d.$validate()}),d.$validators.minlength=function(a,b){return d.$isEmpty(b)||b.length>=e}}}}};return a.angular.bootstrap?void console.log("WARNING: Tried to load angular more than once."):(da(),na(id),void ad(b).ready(function(){$(b,_)}))}(window,document),!window.angular.$$csp()&&window.angular.element(document).find("head").prepend('<style type="text/css">@charset "UTF-8";[ng\\:cloak],[ng-cloak],[data-ng-cloak],[x-ng-cloak],.ng-cloak,.x-ng-cloak,.ng-hide:not(.ng-hide-animate){display:none !important;}ng\\:form{display:block;}</style>'),angular.module("colorpicker.module",[]).factory("helper",function(){return{closest:function(a,b){for(var c=a.matches||a.webkitMatchesSelector||a.mozMatchesSelector||a.msMatchesSelector;a;){if(c.bind(a)(b))return a;a=a.parentNode}return!1},getOffset:function(a){for(var b=0,c=0;a&&!isNaN(a.offsetLeft)&&!isNaN(a.offsetTop);)b+=a.offsetLeft,c+=a.offsetTop,a=a.offsetParent;return{top:c,left:b}},extend:function(){for(var a=1;a<arguments.length;a++)for(var b in arguments[a])arguments[a].hasOwnProperty(b)&&(arguments[0][b]=arguments[a][b]);return arguments[0]},stringParsers:[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(a){return[a[1],a[2],a[3],a[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(a){return[2.55*a[1],2.55*a[2],2.55*a[3],a[4]]}},{re:/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/,parse:function(a){return[parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16)]}},{re:/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/,parse:function(a){return[parseInt(a[1]+a[1],16),parseInt(a[2]+a[2],16),parseInt(a[3]+a[3],16)]}}]}}).factory("Color",["helper",function(a){return{value:{h:1,s:1,b:1,a:1},rgb:function(){var a=this.toRGB();return"rgb("+a.r+","+a.g+","+a.b+")"},rgba:function(){var a=this.toRGB();return"rgba("+a.r+","+a.g+","+a.b+","+a.a+")"},hex:function(){return this.toHex()},RGBtoHSB:function(a,b,c,d){a/=255,b/=255,c/=255;var e,f,g,h;return g=Math.max(a,b,c),h=g-Math.min(a,b,c),e=0===h?null:g==a?(b-c)/h:g==b?(c-a)/h+2:(a-b)/h+4,e=(e+360)%6*60/360,f=0===h?0:h/g,{h:e||1,s:f,b:g,a:d||1}},HueToRGB:function(a,b,c){return 0>c?c+=1:c>1&&(c-=1),1>6*c?a+(b-a)*c*6:1>2*c?b:2>3*c?a+(b-a)*(2/3-c)*6:a},setColor:function(b){b=b.toLowerCase();for(var c in a.stringParsers){var d=a.stringParsers[c],e=d.re.exec(b),f=e&&d.parse(e);d.space||"rgba";if(f)return this.value=this.RGBtoHSB.apply(null,f),!1}},setHue:function(a){this.value.h=1-a},setSaturation:function(a){this.value.s=a},setLightness:function(a){this.value.b=1-a},setAlpha:function(a){this.value.a=parseInt(100*(1-a),10)/100},toRGB:function(a,b,c,d){a||(a=this.value.h,b=this.value.s,c=this.value.b),a*=360;var e,f,g,h,i;return a=a%360/60,i=c*b,h=i*(1-Math.abs(a%2-1)),e=f=g=c-i,a=~~a,e+=[i,h,0,0,h,i][a],f+=[h,i,i,h,0,0][a],g+=[0,0,h,i,i,h][a],{r:Math.round(255*e),g:Math.round(255*f),b:Math.round(255*g),a:d||this.value.a}},toHex:function(a,b,c,d){var e=this.toRGB(a,b,c,d);return"#"+(1<<24|parseInt(e.r)<<16|parseInt(e.g)<<8|parseInt(e.b)).toString(16).substr(1)}}}]).directive("colorpicker",["$document","$compile","Color","helper",function(a,b,c,d){return{require:"?ngModel",restrict:"A",link:function(e,f,g,h){var i,j,k,l,m='<div class="colorpicker dropdown-menu"><div class="colorpicker-saturation"><i><b></b></i></div><div class="colorpicker-hue"><i></i></div><div class="colorpicker-alpha"><i></i></div><div class="colorpicker-color"><div></div></div><button class="close close-colorpicker">&times;</button></div>',n=angular.element(m),o=c,p=null,q=null,r=g.colorpicker?g.colorpicker:"hex",s=g.colorpickerPosition?g.colorpickerPosition:"bottom";b(n)(e),j={enabled:"rgba"===r,css:null},j.enabled===!0&&(n.addClass("alpha"),j.css=n.find("div")[2].style),n.addClass("colorpicker-position-"+s),angular.element(document.body).append(n),h&&(h.$render=function(){f.val(h.$viewValue)},e.$watch(g.ngModel,function(){x()})),f.bind("$destroy",function(){n.remove()}),k=n.find("div")[0].style,i=n.find("div")[4].style,l=n.find("i");var t=function(){try{i.backgroundColor=o[r]()}catch(a){i.backgroundColor=o.toHex()}k.backgroundColor=o.toHex(o.value.h,1,1,1),j.enabled===!0&&(j.css.backgroundColor=o.toHex())},u=function(a){a.stopPropagation(),a.preventDefault();var b=d.closest(a.target,"div");if("colorpicker-saturation"===b.className)q=d.extend({},{maxLeft:100,maxTop:100,callLeft:"setSaturation",callTop:"setLightness"});else if("colorpicker-hue"===b.className)q=d.extend({},{maxLeft:0,maxTop:100,callLeft:!1,callTop:"setHue"});else{if("colorpicker-alpha"!==b.className)return q=null,!1;q=d.extend({},{maxLeft:0,maxTop:100,callLeft:!1,callTop:"setAlpha"})}q.knob=b.children[0].style,q.left=a.pageX-d.getOffset(b).left,q.top=a.pageY-d.getOffset(b).top,p={left:a.pageX,top:a.pageY}},v=function(a){if(q){var b=Math.max(0,Math.min(q.maxLeft,q.left+((a.pageX||p.left)-p.left))),c=Math.max(0,Math.min(q.maxTop,q.top+((a.pageY||p.top)-p.top)));q.knob.left=b+"px",q.knob.top=c+"px",q.callLeft&&o[q.callLeft].call(o,b/100),q.callTop&&o[q.callTop].call(o,c/100),t();var d=o[r]();return f.val(d),h&&e.$apply(h.$setViewValue(d)),!1}},w=function(){a.unbind("mousemove",v),a.unbind("mouseup",w)},x=function(){o.setColor(f.val()),l.eq(0).css({left:100*o.value.s+"px",top:100-100*o.value.b+"px"}),l.eq(1).css("top",100*(1-o.value.h)+"px"),l.eq(2).css("top",100*(1-o.value.a)+"px"),t()},y=function(){var a,b=d.getOffset(f[0]);return"top"===s?a={top:b.top-146,left:b.left}:"right"===s?a={top:b.top,left:b.left+141}:"bottom"===s?a={top:b.top+f[0].offsetHeight,left:b.left}:"left"===s&&(a={top:b.top,left:b.left-131}),{top:a.top+"px",left:a.left+"px"}};f.bind("click",function(){x(),n.addClass("colorpicker-visible").css(y())}),n.bind("mousedown",function(a){a.stopPropagation(),a.preventDefault()}),n.find("div").bind("click",function(a){u(a),v(a)}),n.find("div").bind("mousedown",function(b){u(b),a.bind("mousemove",v),a.bind("mouseup",w)});var z=function(){n.hasClass("colorpicker-visible")&&n.removeClass("colorpicker-visible")};n.find("button").bind("click",function(){z()}),a.bind("mousedown",function(){z()})}}}]),angular.module("ui.bootstrap",["ui.bootstrap.tpls","ui.bootstrap.transition","ui.bootstrap.collapse","ui.bootstrap.accordion","ui.bootstrap.alert","ui.bootstrap.bindHtml","ui.bootstrap.buttons","ui.bootstrap.carousel","ui.bootstrap.dateparser","ui.bootstrap.position","ui.bootstrap.datepicker","ui.bootstrap.dropdown","ui.bootstrap.modal","ui.bootstrap.pagination","ui.bootstrap.tooltip","ui.bootstrap.popover","ui.bootstrap.progressbar","ui.bootstrap.rating","ui.bootstrap.tabs","ui.bootstrap.timepicker","ui.bootstrap.typeahead"]),angular.module("ui.bootstrap.tpls",["template/accordion/accordion-group.html","template/accordion/accordion.html","template/alert/alert.html","template/carousel/carousel.html","template/carousel/slide.html","template/datepicker/datepicker.html","template/datepicker/day.html","template/datepicker/month.html","template/datepicker/popup.html","template/datepicker/year.html","template/modal/backdrop.html","template/modal/window.html","template/pagination/pager.html","template/pagination/pagination.html","template/tooltip/tooltip-html-unsafe-popup.html","template/tooltip/tooltip-popup.html","template/popover/popover.html","template/progressbar/bar.html","template/progressbar/progress.html","template/progressbar/progressbar.html","template/rating/rating.html","template/tabs/tab.html","template/tabs/tabset.html","template/timepicker/timepicker.html","template/typeahead/typeahead-match.html","template/typeahead/typeahead-popup.html"]),angular.module("ui.bootstrap.transition",[]).factory("$transition",["$q","$timeout","$rootScope",function(a,b,c){function d(a){for(var b in a)if(void 0!==f.style[b])return a[b]}var e=function(d,f,g){g=g||{};var h=a.defer(),i=e[g.animation?"animationEndEventName":"transitionEndEventName"],j=function(a){c.$apply(function(){d.unbind(i,j),h.resolve(d)})};return i&&d.bind(i,j),b(function(){angular.isString(f)?d.addClass(f):angular.isFunction(f)?f(d):angular.isObject(f)&&d.css(f),i||h.resolve(d)}),h.promise.cancel=function(){i&&d.unbind(i,j),h.reject("Transition cancelled")},h.promise},f=document.createElement("trans"),g={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",transition:"transitionend"},h={WebkitTransition:"webkitAnimationEnd",MozTransition:"animationend",OTransition:"oAnimationEnd",transition:"animationend"};return e.transitionEndEventName=d(g),e.animationEndEventName=d(h),e}]),angular.module("ui.bootstrap.collapse",["ui.bootstrap.transition"]).directive("collapse",["$transition",function(a){return{link:function(b,c,d){function e(b){function d(){j===e&&(j=void 0)}var e=a(c,b);return j&&j.cancel(),j=e,e.then(d,d),e}function f(){k?(k=!1,g()):(c.removeClass("collapse").addClass("collapsing"),e({height:c[0].scrollHeight+"px"}).then(g))}function g(){c.removeClass("collapsing"),c.addClass("collapse in"),c.css({height:"auto"})}function h(){if(k)k=!1,i(),c.css({height:0});else{c.css({height:c[0].scrollHeight+"px"});c[0].offsetWidth;c.removeClass("collapse in").addClass("collapsing"),e({height:0}).then(i)}}function i(){c.removeClass("collapsing"),c.addClass("collapse")}var j,k=!0;b.$watch(d.collapse,function(a){a?h():f()})}}}]),angular.module("ui.bootstrap.accordion",["ui.bootstrap.collapse"]).constant("accordionConfig",{closeOthers:!0}).controller("AccordionController",["$scope","$attrs","accordionConfig",function(a,b,c){this.groups=[],this.closeOthers=function(d){var e=angular.isDefined(b.closeOthers)?a.$eval(b.closeOthers):c.closeOthers;e&&angular.forEach(this.groups,function(a){a!==d&&(a.isOpen=!1)})},this.addGroup=function(a){var b=this;this.groups.push(a),a.$on("$destroy",function(c){b.removeGroup(a)})},this.removeGroup=function(a){var b=this.groups.indexOf(a);-1!==b&&this.groups.splice(b,1)}}]).directive("accordion",function(){return{restrict:"EA",controller:"AccordionController",transclude:!0,replace:!1,templateUrl:"template/accordion/accordion.html"}}).directive("accordionGroup",function(){return{require:"^accordion",restrict:"EA",transclude:!0,replace:!0,templateUrl:"template/accordion/accordion-group.html",scope:{heading:"@",isOpen:"=?",isDisabled:"=?"},controller:function(){this.setHeading=function(a){this.heading=a}},link:function(a,b,c,d){d.addGroup(a),a.$watch("isOpen",function(b){b&&d.closeOthers(a)}),a.toggleOpen=function(){a.isDisabled||(a.isOpen=!a.isOpen)}}}}).directive("accordionHeading",function(){return{restrict:"EA",transclude:!0,template:"",replace:!0,require:"^accordionGroup",link:function(a,b,c,d,e){d.setHeading(e(a,function(){}))}}}).directive("accordionTransclude",function(){return{require:"^accordionGroup",link:function(a,b,c,d){a.$watch(function(){return d[c.accordionTransclude]},function(a){a&&(b.html(""),b.append(a))})}}}),angular.module("ui.bootstrap.alert",[]).controller("AlertController",["$scope","$attrs",function(a,b){a.closeable="close"in b,this.close=a.close}]).directive("alert",function(){return{restrict:"EA",controller:"AlertController",templateUrl:"template/alert/alert.html",transclude:!0,replace:!0,scope:{type:"@",close:"&"}}}).directive("dismissOnTimeout",["$timeout",function(a){return{require:"alert",link:function(b,c,d,e){a(function(){e.close()},parseInt(d.dismissOnTimeout,10))}}}]),angular.module("ui.bootstrap.bindHtml",[]).directive("bindHtmlUnsafe",function(){return function(a,b,c){b.addClass("ng-binding").data("$binding",c.bindHtmlUnsafe),a.$watch(c.bindHtmlUnsafe,function(a){b.html(a||"")})}}),angular.module("ui.bootstrap.buttons",[]).constant("buttonConfig",{activeClass:"active",toggleEvent:"click"}).controller("ButtonsController",["buttonConfig",function(a){this.activeClass=a.activeClass||"active",this.toggleEvent=a.toggleEvent||"click"}]).directive("btnRadio",function(){return{require:["btnRadio","ngModel"],controller:"ButtonsController",link:function(a,b,c,d){var e=d[0],f=d[1];f.$render=function(){b.toggleClass(e.activeClass,angular.equals(f.$modelValue,a.$eval(c.btnRadio)))},b.bind(e.toggleEvent,function(){var d=b.hasClass(e.activeClass);d&&!angular.isDefined(c.uncheckable)||a.$apply(function(){f.$setViewValue(d?null:a.$eval(c.btnRadio)),f.$render()})})}}}).directive("btnCheckbox",function(){return{require:["btnCheckbox","ngModel"],controller:"ButtonsController",link:function(a,b,c,d){function e(){return g(c.btnCheckboxTrue,!0)}function f(){return g(c.btnCheckboxFalse,!1)}function g(b,c){var d=a.$eval(b);return angular.isDefined(d)?d:c}var h=d[0],i=d[1];i.$render=function(){b.toggleClass(h.activeClass,angular.equals(i.$modelValue,e()))},b.bind(h.toggleEvent,function(){a.$apply(function(){i.$setViewValue(b.hasClass(h.activeClass)?f():e()),i.$render()})})}}}),angular.module("ui.bootstrap.carousel",["ui.bootstrap.transition"]).controller("CarouselController",["$scope","$timeout","$interval","$transition",function(a,b,c,d){function e(){f();var b=+a.interval;!isNaN(b)&&b>0&&(h=c(g,b))}function f(){h&&(c.cancel(h),h=null)}function g(){var b=+a.interval;i&&!isNaN(b)&&b>0?a.next():a.pause()}var h,i,j=this,k=j.slides=a.slides=[],l=-1;j.currentSlide=null;var m=!1;j.select=a.select=function(c,f){function g(){if(!m){if(j.currentSlide&&angular.isString(f)&&!a.noTransition&&c.$element){c.$element.addClass(f);c.$element[0].offsetWidth;angular.forEach(k,function(a){angular.extend(a,{direction:"",entering:!1,leaving:!1,active:!1})}),angular.extend(c,{direction:f,active:!0,entering:!0}),angular.extend(j.currentSlide||{},{direction:f,leaving:!0}),a.$currentTransition=d(c.$element,{}),function(b,c){a.$currentTransition.then(function(){h(b,c)},function(){h(b,c)})}(c,j.currentSlide)}else h(c,j.currentSlide);j.currentSlide=c,l=i,e()}}function h(b,c){angular.extend(b,{direction:"",active:!0,leaving:!1,entering:!1}),angular.extend(c||{},{direction:"",active:!1,leaving:!1,entering:!1}),a.$currentTransition=null}var i=k.indexOf(c);void 0===f&&(f=i>l?"next":"prev"),c&&c!==j.currentSlide&&(a.$currentTransition?(a.$currentTransition.cancel(),b(g)):g())},a.$on("$destroy",function(){m=!0}),j.indexOfSlide=function(a){return k.indexOf(a)},a.next=function(){var b=(l+1)%k.length;return a.$currentTransition?void 0:j.select(k[b],"next")},a.prev=function(){var b=0>l-1?k.length-1:l-1;return a.$currentTransition?void 0:j.select(k[b],"prev")},a.isActive=function(a){return j.currentSlide===a},a.$watch("interval",e),a.$on("$destroy",f),a.play=function(){i||(i=!0,e())},a.pause=function(){a.noPause||(i=!1,f())},j.addSlide=function(b,c){b.$element=c,k.push(b),1===k.length||b.active?(j.select(k[k.length-1]),1==k.length&&a.play()):b.active=!1},j.removeSlide=function(a){var b=k.indexOf(a);k.splice(b,1),k.length>0&&a.active?b>=k.length?j.select(k[b-1]):j.select(k[b]):l>b&&l--}}]).directive("carousel",[function(){return{restrict:"EA",transclude:!0,replace:!0,controller:"CarouselController",require:"carousel",templateUrl:"template/carousel/carousel.html",scope:{interval:"=",noTransition:"=",noPause:"="}}}]).directive("slide",function(){return{require:"^carousel",restrict:"EA",transclude:!0,replace:!0,templateUrl:"template/carousel/slide.html",scope:{active:"=?"},link:function(a,b,c,d){d.addSlide(a,b),a.$on("$destroy",function(){d.removeSlide(a)}),a.$watch("active",function(b){b&&d.select(a)})}}}),angular.module("ui.bootstrap.dateparser",[]).service("dateParser",["$locale","orderByFilter",function(a,b){function c(a){var c=[],d=a.split("");return angular.forEach(e,function(b,e){var f=a.indexOf(e);if(f>-1){a=a.split(""),d[f]="("+b.regex+")",a[f]="$";for(var g=f+1,h=f+e.length;h>g;g++)d[g]="",a[g]="$";a=a.join(""),c.push({index:f,apply:b.apply})}}),{regex:new RegExp("^"+d.join("")+"$"),map:b(c,"index")}}function d(a,b,c){return 1===b&&c>28?29===c&&(a%4===0&&a%100!==0||a%400===0):3===b||5===b||8===b||10===b?31>c:!0}this.parsers={};var e={yyyy:{regex:"\\d{4}",apply:function(a){this.year=+a}},yy:{regex:"\\d{2}",apply:function(a){this.year=+a+2e3}},y:{regex:"\\d{1,4}",apply:function(a){this.year=+a}},MMMM:{regex:a.DATETIME_FORMATS.MONTH.join("|"),apply:function(b){this.month=a.DATETIME_FORMATS.MONTH.indexOf(b)}},MMM:{regex:a.DATETIME_FORMATS.SHORTMONTH.join("|"),apply:function(b){this.month=a.DATETIME_FORMATS.SHORTMONTH.indexOf(b)}},MM:{regex:"0[1-9]|1[0-2]",apply:function(a){this.month=a-1}},M:{regex:"[1-9]|1[0-2]",apply:function(a){this.month=a-1}},dd:{regex:"[0-2][0-9]{1}|3[0-1]{1}",apply:function(a){this.date=+a}},d:{regex:"[1-2]?[0-9]{1}|3[0-1]{1}",apply:function(a){this.date=+a}},EEEE:{regex:a.DATETIME_FORMATS.DAY.join("|")},EEE:{regex:a.DATETIME_FORMATS.SHORTDAY.join("|")}};this.parse=function(b,e){if(!angular.isString(b)||!e)return b;e=a.DATETIME_FORMATS[e]||e,this.parsers[e]||(this.parsers[e]=c(e));var f=this.parsers[e],g=f.regex,h=f.map,i=b.match(g);if(i&&i.length){for(var j,k={year:1900,month:0,date:1,hours:0},l=1,m=i.length;m>l;l++){var n=h[l-1];n.apply&&n.apply.call(k,i[l])}return d(k.year,k.month,k.date)&&(j=new Date(k.year,k.month,k.date,k.hours)),j}}}]),angular.module("ui.bootstrap.position",[]).factory("$position",["$document","$window",function(a,b){function c(a,c){return a.currentStyle?a.currentStyle[c]:b.getComputedStyle?b.getComputedStyle(a)[c]:a.style[c]}function d(a){return"static"===(c(a,"position")||"static")}var e=function(b){for(var c=a[0],e=b.offsetParent||c;e&&e!==c&&d(e);)e=e.offsetParent;return e||c};return{position:function(b){var c=this.offset(b),d={top:0,left:0},f=e(b[0]);f!=a[0]&&(d=this.offset(angular.element(f)),d.top+=f.clientTop-f.scrollTop,d.left+=f.clientLeft-f.scrollLeft);var g=b[0].getBoundingClientRect();return{width:g.width||b.prop("offsetWidth"),height:g.height||b.prop("offsetHeight"),top:c.top-d.top,left:c.left-d.left}},offset:function(c){var d=c[0].getBoundingClientRect();return{width:d.width||c.prop("offsetWidth"),height:d.height||c.prop("offsetHeight"),top:d.top+(b.pageYOffset||a[0].documentElement.scrollTop),left:d.left+(b.pageXOffset||a[0].documentElement.scrollLeft)}},positionElements:function(a,b,c,d){var e,f,g,h,i=c.split("-"),j=i[0],k=i[1]||"center";e=d?this.offset(a):this.position(a),f=b.prop("offsetWidth"),g=b.prop("offsetHeight");var l={center:function(){return e.left+e.width/2-f/2},left:function(){return e.left},right:function(){return e.left+e.width}},m={center:function(){return e.top+e.height/2-g/2},top:function(){return e.top},bottom:function(){return e.top+e.height}};switch(j){case"right":h={top:m[k](),left:l[j]()};break;case"left":h={top:m[k](),left:e.left-f};break;case"bottom":h={top:m[j](),left:l[k]()};break;default:h={top:e.top-g,left:l[k]()}}return h}}}]),angular.module("ui.bootstrap.datepicker",["ui.bootstrap.dateparser","ui.bootstrap.position"]).constant("datepickerConfig",{formatDay:"dd",formatMonth:"MMMM",formatYear:"yyyy",formatDayHeader:"EEE",formatDayTitle:"MMMM yyyy",formatMonthTitle:"yyyy",datepickerMode:"day",minMode:"day",maxMode:"year",showWeeks:!0,startingDay:0,yearRange:20,minDate:null,maxDate:null}).controller("DatepickerController",["$scope","$attrs","$parse","$interpolate","$timeout","$log","dateFilter","datepickerConfig",function(a,b,c,d,e,f,g,h){var i=this,j={$setViewValue:angular.noop};this.modes=["day","month","year"],angular.forEach(["formatDay","formatMonth","formatYear","formatDayHeader","formatDayTitle","formatMonthTitle","minMode","maxMode","showWeeks","startingDay","yearRange"],function(c,e){i[c]=angular.isDefined(b[c])?8>e?d(b[c])(a.$parent):a.$parent.$eval(b[c]):h[c]}),angular.forEach(["minDate","maxDate"],function(d){b[d]?a.$parent.$watch(c(b[d]),function(a){i[d]=a?new Date(a):null,i.refreshView()}):i[d]=h[d]?new Date(h[d]):null}),a.datepickerMode=a.datepickerMode||h.datepickerMode,a.uniqueId="datepicker-"+a.$id+"-"+Math.floor(1e4*Math.random()),this.activeDate=angular.isDefined(b.initDate)?a.$parent.$eval(b.initDate):new Date,a.isActive=function(b){return 0===i.compare(b.date,i.activeDate)?(a.activeDateId=b.uid,!0):!1},this.init=function(a){j=a,j.$render=function(){i.render()}},this.render=function(){if(j.$modelValue){var a=new Date(j.$modelValue),b=!isNaN(a);b?this.activeDate=a:f.error('Datepicker directive: "ng-model" value must be a Date object, a number of milliseconds since 01.01.1970 or a string representing an RFC2822 or ISO 8601 date.'),j.$setValidity("date",b)}this.refreshView()},this.refreshView=function(){if(this.element){this._refreshView();var a=j.$modelValue?new Date(j.$modelValue):null;j.$setValidity("date-disabled",!a||this.element&&!this.isDisabled(a))}},this.createDateObject=function(a,b){var c=j.$modelValue?new Date(j.$modelValue):null;return{date:a,label:g(a,b),selected:c&&0===this.compare(a,c),disabled:this.isDisabled(a),current:0===this.compare(a,new Date)}},this.isDisabled=function(c){return this.minDate&&this.compare(c,this.minDate)<0||this.maxDate&&this.compare(c,this.maxDate)>0||b.dateDisabled&&a.dateDisabled({date:c,mode:a.datepickerMode})},this.split=function(a,b){for(var c=[];a.length>0;)c.push(a.splice(0,b));return c},a.select=function(b){if(a.datepickerMode===i.minMode){var c=j.$modelValue?new Date(j.$modelValue):new Date(0,0,0,0,0,0,0);c.setFullYear(b.getFullYear(),b.getMonth(),b.getDate()),j.$setViewValue(c),j.$render()}else i.activeDate=b,a.datepickerMode=i.modes[i.modes.indexOf(a.datepickerMode)-1]},a.move=function(a){var b=i.activeDate.getFullYear()+a*(i.step.years||0),c=i.activeDate.getMonth()+a*(i.step.months||0);i.activeDate.setFullYear(b,c,1),i.refreshView()},a.toggleMode=function(b){b=b||1,a.datepickerMode===i.maxMode&&1===b||a.datepickerMode===i.minMode&&-1===b||(a.datepickerMode=i.modes[i.modes.indexOf(a.datepickerMode)+b])},a.keys={13:"enter",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down"};var k=function(){e(function(){i.element[0].focus()},0,!1)};a.$on("datepicker.focus",k),a.keydown=function(b){var c=a.keys[b.which];if(c&&!b.shiftKey&&!b.altKey)if(b.preventDefault(),b.stopPropagation(),"enter"===c||"space"===c){if(i.isDisabled(i.activeDate))return;a.select(i.activeDate),k()}else!b.ctrlKey||"up"!==c&&"down"!==c?(i.handleKeyDown(c,b),i.refreshView()):(a.toggleMode("up"===c?1:-1),k())}}]).directive("datepicker",function(){return{restrict:"EA",replace:!0,templateUrl:"template/datepicker/datepicker.html",scope:{datepickerMode:"=?",dateDisabled:"&"},require:["datepicker","?^ngModel"],controller:"DatepickerController",link:function(a,b,c,d){var e=d[0],f=d[1];f&&e.init(f)}}}).directive("daypicker",["dateFilter",function(a){return{restrict:"EA",replace:!0,templateUrl:"template/datepicker/day.html",require:"^datepicker",link:function(b,c,d,e){function f(a,b){return 1!==b||a%4!==0||a%100===0&&a%400!==0?i[b]:29}function g(a,b){var c=new Array(b),d=new Date(a),e=0;for(d.setHours(12);b>e;)c[e++]=new Date(d),d.setDate(d.getDate()+1);return c}function h(a){var b=new Date(a);b.setDate(b.getDate()+4-(b.getDay()||7));var c=b.getTime();return b.setMonth(0),b.setDate(1),Math.floor(Math.round((c-b)/864e5)/7)+1}b.showWeeks=e.showWeeks,e.step={months:1},e.element=c;var i=[31,28,31,30,31,30,31,31,30,31,30,31];e._refreshView=function(){var c=e.activeDate.getFullYear(),d=e.activeDate.getMonth(),f=new Date(c,d,1),i=e.startingDay-f.getDay(),j=i>0?7-i:-i,k=new Date(f);j>0&&k.setDate(-j+1);for(var l=g(k,42),m=0;42>m;m++)l[m]=angular.extend(e.createDateObject(l[m],e.formatDay),{secondary:l[m].getMonth()!==d,uid:b.uniqueId+"-"+m});b.labels=new Array(7);for(var n=0;7>n;n++)b.labels[n]={abbr:a(l[n].date,e.formatDayHeader),full:a(l[n].date,"EEEE")};if(b.title=a(e.activeDate,e.formatDayTitle),b.rows=e.split(l,7),b.showWeeks){b.weekNumbers=[];for(var o=h(b.rows[0][0].date),p=b.rows.length;b.weekNumbers.push(o++)<p;);}},e.compare=function(a,b){return new Date(a.getFullYear(),a.getMonth(),a.getDate())-new Date(b.getFullYear(),b.getMonth(),b.getDate())},e.handleKeyDown=function(a,b){var c=e.activeDate.getDate();if("left"===a)c-=1;else if("up"===a)c-=7;else if("right"===a)c+=1;else if("down"===a)c+=7;else if("pageup"===a||"pagedown"===a){var d=e.activeDate.getMonth()+("pageup"===a?-1:1);e.activeDate.setMonth(d,1),c=Math.min(f(e.activeDate.getFullYear(),e.activeDate.getMonth()),c)}else"home"===a?c=1:"end"===a&&(c=f(e.activeDate.getFullYear(),e.activeDate.getMonth()));e.activeDate.setDate(c)},e.refreshView()}}}]).directive("monthpicker",["dateFilter",function(a){return{restrict:"EA",replace:!0,templateUrl:"template/datepicker/month.html",require:"^datepicker",link:function(b,c,d,e){e.step={years:1},e.element=c,e._refreshView=function(){for(var c=new Array(12),d=e.activeDate.getFullYear(),f=0;12>f;f++)c[f]=angular.extend(e.createDateObject(new Date(d,f,1),e.formatMonth),{uid:b.uniqueId+"-"+f});b.title=a(e.activeDate,e.formatMonthTitle),b.rows=e.split(c,3)},e.compare=function(a,b){return new Date(a.getFullYear(),a.getMonth())-new Date(b.getFullYear(),b.getMonth())},e.handleKeyDown=function(a,b){var c=e.activeDate.getMonth();if("left"===a)c-=1;else if("up"===a)c-=3;else if("right"===a)c+=1;else if("down"===a)c+=3;else if("pageup"===a||"pagedown"===a){var d=e.activeDate.getFullYear()+("pageup"===a?-1:1);e.activeDate.setFullYear(d)}else"home"===a?c=0:"end"===a&&(c=11);e.activeDate.setMonth(c)},e.refreshView()}}}]).directive("yearpicker",["dateFilter",function(a){return{restrict:"EA",replace:!0,templateUrl:"template/datepicker/year.html",require:"^datepicker",link:function(a,b,c,d){function e(a){return parseInt((a-1)/f,10)*f+1}var f=d.yearRange;d.step={years:f},d.element=b,d._refreshView=function(){for(var b=new Array(f),c=0,g=e(d.activeDate.getFullYear());f>c;c++)b[c]=angular.extend(d.createDateObject(new Date(g+c,0,1),d.formatYear),{uid:a.uniqueId+"-"+c});a.title=[b[0].label,b[f-1].label].join(" - "),a.rows=d.split(b,5)},d.compare=function(a,b){return a.getFullYear()-b.getFullYear()},d.handleKeyDown=function(a,b){var c=d.activeDate.getFullYear();"left"===a?c-=1:"up"===a?c-=5:"right"===a?c+=1:"down"===a?c+=5:"pageup"===a||"pagedown"===a?c+=("pageup"===a?-1:1)*d.step.years:"home"===a?c=e(d.activeDate.getFullYear()):"end"===a&&(c=e(d.activeDate.getFullYear())+f-1),d.activeDate.setFullYear(c)},d.refreshView()}}}]).constant("datepickerPopupConfig",{
datepickerPopup:"yyyy-MM-dd",currentText:"Today",clearText:"Clear",closeText:"Done",closeOnDateSelection:!0,appendToBody:!1,showButtonBar:!0}).directive("datepickerPopup",["$compile","$parse","$document","$position","dateFilter","dateParser","datepickerPopupConfig",function(a,b,c,d,e,f,g){return{restrict:"EA",require:"ngModel",scope:{isOpen:"=?",currentText:"@",clearText:"@",closeText:"@",dateDisabled:"&"},link:function(h,i,j,k){function l(a){return a.replace(/([A-Z])/g,function(a){return"-"+a.toLowerCase()})}function m(a){if(a){if(angular.isDate(a)&&!isNaN(a))return k.$setValidity("date",!0),a;if(angular.isString(a)){var b=f.parse(a,n)||new Date(a);return isNaN(b)?void k.$setValidity("date",!1):(k.$setValidity("date",!0),b)}return void k.$setValidity("date",!1)}return k.$setValidity("date",!0),null}var n,o=angular.isDefined(j.closeOnDateSelection)?h.$parent.$eval(j.closeOnDateSelection):g.closeOnDateSelection,p=angular.isDefined(j.datepickerAppendToBody)?h.$parent.$eval(j.datepickerAppendToBody):g.appendToBody;h.showButtonBar=angular.isDefined(j.showButtonBar)?h.$parent.$eval(j.showButtonBar):g.showButtonBar,h.getText=function(a){return h[a+"Text"]||g[a+"Text"]},j.$observe("datepickerPopup",function(a){n=a||g.datepickerPopup,k.$render()});var q=angular.element("<div datepicker-popup-wrap><div datepicker></div></div>");q.attr({"ng-model":"date","ng-change":"dateSelection()"});var r=angular.element(q.children()[0]);j.datepickerOptions&&angular.forEach(h.$parent.$eval(j.datepickerOptions),function(a,b){r.attr(l(b),a)}),h.watchData={},angular.forEach(["minDate","maxDate","datepickerMode"],function(a){if(j[a]){var c=b(j[a]);if(h.$parent.$watch(c,function(b){h.watchData[a]=b}),r.attr(l(a),"watchData."+a),"datepickerMode"===a){var d=c.assign;h.$watch("watchData."+a,function(a,b){a!==b&&d(h.$parent,a)})}}}),j.dateDisabled&&r.attr("date-disabled","dateDisabled({ date: date, mode: mode })"),k.$parsers.unshift(m),h.dateSelection=function(a){angular.isDefined(a)&&(h.date=a),k.$setViewValue(h.date),k.$render(),o&&(h.isOpen=!1,i[0].focus())},i.bind("input change keyup",function(){h.$apply(function(){h.date=k.$modelValue})}),k.$render=function(){var a=k.$viewValue?e(k.$viewValue,n):"";i.val(a),h.date=m(k.$modelValue)};var s=function(a){h.isOpen&&a.target!==i[0]&&h.$apply(function(){h.isOpen=!1})},t=function(a,b){h.keydown(a)};i.bind("keydown",t),h.keydown=function(a){27===a.which?(a.preventDefault(),a.stopPropagation(),h.close()):40!==a.which||h.isOpen||(h.isOpen=!0)},h.$watch("isOpen",function(a){a?(h.$broadcast("datepicker.focus"),h.position=p?d.offset(i):d.position(i),h.position.top=h.position.top+i.prop("offsetHeight"),c.bind("click",s)):c.unbind("click",s)}),h.select=function(a){if("today"===a){var b=new Date;angular.isDate(k.$modelValue)?(a=new Date(k.$modelValue),a.setFullYear(b.getFullYear(),b.getMonth(),b.getDate())):a=new Date(b.setHours(0,0,0,0))}h.dateSelection(a)},h.close=function(){h.isOpen=!1,i[0].focus()};var u=a(q)(h);q.remove(),p?c.find("body").append(u):i.after(u),h.$on("$destroy",function(){u.remove(),i.unbind("keydown",t),c.unbind("click",s)})}}}]).directive("datepickerPopupWrap",function(){return{restrict:"EA",replace:!0,transclude:!0,templateUrl:"template/datepicker/popup.html",link:function(a,b,c){b.bind("click",function(a){a.preventDefault(),a.stopPropagation()})}}}),angular.module("ui.bootstrap.dropdown",[]).constant("dropdownConfig",{openClass:"open"}).service("dropdownService",["$document",function(a){var b=null;this.open=function(e){b||(a.bind("click",c),a.bind("keydown",d)),b&&b!==e&&(b.isOpen=!1),b=e},this.close=function(e){b===e&&(b=null,a.unbind("click",c),a.unbind("keydown",d))};var c=function(a){if(b){var c=b.getToggleElement();a&&c&&c[0].contains(a.target)||b.$apply(function(){b.isOpen=!1})}},d=function(a){27===a.which&&(b.focusToggleElement(),c())}}]).controller("DropdownController",["$scope","$attrs","$parse","dropdownConfig","dropdownService","$animate",function(a,b,c,d,e,f){var g,h=this,i=a.$new(),j=d.openClass,k=angular.noop,l=b.onToggle?c(b.onToggle):angular.noop;this.init=function(d){h.$element=d,b.isOpen&&(g=c(b.isOpen),k=g.assign,a.$watch(g,function(a){i.isOpen=!!a}))},this.toggle=function(a){return i.isOpen=arguments.length?!!a:!i.isOpen},this.isOpen=function(){return i.isOpen},i.getToggleElement=function(){return h.toggleElement},i.focusToggleElement=function(){h.toggleElement&&h.toggleElement[0].focus()},i.$watch("isOpen",function(b,c){f[b?"addClass":"removeClass"](h.$element,j),b?(i.focusToggleElement(),e.open(i)):e.close(i),k(a,b),angular.isDefined(b)&&b!==c&&l(a,{open:!!b})}),a.$on("$locationChangeSuccess",function(){i.isOpen=!1}),a.$on("$destroy",function(){i.$destroy()})}]).directive("dropdown",function(){return{controller:"DropdownController",link:function(a,b,c,d){d.init(b)}}}).directive("dropdownToggle",function(){return{require:"?^dropdown",link:function(a,b,c,d){if(d){d.toggleElement=b;var e=function(e){e.preventDefault(),b.hasClass("disabled")||c.disabled||a.$apply(function(){d.toggle()})};b.bind("click",e),b.attr({"aria-haspopup":!0,"aria-expanded":!1}),a.$watch(d.isOpen,function(a){b.attr("aria-expanded",!!a)}),a.$on("$destroy",function(){b.unbind("click",e)})}}}}),angular.module("ui.bootstrap.modal",["ui.bootstrap.transition"]).factory("$$stackedMap",function(){return{createNew:function(){var a=[];return{add:function(b,c){a.push({key:b,value:c})},get:function(b){for(var c=0;c<a.length;c++)if(b==a[c].key)return a[c]},keys:function(){for(var b=[],c=0;c<a.length;c++)b.push(a[c].key);return b},top:function(){return a[a.length-1]},remove:function(b){for(var c=-1,d=0;d<a.length;d++)if(b==a[d].key){c=d;break}return a.splice(c,1)[0]},removeTop:function(){return a.splice(a.length-1,1)[0]},length:function(){return a.length}}}}}).directive("modalBackdrop",["$timeout",function(a){return{restrict:"EA",replace:!0,templateUrl:"template/modal/backdrop.html",link:function(b,c,d){b.backdropClass=d.backdropClass||"",b.animate=!1,a(function(){b.animate=!0})}}}]).directive("modalWindow",["$modalStack","$timeout",function(a,b){return{restrict:"EA",scope:{index:"@",animate:"="},replace:!0,transclude:!0,templateUrl:function(a,b){return b.templateUrl||"template/modal/window.html"},link:function(c,d,e){d.addClass(e.windowClass||""),c.size=e.size,b(function(){c.animate=!0,d[0].querySelectorAll("[autofocus]").length||d[0].focus()}),c.close=function(b){var c=a.getTop();c&&c.value.backdrop&&"static"!=c.value.backdrop&&b.target===b.currentTarget&&(b.preventDefault(),b.stopPropagation(),a.dismiss(c.key,"backdrop click"))}}}}]).directive("modalTransclude",function(){return{link:function(a,b,c,d,e){e(a.$parent,function(a){b.empty(),b.append(a)})}}}).factory("$modalStack",["$transition","$timeout","$document","$compile","$rootScope","$$stackedMap",function(a,b,c,d,e,f){function g(){for(var a=-1,b=n.keys(),c=0;c<b.length;c++)n.get(b[c]).value.backdrop&&(a=c);return a}function h(a){var b=c.find("body").eq(0),d=n.get(a).value;n.remove(a),j(d.modalDomEl,d.modalScope,300,function(){d.modalScope.$destroy(),b.toggleClass(m,n.length()>0),i()})}function i(){if(k&&-1==g()){var a=l;j(k,l,150,function(){a.$destroy(),a=null}),k=void 0,l=void 0}}function j(c,d,e,f){function g(){g.done||(g.done=!0,c.remove(),f&&f())}d.animate=!1;var h=a.transitionEndEventName;if(h){var i=b(g,e);c.bind(h,function(){b.cancel(i),g(),d.$apply()})}else b(g)}var k,l,m="modal-open",n=f.createNew(),o={};return e.$watch(g,function(a){l&&(l.index=a)}),c.bind("keydown",function(a){var b;27===a.which&&(b=n.top(),b&&b.value.keyboard&&(a.preventDefault(),e.$apply(function(){o.dismiss(b.key,"escape key press")})))}),o.open=function(a,b){n.add(a,{deferred:b.deferred,modalScope:b.scope,backdrop:b.backdrop,keyboard:b.keyboard});var f=c.find("body").eq(0),h=g();if(h>=0&&!k){l=e.$new(!0),l.index=h;var i=angular.element("<div modal-backdrop></div>");i.attr("backdrop-class",b.backdropClass),k=d(i)(l),f.append(k)}var j=angular.element("<div modal-window></div>");j.attr({"template-url":b.windowTemplateUrl,"window-class":b.windowClass,size:b.size,index:n.length()-1,animate:"animate"}).html(b.content);var o=d(j)(b.scope);n.top().value.modalDomEl=o,f.append(o),f.addClass(m)},o.close=function(a,b){var c=n.get(a);c&&(c.value.deferred.resolve(b),h(a))},o.dismiss=function(a,b){var c=n.get(a);c&&(c.value.deferred.reject(b),h(a))},o.dismissAll=function(a){for(var b=this.getTop();b;)this.dismiss(b.key,a),b=this.getTop()},o.getTop=function(){return n.top()},o}]).provider("$modal",function(){var a={options:{backdrop:!0,keyboard:!0},$get:["$injector","$rootScope","$q","$http","$templateCache","$controller","$modalStack",function(b,c,d,e,f,g,h){function i(a){return a.template?d.when(a.template):e.get(angular.isFunction(a.templateUrl)?a.templateUrl():a.templateUrl,{cache:f}).then(function(a){return a.data})}function j(a){var c=[];return angular.forEach(a,function(a){(angular.isFunction(a)||angular.isArray(a))&&c.push(d.when(b.invoke(a)))}),c}var k={};return k.open=function(b){var e=d.defer(),f=d.defer(),k={result:e.promise,opened:f.promise,close:function(a){h.close(k,a)},dismiss:function(a){h.dismiss(k,a)}};if(b=angular.extend({},a.options,b),b.resolve=b.resolve||{},!b.template&&!b.templateUrl)throw new Error("One of template or templateUrl options is required.");var l=d.all([i(b)].concat(j(b.resolve)));return l.then(function(a){var d=(b.scope||c).$new();d.$close=k.close,d.$dismiss=k.dismiss;var f,i={},j=1;b.controller&&(i.$scope=d,i.$modalInstance=k,angular.forEach(b.resolve,function(b,c){i[c]=a[j++]}),f=g(b.controller,i),b.controllerAs&&(d[b.controllerAs]=f)),h.open(k,{scope:d,deferred:e,content:a[0],backdrop:b.backdrop,keyboard:b.keyboard,backdropClass:b.backdropClass,windowClass:b.windowClass,windowTemplateUrl:b.windowTemplateUrl,size:b.size})},function(a){e.reject(a)}),l.then(function(){f.resolve(!0)},function(){f.reject(!1)}),k},k}]};return a}),angular.module("ui.bootstrap.pagination",[]).controller("PaginationController",["$scope","$attrs","$parse",function(a,b,c){var d=this,e={$setViewValue:angular.noop},f=b.numPages?c(b.numPages).assign:angular.noop;this.init=function(f,g){e=f,this.config=g,e.$render=function(){d.render()},b.itemsPerPage?a.$parent.$watch(c(b.itemsPerPage),function(b){d.itemsPerPage=parseInt(b,10),a.totalPages=d.calculateTotalPages()}):this.itemsPerPage=g.itemsPerPage},this.calculateTotalPages=function(){var b=this.itemsPerPage<1?1:Math.ceil(a.totalItems/this.itemsPerPage);return Math.max(b||0,1)},this.render=function(){a.page=parseInt(e.$viewValue,10)||1},a.selectPage=function(b){a.page!==b&&b>0&&b<=a.totalPages&&(e.$setViewValue(b),e.$render())},a.getText=function(b){return a[b+"Text"]||d.config[b+"Text"]},a.noPrevious=function(){return 1===a.page},a.noNext=function(){return a.page===a.totalPages},a.$watch("totalItems",function(){a.totalPages=d.calculateTotalPages()}),a.$watch("totalPages",function(b){f(a.$parent,b),a.page>b?a.selectPage(b):e.$render()})}]).constant("paginationConfig",{itemsPerPage:10,boundaryLinks:!1,directionLinks:!0,firstText:"First",previousText:"Previous",nextText:"Next",lastText:"Last",rotate:!0}).directive("pagination",["$parse","paginationConfig",function(a,b){return{restrict:"EA",scope:{totalItems:"=",firstText:"@",previousText:"@",nextText:"@",lastText:"@"},require:["pagination","?ngModel"],controller:"PaginationController",templateUrl:"template/pagination/pagination.html",replace:!0,link:function(c,d,e,f){function g(a,b,c){return{number:a,text:b,active:c}}function h(a,b){var c=[],d=1,e=b,f=angular.isDefined(k)&&b>k;f&&(l?(d=Math.max(a-Math.floor(k/2),1),e=d+k-1,e>b&&(e=b,d=e-k+1)):(d=(Math.ceil(a/k)-1)*k+1,e=Math.min(d+k-1,b)));for(var h=d;e>=h;h++){var i=g(h,h,h===a);c.push(i)}if(f&&!l){if(d>1){var j=g(d-1,"...",!1);c.unshift(j)}if(b>e){var m=g(e+1,"...",!1);c.push(m)}}return c}var i=f[0],j=f[1];if(j){var k=angular.isDefined(e.maxSize)?c.$parent.$eval(e.maxSize):b.maxSize,l=angular.isDefined(e.rotate)?c.$parent.$eval(e.rotate):b.rotate;c.boundaryLinks=angular.isDefined(e.boundaryLinks)?c.$parent.$eval(e.boundaryLinks):b.boundaryLinks,c.directionLinks=angular.isDefined(e.directionLinks)?c.$parent.$eval(e.directionLinks):b.directionLinks,i.init(j,b),e.maxSize&&c.$parent.$watch(a(e.maxSize),function(a){k=parseInt(a,10),i.render()});var m=i.render;i.render=function(){m(),c.page>0&&c.page<=c.totalPages&&(c.pages=h(c.page,c.totalPages))}}}}}]).constant("pagerConfig",{itemsPerPage:10,previousText:"« Previous",nextText:"Next »",align:!0}).directive("pager",["pagerConfig",function(a){return{restrict:"EA",scope:{totalItems:"=",previousText:"@",nextText:"@"},require:["pager","?ngModel"],controller:"PaginationController",templateUrl:"template/pagination/pager.html",replace:!0,link:function(b,c,d,e){var f=e[0],g=e[1];g&&(b.align=angular.isDefined(d.align)?b.$parent.$eval(d.align):a.align,f.init(g,a))}}}]),angular.module("ui.bootstrap.tooltip",["ui.bootstrap.position","ui.bootstrap.bindHtml"]).provider("$tooltip",function(){function a(a){var b=/[A-Z]/g,c="-";return a.replace(b,function(a,b){return(b?c:"")+a.toLowerCase()})}var b={placement:"top",animation:!0,popupDelay:0},c={mouseenter:"mouseleave",click:"click",focus:"blur"},d={};this.options=function(a){angular.extend(d,a)},this.setTriggers=function(a){angular.extend(c,a)},this.$get=["$window","$compile","$timeout","$document","$position","$interpolate",function(e,f,g,h,i,j){return function(e,k,l){function m(a){var b=a||n.trigger||l,d=c[b]||b;return{show:b,hide:d}}var n=angular.extend({},b,d),o=a(e),p=j.startSymbol(),q=j.endSymbol(),r="<div "+o+'-popup title="'+p+"title"+q+'" content="'+p+"content"+q+'" placement="'+p+"placement"+q+'" animation="animation" is-open="isOpen"></div>';return{restrict:"EA",compile:function(a,b){var c=f(r);return function(a,b,d){function f(){D.isOpen?l():j()}function j(){C&&!a.$eval(d[k+"Enable"])||(s(),D.popupDelay?z||(z=g(o,D.popupDelay,!1),z.then(function(a){a()})):o()())}function l(){a.$apply(function(){p()})}function o(){return z=null,y&&(g.cancel(y),y=null),D.content?(q(),w.css({top:0,left:0,display:"block"}),D.$digest(),E(),D.isOpen=!0,D.$digest(),E):angular.noop}function p(){D.isOpen=!1,g.cancel(z),z=null,D.animation?y||(y=g(r,500)):r()}function q(){w&&r(),x=D.$new(),w=c(x,function(a){A?h.find("body").append(a):b.after(a)})}function r(){y=null,w&&(w.remove(),w=null),x&&(x.$destroy(),x=null)}function s(){t(),u()}function t(){var a=d[k+"Placement"];D.placement=angular.isDefined(a)?a:n.placement}function u(){var a=d[k+"PopupDelay"],b=parseInt(a,10);D.popupDelay=isNaN(b)?n.popupDelay:b}function v(){var a=d[k+"Trigger"];F(),B=m(a),B.show===B.hide?b.bind(B.show,f):(b.bind(B.show,j),b.bind(B.hide,l))}var w,x,y,z,A=angular.isDefined(n.appendToBody)?n.appendToBody:!1,B=m(void 0),C=angular.isDefined(d[k+"Enable"]),D=a.$new(!0),E=function(){var a=i.positionElements(b,w,D.placement,A);a.top+="px",a.left+="px",w.css(a)};D.isOpen=!1,d.$observe(e,function(a){D.content=a,!a&&D.isOpen&&p()}),d.$observe(k+"Title",function(a){D.title=a});var F=function(){b.unbind(B.show,j),b.unbind(B.hide,l)};v();var G=a.$eval(d[k+"Animation"]);D.animation=angular.isDefined(G)?!!G:n.animation;var H=a.$eval(d[k+"AppendToBody"]);A=angular.isDefined(H)?H:A,A&&a.$on("$locationChangeSuccess",function(){D.isOpen&&p()}),a.$on("$destroy",function(){g.cancel(y),g.cancel(z),F(),r(),D=null})}}}}}]}).directive("tooltipPopup",function(){return{restrict:"EA",replace:!0,scope:{content:"@",placement:"@",animation:"&",isOpen:"&"},templateUrl:"template/tooltip/tooltip-popup.html"}}).directive("tooltip",["$tooltip",function(a){return a("tooltip","tooltip","mouseenter")}]).directive("tooltipHtmlUnsafePopup",function(){return{restrict:"EA",replace:!0,scope:{content:"@",placement:"@",animation:"&",isOpen:"&"},templateUrl:"template/tooltip/tooltip-html-unsafe-popup.html"}}).directive("tooltipHtmlUnsafe",["$tooltip",function(a){return a("tooltipHtmlUnsafe","tooltip","mouseenter")}]),angular.module("ui.bootstrap.popover",["ui.bootstrap.tooltip"]).directive("popoverPopup",function(){return{restrict:"EA",replace:!0,scope:{title:"@",content:"@",placement:"@",animation:"&",isOpen:"&"},templateUrl:"template/popover/popover.html"}}).directive("popover",["$tooltip",function(a){return a("popover","popover","click")}]),angular.module("ui.bootstrap.progressbar",[]).constant("progressConfig",{animate:!0,max:100}).controller("ProgressController",["$scope","$attrs","progressConfig",function(a,b,c){var d=this,e=angular.isDefined(b.animate)?a.$parent.$eval(b.animate):c.animate;this.bars=[],a.max=angular.isDefined(b.max)?a.$parent.$eval(b.max):c.max,this.addBar=function(b,c){e||c.css({transition:"none"}),this.bars.push(b),b.$watch("value",function(c){b.percent=+(100*c/a.max).toFixed(2)}),b.$on("$destroy",function(){c=null,d.removeBar(b)})},this.removeBar=function(a){this.bars.splice(this.bars.indexOf(a),1)}}]).directive("progress",function(){return{restrict:"EA",replace:!0,transclude:!0,controller:"ProgressController",require:"progress",scope:{},templateUrl:"template/progressbar/progress.html"}}).directive("bar",function(){return{restrict:"EA",replace:!0,transclude:!0,require:"^progress",scope:{value:"=",type:"@"},templateUrl:"template/progressbar/bar.html",link:function(a,b,c,d){d.addBar(a,b)}}}).directive("progressbar",function(){return{restrict:"EA",replace:!0,transclude:!0,controller:"ProgressController",scope:{value:"=",type:"@"},templateUrl:"template/progressbar/progressbar.html",link:function(a,b,c,d){d.addBar(a,angular.element(b.children()[0]))}}}),angular.module("ui.bootstrap.rating",[]).constant("ratingConfig",{max:5,stateOn:null,stateOff:null}).controller("RatingController",["$scope","$attrs","ratingConfig",function(a,b,c){var d={$setViewValue:angular.noop};this.init=function(e){d=e,d.$render=this.render,this.stateOn=angular.isDefined(b.stateOn)?a.$parent.$eval(b.stateOn):c.stateOn,this.stateOff=angular.isDefined(b.stateOff)?a.$parent.$eval(b.stateOff):c.stateOff;var f=angular.isDefined(b.ratingStates)?a.$parent.$eval(b.ratingStates):new Array(angular.isDefined(b.max)?a.$parent.$eval(b.max):c.max);a.range=this.buildTemplateObjects(f)},this.buildTemplateObjects=function(a){for(var b=0,c=a.length;c>b;b++)a[b]=angular.extend({index:b},{stateOn:this.stateOn,stateOff:this.stateOff},a[b]);return a},a.rate=function(b){!a.readonly&&b>=0&&b<=a.range.length&&(d.$setViewValue(b),d.$render())},a.enter=function(b){a.readonly||(a.value=b),a.onHover({value:b})},a.reset=function(){a.value=d.$viewValue,a.onLeave()},a.onKeydown=function(b){/(37|38|39|40)/.test(b.which)&&(b.preventDefault(),b.stopPropagation(),a.rate(a.value+(38===b.which||39===b.which?1:-1)))},this.render=function(){a.value=d.$viewValue}}]).directive("rating",function(){return{restrict:"EA",require:["rating","ngModel"],scope:{readonly:"=?",onHover:"&",onLeave:"&"},controller:"RatingController",templateUrl:"template/rating/rating.html",replace:!0,link:function(a,b,c,d){var e=d[0],f=d[1];f&&e.init(f)}}}),angular.module("ui.bootstrap.tabs",[]).controller("TabsetController",["$scope",function(a){var b=this,c=b.tabs=a.tabs=[];b.select=function(a){angular.forEach(c,function(b){b.active&&b!==a&&(b.active=!1,b.onDeselect())}),a.active=!0,a.onSelect()},b.addTab=function(a){c.push(a),1===c.length?a.active=!0:a.active&&b.select(a)},b.removeTab=function(a){var e=c.indexOf(a);if(a.active&&c.length>1&&!d){var f=e==c.length-1?e-1:e+1;b.select(c[f])}c.splice(e,1)};var d;a.$on("$destroy",function(){d=!0})}]).directive("tabset",function(){return{restrict:"EA",transclude:!0,replace:!0,scope:{type:"@"},controller:"TabsetController",templateUrl:"template/tabs/tabset.html",link:function(a,b,c){a.vertical=angular.isDefined(c.vertical)?a.$parent.$eval(c.vertical):!1,a.justified=angular.isDefined(c.justified)?a.$parent.$eval(c.justified):!1}}}).directive("tab",["$parse",function(a){return{require:"^tabset",restrict:"EA",replace:!0,templateUrl:"template/tabs/tab.html",transclude:!0,scope:{active:"=?",heading:"@",onSelect:"&select",onDeselect:"&deselect"},controller:function(){},compile:function(b,c,d){return function(b,c,e,f){b.$watch("active",function(a){a&&f.select(b)}),b.disabled=!1,e.disabled&&b.$parent.$watch(a(e.disabled),function(a){b.disabled=!!a}),b.select=function(){b.disabled||(b.active=!0)},f.addTab(b),b.$on("$destroy",function(){f.removeTab(b)}),b.$transcludeFn=d}}}}]).directive("tabHeadingTransclude",[function(){return{restrict:"A",require:"^tab",link:function(a,b,c,d){a.$watch("headingElement",function(a){a&&(b.html(""),b.append(a))})}}}]).directive("tabContentTransclude",function(){function a(a){return a.tagName&&(a.hasAttribute("tab-heading")||a.hasAttribute("data-tab-heading")||"tab-heading"===a.tagName.toLowerCase()||"data-tab-heading"===a.tagName.toLowerCase())}return{restrict:"A",require:"^tabset",link:function(b,c,d){var e=b.$eval(d.tabContentTransclude);e.$transcludeFn(e.$parent,function(b){angular.forEach(b,function(b){a(b)?e.headingElement=b:c.append(b)})})}}}),angular.module("ui.bootstrap.timepicker",[]).constant("timepickerConfig",{hourStep:1,minuteStep:1,showMeridian:!0,meridians:null,readonlyInput:!1,mousewheel:!0}).controller("TimepickerController",["$scope","$attrs","$parse","$log","$locale","timepickerConfig",function(a,b,c,d,e,f){function g(){var b=parseInt(a.hours,10),c=a.showMeridian?b>0&&13>b:b>=0&&24>b;return c?(a.showMeridian&&(12===b&&(b=0),a.meridian===p[1]&&(b+=12)),b):void 0}function h(){var b=parseInt(a.minutes,10);return b>=0&&60>b?b:void 0}function i(a){return angular.isDefined(a)&&a.toString().length<2?"0"+a:a}function j(a){k(),o.$setViewValue(new Date(n)),l(a)}function k(){o.$setValidity("time",!0),a.invalidHours=!1,a.invalidMinutes=!1}function l(b){var c=n.getHours(),d=n.getMinutes();a.showMeridian&&(c=0===c||12===c?12:c%12),a.hours="h"===b?c:i(c),a.minutes="m"===b?d:i(d),a.meridian=n.getHours()<12?p[0]:p[1]}function m(a){var b=new Date(n.getTime()+6e4*a);n.setHours(b.getHours(),b.getMinutes()),j()}var n=new Date,o={$setViewValue:angular.noop},p=angular.isDefined(b.meridians)?a.$parent.$eval(b.meridians):f.meridians||e.DATETIME_FORMATS.AMPMS;this.init=function(c,d){o=c,o.$render=this.render;var e=d.eq(0),g=d.eq(1),h=angular.isDefined(b.mousewheel)?a.$parent.$eval(b.mousewheel):f.mousewheel;h&&this.setupMousewheelEvents(e,g),a.readonlyInput=angular.isDefined(b.readonlyInput)?a.$parent.$eval(b.readonlyInput):f.readonlyInput,this.setupInputEvents(e,g)};var q=f.hourStep;b.hourStep&&a.$parent.$watch(c(b.hourStep),function(a){q=parseInt(a,10)});var r=f.minuteStep;b.minuteStep&&a.$parent.$watch(c(b.minuteStep),function(a){r=parseInt(a,10)}),a.showMeridian=f.showMeridian,b.showMeridian&&a.$parent.$watch(c(b.showMeridian),function(b){if(a.showMeridian=!!b,o.$error.time){var c=g(),d=h();angular.isDefined(c)&&angular.isDefined(d)&&(n.setHours(c),j())}else l()}),this.setupMousewheelEvents=function(b,c){var d=function(a){a.originalEvent&&(a=a.originalEvent);var b=a.wheelDelta?a.wheelDelta:-a.deltaY;return a.detail||b>0};b.bind("mousewheel wheel",function(b){a.$apply(d(b)?a.incrementHours():a.decrementHours()),b.preventDefault()}),c.bind("mousewheel wheel",function(b){a.$apply(d(b)?a.incrementMinutes():a.decrementMinutes()),b.preventDefault()})},this.setupInputEvents=function(b,c){if(a.readonlyInput)return a.updateHours=angular.noop,void(a.updateMinutes=angular.noop);var d=function(b,c){o.$setViewValue(null),o.$setValidity("time",!1),angular.isDefined(b)&&(a.invalidHours=b),angular.isDefined(c)&&(a.invalidMinutes=c)};a.updateHours=function(){var a=g();angular.isDefined(a)?(n.setHours(a),j("h")):d(!0)},b.bind("blur",function(b){!a.invalidHours&&a.hours<10&&a.$apply(function(){a.hours=i(a.hours)})}),a.updateMinutes=function(){var a=h();angular.isDefined(a)?(n.setMinutes(a),j("m")):d(void 0,!0)},c.bind("blur",function(b){!a.invalidMinutes&&a.minutes<10&&a.$apply(function(){a.minutes=i(a.minutes)})})},this.render=function(){var a=o.$modelValue?new Date(o.$modelValue):null;isNaN(a)?(o.$setValidity("time",!1),d.error('Timepicker directive: "ng-model" value must be a Date object, a number of milliseconds since 01.01.1970 or a string representing an RFC2822 or ISO 8601 date.')):(a&&(n=a),k(),l())},a.incrementHours=function(){m(60*q)},a.decrementHours=function(){m(60*-q)},a.incrementMinutes=function(){m(r)},a.decrementMinutes=function(){m(-r)},a.toggleMeridian=function(){m(720*(n.getHours()<12?1:-1))}}]).directive("timepicker",function(){return{restrict:"EA",require:["timepicker","?^ngModel"],controller:"TimepickerController",replace:!0,scope:{},templateUrl:"template/timepicker/timepicker.html",link:function(a,b,c,d){var e=d[0],f=d[1];f&&e.init(f,b.find("input"))}}}),angular.module("ui.bootstrap.typeahead",["ui.bootstrap.position","ui.bootstrap.bindHtml"]).factory("typeaheadParser",["$parse",function(a){var b=/^\s*([\s\S]+?)(?:\s+as\s+([\s\S]+?))?\s+for\s+(?:([\$\w][\$\w\d]*))\s+in\s+([\s\S]+?)$/;return{parse:function(c){var d=c.match(b);if(!d)throw new Error('Expected typeahead specification in form of "_modelValue_ (as _label_)? for _item_ in _collection_" but got "'+c+'".');return{itemName:d[3],source:a(d[4]),viewMapper:a(d[2]||d[1]),modelMapper:a(d[1])}}}}]).directive("typeahead",["$compile","$parse","$q","$timeout","$document","$position","typeaheadParser",function(a,b,c,d,e,f,g){var h=[9,13,27,38,40];return{require:"ngModel",link:function(i,j,k,l){var m,n=i.$eval(k.typeaheadMinLength)||1,o=i.$eval(k.typeaheadWaitMs)||0,p=i.$eval(k.typeaheadEditable)!==!1,q=b(k.typeaheadLoading).assign||angular.noop,r=b(k.typeaheadOnSelect),s=k.typeaheadInputFormatter?b(k.typeaheadInputFormatter):void 0,t=k.typeaheadAppendToBody?i.$eval(k.typeaheadAppendToBody):!1,u=i.$eval(k.typeaheadFocusFirst)!==!1,v=b(k.ngModel).assign,w=g.parse(k.typeahead),x=i.$new();i.$on("$destroy",function(){x.$destroy()});var y="typeahead-"+x.$id+"-"+Math.floor(1e4*Math.random());j.attr({"aria-autocomplete":"list","aria-expanded":!1,"aria-owns":y});var z=angular.element("<div typeahead-popup></div>");z.attr({id:y,matches:"matches",active:"activeIdx",select:"select(activeIdx)",query:"query",position:"position"}),angular.isDefined(k.typeaheadTemplateUrl)&&z.attr("template-url",k.typeaheadTemplateUrl);var A=function(){x.matches=[],x.activeIdx=-1,j.attr("aria-expanded",!1)},B=function(a){return y+"-option-"+a};x.$watch("activeIdx",function(a){0>a?j.removeAttr("aria-activedescendant"):j.attr("aria-activedescendant",B(a))});var C=function(a){var b={$viewValue:a};q(i,!0),c.when(w.source(i,b)).then(function(c){var d=a===l.$viewValue;if(d&&m)if(c.length>0){x.activeIdx=u?0:-1,x.matches.length=0;for(var e=0;e<c.length;e++)b[w.itemName]=c[e],x.matches.push({id:B(e),label:w.viewMapper(x,b),model:c[e]});x.query=a,x.position=t?f.offset(j):f.position(j),x.position.top=x.position.top+j.prop("offsetHeight"),j.attr("aria-expanded",!0)}else A();d&&q(i,!1)},function(){A(),q(i,!1)})};A(),x.query=void 0;var D,E=function(a){D=d(function(){C(a)},o)},F=function(){D&&d.cancel(D)};l.$parsers.unshift(function(a){return m=!0,a&&a.length>=n?o>0?(F(),E(a)):C(a):(q(i,!1),F(),A()),p?a:a?void l.$setValidity("editable",!1):(l.$setValidity("editable",!0),a)}),l.$formatters.push(function(a){var b,c,d={};return s?(d.$model=a,s(i,d)):(d[w.itemName]=a,b=w.viewMapper(i,d),d[w.itemName]=void 0,c=w.viewMapper(i,d),b!==c?b:a)}),x.select=function(a){var b,c,e={};e[w.itemName]=c=x.matches[a].model,b=w.modelMapper(i,e),v(i,b),l.$setValidity("editable",!0),r(i,{$item:c,$model:b,$label:w.viewMapper(i,e)}),A(),d(function(){j[0].focus()},0,!1)},j.bind("keydown",function(a){0!==x.matches.length&&-1!==h.indexOf(a.which)&&(-1!=x.activeIdx||13!==a.which&&9!==a.which)&&(a.preventDefault(),40===a.which?(x.activeIdx=(x.activeIdx+1)%x.matches.length,x.$digest()):38===a.which?(x.activeIdx=(x.activeIdx>0?x.activeIdx:x.matches.length)-1,x.$digest()):13===a.which||9===a.which?x.$apply(function(){x.select(x.activeIdx)}):27===a.which&&(a.stopPropagation(),A(),x.$digest()))}),j.bind("blur",function(a){m=!1});var G=function(a){j[0]!==a.target&&(A(),x.$digest())};e.bind("click",G),i.$on("$destroy",function(){e.unbind("click",G),t&&H.remove()});var H=a(z)(x);t?e.find("body").append(H):j.after(H)}}}]).directive("typeaheadPopup",function(){return{restrict:"EA",scope:{matches:"=",query:"=",active:"=",position:"=",select:"&"},replace:!0,templateUrl:"template/typeahead/typeahead-popup.html",link:function(a,b,c){a.templateUrl=c.templateUrl,a.isOpen=function(){return a.matches.length>0},a.isActive=function(b){return a.active==b},a.selectActive=function(b){a.active=b},a.selectMatch=function(b){a.select({activeIdx:b})}}}}).directive("typeaheadMatch",["$http","$templateCache","$compile","$parse",function(a,b,c,d){return{restrict:"EA",scope:{index:"=",match:"=",query:"="},link:function(e,f,g){var h=d(g.templateUrl)(e.$parent)||"template/typeahead/typeahead-match.html";a.get(h,{cache:b}).success(function(a){f.replaceWith(c(a.trim())(e))})}}}]).filter("typeaheadHighlight",function(){function a(a){return a.replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")}return function(b,c){return c?(""+b).replace(new RegExp(a(c),"gi"),"<strong>$&</strong>"):b}}),angular.module("template/accordion/accordion-group.html",[]).run(["$templateCache",function(a){a.put("template/accordion/accordion-group.html",'<div class="panel panel-default">\n  <div class="panel-heading">\n    <h4 class="panel-title">\n      <a href class="accordion-toggle" ng-click="toggleOpen()" accordion-transclude="heading"><span ng-class="{\'text-muted\': isDisabled}">{{heading}}</span></a>\n    </h4>\n  </div>\n  <div class="panel-collapse" collapse="!isOpen">\n	  <div class="panel-body" ng-transclude></div>\n  </div>\n</div>\n')}]),angular.module("template/accordion/accordion.html",[]).run(["$templateCache",function(a){a.put("template/accordion/accordion.html",'<div class="panel-group" ng-transclude></div>')}]),angular.module("template/alert/alert.html",[]).run(["$templateCache",function(a){a.put("template/alert/alert.html",'<div class="alert" ng-class="[\'alert-\' + (type || \'warning\'), closeable ? \'alert-dismissable\' : null]" role="alert">\n    <button ng-show="closeable" type="button" class="close" ng-click="close()">\n        <span aria-hidden="true">&times;</span>\n        <span class="sr-only">Close</span>\n    </button>\n    <div ng-transclude></div>\n</div>\n')}]),angular.module("template/carousel/carousel.html",[]).run(["$templateCache",function(a){a.put("template/carousel/carousel.html",'<div ng-mouseenter="pause()" ng-mouseleave="play()" class="carousel" ng-swipe-right="prev()" ng-swipe-left="next()">\n    <ol class="carousel-indicators" ng-show="slides.length > 1">\n        <li ng-repeat="slide in slides track by $index" ng-class="{active: isActive(slide)}" ng-click="select(slide)"></li>\n    </ol>\n    <div class="carousel-inner" ng-transclude></div>\n    <a class="left carousel-control" ng-click="prev()" ng-show="slides.length > 1"><span class="glyphicon glyphicon-chevron-left"></span></a>\n    <a class="right carousel-control" ng-click="next()" ng-show="slides.length > 1"><span class="glyphicon glyphicon-chevron-right"></span></a>\n</div>\n')}]),angular.module("template/carousel/slide.html",[]).run(["$templateCache",function(a){a.put("template/carousel/slide.html","<div ng-class=\"{\n    'active': leaving || (active && !entering),\n    'prev': (next || active) && direction=='prev',\n    'next': (next || active) && direction=='next',\n    'right': direction=='prev',\n    'left': direction=='next'\n  }\" class=\"item text-center\" ng-transclude></div>\n")}]),angular.module("template/datepicker/datepicker.html",[]).run(["$templateCache",function(a){a.put("template/datepicker/datepicker.html",'<div ng-switch="datepickerMode" role="application" ng-keydown="keydown($event)">\n  <daypicker ng-switch-when="day" tabindex="0"></daypicker>\n  <monthpicker ng-switch-when="month" tabindex="0"></monthpicker>\n  <yearpicker ng-switch-when="year" tabindex="0"></yearpicker>\n</div>')}]),angular.module("template/datepicker/day.html",[]).run(["$templateCache",function(a){a.put("template/datepicker/day.html",'<table role="grid" aria-labelledby="{{uniqueId}}-title" aria-activedescendant="{{activeDateId}}">\n  <thead>\n    <tr>\n      <th><button type="button" class="btn btn-default btn-sm pull-left" ng-click="move(-1)" tabindex="-1"><i class="glyphicon glyphicon-chevron-left"></i></button></th>\n      <th colspan="{{5 + showWeeks}}"><button id="{{uniqueId}}-title" role="heading" aria-live="assertive" aria-atomic="true" type="button" class="btn btn-default btn-sm" ng-click="toggleMode()" tabindex="-1" style="width:100%;"><strong>{{title}}</strong></button></th>\n      <th><button type="button" class="btn btn-default btn-sm pull-right" ng-click="move(1)" tabindex="-1"><i class="glyphicon glyphicon-chevron-right"></i></button></th>\n    </tr>\n    <tr>\n      <th ng-show="showWeeks" class="text-center"></th>\n      <th ng-repeat="label in labels track by $index" class="text-center"><small aria-label="{{label.full}}">{{label.abbr}}</small></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr ng-repeat="row in rows track by $index">\n      <td ng-show="showWeeks" class="text-center h6"><em>{{ weekNumbers[$index] }}</em></td>\n      <td ng-repeat="dt in row track by dt.date" class="text-center" role="gridcell" id="{{dt.uid}}" aria-disabled="{{!!dt.disabled}}">\n        <button type="button" style="width:100%;" class="btn btn-default btn-sm" ng-class="{\'btn-info\': dt.selected, active: isActive(dt)}" ng-click="select(dt.date)" ng-disabled="dt.disabled" tabindex="-1"><span ng-class="{\'text-muted\': dt.secondary, \'text-info\': dt.current}">{{dt.label}}</span></button>\n      </td>\n    </tr>\n  </tbody>\n</table>\n');
}]),angular.module("template/datepicker/month.html",[]).run(["$templateCache",function(a){a.put("template/datepicker/month.html",'<table role="grid" aria-labelledby="{{uniqueId}}-title" aria-activedescendant="{{activeDateId}}">\n  <thead>\n    <tr>\n      <th><button type="button" class="btn btn-default btn-sm pull-left" ng-click="move(-1)" tabindex="-1"><i class="glyphicon glyphicon-chevron-left"></i></button></th>\n      <th><button id="{{uniqueId}}-title" role="heading" aria-live="assertive" aria-atomic="true" type="button" class="btn btn-default btn-sm" ng-click="toggleMode()" tabindex="-1" style="width:100%;"><strong>{{title}}</strong></button></th>\n      <th><button type="button" class="btn btn-default btn-sm pull-right" ng-click="move(1)" tabindex="-1"><i class="glyphicon glyphicon-chevron-right"></i></button></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr ng-repeat="row in rows track by $index">\n      <td ng-repeat="dt in row track by dt.date" class="text-center" role="gridcell" id="{{dt.uid}}" aria-disabled="{{!!dt.disabled}}">\n        <button type="button" style="width:100%;" class="btn btn-default" ng-class="{\'btn-info\': dt.selected, active: isActive(dt)}" ng-click="select(dt.date)" ng-disabled="dt.disabled" tabindex="-1"><span ng-class="{\'text-info\': dt.current}">{{dt.label}}</span></button>\n      </td>\n    </tr>\n  </tbody>\n</table>\n')}]),angular.module("template/datepicker/popup.html",[]).run(["$templateCache",function(a){a.put("template/datepicker/popup.html",'<ul class="dropdown-menu" ng-style="{display: (isOpen && \'block\') || \'none\', top: position.top+\'px\', left: position.left+\'px\'}" ng-keydown="keydown($event)">\n	<li ng-transclude></li>\n	<li ng-if="showButtonBar" style="padding:10px 9px 2px">\n		<span class="btn-group pull-left">\n			<button type="button" class="btn btn-sm btn-info" ng-click="select(\'today\')">{{ getText(\'current\') }}</button>\n			<button type="button" class="btn btn-sm btn-danger" ng-click="select(null)">{{ getText(\'clear\') }}</button>\n		</span>\n		<button type="button" class="btn btn-sm btn-success pull-right" ng-click="close()">{{ getText(\'close\') }}</button>\n	</li>\n</ul>\n')}]),angular.module("template/datepicker/year.html",[]).run(["$templateCache",function(a){a.put("template/datepicker/year.html",'<table role="grid" aria-labelledby="{{uniqueId}}-title" aria-activedescendant="{{activeDateId}}">\n  <thead>\n    <tr>\n      <th><button type="button" class="btn btn-default btn-sm pull-left" ng-click="move(-1)" tabindex="-1"><i class="glyphicon glyphicon-chevron-left"></i></button></th>\n      <th colspan="3"><button id="{{uniqueId}}-title" role="heading" aria-live="assertive" aria-atomic="true" type="button" class="btn btn-default btn-sm" ng-click="toggleMode()" tabindex="-1" style="width:100%;"><strong>{{title}}</strong></button></th>\n      <th><button type="button" class="btn btn-default btn-sm pull-right" ng-click="move(1)" tabindex="-1"><i class="glyphicon glyphicon-chevron-right"></i></button></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr ng-repeat="row in rows track by $index">\n      <td ng-repeat="dt in row track by dt.date" class="text-center" role="gridcell" id="{{dt.uid}}" aria-disabled="{{!!dt.disabled}}">\n        <button type="button" style="width:100%;" class="btn btn-default" ng-class="{\'btn-info\': dt.selected, active: isActive(dt)}" ng-click="select(dt.date)" ng-disabled="dt.disabled" tabindex="-1"><span ng-class="{\'text-info\': dt.current}">{{dt.label}}</span></button>\n      </td>\n    </tr>\n  </tbody>\n</table>\n')}]),angular.module("template/modal/backdrop.html",[]).run(["$templateCache",function(a){a.put("template/modal/backdrop.html",'<div class="modal-backdrop fade {{ backdropClass }}"\n     ng-class="{in: animate}"\n     ng-style="{\'z-index\': 1040 + (index && 1 || 0) + index*10}"\n></div>\n')}]),angular.module("template/modal/window.html",[]).run(["$templateCache",function(a){a.put("template/modal/window.html",'<div tabindex="-1" role="dialog" class="modal fade" ng-class="{in: animate}" ng-style="{\'z-index\': 1050 + index*10, display: \'block\'}" ng-click="close($event)">\n    <div class="modal-dialog" ng-class="{\'modal-sm\': size == \'sm\', \'modal-lg\': size == \'lg\'}"><div class="modal-content" modal-transclude></div></div>\n</div>')}]),angular.module("template/pagination/pager.html",[]).run(["$templateCache",function(a){a.put("template/pagination/pager.html",'<ul class="pager">\n  <li ng-class="{disabled: noPrevious(), previous: align}"><a href ng-click="selectPage(page - 1)">{{getText(\'previous\')}}</a></li>\n  <li ng-class="{disabled: noNext(), next: align}"><a href ng-click="selectPage(page + 1)">{{getText(\'next\')}}</a></li>\n</ul>')}]),angular.module("template/pagination/pagination.html",[]).run(["$templateCache",function(a){a.put("template/pagination/pagination.html",'<ul class="pagination">\n  <li ng-if="boundaryLinks" ng-class="{disabled: noPrevious()}"><a href ng-click="selectPage(1)">{{getText(\'first\')}}</a></li>\n  <li ng-if="directionLinks" ng-class="{disabled: noPrevious()}"><a href ng-click="selectPage(page - 1)">{{getText(\'previous\')}}</a></li>\n  <li ng-repeat="page in pages track by $index" ng-class="{active: page.active}"><a href ng-click="selectPage(page.number)">{{page.text}}</a></li>\n  <li ng-if="directionLinks" ng-class="{disabled: noNext()}"><a href ng-click="selectPage(page + 1)">{{getText(\'next\')}}</a></li>\n  <li ng-if="boundaryLinks" ng-class="{disabled: noNext()}"><a href ng-click="selectPage(totalPages)">{{getText(\'last\')}}</a></li>\n</ul>')}]),angular.module("template/tooltip/tooltip-html-unsafe-popup.html",[]).run(["$templateCache",function(a){a.put("template/tooltip/tooltip-html-unsafe-popup.html",'<div class="tooltip {{placement}}" ng-class="{ in: isOpen(), fade: animation() }">\n  <div class="tooltip-arrow"></div>\n  <div class="tooltip-inner" bind-html-unsafe="content"></div>\n</div>\n')}]),angular.module("template/tooltip/tooltip-popup.html",[]).run(["$templateCache",function(a){a.put("template/tooltip/tooltip-popup.html",'<div class="tooltip {{placement}}" ng-class="{ in: isOpen(), fade: animation() }">\n  <div class="tooltip-arrow"></div>\n  <div class="tooltip-inner" ng-bind="content"></div>\n</div>\n')}]),angular.module("template/popover/popover.html",[]).run(["$templateCache",function(a){a.put("template/popover/popover.html",'<div class="popover {{placement}}" ng-class="{ in: isOpen(), fade: animation() }">\n  <div class="arrow"></div>\n\n  <div class="popover-inner">\n      <h3 class="popover-title" ng-bind="title" ng-show="title"></h3>\n      <div class="popover-content" ng-bind="content"></div>\n  </div>\n</div>\n')}]),angular.module("template/progressbar/bar.html",[]).run(["$templateCache",function(a){a.put("template/progressbar/bar.html",'<div class="progress-bar" ng-class="type && \'progress-bar-\' + type" role="progressbar" aria-valuenow="{{value}}" aria-valuemin="0" aria-valuemax="{{max}}" ng-style="{width: percent + \'%\'}" aria-valuetext="{{percent | number:0}}%" ng-transclude></div>')}]),angular.module("template/progressbar/progress.html",[]).run(["$templateCache",function(a){a.put("template/progressbar/progress.html",'<div class="progress" ng-transclude></div>')}]),angular.module("template/progressbar/progressbar.html",[]).run(["$templateCache",function(a){a.put("template/progressbar/progressbar.html",'<div class="progress">\n  <div class="progress-bar" ng-class="type && \'progress-bar-\' + type" role="progressbar" aria-valuenow="{{value}}" aria-valuemin="0" aria-valuemax="{{max}}" ng-style="{width: percent + \'%\'}" aria-valuetext="{{percent | number:0}}%" ng-transclude></div>\n</div>')}]),angular.module("template/rating/rating.html",[]).run(["$templateCache",function(a){a.put("template/rating/rating.html",'<span ng-mouseleave="reset()" ng-keydown="onKeydown($event)" tabindex="0" role="slider" aria-valuemin="0" aria-valuemax="{{range.length}}" aria-valuenow="{{value}}">\n    <i ng-repeat="r in range track by $index" ng-mouseenter="enter($index + 1)" ng-click="rate($index + 1)" class="glyphicon" ng-class="$index < value && (r.stateOn || \'glyphicon-star\') || (r.stateOff || \'glyphicon-star-empty\')">\n        <span class="sr-only">({{ $index < value ? \'*\' : \' \' }})</span>\n    </i>\n</span>')}]),angular.module("template/tabs/tab.html",[]).run(["$templateCache",function(a){a.put("template/tabs/tab.html",'<li ng-class="{active: active, disabled: disabled}">\n  <a href ng-click="select()" tab-heading-transclude>{{heading}}</a>\n</li>\n')}]),angular.module("template/tabs/tabset.html",[]).run(["$templateCache",function(a){a.put("template/tabs/tabset.html",'<div>\n  <ul class="nav nav-{{type || \'tabs\'}}" ng-class="{\'nav-stacked\': vertical, \'nav-justified\': justified}" ng-transclude></ul>\n  <div class="tab-content">\n    <div class="tab-pane" \n         ng-repeat="tab in tabs" \n         ng-class="{active: tab.active}"\n         tab-content-transclude="tab">\n    </div>\n  </div>\n</div>\n')}]),angular.module("template/timepicker/timepicker.html",[]).run(["$templateCache",function(a){a.put("template/timepicker/timepicker.html",'<table>\n	<tbody>\n		<tr class="text-center">\n			<td><a ng-click="incrementHours()" class="btn btn-link"><span class="glyphicon glyphicon-chevron-up"></span></a></td>\n			<td>&nbsp;</td>\n			<td><a ng-click="incrementMinutes()" class="btn btn-link"><span class="glyphicon glyphicon-chevron-up"></span></a></td>\n			<td ng-show="showMeridian"></td>\n		</tr>\n		<tr>\n			<td style="width:50px;" class="form-group" ng-class="{\'has-error\': invalidHours}">\n				<input type="text" ng-model="hours" ng-change="updateHours()" class="form-control text-center" ng-mousewheel="incrementHours()" ng-readonly="readonlyInput" maxlength="2">\n			</td>\n			<td>:</td>\n			<td style="width:50px;" class="form-group" ng-class="{\'has-error\': invalidMinutes}">\n				<input type="text" ng-model="minutes" ng-change="updateMinutes()" class="form-control text-center" ng-readonly="readonlyInput" maxlength="2">\n			</td>\n			<td ng-show="showMeridian"><button type="button" class="btn btn-default text-center" ng-click="toggleMeridian()">{{meridian}}</button></td>\n		</tr>\n		<tr class="text-center">\n			<td><a ng-click="decrementHours()" class="btn btn-link"><span class="glyphicon glyphicon-chevron-down"></span></a></td>\n			<td>&nbsp;</td>\n			<td><a ng-click="decrementMinutes()" class="btn btn-link"><span class="glyphicon glyphicon-chevron-down"></span></a></td>\n			<td ng-show="showMeridian"></td>\n		</tr>\n	</tbody>\n</table>\n')}]),angular.module("template/typeahead/typeahead-match.html",[]).run(["$templateCache",function(a){a.put("template/typeahead/typeahead-match.html",'<a tabindex="-1" bind-html-unsafe="match.label | typeaheadHighlight:query"></a>')}]),angular.module("template/typeahead/typeahead-popup.html",[]).run(["$templateCache",function(a){a.put("template/typeahead/typeahead-popup.html",'<ul class="dropdown-menu" ng-show="isOpen()" ng-style="{top: position.top+\'px\', left: position.left+\'px\'}" style="display: block;" role="listbox" aria-hidden="{{!isOpen()}}">\n    <li ng-repeat="match in matches track by $index" ng-class="{active: isActive($index) }" ng-mouseenter="selectActive($index)" ng-click="selectMatch($index)" role="option" id="{{match.id}}">\n        <div typeahead-match index="$index" match="match" query="query" template-url="templateUrl"></div>\n    </li>\n</ul>\n')}]),function(a,b,c){"use strict";b.module("ngCookies",["ng"]).factory("$cookies",["$rootScope","$browser",function(a,d){function e(){var a,e,f,i;for(a in h)k(g[a])&&(d.cookies(a,c),delete h[a]);for(a in g)e=g[a],b.isString(e)||(e=""+e,g[a]=e),e!==h[a]&&(d.cookies(a,e),h[a]=e,i=!0);if(i){f=d.cookies();for(a in g)g[a]!==f[a]&&(k(f[a])?(delete g[a],delete h[a]):g[a]=h[a]=f[a])}}var f,g={},h={},i=!1,j=b.copy,k=b.isUndefined;return d.addPollFn(function(){var b=d.cookies();f!=b&&(f=b,j(b,h),j(b,g),i&&a.$apply())})(),i=!0,a.$watch(e),g}]).factory("$cookieStore",["$cookies",function(a){return{get:function(c){var d=a[c];return d?b.fromJson(d):d},put:function(c,d){a[c]=b.toJson(d)},remove:function(b){delete a[b]}}}])}(window,window.angular),angular.module("dndLists",[]).directive("dndDraggable",["$parse","$timeout","dndDropEffectWorkaround","dndDragTypeWorkaround",function(a,b,c,d){return function(e,f,g){f.attr("draggable","true"),g.dndDisableIf&&e.$watch(g.dndDisableIf,function(a){f.attr("draggable",!a)}),f.on("dragstart",function(h){h=h.originalEvent||h,h.dataTransfer.setData("Text",angular.toJson(e.$eval(g.dndDraggable))),h.dataTransfer.effectAllowed=g.dndEffectAllowed||"move",f.addClass("dndDragging"),b(function(){f.addClass("dndDraggingSource")},0),c.dropEffect="none",d.isDragging=!0,d.dragType=g.dndType?e.$eval(g.dndType):void 0,a(g.dndDragstart)(e,{event:h}),h.stopPropagation()}),f.on("dragend",function(h){h=h.originalEvent||h;var i=c.dropEffect;e.$apply(function(){switch(i){case"move":a(g.dndMoved)(e,{event:h});break;case"copy":a(g.dndCopied)(e,{event:h});break;case"none":a(g.dndCanceled)(e,{event:h})}a(g.dndDragend)(e,{event:h,dropEffect:i})}),f.removeClass("dndDragging"),b(function(){f.removeClass("dndDraggingSource")},0),d.isDragging=!1,h.stopPropagation()}),f.on("click",function(b){g.dndSelected&&(b=b.originalEvent||b,e.$apply(function(){a(g.dndSelected)(e,{event:b})}),b.stopPropagation())}),f.on("selectstart",function(){this.dragDrop&&this.dragDrop()})}}]).directive("dndList",["$parse","$timeout","dndDropEffectWorkaround","dndDragTypeWorkaround",function(a,b,c,d){return function(e,f,g){function h(a,b,c){var d=r?a.offsetX||a.layerX:a.offsetY||a.layerY,e=r?b.offsetWidth:b.offsetHeight,f=r?b.offsetLeft:b.offsetTop;return f=c?f:0,f+e/2>d}function i(){var a;return angular.forEach(f.children(),function(b){var c=angular.element(b);c.hasClass("dndPlaceholder")&&(a=c)}),a||angular.element("<li class='dndPlaceholder'></li>")}function j(){return Array.prototype.indexOf.call(q.children,p)}function k(a){if(!d.isDragging&&!s)return!1;if(!n(a.dataTransfer.types))return!1;if(g.dndAllowedTypes&&d.isDragging){var b=e.$eval(g.dndAllowedTypes);if(angular.isArray(b)&&-1===b.indexOf(d.dragType))return!1}return!g.dndDisableIf||!e.$eval(g.dndDisableIf)}function l(){return o.remove(),f.removeClass("dndDragover"),!0}function m(b,c,f,g){return a(b)(e,{event:c,index:f,item:g||void 0,external:!d.isDragging,type:d.isDragging?d.dragType:void 0})}function n(a){if(!a)return!0;for(var b=0;b<a.length;b++)if("Text"===a[b]||"text/plain"===a[b])return!0;return!1}var o=i(),p=o[0],q=f[0];o.remove();var r=g.dndHorizontalList&&e.$eval(g.dndHorizontalList),s=g.dndExternalSources&&e.$eval(g.dndExternalSources);f.on("dragover",function(a){if(a=a.originalEvent||a,!k(a))return!0;if(p.parentNode!=q&&f.append(o),a.target!==q){for(var b=a.target;b.parentNode!==q&&b.parentNode;)b=b.parentNode;b.parentNode===q&&b!==p&&(h(a,b)?q.insertBefore(p,b):q.insertBefore(p,b.nextSibling))}else if(h(a,p,!0))for(;p.previousElementSibling&&(h(a,p.previousElementSibling,!0)||0===p.previousElementSibling.offsetHeight);)q.insertBefore(p,p.previousElementSibling);else for(;p.nextElementSibling&&!h(a,p.nextElementSibling,!0);)q.insertBefore(p,p.nextElementSibling.nextElementSibling);return g.dndDragover&&!m(g.dndDragover,a,j())?l():(f.addClass("dndDragover"),a.preventDefault(),a.stopPropagation(),!1)}),f.on("drop",function(a){if(a=a.originalEvent||a,!k(a))return!0;a.preventDefault();var b,d=a.dataTransfer.getData("Text")||a.dataTransfer.getData("text/plain");try{b=JSON.parse(d)}catch(f){return l()}var h=j();if(g.dndDrop&&(b=m(g.dndDrop,a,h,b),!b))return l();var i=e.$eval(g.dndList);return e.$apply(function(){i.splice(h,0,b)}),m(g.dndInserted,a,h,b),"none"===a.dataTransfer.dropEffect?"copy"===a.dataTransfer.effectAllowed||"move"===a.dataTransfer.effectAllowed?c.dropEffect=a.dataTransfer.effectAllowed:c.dropEffect=a.ctrlKey?"copy":"move":c.dropEffect=a.dataTransfer.dropEffect,l(),a.stopPropagation(),!1}),f.on("dragleave",function(a){a=a.originalEvent||a,f.removeClass("dndDragover"),b(function(){f.hasClass("dndDragover")||o.remove()},100)})}}]).directive("dndNodrag",function(){return function(a,b,c){b.attr("draggable","true"),b.on("dragstart",function(a){a=a.originalEvent||a,a.dataTransfer.types&&a.dataTransfer.types.length||a.preventDefault(),a.stopPropagation()}),b.on("dragend",function(a){a=a.originalEvent||a,a.stopPropagation()})}}).factory("dndDragTypeWorkaround",function(){return{}}).factory("dndDropEffectWorkaround",function(){return{}}),function(a,b,c){"use strict";function d(){function a(a,c){return b.extend(Object.create(a),c)}function c(a,b){var c=b.caseInsensitiveMatch,d={originalPath:a,regexp:a},e=d.keys=[];return a=a.replace(/([().])/g,"\\$1").replace(/(\/)?:(\w+)([\?\*])?/g,function(a,b,c,d){var f="?"===d?d:null,g="*"===d?d:null;return e.push({name:c,optional:!!f}),b=b||"",""+(f?"":b)+"(?:"+(f?b:"")+(g&&"(.+?)"||"([^/]+)")+(f||"")+")"+(f||"")}).replace(/([\/$\*])/g,"\\$1"),d.regexp=new RegExp("^"+a+"$",c?"i":""),d}var d={};this.when=function(a,e){var f=b.copy(e);if(b.isUndefined(f.reloadOnSearch)&&(f.reloadOnSearch=!0),b.isUndefined(f.caseInsensitiveMatch)&&(f.caseInsensitiveMatch=this.caseInsensitiveMatch),d[a]=b.extend(f,a&&c(a,f)),a){var g="/"==a[a.length-1]?a.substr(0,a.length-1):a+"/";d[g]=b.extend({redirectTo:a},c(g,f))}return this},this.caseInsensitiveMatch=!1,this.otherwise=function(a){return"string"==typeof a&&(a={redirectTo:a}),this.when(null,a),this},this.$get=["$rootScope","$location","$routeParams","$q","$injector","$templateRequest","$sce",function(c,e,f,g,h,j,k){function l(a,b){var c=b.keys,d={};if(!b.regexp)return null;var e=b.regexp.exec(a);if(!e)return null;for(var f=1,g=e.length;g>f;++f){var h=c[f-1],i=e[f];h&&i&&(d[h.name]=i)}return d}function m(a){var d=t.current;q=o(),r=q&&d&&q.$$route===d.$$route&&b.equals(q.pathParams,d.pathParams)&&!q.reloadOnSearch&&!s,r||!d&&!q||c.$broadcast("$routeChangeStart",q,d).defaultPrevented&&a&&a.preventDefault()}function n(){var a=t.current,d=q;r?(a.params=d.params,b.copy(a.params,f),c.$broadcast("$routeUpdate",a)):(d||a)&&(s=!1,t.current=d,d&&d.redirectTo&&(b.isString(d.redirectTo)?e.path(p(d.redirectTo,d.params)).search(d.params).replace():e.url(d.redirectTo(d.pathParams,e.path(),e.search())).replace()),g.when(d).then(function(){if(d){var a,c,e=b.extend({},d.resolve);return b.forEach(e,function(a,c){e[c]=b.isString(a)?h.get(a):h.invoke(a,null,null,c)}),b.isDefined(a=d.template)?b.isFunction(a)&&(a=a(d.params)):b.isDefined(c=d.templateUrl)&&(b.isFunction(c)&&(c=c(d.params)),c=k.getTrustedResourceUrl(c),b.isDefined(c)&&(d.loadedTemplateUrl=c,a=j(c))),b.isDefined(a)&&(e.$template=a),g.all(e)}}).then(function(e){d==t.current&&(d&&(d.locals=e,b.copy(d.params,f)),c.$broadcast("$routeChangeSuccess",d,a))},function(b){d==t.current&&c.$broadcast("$routeChangeError",d,a,b)}))}function o(){var c,f;return b.forEach(d,function(d,g){!f&&(c=l(e.path(),d))&&(f=a(d,{params:b.extend({},e.search(),c),pathParams:c}),f.$$route=d)}),f||d[null]&&a(d[null],{params:{},pathParams:{}})}function p(a,c){var d=[];return b.forEach((a||"").split(":"),function(a,b){if(0===b)d.push(a);else{var e=a.match(/(\w+)(?:[?*])?(.*)/),f=e[1];d.push(c[f]),d.push(e[2]||""),delete c[f]}}),d.join("")}var q,r,s=!1,t={routes:d,reload:function(){s=!0,c.$evalAsync(function(){m(),n()})},updateParams:function(a){if(!this.current||!this.current.$$route)throw i("norout","Tried updating route when with no current route");a=b.extend({},this.current.params,a),e.path(p(this.current.$$route.originalPath,a)),e.search(a)}};return c.$on("$locationChangeStart",m),c.$on("$locationChangeSuccess",n),t}]}function e(){this.$get=function(){return{}}}function f(a,c,d){return{restrict:"ECA",terminal:!0,priority:400,transclude:"element",link:function(e,f,g,h,i){function j(){n&&(d.cancel(n),n=null),l&&(l.$destroy(),l=null),m&&(n=d.leave(m),n.then(function(){n=null}),m=null)}function k(){var g=a.current&&a.current.locals,h=g&&g.$template;if(b.isDefined(h)){var k=e.$new(),n=a.current,q=i(k,function(a){d.enter(a,null,m||f).then(function(){!b.isDefined(o)||o&&!e.$eval(o)||c()}),j()});m=q,l=n.scope=k,l.$emit("$viewContentLoaded"),l.$eval(p)}else j()}var l,m,n,o=g.autoscroll,p=g.onload||"";e.$on("$routeChangeSuccess",k),k()}}}function g(a,b,c){return{restrict:"ECA",priority:-400,link:function(d,e){var f=c.current,g=f.locals;e.html(g.$template);var h=a(e.contents());if(f.controller){g.$scope=d;var i=b(f.controller,g);f.controllerAs&&(d[f.controllerAs]=i),e.data("$ngControllerController",i),e.children().data("$ngControllerController",i)}h(d)}}}var h=b.module("ngRoute",["ng"]).provider("$route",d),i=b.$$minErr("ngRoute");h.provider("$routeParams",e),h.directive("ngView",f),h.directive("ngView",g),f.$inject=["$route","$anchorScroll","$animate"],g.$inject=["$compile","$controller","$route"]}(window,window.angular),function(a,b,c){"use strict";function d(){this.$get=["$$sanitizeUri",function(a){return function(b){var c=[];return g(b,j(c,function(b,c){return!/^unsafe/.test(a(b,c))})),c.join("")}}]}function e(a){var c=[],d=j(c,b.noop);return d.chars(a),c.join("")}function f(a){var b,c={},d=a.split(",");for(b=0;b<d.length;b++)c[d[b]]=!0;return c}function g(a,c){function d(a,d,f,g){if(d=b.lowercase(d),z[d])for(;t.last()&&A[t.last()];)e("",t.last());y[d]&&t.last()==d&&e("",d),g=v[d]||!!g,g||t.push(d);var i={};f.replace(n,function(a,b,c,d,e){var f=c||d||e||"";i[b]=h(f)}),c.start&&c.start(d,i,g)}function e(a,d){var e,f=0;if(d=b.lowercase(d))for(f=t.length-1;f>=0&&t[f]!=d;f--);if(f>=0){for(e=t.length-1;e>=f;e--)c.end&&c.end(t[e]);t.length=f}}"string"!=typeof a&&(a=null===a||"undefined"==typeof a?"":""+a);var f,g,i,j,t=[],u=a;for(t.last=function(){return t[t.length-1]};a;){if(j="",g=!0,t.last()&&C[t.last()]?(a=a.replace(new RegExp("([\\W\\w]*)<\\s*\\/\\s*"+t.last()+"[^>]*>","i"),function(a,b){return b=b.replace(q,"$1").replace(s,"$1"),c.chars&&c.chars(h(b)),""}),e("",t.last())):(0===a.indexOf("<!--")?(f=a.indexOf("--",4),f>=0&&a.lastIndexOf("-->",f)===f&&(c.comment&&c.comment(a.substring(4,f)),a=a.substring(f+3),g=!1)):r.test(a)?(i=a.match(r),i&&(a=a.replace(i[0],""),g=!1)):p.test(a)?(i=a.match(m),i&&(a=a.substring(i[0].length),i[0].replace(m,e),g=!1)):o.test(a)&&(i=a.match(l),i?(i[4]&&(a=a.substring(i[0].length),i[0].replace(l,d)),g=!1):(j+="<",a=a.substring(1))),g&&(f=a.indexOf("<"),j+=0>f?a:a.substring(0,f),a=0>f?"":a.substring(f),c.chars&&c.chars(h(j)))),a==u)throw k("badparse","The sanitizer was unable to parse the following block of html: {0}",a);u=a}e()}function h(a){return a?(I.innerHTML=a.replace(/</g,"&lt;"),I.textContent):""}function i(a){return a.replace(/&/g,"&amp;").replace(t,function(a){var b=a.charCodeAt(0),c=a.charCodeAt(1);return"&#"+(1024*(b-55296)+(c-56320)+65536)+";"}).replace(u,function(a){return"&#"+a.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function j(a,c){var d=!1,e=b.bind(a,a.push);return{start:function(a,f,g){a=b.lowercase(a),!d&&C[a]&&(d=a),d||D[a]!==!0||(e("<"),e(a),b.forEach(f,function(d,f){var g=b.lowercase(f),h="img"===a&&"src"===g||"background"===g;H[g]!==!0||E[g]===!0&&!c(d,h)||(e(" "),e(f),e('="'),e(i(d)),e('"'))}),e(g?"/>":">"))},end:function(a){a=b.lowercase(a),d||D[a]!==!0||(e("</"),e(a),e(">")),a==d&&(d=!1)},chars:function(a){d||e(i(a))}}}var k=b.$$minErr("$sanitize"),l=/^<((?:[a-zA-Z])[\w:-]*)((?:\s+[\w:-]+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)\s*(>?)/,m=/^<\/\s*([\w:-]+)[^>]*>/,n=/([\w:-]+)(?:\s*=\s*(?:(?:"((?:[^"])*)")|(?:'((?:[^'])*)')|([^>\s]+)))?/g,o=/^</,p=/^<\//,q=/<!--(.*?)-->/g,r=/<!DOCTYPE([^>]*?)>/i,s=/<!\[CDATA\[(.*?)]]>/g,t=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,u=/([^\#-~| |!])/g,v=f("area,br,col,hr,img,wbr"),w=f("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),x=f("rp,rt"),y=b.extend({},x,w),z=b.extend({},w,f("address,article,aside,blockquote,caption,center,del,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,map,menu,nav,ol,pre,script,section,table,ul")),A=b.extend({},x,f("a,abbr,acronym,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,q,ruby,rp,rt,s,samp,small,span,strike,strong,sub,sup,time,tt,u,var")),B=f("animate,animateColor,animateMotion,animateTransform,circle,defs,desc,ellipse,font-face,font-face-name,font-face-src,g,glyph,hkern,image,linearGradient,line,marker,metadata,missing-glyph,mpath,path,polygon,polyline,radialGradient,rect,set,stop,svg,switch,text,title,tspan,use"),C=f("script,style"),D=b.extend({},v,z,A,y,B),E=f("background,cite,href,longdesc,src,usemap,xlink:href"),F=f("abbr,align,alt,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,coords,dir,face,headers,height,hreflang,hspace,ismap,lang,language,nohref,nowrap,rel,rev,rows,rowspan,rules,scope,scrolling,shape,size,span,start,summary,target,title,type,valign,value,vspace,width"),G=f("accent-height,accumulate,additive,alphabetic,arabic-form,ascent,attributeName,attributeType,baseProfile,bbox,begin,by,calcMode,cap-height,class,color,color-rendering,content,cx,cy,d,dx,dy,descent,display,dur,end,fill,fill-rule,font-family,font-size,font-stretch,font-style,font-variant,font-weight,from,fx,fy,g1,g2,glyph-name,gradientUnits,hanging,height,horiz-adv-x,horiz-origin-x,ideographic,k,keyPoints,keySplines,keyTimes,lang,marker-end,marker-mid,marker-start,markerHeight,markerUnits,markerWidth,mathematical,max,min,offset,opacity,orient,origin,overline-position,overline-thickness,panose-1,path,pathLength,points,preserveAspectRatio,r,refX,refY,repeatCount,repeatDur,requiredExtensions,requiredFeatures,restart,rotate,rx,ry,slope,stemh,stemv,stop-color,stop-opacity,strikethrough-position,strikethrough-thickness,stroke,stroke-dasharray,stroke-dashoffset,stroke-linecap,stroke-linejoin,stroke-miterlimit,stroke-opacity,stroke-width,systemLanguage,target,text-anchor,to,transform,type,u1,u2,underline-position,underline-thickness,unicode,unicode-range,units-per-em,values,version,viewBox,visibility,width,widths,x,x-height,x1,x2,xlink:actuate,xlink:arcrole,xlink:role,xlink:show,xlink:title,xlink:type,xml:base,xml:lang,xml:space,xmlns,xmlns:xlink,y,y1,y2,zoomAndPan"),H=b.extend({},E,G,F),I=document.createElement("pre");b.module("ngSanitize",[]).provider("$sanitize",d),b.module("ngSanitize").filter("linky",["$sanitize",function(a){var c=/((ftp|https?):\/\/|(www\.)|(mailto:)?[A-Za-z0-9._%+-]+@)\S*[^\s.;,(){}<>"”’]/,d=/^mailto:/;return function(f,g){function h(a){a&&n.push(e(a))}function i(a,c){n.push("<a "),b.isDefined(g)&&n.push('target="',g,'" '),n.push('href="',a.replace(/"/g,"&quot;"),'">'),h(c),n.push("</a>")}if(!f)return f;for(var j,k,l,m=f,n=[];j=m.match(c);)k=j[0],j[2]||j[4]||(k=(j[3]?"http://":"mailto:")+k),l=j.index,h(m.substr(0,l)),i(k,j[0].replace(d,"")),m=m.substring(l+j[0].length);return h(m),a(n.join(""))}}])}(window,window.angular),function(a,b,c){"use strict";angular.module("mgcrea.ngStrap",["mgcrea.ngStrap.modal","mgcrea.ngStrap.aside","mgcrea.ngStrap.alert","mgcrea.ngStrap.button","mgcrea.ngStrap.select","mgcrea.ngStrap.datepicker","mgcrea.ngStrap.timepicker","mgcrea.ngStrap.navbar","mgcrea.ngStrap.tooltip","mgcrea.ngStrap.popover","mgcrea.ngStrap.dropdown","mgcrea.ngStrap.typeahead","mgcrea.ngStrap.scrollspy","mgcrea.ngStrap.affix","mgcrea.ngStrap.tab","mgcrea.ngStrap.collapse"]),angular.module("mgcrea.ngStrap.affix",["mgcrea.ngStrap.helpers.dimensions","mgcrea.ngStrap.helpers.debounce"]).provider("$affix",function(){var a=this.defaults={offsetTop:"auto"};this.$get=["$window","debounce","dimensions",function(b,c,d){function e(e,h){function i(a,b,c){var d=j(),e=k();return s>=d?"top":null!==a&&d+a<=b.top?"middle":null!==t&&b.top+c+q>=e-t?"bottom":"middle"}function j(){return n[0]===b?b.pageYOffset:n[0].scrollTop}function k(){return n[0]===b?b.document.body.scrollHeight:n[0].scrollHeight}var l={},m=angular.extend({},a,h),n=m.target,o="affix affix-top affix-bottom",p=!1,q=0,r=0,s=0,t=0,u=null,v=null,w=e.parent();if(m.offsetParent)if(m.offsetParent.match(/^\d+$/))for(var x=0;x<1*m.offsetParent-1;x++)w=w.parent();else w=angular.element(m.offsetParent);return l.init=function(){this.$parseOffsets(),r=d.offset(e[0]).top+q,p=!e[0].style.width,n.on("scroll",this.checkPosition),n.on("click",this.checkPositionWithEventLoop),g.on("resize",this.$debouncedOnResize),this.checkPosition(),this.checkPositionWithEventLoop()},l.destroy=function(){n.off("scroll",this.checkPosition),n.off("click",this.checkPositionWithEventLoop),g.off("resize",this.$debouncedOnResize)},l.checkPositionWithEventLoop=function(){setTimeout(l.checkPosition,1)},l.checkPosition=function(){var a=j(),b=d.offset(e[0]),c=d.height(e[0]),g=i(v,b,c);u!==g&&(u=g,e.removeClass(o).addClass("affix"+("middle"!==g?"-"+g:"")),"top"===g?(v=null,e.css("position",m.offsetParent?"":"relative"),p&&e.css("width",""),e.css("top","")):"bottom"===g?(v=m.offsetUnpin?-(1*m.offsetUnpin):b.top-a,p&&e.css("width",""),e.css("position",m.offsetParent?"":"relative"),e.css("top",m.offsetParent?"":f[0].offsetHeight-t-c-r+"px")):(v=null,p&&e.css("width",e[0].offsetWidth+"px"),e.css("position","fixed"),e.css("top",q+"px")))},l.$onResize=function(){l.$parseOffsets(),l.checkPosition()},l.$debouncedOnResize=c(l.$onResize,50),l.$parseOffsets=function(){var a=e.css("position");e.css("position",m.offsetParent?"":"relative"),m.offsetTop&&("auto"===m.offsetTop&&(m.offsetTop="+0"),m.offsetTop.match(/^[-+]\d+$/)?(q=1*-m.offsetTop,s=m.offsetParent?d.offset(w[0]).top+1*m.offsetTop:d.offset(e[0]).top-d.css(e[0],"marginTop",!0)+1*m.offsetTop):s=1*m.offsetTop),m.offsetBottom&&(t=m.offsetParent&&m.offsetBottom.match(/^[-+]\d+$/)?k()-(d.offset(w[0]).top+d.height(w[0]))+1*m.offsetBottom+1:1*m.offsetBottom),e.css("position",a)},l.init(),l}var f=angular.element(b.document.body),g=angular.element(b);return e}]}).directive("bsAffix",["$affix","$window",function(a,b){return{restrict:"EAC",require:"^?bsAffixTarget",link:function(c,d,e,f){var g={scope:c,offsetTop:"auto",target:f?f.$element:angular.element(b)};angular.forEach(["offsetTop","offsetBottom","offsetParent","offsetUnpin"],function(a){angular.isDefined(e[a])&&(g[a]=e[a])});var h=a(d,g);c.$on("$destroy",function(){h&&h.destroy(),g=null,h=null})}}}]).directive("bsAffixTarget",function(){return{controller:["$element",function(a){this.$element=a}]}}),angular.module("mgcrea.ngStrap.alert",["mgcrea.ngStrap.modal"]).provider("$alert",function(){var a=this.defaults={animation:"am-fade",prefixClass:"alert",prefixEvent:"alert",placement:null,template:"alert/alert.tpl.html",container:!1,element:null,backdrop:!1,keyboard:!0,show:!0,duration:!1,type:!1,dismissable:!0};this.$get=["$modal","$timeout",function(b,c){function d(d){var e={},f=angular.extend({},a,d);e=b(f),e.$scope.dismissable=!!f.dismissable,f.type&&(e.$scope.type=f.type);var g=e.show;return f.duration&&(e.show=function(){g(),c(function(){e.hide()},1e3*f.duration)}),e}return d}]}).directive("bsAlert",["$window","$sce","$alert",function(a,b,c){a.requestAnimationFrame||a.setTimeout;return{restrict:"EAC",scope:!0,link:function(a,d,e,f){var g={scope:a,element:d,show:!1};angular.forEach(["template","placement","keyboard","html","container","animation","duration","dismissable"],function(a){angular.isDefined(e[a])&&(g[a]=e[a])}),angular.forEach(["title","content","type"],function(c){e[c]&&e.$observe(c,function(d,e){a[c]=b.trustAsHtml(d)})}),e.bsAlert&&a.$watch(e.bsAlert,function(b,c){angular.isObject(b)?angular.extend(a,b):a.content=b},!0);var h=c(g);d.on(e.trigger||"click",h.toggle),a.$on("$destroy",function(){h&&h.destroy(),g=null,h=null})}}}]),angular.module("mgcrea.ngStrap.aside",["mgcrea.ngStrap.modal"]).provider("$aside",function(){var a=this.defaults={animation:"am-fade-and-slide-right",prefixClass:"aside",prefixEvent:"aside",placement:"right",template:"aside/aside.tpl.html",contentTemplate:!1,container:!1,element:null,backdrop:!0,keyboard:!0,html:!1,show:!0};this.$get=["$modal",function(b){function c(c){var d={},e=angular.extend({},a,c);return d=b(e)}return c}]}).directive("bsAside",["$window","$sce","$aside",function(a,b,c){
a.requestAnimationFrame||a.setTimeout;return{restrict:"EAC",scope:!0,link:function(a,d,e,f){var g={scope:a,element:d,show:!1};angular.forEach(["template","contentTemplate","placement","backdrop","keyboard","html","container","animation"],function(a){angular.isDefined(e[a])&&(g[a]=e[a])}),angular.forEach(["title","content"],function(c){e[c]&&e.$observe(c,function(d,e){a[c]=b.trustAsHtml(d)})}),e.bsAside&&a.$watch(e.bsAside,function(b,c){angular.isObject(b)?angular.extend(a,b):a.content=b},!0);var h=c(g);d.on(e.trigger||"click",h.toggle),a.$on("$destroy",function(){h&&h.destroy(),g=null,h=null})}}}]),angular.module("mgcrea.ngStrap.button",[]).provider("$button",function(){var a=this.defaults={activeClass:"active",toggleEvent:"click"};this.$get=function(){return{defaults:a}}}).directive("bsCheckboxGroup",function(){return{restrict:"A",require:"ngModel",compile:function(a,b){a.attr("data-toggle","buttons"),a.removeAttr("ng-model");var c=a[0].querySelectorAll('input[type="checkbox"]');angular.forEach(c,function(a){var c=angular.element(a);c.attr("bs-checkbox",""),c.attr("ng-model",b.ngModel+"."+c.attr("value"))})}}}).directive("bsCheckbox",["$button","$$rAF",function(a,b){var c=a.defaults,d=/^(true|false|\d+)$/;return{restrict:"A",require:"ngModel",link:function(a,e,f,g){var h=c,i="INPUT"===e[0].nodeName,j=i?e.parent():e,k=angular.isDefined(f.trueValue)?f.trueValue:!0;d.test(f.trueValue)&&(k=a.$eval(f.trueValue));var l=angular.isDefined(f.falseValue)?f.falseValue:!1;d.test(f.falseValue)&&(l=a.$eval(f.falseValue));var m="boolean"!=typeof k||"boolean"!=typeof l;m&&(g.$parsers.push(function(a){return a?k:l}),g.$formatters.push(function(a){return angular.equals(a,k)}),a.$watch(f.ngModel,function(a,b){g.$render()})),g.$render=function(){var a=angular.equals(g.$modelValue,k);b(function(){i&&(e[0].checked=a),j.toggleClass(h.activeClass,a)})},e.bind(h.toggleEvent,function(){a.$apply(function(){i||g.$setViewValue(!j.hasClass("active")),m||g.$render()})})}}}]).directive("bsRadioGroup",function(){return{restrict:"A",require:"ngModel",compile:function(a,b){a.attr("data-toggle","buttons"),a.removeAttr("ng-model");var c=a[0].querySelectorAll('input[type="radio"]');angular.forEach(c,function(a){angular.element(a).attr("bs-radio",""),angular.element(a).attr("ng-model",b.ngModel)})}}}).directive("bsRadio",["$button","$$rAF",function(a,b){var c=a.defaults,d=/^(true|false|\d+)$/;return{restrict:"A",require:"ngModel",link:function(a,e,f,g){var h=c,i="INPUT"===e[0].nodeName,j=i?e.parent():e,k=d.test(f.value)?a.$eval(f.value):f.value;g.$render=function(){var a=angular.equals(g.$modelValue,k);b(function(){i&&(e[0].checked=a),j.toggleClass(h.activeClass,a)})},e.bind(h.toggleEvent,function(){a.$apply(function(){g.$setViewValue(k),g.$render()})})}}}]),angular.module("mgcrea.ngStrap.collapse",[]).provider("$collapse",function(){var a=this.defaults={animation:"am-collapse",disallowToggle:!1,activeClass:"in",startCollapsed:!1,allowMultiple:!1},b=this.controller=function(b,c,d){function e(a){for(var b=i.$targets.$active,c=0;c<b.length;c++)a<b[c]&&(b[c]=b[c]-1),b[c]===i.$targets.length&&(b[c]=i.$targets.length-1)}function f(a){var b=i.$targets.$active;return-1!==b.indexOf(a)}function g(a){var b=i.$targets.$active.indexOf(a);-1!==b&&i.$targets.$active.splice(b,1)}function h(a){i.$options.allowMultiple||i.$targets.$active.splice(0,1),-1===i.$targets.$active.indexOf(a)&&i.$targets.$active.push(a)}var i=this;i.$options=angular.copy(a),angular.forEach(["animation","disallowToggle","activeClass","startCollapsed","allowMultiple"],function(a){angular.isDefined(d[a])&&(i.$options[a]=d[a])}),i.$toggles=[],i.$targets=[],i.$viewChangeListeners=[],i.$registerToggle=function(a){i.$toggles.push(a)},i.$registerTarget=function(a){i.$targets.push(a)},i.$unregisterToggle=function(a){var b=i.$toggles.indexOf(a);i.$toggles.splice(b,1)},i.$unregisterTarget=function(a){var b=i.$targets.indexOf(a);i.$targets.splice(b,1),i.$options.allowMultiple&&g(a),e(b),i.$viewChangeListeners.forEach(function(a){a()})},i.$targets.$active=i.$options.startCollapsed?[]:[0],i.$setActive=b.$setActive=function(a){angular.isArray(a)?i.$targets.$active=angular.copy(a):i.$options.disallowToggle?h(a):f(a)?g(a):h(a),i.$viewChangeListeners.forEach(function(a){a()})},i.$activeIndexes=function(){return i.$options.allowMultiple?i.$targets.$active:1===i.$targets.$active.length?i.$targets.$active[0]:-1}};this.$get=function(){var c={};return c.defaults=a,c.controller=b,c}}).directive("bsCollapse",["$window","$animate","$collapse",function(a,b,c){c.defaults;return{require:["?ngModel","bsCollapse"],controller:["$scope","$element","$attrs",c.controller],link:function(a,b,c,d){var e=d[0],f=d[1];e&&(f.$viewChangeListeners.push(function(){e.$setViewValue(f.$activeIndexes())}),e.$formatters.push(function(a){if(angular.isArray(a))f.$setActive(a);else{var b=f.$activeIndexes();angular.isArray(b)?-1===b.indexOf(1*a)&&f.$setActive(1*a):b!==1*a&&f.$setActive(1*a)}return a}))}}}]).directive("bsCollapseToggle",function(){return{require:["^?ngModel","^bsCollapse"],link:function(a,b,c,d){var e=(d[0],d[1]);b.attr("data-toggle","collapse"),e.$registerToggle(b),a.$on("$destroy",function(){e.$unregisterToggle(b)}),b.on("click",function(){var d=c.bsCollapseToggle||e.$toggles.indexOf(b);e.$setActive(1*d),a.$apply()})}}}).directive("bsCollapseTarget",["$animate",function(a){return{require:["^?ngModel","^bsCollapse"],link:function(b,c,d,e){function f(){var b=g.$targets.indexOf(c),d=g.$activeIndexes(),e="removeClass";angular.isArray(d)?-1!==d.indexOf(b)&&(e="addClass"):b===d&&(e="addClass"),a[e](c,g.$options.activeClass)}var g=(e[0],e[1]);c.addClass("collapse"),g.$options.animation&&c.addClass(g.$options.animation),g.$registerTarget(c),b.$on("$destroy",function(){g.$unregisterTarget(c)}),g.$viewChangeListeners.push(function(){f()}),f()}}}]),angular.module("mgcrea.ngStrap.datepicker",["mgcrea.ngStrap.helpers.dateParser","mgcrea.ngStrap.helpers.dateFormatter","mgcrea.ngStrap.tooltip"]).provider("$datepicker",function(){var a=this.defaults={animation:"am-fade",prefixClass:"datepicker",placement:"bottom-left",template:"datepicker/datepicker.tpl.html",trigger:"focus",container:!1,keyboard:!0,html:!1,delay:0,useNative:!1,dateType:"date",dateFormat:"shortDate",modelDateFormat:null,dayFormat:"dd",monthFormat:"MMM",yearFormat:"yyyy",monthTitleFormat:"MMMM yyyy",yearTitleFormat:"yyyy",strictFormat:!1,autoclose:!1,minDate:-(1/0),maxDate:+(1/0),startView:0,minView:0,startWeek:0,daysOfWeekDisabled:"",iconLeft:"glyphicon glyphicon-chevron-left",iconRight:"glyphicon glyphicon-chevron-right"};this.$get=["$window","$document","$rootScope","$sce","$dateFormatter","datepickerViews","$tooltip","$timeout",function(b,c,d,e,f,g,h,i){function j(b,c,d){function e(a){a.selected=j.$isSelected(a.date)}function f(){b[0].focus()}var j=h(b,angular.extend({},a,d)),m=d.scope,n=j.$options,o=j.$scope;n.startView&&(n.startView-=n.minView);var p=g(j);j.$views=p.views;var q=p.viewDate;o.$mode=n.startView,o.$iconLeft=n.iconLeft,o.$iconRight=n.iconRight;var r=j.$views[o.$mode];o.$select=function(a){j.select(a)},o.$selectPane=function(a){j.$selectPane(a)},o.$toggleMode=function(){j.setMode((o.$mode+1)%j.$views.length)},j.update=function(a){angular.isDate(a)&&!isNaN(a.getTime())&&(j.$date=a,r.update.call(r,a)),j.$build(!0)},j.updateDisabledDates=function(a){n.disabledDateRanges=a;for(var b=0,c=o.rows.length;c>b;b++)angular.forEach(o.rows[b],j.$setDisabledEl)},j.select=function(a,b){angular.isDate(c.$dateValue)||(c.$dateValue=new Date(a)),!o.$mode||b?(c.$setViewValue(angular.copy(a)),c.$render(),n.autoclose&&!b&&i(function(){j.hide(!0)})):(angular.extend(q,{year:a.getFullYear(),month:a.getMonth(),date:a.getDate()}),j.setMode(o.$mode-1),j.$build())},j.setMode=function(a){o.$mode=a,r=j.$views[o.$mode],j.$build()},j.$build=function(a){a===!0&&r.built||(a!==!1||r.built)&&r.build.call(r)},j.$updateSelected=function(){for(var a=0,b=o.rows.length;b>a;a++)angular.forEach(o.rows[a],e)},j.$isSelected=function(a){return r.isSelected(a)},j.$setDisabledEl=function(a){a.disabled=r.isDisabled(a.date)},j.$selectPane=function(a){var b=r.steps,c=new Date(Date.UTC(q.year+(b.year||0)*a,q.month+(b.month||0)*a,1));angular.extend(q,{year:c.getUTCFullYear(),month:c.getUTCMonth(),date:c.getUTCDate()}),j.$build()},j.$onMouseDown=function(a){if(a.preventDefault(),a.stopPropagation(),l){var b=angular.element(a.target);"button"!==b[0].nodeName.toLowerCase()&&(b=b.parent()),b.triggerHandler("click")}},j.$onKeyDown=function(a){if(/(38|37|39|40|13)/.test(a.keyCode)&&!a.shiftKey&&!a.altKey){if(a.preventDefault(),a.stopPropagation(),13===a.keyCode)return o.$mode?o.$apply(function(){j.setMode(o.$mode-1)}):j.hide(!0);r.onKeyDown(a),m.$digest()}};var s=j.init;j.init=function(){return k&&n.useNative?(b.prop("type","date"),void b.css("-webkit-appearance","textfield")):(l&&(b.prop("type","text"),b.attr("readonly","true"),b.on("click",f)),void s())};var t=j.destroy;j.destroy=function(){k&&n.useNative&&b.off("click",f),t()};var u=j.show;j.show=function(){u(),i(function(){j.$isShown&&(j.$element.on(l?"touchstart":"mousedown",j.$onMouseDown),n.keyboard&&b.on("keydown",j.$onKeyDown))},0,!1)};var v=j.hide;return j.hide=function(a){j.$isShown&&(j.$element.off(l?"touchstart":"mousedown",j.$onMouseDown),n.keyboard&&b.off("keydown",j.$onKeyDown),v(a))},j}var k=(angular.element(b.document.body),/(ip(a|o)d|iphone|android)/gi.test(b.navigator.userAgent)),l="createTouch"in b.document&&k;return a.lang||(a.lang=f.getDefaultLocale()),j.defaults=a,j}]}).directive("bsDatepicker",["$window","$parse","$q","$dateFormatter","$dateParser","$datepicker",function(a,b,c,d,e,f){var g=(f.defaults,/(ip(a|o)d|iphone|android)/gi.test(a.navigator.userAgent));return{restrict:"EAC",require:"ngModel",link:function(a,b,c,h){function i(a){return a&&a.length?a:null}function j(a){if(angular.isDate(a)){var b=isNaN(m.$options.minDate)||a.getTime()>=m.$options.minDate,c=isNaN(m.$options.maxDate)||a.getTime()<=m.$options.maxDate,d=b&&c;h.$setValidity("date",d),h.$setValidity("min",b),h.$setValidity("max",c),d&&(h.$dateValue=a)}}function k(){return!h.$dateValue||isNaN(h.$dateValue.getTime())?"":o(h.$dateValue,l.dateFormat)}var l={scope:a,controller:h};angular.forEach(["placement","container","delay","trigger","keyboard","html","animation","template","autoclose","dateType","dateFormat","modelDateFormat","dayFormat","strictFormat","startWeek","startDate","useNative","lang","startView","minView","iconLeft","iconRight","daysOfWeekDisabled","id"],function(a){angular.isDefined(c[a])&&(l[a]=c[a])}),c.bsShow&&a.$watch(c.bsShow,function(a,b){m&&angular.isDefined(a)&&(angular.isString(a)&&(a=!!a.match(/true|,?(datepicker),?/i)),a===!0?m.show():m.hide())});var m=f(b,h,l);l=m.$options,g&&l.useNative&&(l.dateFormat="yyyy-MM-dd");var n=l.lang,o=function(a,b){return d.formatDate(a,b,n)},p=e({format:l.dateFormat,lang:n,strict:l.strictFormat});angular.forEach(["minDate","maxDate"],function(a){angular.isDefined(c[a])&&c.$observe(a,function(b){m.$options[a]=p.getDateForAttribute(a,b),!isNaN(m.$options[a])&&m.$build(!1),j(h.$dateValue)})}),a.$watch(c.ngModel,function(a,b){m.update(h.$dateValue)},!0),angular.isDefined(c.disabledDates)&&a.$watch(c.disabledDates,function(a,b){a=i(a),b=i(b),a&&m.updateDisabledDates(a)}),h.$parsers.unshift(function(a){if(!a)return h.$setValidity("date",!0),null;var b=p.parse(a,h.$dateValue);return!b||isNaN(b.getTime())?void h.$setValidity("date",!1):(j(b),"string"===l.dateType?o(b,l.modelDateFormat||l.dateFormat):"number"===l.dateType?h.$dateValue.getTime():"unix"===l.dateType?h.$dateValue.getTime()/1e3:"iso"===l.dateType?h.$dateValue.toISOString():new Date(h.$dateValue))}),h.$formatters.push(function(a){var b;return b=angular.isUndefined(a)||null===a?NaN:angular.isDate(a)?a:"string"===l.dateType?p.parse(a,null,l.modelDateFormat):"unix"===l.dateType?new Date(1e3*a):new Date(a),h.$dateValue=b,k()}),h.$render=function(){b.val(k())},a.$on("$destroy",function(){m&&m.destroy(),l=null,m=null})}}}]).provider("datepickerViews",function(){function a(a,b){for(var c=[];a.length>0;)c.push(a.splice(0,b));return c}function b(a,b){return(a%b+b)%b}this.defaults={dayFormat:"dd",daySplit:7};this.$get=["$dateFormatter","$dateParser","$sce",function(c,d,e){return function(f){var g=f.$scope,h=f.$options,i=h.lang,j=function(a,b){return c.formatDate(a,b,i)},k=d({format:h.dateFormat,lang:i,strict:h.strictFormat}),l=c.weekdaysShort(i),m=l.slice(h.startWeek).concat(l.slice(0,h.startWeek)),n=e.trustAsHtml('<th class="dow text-center">'+m.join('</th><th class="dow text-center">')+"</th>"),o=f.$date||(h.startDate?k.getDateForAttribute("startDate",h.startDate):new Date),p={year:o.getFullYear(),month:o.getMonth(),date:o.getDate()},q=(6e4*o.getTimezoneOffset(),[{format:h.dayFormat,split:7,steps:{month:1},update:function(a,b){!this.built||b||a.getFullYear()!==p.year||a.getMonth()!==p.month?(angular.extend(p,{year:f.$date.getFullYear(),month:f.$date.getMonth(),date:f.$date.getDate()}),f.$build()):a.getDate()!==p.date&&(p.date=f.$date.getDate(),f.$updateSelected())},build:function(){var c=new Date(p.year,p.month,1),d=c.getTimezoneOffset(),e=new Date(+c-864e5*b(c.getDay()-h.startWeek,7)),i=e.getTimezoneOffset(),l=(new Date).toDateString();i!==d&&(e=new Date(+e+6e4*(i-d)));for(var m,o=[],q=0;42>q;q++)m=k.daylightSavingAdjust(new Date(e.getFullYear(),e.getMonth(),e.getDate()+q)),o.push({date:m,isToday:m.toDateString()===l,label:j(m,this.format),selected:f.$date&&this.isSelected(m),muted:m.getMonth()!==p.month,disabled:this.isDisabled(m)});g.title=j(c,h.monthTitleFormat),g.showLabels=!0,g.labels=n,g.rows=a(o,this.split),this.built=!0},isSelected:function(a){return f.$date&&a.getFullYear()===f.$date.getFullYear()&&a.getMonth()===f.$date.getMonth()&&a.getDate()===f.$date.getDate()},isDisabled:function(a){var b=a.getTime();if(b<h.minDate||b>h.maxDate)return!0;if(-1!==h.daysOfWeekDisabled.indexOf(a.getDay()))return!0;if(h.disabledDateRanges)for(var c=0;c<h.disabledDateRanges.length;c++)if(b>=h.disabledDateRanges[c].start&&b<=h.disabledDateRanges[c].end)return!0;return!1},onKeyDown:function(a){if(f.$date){var b,c=f.$date.getTime();37===a.keyCode?b=new Date(c-864e5):38===a.keyCode?b=new Date(c-6048e5):39===a.keyCode?b=new Date(c+864e5):40===a.keyCode&&(b=new Date(c+6048e5)),this.isDisabled(b)||f.select(b,!0)}}},{name:"month",format:h.monthFormat,split:4,steps:{year:1},update:function(a,b){this.built&&a.getFullYear()===p.year?a.getMonth()!==p.month&&(angular.extend(p,{month:f.$date.getMonth(),date:f.$date.getDate()}),f.$updateSelected()):(angular.extend(p,{year:f.$date.getFullYear(),month:f.$date.getMonth(),date:f.$date.getDate()}),f.$build())},build:function(){for(var b,c=(new Date(p.year,0,1),[]),d=0;12>d;d++)b=new Date(p.year,d,1),c.push({date:b,label:j(b,this.format),selected:f.$isSelected(b),disabled:this.isDisabled(b)});g.title=j(b,h.yearTitleFormat),g.showLabels=!1,g.rows=a(c,this.split),this.built=!0},isSelected:function(a){return f.$date&&a.getFullYear()===f.$date.getFullYear()&&a.getMonth()===f.$date.getMonth()},isDisabled:function(a){var b=+new Date(a.getFullYear(),a.getMonth()+1,0);return b<h.minDate||a.getTime()>h.maxDate},onKeyDown:function(a){if(f.$date){var b=f.$date.getMonth(),c=new Date(f.$date);37===a.keyCode?c.setMonth(b-1):38===a.keyCode?c.setMonth(b-4):39===a.keyCode?c.setMonth(b+1):40===a.keyCode&&c.setMonth(b+4),this.isDisabled(c)||f.select(c,!0)}}},{name:"year",format:h.yearFormat,split:4,steps:{year:12},update:function(a,b){!this.built||b||parseInt(a.getFullYear()/20,10)!==parseInt(p.year/20,10)?(angular.extend(p,{year:f.$date.getFullYear(),month:f.$date.getMonth(),date:f.$date.getDate()}),f.$build()):a.getFullYear()!==p.year&&(angular.extend(p,{year:f.$date.getFullYear(),month:f.$date.getMonth(),date:f.$date.getDate()}),f.$updateSelected())},build:function(){for(var b,c=p.year-p.year%(3*this.split),d=[],e=0;12>e;e++)b=new Date(c+e,0,1),d.push({date:b,label:j(b,this.format),selected:f.$isSelected(b),disabled:this.isDisabled(b)});g.title=d[0].label+"-"+d[d.length-1].label,g.showLabels=!1,g.rows=a(d,this.split),this.built=!0},isSelected:function(a){return f.$date&&a.getFullYear()===f.$date.getFullYear()},isDisabled:function(a){var b=+new Date(a.getFullYear()+1,0,0);return b<h.minDate||a.getTime()>h.maxDate},onKeyDown:function(a){if(f.$date){var b=f.$date.getFullYear(),c=new Date(f.$date);37===a.keyCode?c.setYear(b-1):38===a.keyCode?c.setYear(b-4):39===a.keyCode?c.setYear(b+1):40===a.keyCode&&c.setYear(b+4),this.isDisabled(c)||f.select(c,!0)}}}]);return{views:h.minView?Array.prototype.slice.call(q,h.minView):q,viewDate:p}}}]}),angular.module("mgcrea.ngStrap.dropdown",["mgcrea.ngStrap.tooltip"]).provider("$dropdown",function(){var a=this.defaults={animation:"am-fade",prefixClass:"dropdown",placement:"bottom-left",template:"dropdown/dropdown.tpl.html",trigger:"click",container:!1,keyboard:!0,html:!1,delay:0};this.$get=["$window","$rootScope","$tooltip","$timeout",function(b,c,d,e){function f(b,f){function i(a){return a.target!==b[0]?a.target!==b[0]&&j.hide():void 0}var j={},k=angular.extend({},a,f);j.$scope=k.scope&&k.scope.$new()||c.$new();j=d(b,k);var l=b.parent();j.$onKeyDown=function(a){if(/(38|40)/.test(a.keyCode)){a.preventDefault(),a.stopPropagation();var b=angular.element(j.$element[0].querySelectorAll("li:not(.divider) a"));if(b.length){var c;angular.forEach(b,function(a,b){h&&h.call(a,":focus")&&(c=b)}),38===a.keyCode&&c>0?c--:40===a.keyCode&&c<b.length-1?c++:angular.isUndefined(c)&&(c=0),b.eq(c)[0].focus()}}};var m=j.show;j.show=function(){m(),e(function(){k.keyboard&&j.$element.on("keydown",j.$onKeyDown),g.on("click",i)},0,!1),l.hasClass("dropdown")&&l.addClass("open")};var n=j.hide;j.hide=function(){j.$isShown&&(k.keyboard&&j.$element.off("keydown",j.$onKeyDown),g.off("click",i),l.hasClass("dropdown")&&l.removeClass("open"),n())};var o=j.destroy;return j.destroy=function(){g.off("click",i),o()},j}var g=angular.element(b.document.body),h=Element.prototype.matchesSelector||Element.prototype.webkitMatchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector;return f}]}).directive("bsDropdown",["$window","$sce","$dropdown",function(a,b,c){return{restrict:"EAC",scope:!0,link:function(a,b,d,e){var f={scope:a};angular.forEach(["placement","container","delay","trigger","keyboard","html","animation","template","id"],function(a){angular.isDefined(d[a])&&(f[a]=d[a])}),d.bsDropdown&&a.$watch(d.bsDropdown,function(b,c){a.content=b},!0),d.bsShow&&a.$watch(d.bsShow,function(a,b){g&&angular.isDefined(a)&&(angular.isString(a)&&(a=!!a.match(/true|,?(dropdown),?/i)),a===!0?g.show():g.hide())});var g=c(b,f);a.$on("$destroy",function(){g&&g.destroy(),f=null,g=null})}}}]),angular.module("mgcrea.ngStrap.helpers.dateFormatter",[]).service("$dateFormatter",["$locale","dateFilter",function(a,b){function c(a){return/(h+)([:\.])?(m+)[ ]?(a?)/i.exec(a).slice(1)}this.getDefaultLocale=function(){return a.id},this.getDatetimeFormat=function(b,c){return a.DATETIME_FORMATS[b]||b},this.weekdaysShort=function(b){return a.DATETIME_FORMATS.SHORTDAY},this.hoursFormat=function(a){return c(a)[0]},this.minutesFormat=function(a){return c(a)[2]},this.timeSeparator=function(a){return c(a)[1]},this.showAM=function(a){return!!c(a)[3]},this.formatDate=function(a,c,d){return b(a,c)}}]),angular.module("mgcrea.ngStrap.helpers.dateParser",[]).provider("$dateParser",["$localeProvider",function(a){function b(){this.year=1970,this.month=0,this.day=1,this.hours=0,this.minutes=0,this.seconds=0,this.milliseconds=0}function c(){}function d(a){return!isNaN(parseFloat(a))&&isFinite(a)}function e(a,b){for(var c=a.length,d=b.toString().toLowerCase(),e=0;c>e;e++)if(a[e].toLowerCase()===d)return e;return-1}b.prototype.setMilliseconds=function(a){this.milliseconds=a},b.prototype.setSeconds=function(a){this.seconds=a},b.prototype.setMinutes=function(a){this.minutes=a},b.prototype.setHours=function(a){this.hours=a},b.prototype.getHours=function(){return this.hours},b.prototype.setDate=function(a){this.day=a},b.prototype.setMonth=function(a){this.month=a},b.prototype.setFullYear=function(a){this.year=a},b.prototype.fromDate=function(a){return this.year=a.getFullYear(),this.month=a.getMonth(),this.day=a.getDate(),this.hours=a.getHours(),this.minutes=a.getMinutes(),this.seconds=a.getSeconds(),this.milliseconds=a.getMilliseconds(),this},b.prototype.toDate=function(){return new Date(this.year,this.month,this.day,this.hours,this.minutes,this.seconds,this.milliseconds)};var f=b.prototype,g=this.defaults={format:"shortDate",strict:!1};this.$get=["$locale","dateFilter",function(a,h){var i=function(i){function j(a){var b,c=Object.keys(r),d=[],e=[],f=a;for(b=0;b<c.length;b++)if(a.split(c[b]).length>1){var g=f.search(c[b]);a=a.split(c[b]).join(""),r[c[b]]&&(d[g]=r[c[b]])}return angular.forEach(d,function(a){a&&e.push(a)}),e}function k(a){return a.replace(/\//g,"[\\/]").replace("/-/g","[-]").replace(/\./g,"[.]").replace(/\\s/g,"[\\s]")}function l(a){var b,c=Object.keys(q),d=a;for(b=0;b<c.length;b++)d=d.split(c[b]).join("${"+b+"}");for(b=0;b<c.length;b++)d=d.split("${"+b+"}").join("("+q[c[b]]+")");return a=k(a),new RegExp("^"+d+"$",["i"])}var m,n,o=angular.extend({},g,i),p={},q={sss:"[0-9]{3}",ss:"[0-5][0-9]",s:o.strict?"[1-5]?[0-9]":"[0-9]|[0-5][0-9]",mm:"[0-5][0-9]",m:o.strict?"[1-5]?[0-9]":"[0-9]|[0-5][0-9]",HH:"[01][0-9]|2[0-3]",H:o.strict?"1?[0-9]|2[0-3]":"[01]?[0-9]|2[0-3]",hh:"[0][1-9]|[1][012]",h:o.strict?"[1-9]|1[012]":"0?[1-9]|1[012]",a:"AM|PM",EEEE:a.DATETIME_FORMATS.DAY.join("|"),EEE:a.DATETIME_FORMATS.SHORTDAY.join("|"),dd:"0[1-9]|[12][0-9]|3[01]",d:o.strict?"[1-9]|[1-2][0-9]|3[01]":"0?[1-9]|[1-2][0-9]|3[01]",MMMM:a.DATETIME_FORMATS.MONTH.join("|"),MMM:a.DATETIME_FORMATS.SHORTMONTH.join("|"),MM:"0[1-9]|1[012]",M:o.strict?"[1-9]|1[012]":"0?[1-9]|1[012]",yyyy:"[1]{1}[0-9]{3}|[2]{1}[0-9]{3}",yy:"[0-9]{2}",y:o.strict?"-?(0|[1-9][0-9]{0,3})":"-?0*[0-9]{1,4}"},r={sss:f.setMilliseconds,ss:f.setSeconds,s:f.setSeconds,mm:f.setMinutes,m:f.setMinutes,HH:f.setHours,H:f.setHours,hh:f.setHours,h:f.setHours,EEEE:c,EEE:c,dd:f.setDate,d:f.setDate,a:function(a){var b=this.getHours()%12;return this.setHours(a.match(/pm/i)?b+12:b)},MMMM:function(b){return this.setMonth(e(a.DATETIME_FORMATS.MONTH,b))},MMM:function(b){return this.setMonth(e(a.DATETIME_FORMATS.SHORTMONTH,b))},MM:function(a){return this.setMonth(1*a-1)},M:function(a){return this.setMonth(1*a-1)},yyyy:f.setFullYear,yy:function(a){return this.setFullYear(2e3+1*a)},y:f.setFullYear};return p.init=function(){p.$format=a.DATETIME_FORMATS[o.format]||o.format,m=l(p.$format),n=j(p.$format)},p.isValid=function(a){return angular.isDate(a)?!isNaN(a.getTime()):m.test(a)},p.parse=function(c,d,e){e&&(e=a.DATETIME_FORMATS[e]||e),angular.isDate(c)&&(c=h(c,e||p.$format));var f=e?l(e):m,g=e?j(e):n,i=f.exec(c);if(!i)return!1;for(var k=d&&!isNaN(d.getTime())?(new b).fromDate(d):(new b).fromDate(new Date(1970,0,1,0)),o=0;o<i.length-1;o++)g[o]&&g[o].call(k,i[o+1]);var q=k.toDate();return parseInt(k.day,10)!==q.getDate()?!1:q},p.getDateForAttribute=function(a,b){var c;if("today"===b){var e=new Date;c=new Date(e.getFullYear(),e.getMonth(),e.getDate()+("maxDate"===a?1:0),0,0,0,"minDate"===a?0:-1)}else c=angular.isString(b)&&b.match(/^".+"$/)?new Date(b.substr(1,b.length-2)):d(b)?new Date(parseInt(b,10)):angular.isString(b)&&0===b.length?"minDate"===a?-(1/0):+(1/0):new Date(b);return c},p.getTimeForAttribute=function(a,b){var c;return c="now"===b?(new Date).setFullYear(1970,0,1):angular.isString(b)&&b.match(/^".+"$/)?new Date(b.substr(1,b.length-2)).setFullYear(1970,0,1):d(b)?new Date(parseInt(b,10)).setFullYear(1970,0,1):angular.isString(b)&&0===b.length?"minTime"===a?-(1/0):+(1/0):p.parse(b,new Date(1970,0,1,0))},p.daylightSavingAdjust=function(a){return a?(a.setHours(a.getHours()>12?a.getHours()+2:0),a):null},p.init(),p};return i}]}]),angular.module("mgcrea.ngStrap.helpers.debounce",[]).factory("debounce",["$timeout",function(a){return function(b,c,d){var e=null;return function(){var f=this,g=arguments,h=d&&!e;return e&&a.cancel(e),e=a(function(){e=null,d||b.apply(f,g)},c,!1),h&&b.apply(f,g),e}}}]).factory("throttle",["$timeout",function(a){return function(b,c,d){var e=null;return d||(d={}),function(){var f=this,g=arguments;e||(d.leading!==!1&&b.apply(f,g),e=a(function(){e=null,d.trailing!==!1&&b.apply(f,g)},c,!1))}}}]),angular.module("mgcrea.ngStrap.helpers.dimensions",[]).factory("dimensions",["$document","$window",function(b,c){var d=(angular.element,{}),e=d.nodeName=function(a,b){return a.nodeName&&a.nodeName.toLowerCase()===b.toLowerCase()};d.css=function(b,c,d){var e;return e=b.currentStyle?b.currentStyle[c]:a.getComputedStyle?a.getComputedStyle(b)[c]:b.style[c],d===!0?parseFloat(e)||0:e},d.offset=function(b){var c=b.getBoundingClientRect(),d=b.ownerDocument;return{width:c.width||b.offsetWidth,height:c.height||b.offsetHeight,top:c.top+(a.pageYOffset||d.documentElement.scrollTop)-(d.documentElement.clientTop||0),left:c.left+(a.pageXOffset||d.documentElement.scrollLeft)-(d.documentElement.clientLeft||0)}},d.position=function(a){var b,c,g={top:0,left:0};return"fixed"===d.css(a,"position")?c=a.getBoundingClientRect():(b=f(a),c=d.offset(a),e(b,"html")||(g=d.offset(b)),g.top+=d.css(b,"borderTopWidth",!0),g.left+=d.css(b,"borderLeftWidth",!0)),{width:a.offsetWidth,height:a.offsetHeight,top:c.top-g.top-d.css(a,"marginTop",!0),left:c.left-g.left-d.css(a,"marginLeft",!0)}};var f=function(a){var b=a.ownerDocument,c=a.offsetParent||b;if(e(c,"#document"))return b.documentElement;for(;c&&!e(c,"html")&&"static"===d.css(c,"position");)c=c.offsetParent;return c||b.documentElement};return d.height=function(a,b){var c=a.offsetHeight;return b?c+=d.css(a,"marginTop",!0)+d.css(a,"marginBottom",!0):c-=d.css(a,"paddingTop",!0)+d.css(a,"paddingBottom",!0)+d.css(a,"borderTopWidth",!0)+d.css(a,"borderBottomWidth",!0),c},d.width=function(a,b){var c=a.offsetWidth;return b?c+=d.css(a,"marginLeft",!0)+d.css(a,"marginRight",!0):c-=d.css(a,"paddingLeft",!0)+d.css(a,"paddingRight",!0)+d.css(a,"borderLeftWidth",!0)+d.css(a,"borderRightWidth",!0),c},d}]),angular.module("mgcrea.ngStrap.helpers.parseOptions",[]).provider("$parseOptions",function(){var a=this.defaults={regexp:/^\s*(.*?)(?:\s+as\s+(.*?))?(?:\s+group\s+by\s+(.*))?\s+for\s+(?:([\$\w][\$\w]*)|(?:\(\s*([\$\w][\$\w]*)\s*,\s*([\$\w][\$\w]*)\s*\)))\s+in\s+(.*?)(?:\s+track\s+by\s+(.*?))?$/};this.$get=["$parse","$q",function(b,c){function d(d,e){function f(a,b){return a.map(function(a,c){var d,e,f={};return f[k]=a,d=j(b,f),e=n(b,f),{label:d,value:e,index:c}})}var g={},h=angular.extend({},a,e);g.$values=[];var i,j,k,l,m,n,o;return g.init=function(){g.$match=i=d.match(h.regexp),j=b(i[2]||i[1]),k=i[4]||i[6],l=i[5],m=b(i[3]||""),n=b(i[2]?i[1]:k),o=b(i[7])},g.valuesFn=function(a,b){return c.when(o(a,b)).then(function(b){return g.$values=b?f(b,a):{},g.$values})},g.displayValue=function(a){var b={};return b[k]=a,j(b)},g.init(),g}return d}]}),angular.version.minor<3&&angular.version.dot<14&&angular.module("ng").factory("$$rAF",["$window","$timeout",function(a,b){var c=a.requestAnimationFrame||a.webkitRequestAnimationFrame||a.mozRequestAnimationFrame,d=a.cancelAnimationFrame||a.webkitCancelAnimationFrame||a.mozCancelAnimationFrame||a.webkitCancelRequestAnimationFrame,e=!!c,f=e?function(a){var b=c(a);return function(){d(b)}}:function(a){var c=b(a,16.66,!1);return function(){b.cancel(c)}};return f.supported=e,f}]),angular.module("mgcrea.ngStrap.modal",["mgcrea.ngStrap.helpers.dimensions"]).provider("$modal",function(){var a=this.defaults={animation:"am-fade",backdropAnimation:"am-fade",prefixClass:"modal",prefixEvent:"modal",placement:"top",template:"modal/modal.tpl.html",contentTemplate:!1,container:!1,element:null,backdrop:!0,keyboard:!0,html:!1,show:!0};this.$get=["$window","$rootScope","$compile","$q","$templateCache","$http","$animate","$timeout","$sce","dimensions",function(c,d,e,f,g,h,i,j,k,l){function m(b){function c(){m.$emit(l.prefixEvent+".show",j)}function f(){m.$emit(l.prefixEvent+".hide",j),t.removeClass(l.prefixClass+"-open"),l.animation&&t.removeClass(l.prefixClass+"-with-"+l.animation)}function g(a){a.target===a.currentTarget&&("static"===l.backdrop?j.focus():j.hide())}function h(a){a.preventDefault()}var j={},l=j.$options=angular.extend({},a,b);j.$promise=p(l.template);var m=j.$scope=l.scope&&l.scope.$new()||d.$new();l.element||l.container||(l.container="body"),j.$id=l.id||l.element&&l.element.attr("id")||"",q(["title","content"],function(a){l[a]&&(m[a]=k.trustAsHtml(l[a]))}),m.$hide=function(){m.$$postDigest(function(){j.hide()})},m.$show=function(){m.$$postDigest(function(){j.show()})},m.$toggle=function(){m.$$postDigest(function(){j.toggle()})},j.$isShown=m.$isShown=!1,l.contentTemplate&&(j.$promise=j.$promise.then(function(a){var c=angular.element(a);return p(l.contentTemplate).then(function(a){var d=o('[ng-bind="content"]',c[0]).removeAttr("ng-bind").html(a);return b.template||d.next().remove(),c[0].outerHTML})}));var v,w,x=angular.element('<div class="'+l.prefixClass+'-backdrop"/>');return j.$promise.then(function(a){angular.isObject(a)&&(a=a.data),l.html&&(a=a.replace(u,'ng-bind-html="')),a=r.apply(a),v=e(a),j.init()}),j.init=function(){l.show&&m.$$postDigest(function(){j.show()})},j.destroy=function(){w&&(w.remove(),w=null),x&&(x.remove(),x=null),m.$destroy()},j.show=function(){if(!j.$isShown&&!m.$emit(l.prefixEvent+".show.before",j).defaultPrevented){var a,b;angular.isElement(l.container)?(a=l.container,b=l.container[0].lastChild?angular.element(l.container[0].lastChild):null):l.container?(a=o(l.container),b=a[0].lastChild?angular.element(a[0].lastChild):null):(a=null,b=l.element),w=j.$element=v(m,function(a,b){}),w.css({display:"block"}).addClass(l.placement),l.animation&&(l.backdrop&&x.addClass(l.backdropAnimation),w.addClass(l.animation)),l.backdrop&&i.enter(x,t,null);var d=i.enter(w,a,b,c);d&&d.then&&d.then(c),j.$isShown=m.$isShown=!0,n(m);var e=w[0];s(function(){e.focus()}),t.addClass(l.prefixClass+"-open"),l.animation&&t.addClass(l.prefixClass+"-with-"+l.animation),l.backdrop&&(w.on("click",g),x.on("click",g),x.on("wheel",h)),l.keyboard&&w.on("keyup",j.$onKeyUp)}},j.hide=function(){if(j.$isShown&&!m.$emit(l.prefixEvent+".hide.before",j).defaultPrevented){var a=i.leave(w,f);a&&a.then&&a.then(f),l.backdrop&&i.leave(x),j.$isShown=m.$isShown=!1,n(m),l.backdrop&&(w.off("click",g),x.off("click",g),x.off("wheel",h)),l.keyboard&&w.off("keyup",j.$onKeyUp)}},j.toggle=function(){j.$isShown?j.hide():j.show()},j.focus=function(){w[0].focus()},j.$onKeyUp=function(a){27===a.which&&j.$isShown&&(j.hide(),a.stopPropagation())},j}function n(a){a.$$phase||a.$root&&a.$root.$$phase||a.$digest()}function o(a,c){return angular.element((c||b).querySelectorAll(a))}function p(a){return v[a]?v[a]:v[a]=f.when(g.get(a)||h.get(a)).then(function(b){return angular.isObject(b)?(g.put(a,b.data),b.data):b})}var q=angular.forEach,r=String.prototype.trim,s=c.requestAnimationFrame||c.setTimeout,t=angular.element(c.document.body),u=/ng-bind="/gi,v={};return m}]}).directive("bsModal",["$window","$sce","$modal",function(a,b,c){return{restrict:"EAC",scope:!0,link:function(a,d,e,f){var g={scope:a,element:d,show:!1};angular.forEach(["template","contentTemplate","placement","backdrop","keyboard","html","container","animation","id"],function(a){angular.isDefined(e[a])&&(g[a]=e[a])}),angular.forEach(["title","content"],function(c){e[c]&&e.$observe(c,function(d,e){a[c]=b.trustAsHtml(d)})}),e.bsModal&&a.$watch(e.bsModal,function(b,c){angular.isObject(b)?angular.extend(a,b):a.content=b},!0);var h=c(g);d.on(e.trigger||"click",h.toggle),a.$on("$destroy",function(){h&&h.destroy(),g=null,h=null})}}}]),angular.module("mgcrea.ngStrap.navbar",[]).provider("$navbar",function(){var a=this.defaults={activeClass:"active",routeAttr:"data-match-route",strict:!1};this.$get=function(){return{defaults:a}}}).directive("bsNavbar",["$window","$location","$navbar",function(a,b,c){var d=c.defaults;return{restrict:"A",link:function(a,c,e,f){
var g=angular.copy(d);angular.forEach(Object.keys(d),function(a){angular.isDefined(e[a])&&(g[a]=e[a])}),a.$watch(function(){return b.path()},function(a,b){var d=c[0].querySelectorAll("li["+g.routeAttr+"]");angular.forEach(d,function(b){var c=angular.element(b),d=c.attr(g.routeAttr).replace("/","\\/");g.strict&&(d="^"+d+"$");var e=new RegExp(d,["i"]);e.test(a)?c.addClass(g.activeClass):c.removeClass(g.activeClass)})})}}}]),angular.module("mgcrea.ngStrap.popover",["mgcrea.ngStrap.tooltip"]).provider("$popover",function(){var a=this.defaults={animation:"am-fade",customClass:"",container:!1,target:!1,placement:"right",template:"popover/popover.tpl.html",contentTemplate:!1,trigger:"click",keyboard:!0,html:!1,title:"",content:"",delay:0,autoClose:!1};this.$get=["$tooltip",function(b){function c(c,d){var e=angular.extend({},a,d),f=b(c,e);return e.content&&(f.$scope.content=e.content),f}return c}]}).directive("bsPopover",["$window","$sce","$popover",function(a,b,c){var d=a.requestAnimationFrame||a.setTimeout;return{restrict:"EAC",scope:!0,link:function(a,e,f){var g={scope:a};angular.forEach(["template","contentTemplate","placement","container","target","delay","trigger","keyboard","html","animation","customClass","autoClose","id"],function(a){angular.isDefined(f[a])&&(g[a]=f[a])}),angular.forEach(["title","content"],function(c){f[c]&&f.$observe(c,function(e,f){a[c]=b.trustAsHtml(e),angular.isDefined(f)&&d(function(){h&&h.$applyPlacement()})})}),f.bsPopover&&a.$watch(f.bsPopover,function(b,c){angular.isObject(b)?angular.extend(a,b):a.content=b,angular.isDefined(c)&&d(function(){h&&h.$applyPlacement()})},!0),f.bsShow&&a.$watch(f.bsShow,function(a,b){h&&angular.isDefined(a)&&(angular.isString(a)&&(a=!!a.match(/true|,?(popover),?/i)),a===!0?h.show():h.hide())});var h=c(e,g);a.$on("$destroy",function(){h&&h.destroy(),g=null,h=null})}}}]),angular.module("mgcrea.ngStrap.select",["mgcrea.ngStrap.tooltip","mgcrea.ngStrap.helpers.parseOptions"]).provider("$select",function(){var a=this.defaults={animation:"am-fade",prefixClass:"select",prefixEvent:"$select",placement:"bottom-left",template:"select/select.tpl.html",trigger:"focus",container:!1,keyboard:!0,html:!1,delay:0,multiple:!1,allNoneButtons:!1,sort:!0,caretHtml:'&nbsp;<span class="caret"></span>',placeholder:"Choose among the following...",allText:"All",noneText:"None",maxLength:3,maxLengthHtml:"selected",iconCheckmark:"glyphicon glyphicon-ok"};this.$get=["$window","$document","$rootScope","$tooltip","$timeout",function(b,c,d,e,f){function g(b,c,d){var g={},h=angular.extend({},a,d);g=e(b,h);var j=g.$scope;j.$matches=[],j.$activeIndex=0,j.$isMultiple=h.multiple,j.$showAllNoneButtons=h.allNoneButtons&&h.multiple,j.$iconCheckmark=h.iconCheckmark,j.$allText=h.allText,j.$noneText=h.noneText,j.$activate=function(a){j.$$postDigest(function(){g.activate(a)})},j.$select=function(a,b){j.$$postDigest(function(){g.select(a)})},j.$isVisible=function(){return g.$isVisible()},j.$isActive=function(a){return g.$isActive(a)},j.$selectAll=function(){for(var a=0;a<j.$matches.length;a++)j.$isActive(a)||j.$select(a)},j.$selectNone=function(){for(var a=0;a<j.$matches.length;a++)j.$isActive(a)&&j.$select(a)},g.update=function(a){j.$matches=a,g.$updateActiveIndex()},g.activate=function(a){return h.multiple?(j.$activeIndex.sort(),g.$isActive(a)?j.$activeIndex.splice(j.$activeIndex.indexOf(a),1):j.$activeIndex.push(a),h.sort&&j.$activeIndex.sort()):j.$activeIndex=a,j.$activeIndex},g.select=function(a){var b=j.$matches[a].value;j.$apply(function(){g.activate(a),h.multiple?c.$setViewValue(j.$activeIndex.map(function(a){return j.$matches[a].value})):(c.$setViewValue(b),g.hide())}),j.$emit(h.prefixEvent+".select",b,a,g)},g.$updateActiveIndex=function(){c.$modelValue&&j.$matches.length?h.multiple&&angular.isArray(c.$modelValue)?j.$activeIndex=c.$modelValue.map(function(a){return g.$getIndex(a)}):j.$activeIndex=g.$getIndex(c.$modelValue):j.$activeIndex>=j.$matches.length&&(j.$activeIndex=h.multiple?[]:0)},g.$isVisible=function(){return h.minLength&&c?j.$matches.length&&c.$viewValue.length>=h.minLength:j.$matches.length},g.$isActive=function(a){return h.multiple?-1!==j.$activeIndex.indexOf(a):j.$activeIndex===a},g.$getIndex=function(a){var b=j.$matches.length,c=b;if(b){for(c=b;c--&&j.$matches[c].value!==a;);if(!(0>c))return c}},g.$onMouseDown=function(a){if(a.preventDefault(),a.stopPropagation(),i){var b=angular.element(a.target);b.triggerHandler("click")}},g.$onKeyDown=function(a){if(/(9|13|38|40)/.test(a.keyCode)){if(a.preventDefault(),a.stopPropagation(),!h.multiple&&(13===a.keyCode||9===a.keyCode))return g.select(j.$activeIndex);38===a.keyCode&&j.$activeIndex>0?j.$activeIndex--:40===a.keyCode&&j.$activeIndex<j.$matches.length-1?j.$activeIndex++:angular.isUndefined(j.$activeIndex)&&(j.$activeIndex=0),j.$digest()}};var k=g.show;g.show=function(){k(),h.multiple&&g.$element.addClass("select-multiple"),f(function(){g.$element.on(i?"touchstart":"mousedown",g.$onMouseDown),h.keyboard&&b.on("keydown",g.$onKeyDown)},0,!1)};var l=g.hide;return g.hide=function(){g.$element.off(i?"touchstart":"mousedown",g.$onMouseDown),h.keyboard&&b.off("keydown",g.$onKeyDown),l(!0)},g}var h=(angular.element(b.document.body),/(ip(a|o)d|iphone|android)/gi.test(b.navigator.userAgent)),i="createTouch"in b.document&&h;return g.defaults=a,g}]}).directive("bsSelect",["$window","$parse","$q","$select","$parseOptions",function(a,b,c,d,e){var f=d.defaults;return{restrict:"EAC",require:"ngModel",link:function(a,b,c,g){var h={scope:a,placeholder:f.placeholder};if(angular.forEach(["placement","container","delay","trigger","keyboard","html","animation","template","placeholder","multiple","allNoneButtons","maxLength","maxLengthHtml","allText","noneText","iconCheckmark","autoClose","id"],function(a){angular.isDefined(c[a])&&(h[a]=c[a])}),"select"===b[0].nodeName.toLowerCase()){var i=b;i.css("display","none"),b=angular.element('<button type="button" class="btn btn-default"></button>'),i.after(b)}var j=e(c.ngOptions),k=d(b,g,h),l=j.$match[7].replace(/\|.+/,"").trim();a.$watch(l,function(b,c){j.valuesFn(a,g).then(function(a){k.update(a),g.$render()})},!0),a.$watch(c.ngModel,function(a,b){k.$updateActiveIndex(),g.$render()},!0),g.$render=function(){var a,c;h.multiple&&angular.isArray(g.$modelValue)?(a=g.$modelValue.map(function(a){return c=k.$getIndex(a),angular.isDefined(c)?k.$scope.$matches[c].label:!1}).filter(angular.isDefined),a=a.length>(h.maxLength||f.maxLength)?a.length+" "+(h.maxLengthHtml||f.maxLengthHtml):a.join(", ")):(c=k.$getIndex(g.$modelValue),a=angular.isDefined(c)?k.$scope.$matches[c].label:!1),b.html((a?a:h.placeholder)+f.caretHtml)},h.multiple&&(g.$isEmpty=function(a){return!a||0===a.length}),a.$on("$destroy",function(){k&&k.destroy(),h=null,k=null})}}}]),angular.module("mgcrea.ngStrap.tab",[]).provider("$tab",function(){var a=this.defaults={animation:"am-fade",template:"tab/tab.tpl.html",navClass:"nav-tabs",activeClass:"active"},b=this.controller=function(b,c,d){var e=this;e.$options=angular.copy(a),angular.forEach(["animation","navClass","activeClass"],function(a){angular.isDefined(d[a])&&(e.$options[a]=d[a])}),b.$navClass=e.$options.navClass,b.$activeClass=e.$options.activeClass,e.$panes=b.$panes=[],e.$activePaneChangeListeners=e.$viewChangeListeners=[],e.$push=function(a){e.$panes.push(a)},e.$remove=function(a){var b=e.$panes.indexOf(a),c=e.$panes.$active;e.$panes.splice(b,1),c>b?c--:b===c&&c===e.$panes.length&&c--,e.$setActive(c)},e.$panes.$active=0,e.$setActive=b.$setActive=function(a){e.$panes.$active=a,e.$activePaneChangeListeners.forEach(function(a){a()})}};this.$get=function(){var c={};return c.defaults=a,c.controller=b,c}}).directive("bsTabs",["$window","$animate","$tab","$parse",function(a,b,c,d){var e=c.defaults;return{require:["?ngModel","bsTabs"],transclude:!0,scope:!0,controller:["$scope","$element","$attrs",c.controller],templateUrl:function(a,b){return b.template||e.template},link:function(a,b,c,e){var f=e[0],g=e[1];if(f&&(console.warn("Usage of ngModel is deprecated, please use bsActivePane instead!"),g.$activePaneChangeListeners.push(function(){f.$setViewValue(g.$panes.$active)}),f.$formatters.push(function(a){return g.$setActive(1*a),a})),c.bsActivePane){var h=d(c.bsActivePane);g.$activePaneChangeListeners.push(function(){h.assign(a,g.$panes.$active)}),a.$watch(c.bsActivePane,function(a,b){g.$setActive(1*a)},!0)}}}}]).directive("bsPane",["$window","$animate","$sce",function(a,b,c){return{require:["^?ngModel","^bsTabs"],scope:!0,link:function(a,d,e,f){function g(){var c=h.$panes.indexOf(a),e=h.$panes.$active;b[c===e?"addClass":"removeClass"](d,h.$options.activeClass)}var h=(f[0],f[1]);d.addClass("tab-pane"),e.$observe("title",function(b,d){a.title=c.trustAsHtml(b)}),h.$options.animation&&d.addClass(h.$options.animation),h.$push(a),a.$on("$destroy",function(){h.$remove(a)}),h.$activePaneChangeListeners.push(function(){g()}),g()}}}]),angular.module("mgcrea.ngStrap.scrollspy",["mgcrea.ngStrap.helpers.debounce","mgcrea.ngStrap.helpers.dimensions"]).provider("$scrollspy",function(){var a=this.$$spies={},c=this.defaults={debounce:150,throttle:100,offset:100};this.$get=["$window","$document","$rootScope","dimensions","debounce","throttle",function(d,e,f,g,h,i){function j(a,b){return a[0].nodeName&&a[0].nodeName.toLowerCase()===b.toLowerCase()}function k(e){var k=angular.extend({},c,e);k.element||(k.element=n);var o=j(k.element,"body"),p=o?l:k.element,q=o?"window":k.id;if(a[q])return a[q].$$count++,a[q];var r,s,t,u,v,w,x,y,z={},A=z.$trackedElements=[],B=[];return z.init=function(){this.$$count=1,u=h(this.checkPosition,k.debounce),v=i(this.checkPosition,k.throttle),p.on("click",this.checkPositionWithEventLoop),l.on("resize",u),p.on("scroll",v),w=h(this.checkOffsets,k.debounce),r=f.$on("$viewContentLoaded",w),s=f.$on("$includeContentLoaded",w),w(),q&&(a[q]=z)},z.destroy=function(){this.$$count--,this.$$count>0||(p.off("click",this.checkPositionWithEventLoop),l.off("resize",u),p.off("scroll",v),r(),s(),q&&delete a[q])},z.checkPosition=function(){if(B.length){if(y=(o?d.pageYOffset:p.prop("scrollTop"))||0,x=Math.max(d.innerHeight,m.prop("clientHeight")),y<B[0].offsetTop&&t!==B[0].target)return z.$activateElement(B[0]);for(var a=B.length;a--;)if(!angular.isUndefined(B[a].offsetTop)&&null!==B[a].offsetTop&&t!==B[a].target&&!(y<B[a].offsetTop||B[a+1]&&y>B[a+1].offsetTop))return z.$activateElement(B[a])}},z.checkPositionWithEventLoop=function(){setTimeout(z.checkPosition,1)},z.$activateElement=function(a){if(t){var b=z.$getTrackedElement(t);b&&(b.source.removeClass("active"),j(b.source,"li")&&j(b.source.parent().parent(),"li")&&b.source.parent().parent().removeClass("active"))}t=a.target,a.source.addClass("active"),j(a.source,"li")&&j(a.source.parent().parent(),"li")&&a.source.parent().parent().addClass("active")},z.$getTrackedElement=function(a){return A.filter(function(b){return b.target===a})[0]},z.checkOffsets=function(){angular.forEach(A,function(a){var c=b.querySelector(a.target);a.offsetTop=c?g.offset(c).top:null,k.offset&&null!==a.offsetTop&&(a.offsetTop-=1*k.offset)}),B=A.filter(function(a){return null!==a.offsetTop}).sort(function(a,b){return a.offsetTop-b.offsetTop}),u()},z.trackElement=function(a,b){A.push({target:a,source:b})},z.untrackElement=function(a,b){for(var c,d=A.length;d--;)if(A[d].target===a&&A[d].source===b){c=d;break}A=A.splice(c,1)},z.activate=function(a){A[a].addClass("active")},z.init(),z}var l=angular.element(d),m=angular.element(e.prop("documentElement")),n=angular.element(d.document.body);return k}]}).directive("bsScrollspy",["$rootScope","debounce","dimensions","$scrollspy",function(a,b,c,d){return{restrict:"EAC",link:function(a,b,c){var e={scope:a};angular.forEach(["offset","target"],function(a){angular.isDefined(c[a])&&(e[a]=c[a])});var f=d(e);f.trackElement(e.target,b),a.$on("$destroy",function(){f&&(f.untrackElement(e.target,b),f.destroy()),e=null,f=null})}}}]).directive("bsScrollspyList",["$rootScope","debounce","dimensions","$scrollspy",function(a,b,c,d){return{restrict:"A",compile:function(a,b){var c=a[0].querySelectorAll("li > a[href]");angular.forEach(c,function(a){var b=angular.element(a);b.parent().attr("bs-scrollspy","").attr("data-target",b.attr("href"))})}}}]),angular.module("mgcrea.ngStrap.timepicker",["mgcrea.ngStrap.helpers.dateParser","mgcrea.ngStrap.helpers.dateFormatter","mgcrea.ngStrap.tooltip"]).provider("$timepicker",function(){var a=this.defaults={animation:"am-fade",prefixClass:"timepicker",placement:"bottom-left",template:"timepicker/timepicker.tpl.html",trigger:"focus",container:!1,keyboard:!0,html:!1,delay:0,useNative:!0,timeType:"date",timeFormat:"shortTime",modelTimeFormat:null,autoclose:!1,minTime:-(1/0),maxTime:+(1/0),length:5,hourStep:1,minuteStep:5,iconUp:"glyphicon glyphicon-chevron-up",iconDown:"glyphicon glyphicon-chevron-down",arrowBehavior:"pager"};this.$get=["$window","$document","$rootScope","$sce","$dateFormatter","$tooltip","$timeout",function(b,c,d,e,f,g,h){function i(b,c,d){function e(a,c){if(b[0].createTextRange){var d=b[0].createTextRange();d.collapse(!0),d.moveStart("character",a),d.moveEnd("character",c),d.select()}else b[0].setSelectionRange?b[0].setSelectionRange(a,c):angular.isUndefined(b[0].selectionStart)&&(b[0].selectionStart=a,b[0].selectionEnd=c)}function i(){b[0].focus()}var l=g(b,angular.extend({},a,d)),m=d.scope,n=l.$options,o=l.$scope,p=n.lang,q=function(a,b){return f.formatDate(a,b,p)},r=0,s=c.$dateValue||new Date,t={hour:s.getHours(),meridian:s.getHours()<12,minute:s.getMinutes(),second:s.getSeconds(),millisecond:s.getMilliseconds()},u=f.getDatetimeFormat(n.timeFormat,p),v=f.hoursFormat(u),w=f.timeSeparator(u),x=f.minutesFormat(u),y=f.showAM(u);o.$iconUp=n.iconUp,o.$iconDown=n.iconDown,o.$select=function(a,b){l.select(a,b)},o.$moveIndex=function(a,b){l.$moveIndex(a,b)},o.$switchMeridian=function(a){l.switchMeridian(a)},l.update=function(a){angular.isDate(a)&&!isNaN(a.getTime())?(l.$date=a,angular.extend(t,{hour:a.getHours(),minute:a.getMinutes(),second:a.getSeconds(),millisecond:a.getMilliseconds()}),l.$build()):l.$isBuilt||l.$build()},l.select=function(a,b,d){c.$dateValue&&!isNaN(c.$dateValue.getTime())||(c.$dateValue=new Date(1970,0,1)),angular.isDate(a)||(a=new Date(a)),0===b?c.$dateValue.setHours(a.getHours()):1===b&&c.$dateValue.setMinutes(a.getMinutes()),c.$setViewValue(angular.copy(c.$dateValue)),c.$render(),n.autoclose&&!d&&h(function(){l.hide(!0)})},l.switchMeridian=function(a){if(c.$dateValue&&!isNaN(c.$dateValue.getTime())){var b=(a||c.$dateValue).getHours();c.$dateValue.setHours(12>b?b+12:b-12),c.$setViewValue(angular.copy(c.$dateValue)),c.$render()}},l.$build=function(){var a,b,c=o.midIndex=parseInt(n.length/2,10),d=[];for(a=0;a<n.length;a++)b=new Date(1970,0,1,t.hour-(c-a)*n.hourStep),d.push({date:b,label:q(b,v),selected:l.$date&&l.$isSelected(b,0),disabled:l.$isDisabled(b,0)});var e,f=[];for(a=0;a<n.length;a++)e=new Date(1970,0,1,0,t.minute-(c-a)*n.minuteStep),f.push({date:e,label:q(e,x),selected:l.$date&&l.$isSelected(e,1),disabled:l.$isDisabled(e,1)});var g=[];for(a=0;a<n.length;a++)g.push([d[a],f[a]]);o.rows=g,o.showAM=y,o.isAM=(l.$date||d[c].date).getHours()<12,o.timeSeparator=w,l.$isBuilt=!0},l.$isSelected=function(a,b){return l.$date?0===b?a.getHours()===l.$date.getHours():1===b?a.getMinutes()===l.$date.getMinutes():void 0:!1},l.$isDisabled=function(a,b){var c;return 0===b?c=a.getTime()+6e4*t.minute:1===b&&(c=a.getTime()+36e5*t.hour),c<1*n.minTime||c>1*n.maxTime},o.$arrowAction=function(a,b){"picker"===n.arrowBehavior?l.$setTimeByStep(a,b):l.$moveIndex(a,b)},l.$setTimeByStep=function(a,b){var c=new Date(l.$date),d=c.getHours(),e=(q(c,v).length,c.getMinutes());q(c,x).length;0===b?c.setHours(d-parseInt(n.hourStep,10)*a):c.setMinutes(e-parseInt(n.minuteStep,10)*a),l.select(c,b,!0)},l.$moveIndex=function(a,b){var c;0===b?(c=new Date(1970,0,1,t.hour+a*n.length,t.minute),angular.extend(t,{hour:c.getHours()})):1===b&&(c=new Date(1970,0,1,t.hour,t.minute+a*n.length*n.minuteStep),angular.extend(t,{minute:c.getMinutes()})),l.$build()},l.$onMouseDown=function(a){if("input"!==a.target.nodeName.toLowerCase()&&a.preventDefault(),a.stopPropagation(),k){var b=angular.element(a.target);"button"!==b[0].nodeName.toLowerCase()&&(b=b.parent()),b.triggerHandler("click")}},l.$onKeyDown=function(a){if(/(38|37|39|40|13)/.test(a.keyCode)&&!a.shiftKey&&!a.altKey){if(a.preventDefault(),a.stopPropagation(),13===a.keyCode)return l.hide(!0);var b=new Date(l.$date),c=b.getHours(),d=q(b,v).length,f=b.getMinutes(),g=q(b,x).length,h=/(37|39)/.test(a.keyCode),i=2+1*y;h&&(37===a.keyCode?r=1>r?i-1:r-1:39===a.keyCode&&(r=i-1>r?r+1:0));var j=[0,d];0===r?(38===a.keyCode?b.setHours(c-parseInt(n.hourStep,10)):40===a.keyCode&&b.setHours(c+parseInt(n.hourStep,10)),d=q(b,v).length,j=[0,d]):1===r?(38===a.keyCode?b.setMinutes(f-parseInt(n.minuteStep,10)):40===a.keyCode&&b.setMinutes(f+parseInt(n.minuteStep,10)),g=q(b,x).length,j=[d+1,d+1+g]):2===r&&(h||l.switchMeridian(),j=[d+1+g+1,d+1+g+3]),l.select(b,r,!0),e(j[0],j[1]),m.$digest()}};var z=l.init;l.init=function(){return j&&n.useNative?(b.prop("type","time"),void b.css("-webkit-appearance","textfield")):(k&&(b.prop("type","text"),b.attr("readonly","true"),b.on("click",i)),void z())};var A=l.destroy;l.destroy=function(){j&&n.useNative&&b.off("click",i),A()};var B=l.show;l.show=function(){B(),h(function(){l.$element.on(k?"touchstart":"mousedown",l.$onMouseDown),n.keyboard&&b.on("keydown",l.$onKeyDown)},0,!1)};var C=l.hide;return l.hide=function(a){l.$isShown&&(l.$element.off(k?"touchstart":"mousedown",l.$onMouseDown),n.keyboard&&b.off("keydown",l.$onKeyDown),C(a))},l}var j=(angular.element(b.document.body),/(ip(a|o)d|iphone|android)/gi.test(b.navigator.userAgent)),k="createTouch"in b.document&&j;return a.lang||(a.lang=f.getDefaultLocale()),i.defaults=a,i}]}).directive("bsTimepicker",["$window","$parse","$q","$dateFormatter","$dateParser","$timepicker",function(a,b,c,d,e,f){var g=f.defaults,h=/(ip(a|o)d|iphone|android)/gi.test(a.navigator.userAgent);a.requestAnimationFrame||a.setTimeout;return{restrict:"EAC",require:"ngModel",link:function(a,b,c,i){function j(a){if(angular.isDate(a)){var b=isNaN(l.minTime)||new Date(a.getTime()).setFullYear(1970,0,1)>=l.minTime,c=isNaN(l.maxTime)||new Date(a.getTime()).setFullYear(1970,0,1)<=l.maxTime,d=b&&c;i.$setValidity("date",d),i.$setValidity("min",b),i.$setValidity("max",c),d&&(i.$dateValue=a)}}function k(){return!i.$dateValue||isNaN(i.$dateValue.getTime())?"":o(i.$dateValue,l.timeFormat)}var l={scope:a,controller:i};angular.forEach(["placement","container","delay","trigger","keyboard","html","animation","template","autoclose","timeType","timeFormat","modelTimeFormat","useNative","hourStep","minuteStep","length","arrowBehavior","iconUp","iconDown","id"],function(a){angular.isDefined(c[a])&&(l[a]=c[a])}),c.bsShow&&a.$watch(c.bsShow,function(a,b){m&&angular.isDefined(a)&&(angular.isString(a)&&(a=!!a.match(/true|,?(timepicker),?/i)),a===!0?m.show():m.hide())}),h&&(l.useNative||g.useNative)&&(l.timeFormat="HH:mm");var m=f(b,i,l);l=m.$options;var n=l.lang,o=function(a,b){return d.formatDate(a,b,n)},p=e({format:l.timeFormat,lang:n});angular.forEach(["minTime","maxTime"],function(a){angular.isDefined(c[a])&&c.$observe(a,function(b){m.$options[a]=p.getTimeForAttribute(a,b),!isNaN(m.$options[a])&&m.$build(),j(i.$dateValue)})}),a.$watch(c.ngModel,function(a,b){m.update(i.$dateValue)},!0),i.$parsers.unshift(function(a){if(!a)return i.$setValidity("date",!0),null;var b=angular.isDate(a)?a:p.parse(a,i.$dateValue);return!b||isNaN(b.getTime())?void i.$setValidity("date",!1):(j(b),"string"===l.timeType?o(b,l.modelTimeFormat||l.timeFormat):"number"===l.timeType?i.$dateValue.getTime():"unix"===l.timeType?i.$dateValue.getTime()/1e3:"iso"===l.timeType?i.$dateValue.toISOString():new Date(i.$dateValue))}),i.$formatters.push(function(a){var b;return b=angular.isUndefined(a)||null===a?NaN:angular.isDate(a)?a:"string"===l.timeType?p.parse(a,null,l.modelTimeFormat):"unix"===l.timeType?new Date(1e3*a):new Date(a),i.$dateValue=b,k()}),i.$render=function(){b.val(k())},a.$on("$destroy",function(){m&&m.destroy(),l=null,m=null})}}}]),angular.module("mgcrea.ngStrap.tooltip",["mgcrea.ngStrap.helpers.dimensions"]).provider("$tooltip",function(){var a=this.defaults={animation:"am-fade",customClass:"",prefixClass:"tooltip",prefixEvent:"tooltip",container:!1,target:!1,placement:"top",template:"tooltip/tooltip.tpl.html",contentTemplate:!1,trigger:"hover focus",keyboard:!1,html:!1,show:!1,title:"",type:"",delay:0,autoClose:!1,bsEnabled:!0};this.$get=["$window","$rootScope","$compile","$q","$templateCache","$http","$animate","$sce","dimensions","$$rAF","$timeout",function(c,d,e,f,g,h,i,j,k,l,m){function n(c,f){function g(){I.$emit(H.prefixEvent+".show",F)}function h(){if(I.$emit(H.prefixEvent+".hide",F),N===S){if(R&&"focus"===H.trigger)return c[0].blur();E()}}function n(){var a=H.trigger.split(" ");angular.forEach(a,function(a){"click"===a?c.on("click",F.toggle):"manual"!==a&&(c.on("hover"===a?"mouseenter":"focus",F.enter),c.on("hover"===a?"mouseleave":"blur",F.leave),"button"===G&&"hover"!==a&&c.on(s?"touchstart":"mousedown",F.$onFocusElementMouseDown))})}function v(){for(var a=H.trigger.split(" "),b=a.length;b--;){var d=a[b];"click"===d?c.off("click",F.toggle):"manual"!==d&&(c.off("hover"===d?"mouseenter":"focus",F.enter),c.off("hover"===d?"mouseleave":"blur",F.leave),"button"===G&&"hover"!==d&&c.off(s?"touchstart":"mousedown",F.$onFocusElementMouseDown))}}function w(){"focus"!==H.trigger?N.on("keyup",F.$onKeyUp):c.on("keyup",F.$onFocusKeyUp)}function x(){"focus"!==H.trigger?N.off("keyup",F.$onKeyUp):c.off("keyup",F.$onFocusKeyUp)}function y(){m(function(){N.on("click",A),u.on("click",F.hide),T=!0},0,!1)}function z(){T&&(N.off("click",A),u.off("click",F.hide),T=!1)}function A(a){a.stopPropagation()}function B(a){a=a||H.target||c;var b=a[0],d=b.getBoundingClientRect();null===d.width&&(d=angular.extend({},d,{width:d.right-d.left,height:d.bottom-d.top}));var e;return e="body"===H.container?k.offset(b):k.position(b),angular.extend({},d,e)}function C(a,b,c,d){var e,f=a.split("-");switch(f[0]){case"right":e={top:b.top+b.height/2-d/2,left:b.left+b.width};break;case"bottom":e={top:b.top+b.height,left:b.left+b.width/2-c/2};break;case"left":e={top:b.top+b.height/2-d/2,left:b.left-c};break;default:e={top:b.top-d,left:b.left+b.width/2-c/2}}if(!f[1])return e;if("top"===f[0]||"bottom"===f[0])switch(f[1]){case"left":e.left=b.left;break;case"right":e.left=b.left+b.width-c}else if("left"===f[0]||"right"===f[0])switch(f[1]){case"top":e.top=b.top-d;break;case"bottom":e.top=b.top+b.height}return e}function D(a,b){N.css({top:a+"px",left:b+"px"})}function E(){clearTimeout(K),F.$isShown&&null!==N&&(H.autoClose&&z(),H.keyboard&&x()),Q&&(Q.$destroy(),Q=null),N&&(N.remove(),N=F.$element=null)}var F={},G=c[0].nodeName.toLowerCase(),H=F.$options=angular.extend({},a,f);F.$promise=q(H.template);var I=F.$scope=H.scope&&H.scope.$new()||d.$new();if(H.delay&&angular.isString(H.delay)){var J=H.delay.split(",").map(parseFloat);H.delay=J.length>1?{show:J[0],hide:J[1]}:J[0]}F.$id=H.id||c.attr("id")||"",H.title&&(I.title=j.trustAsHtml(H.title)),I.$setEnabled=function(a){I.$$postDigest(function(){F.setEnabled(a)})},I.$hide=function(){I.$$postDigest(function(){F.hide()})},I.$show=function(){I.$$postDigest(function(){F.show()})},I.$toggle=function(){I.$$postDigest(function(){F.toggle()})},F.$isShown=I.$isShown=!1;var K,L;H.contentTemplate&&(F.$promise=F.$promise.then(function(a){var b=angular.element(a);return q(H.contentTemplate).then(function(a){var c=p('[ng-bind="content"]',b[0]);return c.length||(c=p('[ng-bind="title"]',b[0])),c.removeAttr("ng-bind").html(a),b[0].outerHTML})}));var M,N,O,P,Q;F.$promise.then(function(a){angular.isObject(a)&&(a=a.data),H.html&&(a=a.replace(t,'ng-bind-html="')),a=r.apply(a),O=a,M=e(a),F.init()}),F.init=function(){H.delay&&angular.isNumber(H.delay)&&(H.delay={show:H.delay,hide:H.delay}),"self"===H.container?P=c:angular.isElement(H.container)?P=H.container:H.container&&(P=p(H.container)),n(),H.target&&(H.target=angular.isElement(H.target)?H.target:p(H.target)),H.show&&I.$$postDigest(function(){"focus"===H.trigger?c[0].focus():F.show()})},F.destroy=function(){v(),E(),I.$destroy()},F.enter=function(){return clearTimeout(K),L="in",H.delay&&H.delay.show?void(K=setTimeout(function(){"in"===L&&F.show()},H.delay.show)):F.show()},F.show=function(){if(H.bsEnabled&&!F.$isShown){I.$emit(H.prefixEvent+".show.before",F);var a,b;H.container?(a=P,b=P[0].lastChild?angular.element(P[0].lastChild):null):(a=null,b=c),N&&E(),Q=F.$scope.$new(),N=F.$element=M(Q,function(a,b){}),N.css({top:"-9999px",left:"-9999px",display:"block",visibility:"hidden"}),H.animation&&N.addClass(H.animation),H.type&&N.addClass(H.prefixClass+"-"+H.type),H.customClass&&N.addClass(H.customClass);var d=i.enter(N,a,b,g);d&&d.then&&d.then(g),F.$isShown=I.$isShown=!0,o(I),l(function(){F.$applyPlacement(),N&&N.css({visibility:"visible"})}),H.keyboard&&("focus"!==H.trigger&&F.focus(),w()),H.autoClose&&y()}},F.leave=function(){return clearTimeout(K),L="out",H.delay&&H.delay.hide?void(K=setTimeout(function(){"out"===L&&F.hide()},H.delay.hide)):F.hide()};var R,S;F.hide=function(a){if(F.$isShown){I.$emit(H.prefixEvent+".hide.before",F),R=a,S=N;var b=i.leave(N,h);b&&b.then&&b.then(h),F.$isShown=I.$isShown=!1,o(I),H.keyboard&&null!==N&&x(),H.autoClose&&null!==N&&z()}},F.toggle=function(){F.$isShown?F.leave():F.enter()},F.focus=function(){N[0].focus()},F.setEnabled=function(a){H.bsEnabled=a},F.$applyPlacement=function(){if(N){var d=H.placement,e=/\s?auto?\s?/i,f=e.test(d);f&&(d=d.replace(e,"")||a.placement),N.addClass(H.placement);var g=B(),h=N.prop("offsetWidth"),i=N.prop("offsetHeight");if(f){var j=d,k=H.container?angular.element(b.querySelector(H.container)):c.parent(),l=B(k);j.indexOf("bottom")>=0&&g.bottom+i>l.bottom?d=j.replace("bottom","top"):j.indexOf("top")>=0&&g.top-i<l.top&&(d=j.replace("top","bottom")),("right"===j||"bottom-left"===j||"top-left"===j)&&g.right+h>l.width?d="right"===j?"left":d.replace("left","right"):("left"===j||"bottom-right"===j||"top-right"===j)&&g.left-h<l.left&&(d="left"===j?"right":d.replace("right","left")),N.removeClass(j).addClass(d)}var m=C(d,g,h,i);D(m.top,m.left)}},F.$onKeyUp=function(a){27===a.which&&F.$isShown&&(F.hide(),a.stopPropagation())},F.$onFocusKeyUp=function(a){27===a.which&&(c[0].blur(),a.stopPropagation())},F.$onFocusElementMouseDown=function(a){a.preventDefault(),a.stopPropagation(),F.$isShown?c[0].blur():c[0].focus()};var T=!1;return F}function o(a){a.$$phase||a.$root&&a.$root.$$phase||a.$digest()}function p(a,c){return angular.element((c||b).querySelectorAll(a))}function q(a){return v[a]?v[a]:v[a]=f.when(g.get(a)||h.get(a)).then(function(b){return angular.isObject(b)?(g.put(a,b.data),b.data):b})}var r=String.prototype.trim,s="createTouch"in c.document,t=/ng-bind="/gi,u=angular.element(c.document),v={};return n}]}).directive("bsTooltip",["$window","$location","$sce","$tooltip","$$rAF",function(a,b,c,d,e){return{restrict:"EAC",scope:!0,link:function(a,b,f,g){var h={scope:a};angular.forEach(["template","contentTemplate","placement","container","target","delay","trigger","keyboard","html","animation","backdropAnimation","type","customClass","id"],function(a){angular.isDefined(f[a])&&(h[a]=f[a])}),a.hasOwnProperty("title")||(a.title=""),f.$observe("title",function(b){if(angular.isDefined(b)||!a.hasOwnProperty("title")){var d=a.title;a.title=c.trustAsHtml(b),angular.isDefined(d)&&e(function(){i&&i.$applyPlacement()})}}),f.bsTooltip&&a.$watch(f.bsTooltip,function(b,c){angular.isObject(b)?angular.extend(a,b):a.title=b,angular.isDefined(c)&&e(function(){i&&i.$applyPlacement()})},!0),f.bsShow&&a.$watch(f.bsShow,function(a,b){i&&angular.isDefined(a)&&(angular.isString(a)&&(a=!!a.match(/true|,?(tooltip),?/i)),a===!0?i.show():i.hide())}),f.bsEnabled&&a.$watch(f.bsEnabled,function(a,b){i&&angular.isDefined(a)&&(angular.isString(a)&&(a=!!a.match(/true|1|,?(tooltip),?/i)),a===!1?i.setEnabled(!1):i.setEnabled(!0))});var i=d(b,h);a.$on("$destroy",function(){i&&i.destroy(),h=null,i=null})}}}]),angular.module("mgcrea.ngStrap.typeahead",["mgcrea.ngStrap.tooltip","mgcrea.ngStrap.helpers.parseOptions"]).provider("$typeahead",function(){var a=this.defaults={animation:"am-fade",prefixClass:"typeahead",prefixEvent:"$typeahead",placement:"bottom-left",template:"typeahead/typeahead.tpl.html",trigger:"focus",container:!1,keyboard:!0,html:!1,delay:0,minLength:1,filter:"filter",limit:6,comparator:""};this.$get=["$window","$rootScope","$tooltip","$timeout",function(b,c,d,e){function f(b,c,f){var g={},h=angular.extend({},a,f);g=d(b,h);var i=f.scope,j=g.$scope;j.$resetMatches=function(){j.$matches=[],j.$activeIndex=0},j.$resetMatches(),j.$activate=function(a){j.$$postDigest(function(){g.activate(a)})},j.$select=function(a,b){j.$$postDigest(function(){g.select(a)})},j.$isVisible=function(){return g.$isVisible()},g.update=function(a){j.$matches=a,j.$activeIndex>=a.length&&(j.$activeIndex=0)},g.activate=function(a){j.$activeIndex=a},g.select=function(a){var b=j.$matches[a].value;c.$setViewValue(b),c.$render(),j.$resetMatches(),i&&i.$digest(),j.$emit(h.prefixEvent+".select",b,a,g)},g.$isVisible=function(){return h.minLength&&c?j.$matches.length&&angular.isString(c.$viewValue)&&c.$viewValue.length>=h.minLength:!!j.$matches.length},g.$getIndex=function(a){var b=j.$matches.length,c=b;if(b){for(c=b;c--&&j.$matches[c].value!==a;);if(!(0>c))return c}},g.$onMouseDown=function(a){a.preventDefault(),a.stopPropagation()},g.$onKeyDown=function(a){/(38|40|13)/.test(a.keyCode)&&(g.$isVisible()&&(a.preventDefault(),a.stopPropagation()),13===a.keyCode&&j.$matches.length?g.select(j.$activeIndex):38===a.keyCode&&j.$activeIndex>0?j.$activeIndex--:40===a.keyCode&&j.$activeIndex<j.$matches.length-1?j.$activeIndex++:angular.isUndefined(j.$activeIndex)&&(j.$activeIndex=0),j.$digest())};var k=g.show;g.show=function(){k(),e(function(){g.$element.on("mousedown",g.$onMouseDown),h.keyboard&&b.on("keydown",g.$onKeyDown)},0,!1)};var l=g.hide;return g.hide=function(){g.$element.off("mousedown",g.$onMouseDown),h.keyboard&&b.off("keydown",g.$onKeyDown),l()},g}angular.element(b.document.body);return f.defaults=a,f}]}).directive("bsTypeahead",["$window","$parse","$q","$typeahead","$parseOptions",function(a,b,d,e,f){var g=e.defaults;return{restrict:"EAC",require:"ngModel",link:function(a,b,d,h){var i={scope:a};angular.forEach(["placement","container","delay","trigger","keyboard","html","animation","template","filter","limit","minLength","watchOptions","selectMode","comparator","id"],function(a){angular.isDefined(d[a])&&(i[a]=d[a])});var j=i.filter||g.filter,k=i.limit||g.limit,l=i.comparator||g.comparator,m=d.ngOptions;j&&(m+=" | "+j+":$viewValue"),l&&(m+=":"+l),k&&(m+=" | limitTo:"+k);var n=f(m),o=e(b,h,i);if(i.watchOptions){var p=n.$match[7].replace(/\|.+/,"").replace(/\(.*\)/g,"").trim();a.$watch(p,function(b,c){n.valuesFn(a,h).then(function(a){o.update(a),h.$render()})},!0)}a.$watch(d.ngModel,function(b,c){a.$modelValue=b,n.valuesFn(a,h).then(function(a){if(i.selectMode&&!a.length&&b.length>0)return void h.$setViewValue(h.$viewValue.substring(0,h.$viewValue.length-1));a.length>k&&(a=a.slice(0,k));var c=o.$isVisible();c&&o.update(a),1===a.length&&a[0].value===b||(!c&&o.update(a),h.$render())})}),h.$formatters.push(function(a){var b=n.displayValue(a);return b===c?"":b}),h.$render=function(){if(h.$isEmpty(h.$viewValue))return b.val("");var a=o.$getIndex(h.$modelValue),c=angular.isDefined(a)?o.$scope.$matches[a].label:h.$viewValue;c=angular.isObject(c)?n.displayValue(c):c,b.val(c?c.toString().replace(/<(?:.|\n)*?>/gm,"").trim():"")},a.$on("$destroy",function(){o&&o.destroy(),i=null,o=null})}}}])}(window,document),function(a,b,c){"use strict";angular.module("mgcrea.ngStrap.alert").run(["$templateCache",function(a){a.put("alert/alert.tpl.html",'<div class="alert" ng-class="[type ? \'alert-\' + type : null]"><button type="button" class="close" ng-if="dismissable" ng-click="$hide()">&times;</button> <strong ng-bind="title"></strong>&nbsp;<span ng-bind-html="content"></span></div>');
}]),angular.module("mgcrea.ngStrap.aside").run(["$templateCache",function(a){a.put("aside/aside.tpl.html",'<div class="aside" tabindex="-1" role="dialog"><div class="aside-dialog"><div class="aside-content"><div class="aside-header" ng-show="title"><button type="button" class="close" ng-click="$hide()">&times;</button><h4 class="aside-title" ng-bind="title"></h4></div><div class="aside-body" ng-bind="content"></div><div class="aside-footer"><button type="button" class="btn btn-default" ng-click="$hide()">Close</button></div></div></div></div>')}]),angular.module("mgcrea.ngStrap.datepicker").run(["$templateCache",function(a){a.put("datepicker/datepicker.tpl.html",'<div class="dropdown-menu datepicker" ng-class="\'datepicker-mode-\' + $mode" style="max-width: 320px"><table style="table-layout: fixed; height: 100%; width: 100%"><thead><tr class="text-center"><th><button tabindex="-1" type="button" class="btn btn-default pull-left" ng-click="$selectPane(-1)"><i class="{{$iconLeft}}"></i></button></th><th colspan="{{ rows[0].length - 2 }}"><button tabindex="-1" type="button" class="btn btn-default btn-block text-strong" ng-click="$toggleMode()"><strong style="text-transform: capitalize" ng-bind="title"></strong></button></th><th><button tabindex="-1" type="button" class="btn btn-default pull-right" ng-click="$selectPane(+1)"><i class="{{$iconRight}}"></i></button></th></tr><tr ng-show="showLabels" ng-bind-html="labels"></tr></thead><tbody><tr ng-repeat="(i, row) in rows" height="{{ 100 / rows.length }}%"><td class="text-center" ng-repeat="(j, el) in row"><button tabindex="-1" type="button" class="btn btn-default" style="width: 100%" ng-class="{\'btn-primary\': el.selected, \'btn-info btn-today\': el.isToday && !el.selected}" ng-click="$select(el.date)" ng-disabled="el.disabled"><span ng-class="{\'text-muted\': el.muted}" ng-bind="el.label"></span></button></td></tr></tbody></table></div>')}]),angular.module("mgcrea.ngStrap.dropdown").run(["$templateCache",function(a){a.put("dropdown/dropdown.tpl.html",'<ul tabindex="-1" class="dropdown-menu" role="menu"><li role="presentation" ng-class="{divider: item.divider}" ng-repeat="item in content"><a role="menuitem" tabindex="-1" ng-href="{{item.href}}" ng-if="!item.divider && item.href" target="{{item.target || \'\'}}" ng-bind="item.text"></a> <a role="menuitem" tabindex="-1" href="javascript:void(0)" ng-if="!item.divider && item.click" ng-click="$eval(item.click);$hide()" ng-bind="item.text"></a></li></ul>')}]),angular.module("mgcrea.ngStrap.modal").run(["$templateCache",function(a){a.put("modal/modal.tpl.html",'<div class="modal" tabindex="-1" role="dialog"><div class="modal-dialog"><div class="modal-content"><div class="modal-header" ng-show="title"><button type="button" class="close" ng-click="$hide()">&times;</button><h4 class="modal-title" ng-bind="title"></h4></div><div class="modal-body" ng-bind="content"></div><div class="modal-footer"><button type="button" class="btn btn-default" ng-click="$hide()">Close</button></div></div></div></div>')}]),angular.module("mgcrea.ngStrap.popover").run(["$templateCache",function(a){a.put("popover/popover.tpl.html",'<div class="popover"><div class="arrow"></div><h3 class="popover-title" ng-bind="title" ng-show="title"></h3><div class="popover-content" ng-bind="content"></div></div>')}]),angular.module("mgcrea.ngStrap.select").run(["$templateCache",function(a){a.put("select/select.tpl.html",'<ul tabindex="-1" class="select dropdown-menu" ng-show="$isVisible()" role="select"><li ng-if="$showAllNoneButtons"><div class="btn-group" style="margin-bottom: 5px; margin-left: 5px"><button type="button" class="btn btn-default btn-xs" ng-click="$selectAll()">{{$allText}}</button> <button type="button" class="btn btn-default btn-xs" ng-click="$selectNone()">{{$noneText}}</button></div></li><li role="presentation" ng-repeat="match in $matches" ng-class="{active: $isActive($index)}"><a style="cursor: default" role="menuitem" tabindex="-1" ng-click="$select($index, $event)"><i class="{{$iconCheckmark}} pull-right" ng-if="$isMultiple && $isActive($index)"></i> <span ng-bind="match.label"></span></a></li></ul>')}]),angular.module("mgcrea.ngStrap.tab").run(["$templateCache",function(a){a.put("tab/tab.tpl.html",'<ul class="nav" ng-class="$navClass" role="tablist"><li ng-repeat="$pane in $panes track by $index" ng-class="$index == $panes.$active ? $activeClass : \'\'"><a role="tab" data-toggle="tab" ng-click="$setActive($index)" data-index="{{ $index }}" ng-bind-html="$pane.title"></a></li></ul><div ng-transclude class="tab-content"></div>')}]),angular.module("mgcrea.ngStrap.timepicker").run(["$templateCache",function(a){a.put("timepicker/timepicker.tpl.html",'<div class="dropdown-menu timepicker" style="min-width: 0px;width: auto"><table height="100%"><thead><tr class="text-center"><th><button tabindex="-1" type="button" class="btn btn-default pull-left" ng-click="$arrowAction(-1, 0)"><i class="{{ $iconUp }}"></i></button></th><th>&nbsp;</th><th><button tabindex="-1" type="button" class="btn btn-default pull-left" ng-click="$arrowAction(-1, 1)"><i class="{{ $iconUp }}"></i></button></th></tr></thead><tbody><tr ng-repeat="(i, row) in rows"><td class="text-center"><button tabindex="-1" style="width: 100%" type="button" class="btn btn-default" ng-class="{\'btn-primary\': row[0].selected}" ng-click="$select(row[0].date, 0)" ng-disabled="row[0].disabled"><span ng-class="{\'text-muted\': row[0].muted}" ng-bind="row[0].label"></span></button></td><td><span ng-bind="i == midIndex ? timeSeparator : \' \'"></span></td><td class="text-center"><button tabindex="-1" ng-if="row[1].date" style="width: 100%" type="button" class="btn btn-default" ng-class="{\'btn-primary\': row[1].selected}" ng-click="$select(row[1].date, 1)" ng-disabled="row[1].disabled"><span ng-class="{\'text-muted\': row[1].muted}" ng-bind="row[1].label"></span></button></td><td ng-if="showAM">&nbsp;</td><td ng-if="showAM"><button tabindex="-1" ng-show="i == midIndex - !isAM * 1" style="width: 100%" type="button" ng-class="{\'btn-primary\': !!isAM}" class="btn btn-default" ng-click="$switchMeridian()" ng-disabled="el.disabled">AM</button> <button tabindex="-1" ng-show="i == midIndex + 1 - !isAM * 1" style="width: 100%" type="button" ng-class="{\'btn-primary\': !isAM}" class="btn btn-default" ng-click="$switchMeridian()" ng-disabled="el.disabled">PM</button></td></tr></tbody><tfoot><tr class="text-center"><th><button tabindex="-1" type="button" class="btn btn-default pull-left" ng-click="$arrowAction(1, 0)"><i class="{{ $iconDown }}"></i></button></th><th>&nbsp;</th><th><button tabindex="-1" type="button" class="btn btn-default pull-left" ng-click="$arrowAction(1, 1)"><i class="{{ $iconDown }}"></i></button></th></tr></tfoot></table></div>')}]),angular.module("mgcrea.ngStrap.tooltip").run(["$templateCache",function(a){a.put("tooltip/tooltip.tpl.html",'<div class="tooltip in" ng-show="title"><div class="tooltip-arrow"></div><div class="tooltip-inner" ng-bind="title"></div></div>')}]),angular.module("mgcrea.ngStrap.typeahead").run(["$templateCache",function(a){a.put("typeahead/typeahead.tpl.html",'<ul tabindex="-1" class="typeahead dropdown-menu" ng-show="$isVisible()" role="select"><li role="presentation" ng-repeat="match in $matches" ng-class="{active: $index == $activeIndex}"><a role="menuitem" tabindex="-1" ng-click="$select($index, $event)" ng-bind="match.label"></a></li></ul>')}])}(window,document),angular.module("ui.alias",[]).config(["$compileProvider","uiAliasConfig",function(a,b){"use strict";b=b||{},angular.forEach(b,function(b,c){angular.isString(b)&&(b={replace:!0,template:b}),a.directive(c,function(){return b})})}]),angular.module("ui.event",[]).directive("uiEvent",["$parse",function(a){"use strict";return function(b,c,d){var e=b.$eval(d.uiEvent);angular.forEach(e,function(d,e){var f=a(d);c.bind(e,function(a){var c=Array.prototype.slice.call(arguments);c=c.splice(1),f(b,{$event:a,$params:c}),b.$$phase||b.$apply()})})}}]),angular.module("ui.format",[]).filter("format",function(){"use strict";return function(a,b){var c=a;if(angular.isString(c)&&void 0!==b)if(angular.isArray(b)||angular.isObject(b)||(b=[b]),angular.isArray(b)){var d=b.length,e=function(a,c){return c=parseInt(c,10),c>=0&&d>c?b[c]:a};c=c.replace(/\$([0-9]+)/g,e)}else angular.forEach(b,function(a,b){c=c.split(":"+b).join(a)});return c}}),angular.module("ui.highlight",[]).filter("highlight",function(){"use strict";return function(a,b,c){return a&&(b||angular.isNumber(b))?(a=a.toString(),b=b.toString(),c?a.split(b).join('<span class="ui-match">'+b+"</span>"):a.replace(new RegExp(b,"gi"),'<span class="ui-match">$&</span>')):a}}),angular.module("ui.include",[]).directive("uiInclude",["$http","$templateCache","$anchorScroll","$compile",function(a,b,c,d){"use strict";return{restrict:"ECA",terminal:!0,compile:function(e,f){var g=f.uiInclude||f.src,h=f.fragment||"",i=f.onload||"",j=f.autoscroll;return function(e,f){function k(){var k=++m,o=e.$eval(g),p=e.$eval(h);o?a.get(o,{cache:b}).success(function(a){if(k===m){l&&l.$destroy(),l=e.$new();var b;b=p?angular.element("<div/>").html(a).find(p):angular.element("<div/>").html(a).contents(),f.html(b),d(b)(l),!angular.isDefined(j)||j&&!e.$eval(j)||c(),l.$emit("$includeContentLoaded"),e.$eval(i)}}).error(function(){k===m&&n()}):n()}var l,m=0,n=function(){l&&(l.$destroy(),l=null),f.html("")};e.$watch(h,k),e.$watch(g,k)}}}}]),angular.module("ui.indeterminate",[]).directive("uiIndeterminate",[function(){"use strict";return{compile:function(a,b){return b.type&&"checkbox"===b.type.toLowerCase()?function(a,b,c){a.$watch(c.uiIndeterminate,function(a){b[0].indeterminate=!!a})}:angular.noop}}}]),angular.module("ui.inflector",[]).filter("inflector",function(){"use strict";function a(a){return a=a.replace(/([A-Z])|([\-|\_])/g,function(a,b){return" "+(b||"")}),a.replace(/\s\s+/g," ").trim().toLowerCase().split(" ")}function b(a){var b=[];return angular.forEach(a,function(a){b.push(a.charAt(0).toUpperCase()+a.substr(1))}),b}var c={humanize:function(c){return b(a(c)).join(" ")},underscore:function(b){return a(b).join("_")},variable:function(c){return c=a(c),c=c[0]+b(c.slice(1)).join("")}};return function(a,b){return b!==!1&&angular.isString(a)?(b=b||"humanize",c[b](a)):a}}),angular.module("ui.jq",[]).value("uiJqConfig",{}).directive("uiJq",["uiJqConfig","$timeout",function(a,b){"use strict";return{restrict:"A",compile:function(c,d){if(!angular.isFunction(c[d.uiJq]))throw new Error('ui-jq: The "'+d.uiJq+'" function does not exist');var e=a&&a[d.uiJq];return function(a,c,d){function f(){var b=[];return d.uiOptions?(b=a.$eval("["+d.uiOptions+"]"),angular.isObject(e)&&angular.isObject(b[0])&&(b[0]=angular.extend({},e,b[0]))):e&&(b=[e]),b}function g(){b(function(){c[d.uiJq].apply(c,f())},0,!1)}d.ngModel&&c.is("select,input,textarea")&&c.bind("change",function(){c.trigger("input")}),d.uiRefresh&&a.$watch(d.uiRefresh,function(){g()}),g()}}}}]),angular.module("ui.keypress",[]).factory("keypressHelper",["$parse",function(a){"use strict";var b={8:"backspace",9:"tab",13:"enter",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"delete"},c=function(a){return a.charAt(0).toUpperCase()+a.slice(1)};return function(d,e,f,g){var h,i=[];h=e.$eval(g["ui"+c(d)]),angular.forEach(h,function(b,c){var d,e;e=a(b),angular.forEach(c.split(" "),function(a){d={expression:e,keys:{}},angular.forEach(a.split("-"),function(a){d.keys[a]=!0}),i.push(d)})}),f.bind(d,function(a){var c=!(!a.metaKey||a.ctrlKey),f=!!a.altKey,g=!!a.ctrlKey,h=!!a.shiftKey,j=a.keyCode;"keypress"===d&&!h&&j>=97&&122>=j&&(j-=32),angular.forEach(i,function(d){var i=d.keys[b[j]]||d.keys[j.toString()],k=!!d.keys.meta,l=!!d.keys.alt,m=!!d.keys.ctrl,n=!!d.keys.shift;i&&k===c&&l===f&&m===g&&n===h&&e.$apply(function(){d.expression(e,{$event:a})})})})}}]),angular.module("ui.keypress").directive("uiKeydown",["keypressHelper",function(a){"use strict";return{link:function(b,c,d){a("keydown",b,c,d)}}}]),angular.module("ui.keypress").directive("uiKeypress",["keypressHelper",function(a){"use strict";return{link:function(b,c,d){a("keypress",b,c,d)}}}]),angular.module("ui.keypress").directive("uiKeyup",["keypressHelper",function(a){"use strict";return{link:function(b,c,d){a("keyup",b,c,d)}}}]),angular.module("ui.mask",[]).value("uiMaskConfig",{maskDefinitions:{9:/\d/,A:/[a-zA-Z]/,"*":/[a-zA-Z0-9]/},clearOnBlur:!0}).directive("uiMask",["uiMaskConfig","$parse",function(a,b){"use strict";return{priority:100,require:"ngModel",restrict:"A",compile:function(){var c=a;return function(a,d,e,f){function g(a){return angular.isDefined(a)?(t(a),O?(l(),m(),!0):k()):k()}function h(a){angular.isDefined(a)&&(E=a,O&&x())}function i(a){return O?(H=p(a||""),J=o(H),f.$setValidity("mask",J),J&&H.length?q(H):void 0):a}function j(a){return O?(H=p(a||""),J=o(H),f.$viewValue=H.length?q(H):"",f.$setValidity("mask",J),""===H&&e.required&&f.$setValidity("required",!f.$error.required),J?H:void 0):a}function k(){return O=!1,n(),angular.isDefined(Q)?d.attr("placeholder",Q):d.removeAttr("placeholder"),angular.isDefined(R)?d.attr("maxlength",R):d.removeAttr("maxlength"),d.val(f.$modelValue),f.$viewValue=f.$modelValue,!1}function l(){H=L=p(f.$viewValue||""),I=K=q(H),J=o(H);var a=J&&H.length?I:"";e.maxlength&&d.attr("maxlength",2*C[C.length-1]),d.attr("placeholder",E),d.val(a),f.$viewValue=a}function m(){P||(d.bind("blur",u),d.bind("mousedown mouseup",v),d.bind("input keyup click focus",x),P=!0)}function n(){P&&(d.unbind("blur",u),d.unbind("mousedown",v),d.unbind("mouseup",v),d.unbind("input",x),d.unbind("keyup",x),d.unbind("click",x),d.unbind("focus",x),P=!1)}function o(a){return a.length?a.length>=G:!0}function p(a){var b="",c=D.slice();return a=a.toString(),angular.forEach(F,function(b){a=a.replace(b,"")}),angular.forEach(a.split(""),function(a){c.length&&c[0].test(a)&&(b+=a,c.shift())}),b}function q(a){var b="",c=C.slice();return angular.forEach(E.split(""),function(d,e){a.length&&e===c[0]?(b+=a.charAt(0)||"_",a=a.substr(1),c.shift()):b+=d}),b}function r(a){var b=e.placeholder;return"undefined"!=typeof b&&b[a]?b[a]:"_"}function s(){return E.replace(/[_]+/g,"_").replace(/([^_]+)([a-zA-Z0-9])([^_])/g,"$1$2_$3").split("_")}function t(a){var b=0;if(C=[],D=[],E="","string"==typeof a){G=0;var c=!1,d=0,e=a.split("");angular.forEach(e,function(a,e){S.maskDefinitions[a]?(C.push(b),E+=r(e-d),D.push(S.maskDefinitions[a]),b++,c||G++):"?"===a?(c=!0,d++):(E+=a,b++)})}C.push(C.slice().pop()+1),F=s(),O=C.length>1}function u(){S.clearOnBlur&&(M=0,N=0,J&&0!==H.length||(I="",d.val(""),a.$apply(function(){f.$setViewValue("")})))}function v(a){"mousedown"===a.type?d.bind("mouseout",w):d.unbind("mouseout",w)}function w(){N=B(this),d.unbind("mouseout",w)}function x(b){b=b||{};var c=b.which,e=b.type;if(16!==c&&91!==c){var g,h=d.val(),i=K,j=p(h),k=L,l=!1,m=z(this)||0,n=M||0,o=m-n,r=C[0],s=C[j.length]||C.slice().shift(),t=N||0,u=B(this)>0,v=t>0,w=h.length>i.length||t&&h.length>i.length-t,x=h.length<i.length||t&&h.length===i.length-t,D=c>=37&&40>=c&&b.shiftKey,E=37===c,F=8===c||"keyup"!==e&&x&&-1===o,G=46===c||"keyup"!==e&&x&&0===o&&!v,H=(E||F||"click"===e)&&m>r;if(N=B(this),!D&&(!u||"click"!==e&&"keyup"!==e)){if("input"===e&&x&&!v&&j===k){for(;F&&m>r&&!y(m);)m--;for(;G&&s>m&&-1===C.indexOf(m);)m++;var I=C.indexOf(m);j=j.substring(0,I)+j.substring(I+1),l=!0}for(g=q(j),K=g,L=j,d.val(g),l&&a.$apply(function(){f.$setViewValue(j)}),w&&r>=m&&(m=r+1),H&&m--,m=m>s?s:r>m?r:m;!y(m)&&m>r&&s>m;)m+=H?-1:1;(H&&s>m||w&&!y(n))&&m++,M=m,A(this,m)}}}function y(a){return C.indexOf(a)>-1}function z(a){if(!a)return 0;if(void 0!==a.selectionStart)return a.selectionStart;if(document.selection){a.focus();var b=document.selection.createRange();return b.moveStart("character",a.value?-a.value.length:0),b.text.length}return 0}function A(a,b){if(!a)return 0;if(0!==a.offsetWidth&&0!==a.offsetHeight)if(a.setSelectionRange)a.focus(),a.setSelectionRange(b,b);else if(a.createTextRange){var c=a.createTextRange();c.collapse(!0),c.moveEnd("character",b),c.moveStart("character",b),c.select()}}function B(a){return a?void 0!==a.selectionStart?a.selectionEnd-a.selectionStart:document.selection?document.selection.createRange().text.length:0:0}var C,D,E,F,G,H,I,J,K,L,M,N,O=!1,P=!1,Q=e.placeholder,R=e.maxlength,S={};e.uiOptions?(S=a.$eval("["+e.uiOptions+"]"),angular.isObject(S[0])&&(S=function(a,b){for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(void 0===b[c]?b[c]=angular.copy(a[c]):angular.extend(b[c],a[c]));return b}(c,S[0]))):S=c,e.$observe("uiMask",g),e.$observe("placeholder",h);var T=!1;e.$observe("modelViewValue",function(a){"true"===a&&(T=!0)}),a.$watch(e.ngModel,function(c){if(T&&c){var d=b(e.ngModel);d.assign(a,f.$viewValue)}}),f.$formatters.push(i),f.$parsers.push(j),d.bind("mousedown mouseup",v),Array.prototype.indexOf||(Array.prototype.indexOf=function(a){if(null===this)throw new TypeError;var b=Object(this),c=b.length>>>0;if(0===c)return-1;var d=0;if(arguments.length>1&&(d=Number(arguments[1]),d!==d?d=0:0!==d&&d!==1/0&&d!==-(1/0)&&(d=(d>0||-1)*Math.floor(Math.abs(d)))),d>=c)return-1;for(var e=d>=0?d:Math.max(c-Math.abs(d),0);c>e;e++)if(e in b&&b[e]===a)return e;return-1})}}}}]),angular.module("ui.reset",[]).value("uiResetConfig",null).directive("uiReset",["uiResetConfig",function(a){"use strict";var b=null;return void 0!==a&&(b=a),{require:"ngModel",link:function(a,c,d,e){var f;f=angular.element('<a class="ui-reset" />'),c.wrap('<span class="ui-resetwrap" />').after(f),f.bind("click",function(c){c.preventDefault(),a.$apply(function(){d.uiReset?e.$setViewValue(a.$eval(d.uiReset)):e.$setViewValue(b),e.$render()})})}}}]),angular.module("ui.route",[]).directive("uiRoute",["$location","$parse",function(a,b){"use strict";return{restrict:"AC",scope:!0,compile:function(c,d){var e;if(d.uiRoute)e="uiRoute";else if(d.ngHref)e="ngHref";else{if(!d.href)throw new Error("uiRoute missing a route or href property on "+c[0]);e="href"}return function(c,d,f){function g(b){var d=b.indexOf("#");d>-1&&(b=b.substr(d+1)),(j=function(){i(c,a.path().indexOf(b)>-1)})()}function h(b){var d=b.indexOf("#");d>-1&&(b=b.substr(d+1)),(j=function(){var d=new RegExp("^"+b+"$",["i"]);i(c,d.test(a.path()))})()}var i=b(f.ngModel||f.routeModel||"$uiRoute").assign,j=angular.noop;switch(e){case"uiRoute":f.uiRoute?h(f.uiRoute):f.$observe("uiRoute",h);break;case"ngHref":f.ngHref?g(f.ngHref):f.$observe("ngHref",g);break;case"href":g(f.href)}c.$on("$routeChangeSuccess",function(){j()}),c.$on("$stateChangeSuccess",function(){j()})}}}}]),angular.module("ui.scroll.jqlite",["ui.scroll"]).service("jqLiteExtras",["$log","$window",function(a,b){"use strict";return{registerFor:function(a){var c,d,e,f,g,h,i;return d=angular.element.prototype.css,a.prototype.css=function(a,b){var c,e;return e=this,c=e[0],c&&3!==c.nodeType&&8!==c.nodeType&&c.style?d.call(e,a,b):void 0},h=function(a){return a&&a.document&&a.location&&a.alert&&a.setInterval},i=function(a,b,c){var d,e,f,g,i;return d=a[0],i={top:["scrollTop","pageYOffset","scrollLeft"],left:["scrollLeft","pageXOffset","scrollTop"]}[b],e=i[0],g=i[1],f=i[2],h(d)?angular.isDefined(c)?d.scrollTo(a[f].call(a),c):g in d?d[g]:d.document.documentElement[e]:angular.isDefined(c)?d[e]=c:d[e]},b.getComputedStyle?(f=function(a){return b.getComputedStyle(a,null)},c=function(a,b){return parseFloat(b)}):(f=function(a){return a.currentStyle},c=function(a,b){var c,d,e,f,g,h,i;return c=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,f=new RegExp("^("+c+")(?!px)[a-z%]+$","i"),f.test(b)?(i=a.style,d=i.left,g=a.runtimeStyle,h=g&&g.left,g&&(g.left=i.left),i.left=b,e=i.pixelLeft,i.left=d,h&&(g.left=h),e):parseFloat(b)}),e=function(a,b){var d,e,g,i,j,k,l,m,n,o,p,q,r;return h(a)?(d=document.documentElement[{height:"clientHeight",width:"clientWidth"}[b]],{base:d,padding:0,border:0,margin:0}):(r={width:[a.offsetWidth,"Left","Right"],height:[a.offsetHeight,"Top","Bottom"]}[b],d=r[0],l=r[1],m=r[2],k=f(a),p=c(a,k["padding"+l])||0,q=c(a,k["padding"+m])||0,e=c(a,k["border"+l+"Width"])||0,g=c(a,k["border"+m+"Width"])||0,i=k["margin"+l],j=k["margin"+m],n=c(a,i)||0,o=c(a,j)||0,{base:d,padding:p+q,border:e+g,margin:n+o})},g=function(a,b,c){var d,g,h;return g=e(a,b),g.base>0?{base:g.base-g.padding-g.border,outer:g.base,outerfull:g.base+g.margin}[c]:(d=f(a),h=d[b],(0>h||null===h)&&(h=a.style[b]||0),h=parseFloat(h)||0,{base:h-g.padding-g.border,outer:h,outerfull:h+g.padding+g.border+g.margin}[c])},angular.forEach({before:function(a){var b,c,d,e,f,g,h;if(f=this,c=f[0],e=f.parent(),b=e.contents(),b[0]===c)return e.prepend(a);for(d=g=1,h=b.length-1;h>=1?h>=g:g>=h;d=h>=1?++g:--g)if(b[d]===c)return void angular.element(b[d-1]).after(a);throw new Error("invalid DOM structure "+c.outerHTML)},height:function(a){var b;return b=this,angular.isDefined(a)?(angular.isNumber(a)&&(a+="px"),d.call(b,"height",a)):g(this[0],"height","base")},outerHeight:function(a){return g(this[0],"height",a?"outerfull":"outer")},offset:function(a){var b,c,d,e,f,g;if(f=this,arguments.length){if(void 0===a)return f;throw new Error("offset setter method is not implemented")}return b={top:0,left:0},e=f[0],(c=e&&e.ownerDocument)?(d=c.documentElement,null!=e.getBoundingClientRect&&(b=e.getBoundingClientRect()),g=c.defaultView||c.parentWindow,{top:b.top+(g.pageYOffset||d.scrollTop)-(d.clientTop||0),left:b.left+(g.pageXOffset||d.scrollLeft)-(d.clientLeft||0)}):void 0},scrollTop:function(a){return i(this,"top",a)},scrollLeft:function(a){return i(this,"left",a)}},function(b,c){return a.prototype[c]?void 0:a.prototype[c]=b})}}}]).run(["$log","$window","jqLiteExtras",function(a,b,c){"use strict";return b.jQuery?void 0:c.registerFor(angular.element)}]),angular.module("ui.scroll",[]).directive("uiScrollViewport",["$log",function(){"use strict";return{controller:["$scope","$element",function(a,b){return this.viewport=b,this}]}}]).directive("uiScroll",["$log","$injector","$rootScope","$timeout",function(a,b,c,d){"use strict";return{require:["?^uiScrollViewport"],transclude:"element",priority:1e3,terminal:!0,compile:function(e,f,g){return function(e,f,h,i){var j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da;if(O=a.debug||a.log,P=h.uiScroll.match(/^\s*(\w+)\s+in\s+([\w\.]+)\s*$/),!P)throw new Error("Expected uiScroll in form of '_item_ in _datasource_' but got '"+h.uiScroll+"'");if(M=P[1],x=P[2],I=function(a,b){var c;if(a)return c=b.match(/^([\w]+)\.(.+)$/),c&&3===c.length?I(a[c[1]],c[2]):a[b]},X=function(a,b,c,d){var e;if(a&&b&&((e=b.match(/^([\w]+)\.(.+)$/))||-1===b.indexOf(".")))return e&&3===e.length?(angular.isObject(a[e[1]])||d||(a[e[1]]={}),X(a[e[1]],e[2],c,d)):angular.isObject(a[b])||d?a[b]=c:a[b]=c},w=I(e,x),L=function(){return angular.isObject(w)&&"function"==typeof w.get},!L()&&(w=b.get(x),!L()))throw new Error(""+x+" is not a valid datasource");return s=Math.max(3,+h.bufferSize||10),r=function(){return ba.outerHeight()*Math.max(.1,+h.padding||.1)},W=function(a){var b;return null!=(b=a[0].scrollHeight)?b:a[0].document.documentElement.scrollHeight},t=null,g(e.$new(),function(a){var b,c,d,g,h,j;if(g=a[0].localName,"dl"===g)throw new Error("ui-scroll directive does not support <"+a[0].localName+"> as a repeating tag: "+a[0].outerHTML);return"li"!==g&&"tr"!==g&&(g="div"),j=i[0]&&i[0].viewport?i[0].viewport:angular.element(window),j.css({"overflow-y":"auto",display:"block"}),d=function(a){var b,c,d;switch(a){case"tr":return d=angular.element("<table><tr><td><div></div></td></tr></table>"),b=d.find("div"),c=d.find("tr"),c.paddingHeight=function(){return b.height.apply(b,arguments)},c;default:return c=angular.element("<"+a+"></"+a+">"),c.paddingHeight=c.height,c}},c=function(a,b,c){return b[{top:"before",bottom:"after"}[c]](a),{paddingHeight:function(){return a.paddingHeight.apply(a,arguments)},insert:function(b){return a[{top:"after",bottom:"before"}[c]](b)}}},h=c(d(g),f,"top"),b=c(d(g),f,"bottom"),e.$on("$destroy",a.remove),t={viewport:j,topPadding:h.paddingHeight,bottomPadding:b.paddingHeight,append:b.insert,prepend:h.insert,bottomDataPos:function(){return W(j)-b.paddingHeight()},topDataPos:function(){return h.paddingHeight()}}}),ba=t.viewport,ca=ba.scope()||c,_=function(a){return j.topVisible=a.scope[M],j.topVisibleElement=a.element,j.topVisibleScope=a.scope,h.topVisible&&X(ca,h.topVisible,j.topVisible),h.topVisibleElement&&X(ca,h.topVisibleElement,j.topVisibleElement),h.topVisibleScope&&X(ca,h.topVisibleScope,j.topVisibleScope),"function"==typeof w.topVisible?w.topVisible(a):void 0},N=function(a){return j.isLoading=a,h.isLoading&&X(e,h.isLoading,a),"function"==typeof w.loading?w.loading(a):void 0},V=0,H=1,Q=1,q=[],R=[],D=!1,o=!1,T=function(a,b){var c,d;for(c=d=a;b>=a?b>d:d>b;c=b>=a?++d:--d)q[c].scope.$destroy(),q[c].element.remove();return q.splice(a,b-a)},S=function(){return V++,H=1,Q=1,T(0,q.length),t.topPadding(0),t.bottomPadding(0),R=[],D=!1,o=!1,l(V)},p=function(){return ba.scrollTop()+ba.outerHeight()},aa=function(){return ba.scrollTop()},Y=function(){return!D&&t.bottomDataPos()<p()+r()},u=function(){var a,b,c,d,e,f,g,h,i,j;for(a=0,g=0,b=i=j=q.length-1;0>=j?0>=i:i>=0;b=0>=j?++i:--i)if(c=q[b],e=c.element.offset().top,f=h!==e,h=e,f&&(d=c.element.outerHeight(!0)),t.bottomDataPos()-a-d>p()+r())f&&(a+=d),g++,D=!1;else{if(f)break;g++}return g>0?(t.bottomPadding(t.bottomPadding()+a),T(q.length-g,q.length),Q-=g):void 0},Z=function(){return!o&&t.topDataPos()>aa()-r()},v=function(){var a,b,c,d,e,f,g,h,i;for(g=0,e=0,h=0,i=q.length;i>h;h++)if(a=q[h],c=a.element.offset().top,d=f!==c,f=c,d&&(b=a.element.outerHeight(!0)),t.topDataPos()+g+b<aa()-r())d&&(g+=b),e++,o=!1;else{if(d)break;e++}return e>0?(t.topPadding(t.topPadding()+g),T(0,e),H+=e):void 0},C=function(a,b){return j.isLoading||N(!0),1===R.push(b)?F(a):void 0},J=function(a){return a.displayTemp=a.css("display"),a.css("display","none")},$=function(a){return a.hasOwnProperty("displayTemp")?a.css("display",a.displayTemp):void 0},K=function(a,b){var c,d,f;return c=e.$new(),c[M]=b,d=a>H,c.$index=a,d&&c.$index--,f={scope:c},g(c,function(b){return f.element=b,d?a===Q?(J(b),t.append(b),q.push(f)):(q[a-H].element.after(b),q.splice(a-H+1,0,f)):(J(b),t.prepend(b),q.unshift(f))}),{appended:d,wrapper:f}},m=function(a,b){var c;return a?t.bottomPadding(Math.max(0,t.bottomPadding()-b.element.outerHeight(!0))):(c=t.topPadding()-b.element.outerHeight(!0),c>=0?t.topPadding(c):ba.scrollTop(ba.scrollTop()+b.element.outerHeight(!0)))},y=function(a,b){var c,d,e,f,g,h,i,j,k;if(Y()?C(a,!0):Z()&&C(a,!1),b&&b(a),0===R.length){for(h=0,k=[],i=0,j=q.length;j>i;i++){if(c=q[i],e=c.element.offset().top,f=g!==e,g=e,f&&(d=c.element.outerHeight(!0)),!(f&&t.topDataPos()+h+d<aa())){f&&_(c);break}k.push(h+=d)}return k}},l=function(a,b,c){return b&&b.length?d(function(){var d,e,f,g,h,i,j,k,l;for(h=[],i=0,k=b.length;k>i;i++)f=b[i],d=f.wrapper.element,$(d),e=d.offset().top,g!==e&&(h.push(f),g=e);for(j=0,l=h.length;l>j;j++)f=h[j],m(f.appended,f.wrapper);return y(a,c)}):y(a,c)},G=function(a,b){return l(a,b,function(){return R.shift(),0===R.length?N(!1):F(a)})},F=function(a){var b;return b=R[0],b?q.length&&!Y()?G(a):w.get(Q,s,function(b){var c,d,f,g;if(!(a&&a!==V||e.$$destroyed)){if(d=[],b.length<s&&(D=!0,t.bottomPadding(0)),b.length>0)for(v(),f=0,g=b.length;g>f;f++)c=b[f],d.push(K(++Q,c));return G(a,d)}}):q.length&&!Z()?G(a):w.get(H-s,s,function(b){var c,d,f,g;if(!(a&&a!==V||e.$$destroyed)){if(d=[],b.length<s&&(o=!0,t.topPadding(0)),b.length>0)for(q.length&&u(),c=f=g=b.length-1;0>=g?0>=f:f>=0;c=0>=g?++f:--f)d.unshift(K(--H,b[c]));return G(a,d)}})},U=function(){return c.$$phase||j.isLoading?void 0:(l(),e.$apply())},da=function(a){var b,c;return b=ba[0].scrollTop,c=ba[0].scrollHeight-ba[0].clientHeight,0===b&&!o||b===c&&!D?a.preventDefault():void 0},ba.bind("resize",U),ba.bind("scroll",U),ba.bind("mousewheel",da),e.$watch(w.revision,S),E=w.scope?w.scope.$new():e.$new(),e.$on("$destroy",function(){var a,b,c;for(b=0,c=q.length;c>b;b++)a=q[b],a.scope.$destroy(),a.element.remove();return ba.unbind("resize",U),ba.unbind("scroll",U),ba.unbind("mousewheel",da)}),j={},j.isLoading=!1,n=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n;if(d=[],angular.isArray(b))if(b.length){if(1===b.length&&b[0]===a.scope[M])return d;for(f=a.scope.$index,h=f>H?f-H:1,c=i=0,l=b.length;l>i;c=++i)g=b[c],d.push(K(f+c,g));for(T(h,h+1),c=j=0,m=q.length;m>j;c=++j)e=q[c],e.scope.$index=H+c}else for(T(a.scope.$index-H,a.scope.$index-H+1),Q--,c=k=0,n=q.length;n>k;c=++k)e=q[c],e.scope.$index=H+c;return d},j.applyUpdates=function(a,b){var c,d,e,f,g,h;if(c=[],V++,angular.isFunction(a))for(g=q.slice(0),e=0,f=g.length;f>e;e++)d=g[e],c.concat(c,n(d,a(d.scope[M],d.scope,d.element)));else{if(a%1!==0)throw new Error("applyUpdates - "+a+" is not a valid index or outside of range");0<=(h=a-H-1)&&h<q.length&&(c=n(q[a-H],b))}return l(V,c)},h.adapter&&(k=I(e,h.adapter),k||(X(e,h.adapter,{}),k=I(e,h.adapter)),angular.extend(k,j),j=k),B=function(a,b){var c,d,e,f,g;if(angular.isFunction(a))for(d=function(b){return a(b.scope)},e=0,f=q.length;f>e;e++)c=q[e],d(c);else 0<=(g=a-H-1)&&g<q.length&&(q[a-H-1].scope[M]=b);return null},z=function(a){var b,c,d,e,f,g,h,i,j,k,m,n;if(angular.isFunction(a)){for(d=[],g=0,j=q.length;j>g;g++)c=q[g],d.unshift(c);for(f=function(c){return a(c.scope)?(T(d.length-1-b,d.length-b),Q--):void 0},b=h=0,k=d.length;k>h;b=++h)e=d[b],f(e)}else 0<=(n=a-H-1)&&n<q.length&&(T(a-H-1,a-H),Q--);for(b=i=0,m=q.length;m>i;b=++i)c=q[b],c.scope.$index=H+b;return l()},A=function(a,b){var c,d,e,f,g;if(d=[],angular.isFunction(a))throw new Error("not implemented - Insert with locator function");for(0<=(g=a-H-1)&&g<q.length&&(d.push(K(a,b)),Q++),c=e=0,f=q.length;f>e;c=++e)b=q[c],b.scope.$index=H+c;return l(null,d)},E.$on("insert.item",function(a,b,c){return A(b,c)}),E.$on("update.items",function(a,b,c){return B(b,c)}),E.$on("delete.items",function(a,b){return z(b)})}}}}]),angular.module("ui.scrollfix",[]).directive("uiScrollfix",["$window",function(a){"use strict";function b(){if(angular.isDefined(a.pageYOffset))return a.pageYOffset;var b=document.compatMode&&"BackCompat"!==document.compatMode?document.documentElement:document.body;return b.scrollTop}return{require:"^?uiScrollfixTarget",link:function(c,d,e,f){function g(){var a=i?e.uiScrollfix:d[0].offsetTop+j,c=f?k[0].scrollTop:b();!d.hasClass("ui-scrollfix")&&c>a?(d.addClass("ui-scrollfix"),h=a):d.hasClass("ui-scrollfix")&&h>c&&d.removeClass("ui-scrollfix")}var h,i=!0,j=0,k=f&&f.$element||angular.element(a);e.uiScrollfix?"string"==typeof e.uiScrollfix&&("-"===e.uiScrollfix.charAt(0)?(i=!1,j=-parseFloat(e.uiScrollfix.substr(1))):"+"===e.uiScrollfix.charAt(0)&&(i=!1,j=parseFloat(e.uiScrollfix.substr(1)))):i=!1,h=i?e.uiScrollfix:d[0].offsetTop+j,k.on("scroll",g),c.$on("$destroy",function(){k.off("scroll",g)})}}}]).directive("uiScrollfixTarget",[function(){"use strict";return{controller:["$element",function(a){this.$element=a}]}}]),angular.module("ui.showhide",[]).directive("uiShow",[function(){"use strict";return function(a,b,c){a.$watch(c.uiShow,function(a){a?b.addClass("ui-show"):b.removeClass("ui-show")})}}]).directive("uiHide",[function(){"use strict";return function(a,b,c){a.$watch(c.uiHide,function(a){a?b.addClass("ui-hide"):b.removeClass("ui-hide")})}}]).directive("uiToggle",[function(){"use strict";return function(a,b,c){a.$watch(c.uiToggle,function(a){a?b.removeClass("ui-hide").addClass("ui-show"):b.removeClass("ui-show").addClass("ui-hide")})}}]),angular.module("ui.unique",[]).filter("unique",["$parse",function(a){"use strict";return function(b,c){if(c===!1)return b;if((c||angular.isUndefined(c))&&angular.isArray(b)){var d=[],e=angular.isString(c)?a(c):function(a){return a},f=function(a){return angular.isObject(a)?e(a):a};angular.forEach(b,function(a){for(var b=!1,c=0;c<d.length;c++)if(angular.equals(f(d[c]),f(a))){b=!0;break}b||d.push(a)}),b=d}return b}}]),angular.module("ui.uploader",[]).service("uiUploader",uiUploader),uiUploader.$inject=["$log"],angular.module("ui.validate",[]).directive("uiValidate",function(){
"use strict";return{restrict:"A",require:"ngModel",link:function(a,b,c,d){function e(b){return angular.isString(b)?void a.$watch(b,function(){angular.forEach(g,function(a){a(d.$modelValue)})}):angular.isArray(b)?void angular.forEach(b,function(b){a.$watch(b,function(){angular.forEach(g,function(a){a(d.$modelValue)})})}):void(angular.isObject(b)&&angular.forEach(b,function(b,c){angular.isString(b)&&a.$watch(b,function(){g[c](d.$modelValue)}),angular.isArray(b)&&angular.forEach(b,function(b){a.$watch(b,function(){g[c](d.$modelValue)})})}))}var f,g={},h=a.$eval(c.uiValidate);h&&(angular.isString(h)&&(h={validator:h}),angular.forEach(h,function(b,c){f=function(e){var f=a.$eval(b,{$value:e});return angular.isObject(f)&&angular.isFunction(f.then)?(f.then(function(){d.$setValidity(c,!0)},function(){d.$setValidity(c,!1)}),e):f?(d.$setValidity(c,!0),e):(d.$setValidity(c,!1),e)},g[c]=f,d.$formatters.push(f),d.$parsers.push(f)}),c.uiValidateWatch&&e(a.$eval(c.uiValidateWatch)))}}}),angular.module("ui.utils",["ui.event","ui.format","ui.highlight","ui.include","ui.indeterminate","ui.inflector","ui.jq","ui.keypress","ui.mask","ui.reset","ui.route","ui.scrollfix","ui.scroll","ui.scroll.jqlite","ui.showhide","ui.unique","ui.validate"]),!function(a,b){"undefined"!=typeof module&&module.exports?module.exports.browser=b():"function"==typeof define&&define.amd?define(b):this[a]=b()}("bowser",function(){function a(a){function c(b){var c=a.match(b);return c&&c.length>1&&c[1]||""}function d(b){var c=a.match(b);return c&&c.length>1&&c[2]||""}var e,f=c(/(ipod|iphone|ipad)/i).toLowerCase(),g=/like android/i.test(a),h=!g&&/android/i.test(a),i=c(/edge\/(\d+(\.\d+)?)/i),j=c(/version\/(\d+(\.\d+)?)/i),k=/tablet/i.test(a),l=!k&&/[^-]mobi/i.test(a);/opera|opr/i.test(a)?e={name:"Opera",opera:b,version:j||c(/(?:opera|opr)[\s\/](\d+(\.\d+)?)/i)}:/windows phone/i.test(a)?(e={name:"Windows Phone",windowsphone:b},i?(e.msedge=b,e.version=i):(e.msie=b,e.version=c(/iemobile\/(\d+(\.\d+)?)/i))):/msie|trident/i.test(a)?e={name:"Internet Explorer",msie:b,version:c(/(?:msie |rv:)(\d+(\.\d+)?)/i)}:/chrome.+? edge/i.test(a)?e={name:"Microsoft Edge",msedge:b,version:i}:/chrome|crios|crmo/i.test(a)?e={name:"Chrome",chrome:b,version:c(/(?:chrome|crios|crmo)\/(\d+(\.\d+)?)/i)}:f?(e={name:"iphone"==f?"iPhone":"ipad"==f?"iPad":"iPod"},j&&(e.version=j)):/sailfish/i.test(a)?e={name:"Sailfish",sailfish:b,version:c(/sailfish\s?browser\/(\d+(\.\d+)?)/i)}:/seamonkey\//i.test(a)?e={name:"SeaMonkey",seamonkey:b,version:c(/seamonkey\/(\d+(\.\d+)?)/i)}:/firefox|iceweasel/i.test(a)?(e={name:"Firefox",firefox:b,version:c(/(?:firefox|iceweasel)[ \/](\d+(\.\d+)?)/i)},/\((mobile|tablet);[^\)]*rv:[\d\.]+\)/i.test(a)&&(e.firefoxos=b)):/silk/i.test(a)?e={name:"Amazon Silk",silk:b,version:c(/silk\/(\d+(\.\d+)?)/i)}:h?e={name:"Android",version:j}:/phantom/i.test(a)?e={name:"PhantomJS",phantom:b,version:c(/phantomjs\/(\d+(\.\d+)?)/i)}:/blackberry|\bbb\d+/i.test(a)||/rim\stablet/i.test(a)?e={name:"BlackBerry",blackberry:b,version:j||c(/blackberry[\d]+\/(\d+(\.\d+)?)/i)}:/(web|hpw)os/i.test(a)?(e={name:"WebOS",webos:b,version:j||c(/w(?:eb)?osbrowser\/(\d+(\.\d+)?)/i)},/touchpad\//i.test(a)&&(e.touchpad=b)):e=/bada/i.test(a)?{name:"Bada",bada:b,version:c(/dolfin\/(\d+(\.\d+)?)/i)}:/tizen/i.test(a)?{name:"Tizen",tizen:b,version:c(/(?:tizen\s?)?browser\/(\d+(\.\d+)?)/i)||j}:/safari/i.test(a)?{name:"Safari",safari:b,version:j}:{name:c(/^(.*)\/(.*) /),version:d(/^(.*)\/(.*) /)},!e.msedge&&/(apple)?webkit/i.test(a)?(e.name=e.name||"Webkit",e.webkit=b,!e.version&&j&&(e.version=j)):!e.opera&&/gecko\//i.test(a)&&(e.name=e.name||"Gecko",e.gecko=b,e.version=e.version||c(/gecko\/(\d+(\.\d+)?)/i)),e.msedge||!h&&!e.silk?f&&(e[f]=b,e.ios=b):e.android=b;var m="";e.windowsphone?m=c(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i):f?(m=c(/os (\d+([_\s]\d+)*) like mac os x/i),m=m.replace(/[_\s]/g,".")):h?m=c(/android[ \/-](\d+(\.\d+)*)/i):e.webos?m=c(/(?:web|hpw)os\/(\d+(\.\d+)*)/i):e.blackberry?m=c(/rim\stablet\sos\s(\d+(\.\d+)*)/i):e.bada?m=c(/bada\/(\d+(\.\d+)*)/i):e.tizen&&(m=c(/tizen[\/\s](\d+(\.\d+)*)/i)),m&&(e.osversion=m);var n=m.split(".")[0];return k||"ipad"==f||h&&(3==n||4==n&&!l)||e.silk?e.tablet=b:(l||"iphone"==f||"ipod"==f||h||e.blackberry||e.webos||e.bada)&&(e.mobile=b),e.msedge||e.msie&&e.version>=10||e.chrome&&e.version>=20||e.firefox&&e.version>=20||e.safari&&e.version>=6||e.opera&&e.version>=10||e.ios&&e.osversion&&e.osversion.split(".")[0]>=6||e.blackberry&&e.version>=10.1?e.a=b:e.msie&&e.version<10||e.chrome&&e.version<20||e.firefox&&e.version<20||e.safari&&e.version<6||e.opera&&e.version<10||e.ios&&e.osversion&&e.osversion.split(".")[0]<6?e.c=b:e.x=b,e}var b=!0,c=a("undefined"!=typeof navigator?navigator.userAgent:"");return c.test=function(a){for(var b=0;b<a.length;++b){var d=a[b];if("string"==typeof d&&d in c)return!0}return!1},c._detect=a,c}),function(){var a=Date,b=Date.CultureStrings?Date.CultureStrings.lang:null,c={},d={getFromKey:function(a,b){var c;return c=Date.CultureStrings&&Date.CultureStrings[b]&&Date.CultureStrings[b][a]?Date.CultureStrings[b][a]:d.buildFromDefault(a),"/"===a.charAt(0)&&(c=d.buildFromRegex(a,b)),c},getFromObjectValues:function(a,b){var c,e={};for(c in a)a.hasOwnProperty(c)&&(e[c]=d.getFromKey(a[c],b));return e},getFromObjectKeys:function(a,b){var c,e={};for(c in a)a.hasOwnProperty(c)&&(e[d.getFromKey(c,b)]=a[c]);return e},getFromArray:function(a,b){for(var c=[],e=0;e<a.length;e++)e in a&&(c[e]=d.getFromKey(a[e],b));return c},buildFromDefault:function(a){var b,c,d,e;switch(a){case"name":b="en-US";break;case"englishName":b="English (United States)";break;case"nativeName":b="English (United States)";break;case"twoDigitYearMax":b=2049;break;case"firstDayOfWeek":b=0;break;default:b=a,d=a.split("_"),c=d.length,c>1&&"/"!==a.charAt(0)&&(e=d[c-1].toLowerCase(),"initial"!==e&&"abbr"!==e||(b=d[0]))}return b},buildFromRegex:function(a,b){var c;return c=Date.CultureStrings&&Date.CultureStrings[b]&&Date.CultureStrings[b][a]?new RegExp(Date.CultureStrings[b][a],"i"):new RegExp(a.replace(new RegExp("/","g"),""),"i")}},e=function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])},f=function(a,e){var f=e?e:b;return c[a]=a,"object"==typeof a?a instanceof Array?d.getFromArray(a,f):d.getFromObjectKeys(a,f):d.getFromKey(a,f)},g=function(a){var b=Date.Config.i18n+a+".js",c=document.getElementsByTagName("head")[0]||document.documentElement,d=document.createElement("script");d.src=b;var e=!1,f={done:function(){}};return d.onload=d.onreadystatechange=function(){e||this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(f.done(),c.removeChild(d))},setTimeout(function(){c.insertBefore(d,c.firstChild)},0),{done:function(a){f.done=function(){a&&setTimeout(a,0)}}}},h={buildFromMethodHash:function(a){var b;for(b in a)a.hasOwnProperty(b)&&(a[b]=h[a[b]]());return a},timeZoneDST:function(){var a={CHADT:"+1345",NZDT:"+1300",AEDT:"+1100",ACDT:"+1030",AZST:"+0500",IRDT:"+0430",EEST:"+0300",CEST:"+0200",BST:"+0100",PMDT:"-0200",ADT:"-0300",NDT:"-0230",EDT:"-0400",CDT:"-0500",MDT:"-0600",PDT:"-0700",AKDT:"-0800",HADT:"-0900"};return f(a)},timeZoneStandard:function(){var a={LINT:"+1400",TOT:"+1300",CHAST:"+1245",NZST:"+1200",NFT:"+1130",SBT:"+1100",AEST:"+1000",ACST:"+0930",JST:"+0900",CWST:"+0845",CT:"+0800",ICT:"+0700",MMT:"+0630",BST:"+0600",NPT:"+0545",IST:"+0530",PKT:"+0500",AFT:"+0430",MSK:"+0400",IRST:"+0330",FET:"+0300",EET:"+0200",CET:"+0100",GMT:"+0000",UTC:"+0000",CVT:"-0100",GST:"-0200",BRT:"-0300",NST:"-0330",AST:"-0400",EST:"-0500",CST:"-0600",MST:"-0700",PST:"-0800",AKST:"-0900",MIT:"-0930",HST:"-1000",SST:"-1100",BIT:"-1200"};return f(a)},timeZones:function(a){var b;a.timezones=[];for(b in a.abbreviatedTimeZoneStandard)a.abbreviatedTimeZoneStandard.hasOwnProperty(b)&&a.timezones.push({name:b,offset:a.abbreviatedTimeZoneStandard[b]});for(b in a.abbreviatedTimeZoneDST)a.abbreviatedTimeZoneDST.hasOwnProperty(b)&&a.timezones.push({name:b,offset:a.abbreviatedTimeZoneDST[b],dst:!0});return a.timezones},days:function(){return f(["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"])},dayAbbr:function(){return f(["Sun","Mon","Tue","Wed","Thu","Fri","Sat"])},dayShortNames:function(){return f(["Su","Mo","Tu","We","Th","Fr","Sa"])},dayFirstLetters:function(){return f(["S_Sun_Initial","M_Mon_Initial","T_Tues_Initial","W_Wed_Initial","T_Thu_Initial","F_Fri_Initial","S_Sat_Initial"])},months:function(){return f(["January","February","March","April","May","June","July","August","September","October","November","December"])},monthAbbr:function(){return f(["Jan_Abbr","Feb_Abbr","Mar_Abbr","Apr_Abbr","May_Abbr","Jun_Abbr","Jul_Abbr","Aug_Abbr","Sep_Abbr","Oct_Abbr","Nov_Abbr","Dec_Abbr"])},formatPatterns:function(){return d.getFromObjectValues({shortDate:"M/d/yyyy",longDate:"dddd, MMMM dd, yyyy",shortTime:"h:mm tt",longTime:"h:mm:ss tt",fullDateTime:"dddd, MMMM dd, yyyy h:mm:ss tt",sortableDateTime:"yyyy-MM-ddTHH:mm:ss",universalSortableDateTime:"yyyy-MM-dd HH:mm:ssZ",rfc1123:"ddd, dd MMM yyyy HH:mm:ss",monthDay:"MMMM dd",yearMonth:"MMMM, yyyy"},Date.i18n.currentLanguage())},regex:function(){return d.getFromObjectValues({inTheMorning:"/( in the )(morn(ing)?)\\b/",thisMorning:"/(this )(morn(ing)?)\\b/",amThisMorning:"/(\b\\d(am)? )(this )(morn(ing)?)/",inTheEvening:"/( in the )(even(ing)?)\\b/",thisEvening:"/(this )(even(ing)?)\\b/",pmThisEvening:"/(\b\\d(pm)? )(this )(even(ing)?)/",jan:"/jan(uary)?/",feb:"/feb(ruary)?/",mar:"/mar(ch)?/",apr:"/apr(il)?/",may:"/may/",jun:"/jun(e)?/",jul:"/jul(y)?/",aug:"/aug(ust)?/",sep:"/sep(t(ember)?)?/",oct:"/oct(ober)?/",nov:"/nov(ember)?/",dec:"/dec(ember)?/",sun:"/^su(n(day)?)?/",mon:"/^mo(n(day)?)?/",tue:"/^tu(e(s(day)?)?)?/",wed:"/^we(d(nesday)?)?/",thu:"/^th(u(r(s(day)?)?)?)?/",fri:"/fr(i(day)?)?/",sat:"/^sa(t(urday)?)?/",future:"/^next/",past:"/^last|past|prev(ious)?/",add:"/^(\\+|aft(er)?|from|hence)/",subtract:"/^(\\-|bef(ore)?|ago)/",yesterday:"/^yes(terday)?/",today:"/^t(od(ay)?)?/",tomorrow:"/^tom(orrow)?/",now:"/^n(ow)?/",millisecond:"/^ms|milli(second)?s?/",second:"/^sec(ond)?s?/",minute:"/^mn|min(ute)?s?/",hour:"/^h(our)?s?/",week:"/^w(eek)?s?/",month:"/^m(onth)?s?/",day:"/^d(ay)?s?/",year:"/^y(ear)?s?/",shortMeridian:"/^(a|p)/",longMeridian:"/^(a\\.?m?\\.?|p\\.?m?\\.?)/",timezone:"/^((e(s|d)t|c(s|d)t|m(s|d)t|p(s|d)t)|((gmt)?\\s*(\\+|\\-)\\s*\\d\\d\\d\\d?)|gmt|utc)/",ordinalSuffix:"/^\\s*(st|nd|rd|th)/",timeContext:"/^\\s*(\\:|a(?!u|p)|p)/"},Date.i18n.currentLanguage())}},i=function(){var a=d.getFromObjectValues({name:"name",englishName:"englishName",nativeName:"nativeName",amDesignator:"AM",pmDesignator:"PM",firstDayOfWeek:"firstDayOfWeek",twoDigitYearMax:"twoDigitYearMax",dateElementOrder:"mdy"},Date.i18n.currentLanguage()),b=h.buildFromMethodHash({dayNames:"days",abbreviatedDayNames:"dayAbbr",shortestDayNames:"dayShortNames",firstLetterDayNames:"dayFirstLetters",monthNames:"months",abbreviatedMonthNames:"monthAbbr",formatPatterns:"formatPatterns",regexPatterns:"regex",abbreviatedTimeZoneDST:"timeZoneDST",abbreviatedTimeZoneStandard:"timeZoneStandard"});return e(a,b),h.timeZones(a),a};a.i18n={__:function(a,b){return f(a,b)},currentLanguage:function(){return b||"en-US"},setLanguage:function(c,d,e){var f=!1;if(d||"en-US"===c||Date.CultureStrings&&Date.CultureStrings[c])b=c,Date.CultureStrings=Date.CultureStrings||{},Date.CultureStrings.lang=c,Date.CultureInfo=new i;else if(!Date.CultureStrings||!Date.CultureStrings[c])if("undefined"!=typeof exports&&this.exports!==exports)try{require("../i18n/"+c+".js"),b=c,Date.CultureStrings.lang=c,Date.CultureInfo=new i}catch(h){throw new Error("The DateJS IETF language tag '"+c+"' could not be loaded by Node. It likely does not exist.")}else{if(!Date.Config||!Date.Config.i18n)return Date.console.error("The DateJS IETF language tag '"+c+"' is not available and has not been loaded."),!1;f=!0,g(c).done(function(){b=c,Date.CultureStrings=Date.CultureStrings||{},Date.CultureStrings.lang=c,Date.CultureInfo=new i,a.Parsing.Normalizer.buildReplaceData(),a.Grammar&&a.Grammar.buildGrammarFormats(),e&&setTimeout(e,0)})}a.Parsing.Normalizer.buildReplaceData(),a.Grammar&&a.Grammar.buildGrammarFormats(),!f&&e&&setTimeout(e,0)},getLoggedKeys:function(){return c},updateCultureInfo:function(){Date.CultureInfo=new i}},a.i18n.updateCultureInfo()}(),function(){var a=Date,b=a.prototype,c=function(a,b){return b||(b=2),("000"+a).slice(-1*b)};"undefined"!=typeof window&&"undefined"!=typeof window.console&&"undefined"!=typeof window.console.log?a.console=console:a.console={log:function(){},error:function(){}},a.Config=a.Config||{},a.initOverloads=function(){a.now?a._now||(a._now=a.now):a._now=function(){return(new Date).getTime()},a.now=function(b){return b?a.present():a._now()},b.toISOString||(b.toISOString=function(){return this.getUTCFullYear()+"-"+c(this.getUTCMonth()+1)+"-"+c(this.getUTCDate())+"T"+c(this.getUTCHours())+":"+c(this.getUTCMinutes())+":"+c(this.getUTCSeconds())+"."+String((this.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}),void 0===b._toString&&(b._toString=b.toString)},a.initOverloads(),a.today=function(){return(new Date).clearTime()},a.present=function(){return new Date},a.compare=function(a,b){if(isNaN(a)||isNaN(b))throw new Error(a+" - "+b);if(a instanceof Date&&b instanceof Date)return b>a?-1:a>b?1:0;throw new TypeError(a+" - "+b)},a.equals=function(a,b){return 0===a.compareTo(b)},a.getDayName=function(a){return Date.CultureInfo.dayNames[a]},a.getDayNumberFromName=function(a){for(var b=Date.CultureInfo.dayNames,c=Date.CultureInfo.abbreviatedDayNames,d=Date.CultureInfo.shortestDayNames,e=a.toLowerCase(),f=0;f<b.length;f++)if(b[f].toLowerCase()===e||c[f].toLowerCase()===e||d[f].toLowerCase()===e)return f;return-1},a.getMonthNumberFromName=function(a){for(var b=Date.CultureInfo.monthNames,c=Date.CultureInfo.abbreviatedMonthNames,d=a.toLowerCase(),e=0;e<b.length;e++)if(b[e].toLowerCase()===d||c[e].toLowerCase()===d)return e;return-1},a.getMonthName=function(a){return Date.CultureInfo.monthNames[a]},a.isLeapYear=function(a){return a%4===0&&a%100!==0||a%400===0},a.getDaysInMonth=function(b,c){return!c&&a.validateMonth(b)&&(c=b,b=Date.today().getFullYear()),[31,a.isLeapYear(b)?29:28,31,30,31,30,31,31,30,31,30,31][c]},b.getDaysInMonth=function(){return a.getDaysInMonth(this.getFullYear(),this.getMonth())},a.getTimezoneAbbreviation=function(a,b){var c,d=b?Date.CultureInfo.abbreviatedTimeZoneDST:Date.CultureInfo.abbreviatedTimeZoneStandard;for(c in d)if(d.hasOwnProperty(c)&&d[c]===a)return c;return null},a.getTimezoneOffset=function(a,b){var c,d=[],e=Date.CultureInfo.timezones;for(a||(a=(new Date).getTimezone()),c=0;c<e.length;c++)e[c].name===a.toUpperCase()&&d.push(c);if(!e[d[0]])return null;if(1===d.length||!b)return e[d[0]].offset;for(c=0;c<d.length;c++)if(e[d[c]].dst)return e[d[c]].offset},a.getQuarter=function(a){a=a||new Date;var b=[1,2,3,4];return b[Math.floor(a.getMonth()/3)]},a.getDaysLeftInQuarter=function(a){a=a||new Date;var b=new Date(a);return b.setMonth(b.getMonth()+3-b.getMonth()%3,0),Math.floor((b-a)/864e5)};var d=function(a,b,c,d){if(d=d?d:"Object","undefined"==typeof a)return!1;if("number"!=typeof a)throw new TypeError(a+" is not a Number.");return!(b>a||a>c)};a.validateMillisecond=function(a){return d(a,0,999,"millisecond")},a.validateSecond=function(a){return d(a,0,59,"second")},a.validateMinute=function(a){return d(a,0,59,"minute")},a.validateHour=function(a){return d(a,0,23,"hour")},a.validateDay=function(b,c,e){return void 0===c||null===c||void 0===e||null===e?!1:d(b,1,a.getDaysInMonth(c,e),"day")},a.validateWeek=function(a){return d(a,0,53,"week")},a.validateMonth=function(a){return d(a,0,11,"month")},a.validateYear=function(a){return d(a,-271822,275760,"year")},a.validateTimezone=function(a){var b={ACDT:1,ACST:1,ACT:1,ADT:1,AEDT:1,AEST:1,AFT:1,AKDT:1,AKST:1,AMST:1,AMT:1,ART:1,AST:1,AWDT:1,AWST:1,AZOST:1,AZT:1,BDT:1,BIOT:1,BIT:1,BOT:1,BRT:1,BST:1,BTT:1,CAT:1,CCT:1,CDT:1,CEDT:1,CEST:1,CET:1,CHADT:1,CHAST:1,CHOT:1,ChST:1,CHUT:1,CIST:1,CIT:1,CKT:1,CLST:1,CLT:1,COST:1,COT:1,CST:1,CT:1,CVT:1,CWST:1,CXT:1,DAVT:1,DDUT:1,DFT:1,EASST:1,EAST:1,EAT:1,ECT:1,EDT:1,EEDT:1,EEST:1,EET:1,EGST:1,EGT:1,EIT:1,EST:1,FET:1,FJT:1,FKST:1,FKT:1,FNT:1,GALT:1,GAMT:1,GET:1,GFT:1,GILT:1,GIT:1,GMT:1,GST:1,GYT:1,HADT:1,HAEC:1,HAST:1,HKT:1,HMT:1,HOVT:1,HST:1,ICT:1,IDT:1,IOT:1,IRDT:1,IRKT:1,IRST:1,IST:1,JST:1,KGT:1,KOST:1,KRAT:1,KST:1,LHST:1,LINT:1,MAGT:1,MART:1,MAWT:1,MDT:1,MET:1,MEST:1,MHT:1,MIST:1,MIT:1,MMT:1,MSK:1,MST:1,MUT:1,MVT:1,MYT:1,NCT:1,NDT:1,NFT:1,NPT:1,NST:1,NT:1,NUT:1,NZDT:1,NZST:1,OMST:1,ORAT:1,PDT:1,PET:1,PETT:1,PGT:1,PHOT:1,PHT:1,PKT:1,PMDT:1,PMST:1,PONT:1,PST:1,PYST:1,PYT:1,RET:1,ROTT:1,SAKT:1,SAMT:1,SAST:1,SBT:1,SCT:1,SGT:1,SLST:1,SRT:1,SST:1,SYOT:1,TAHT:1,THA:1,TFT:1,TJT:1,TKT:1,TLT:1,TMT:1,TOT:1,TVT:1,UCT:1,ULAT:1,UTC:1,UYST:1,UYT:1,UZT:1,VET:1,VLAT:1,VOLT:1,VOST:1,VUT:1,WAKT:1,WAST:1,WAT:1,WEDT:1,WEST:1,WET:1,WST:1,YAKT:1,YEKT:1,Z:1};return 1===b[a]},a.validateTimezoneOffset=function(a){return a>-841&&721>a}}(),function(){var a=Date,b=a.prototype,c=function(a,b){return b||(b=2),("000"+a).slice(-1*b)},d=function(b){var c,d,e={},f=this;d=function(c,d,e){if("day"===c){var g=void 0!==b.month?b.month:f.getMonth(),h=void 0!==b.year?b.year:f.getFullYear();return a[d](e,h,g)}return a[d](e)};for(c in b)if(hasOwnProperty.call(b,c)){var g="validate"+c.charAt(0).toUpperCase()+c.slice(1);a[g]&&null!==b[c]&&d(c,g,b[c])&&(e[c]=b[c])}return e};b.clearTime=function(){return this.setHours(0),this.setMinutes(0),this.setSeconds(0),this.setMilliseconds(0),this},b.setTimeToNow=function(){var a=new Date;return this.setHours(a.getHours()),this.setMinutes(a.getMinutes()),this.setSeconds(a.getSeconds()),this.setMilliseconds(a.getMilliseconds()),this},b.clone=function(){return new Date(this.getTime())},b.compareTo=function(a){return Date.compare(this,a)},b.equals=function(a){return Date.equals(this,void 0!==a?a:new Date)},b.between=function(a,b){return this.getTime()>=a.getTime()&&this.getTime()<=b.getTime()},b.isAfter=function(a){return 1===this.compareTo(a||new Date)},b.isBefore=function(a){return-1===this.compareTo(a||new Date)},b.isToday=b.isSameDay=function(a){return this.clone().clearTime().equals((a||new Date).clone().clearTime())},b.addMilliseconds=function(a){return a?(this.setTime(this.getTime()+1*a),this):this},b.addSeconds=function(a){return a?this.addMilliseconds(1e3*a):this},b.addMinutes=function(a){return a?this.addMilliseconds(6e4*a):this},b.addHours=function(a){return a?this.addMilliseconds(36e5*a):this},b.addDays=function(a){return a?(this.setDate(this.getDate()+1*a),this):this},b.addWeekdays=function(a){if(!a)return this;var b=this.getDay(),c=Math.ceil(Math.abs(a)/7);if(0!==b&&6!==b||a>0&&(this.next().monday(),this.addDays(-1),b=this.getDay()),0>a){for(;0>a;)this.addDays(-1),b=this.getDay(),0!==b&&6!==b&&a++;return this}return(a>5||a>=6-b)&&(a+=2*c),this.addDays(a)},b.addWeeks=function(a){return a?this.addDays(7*a):this},b.addMonths=function(b){if(!b)return this;var c=this.getDate();return this.setDate(1),this.setMonth(this.getMonth()+1*b),this.setDate(Math.min(c,a.getDaysInMonth(this.getFullYear(),this.getMonth()))),this},b.addQuarters=function(a){return a?this.addMonths(3*a):this},b.addYears=function(a){return a?this.addMonths(12*a):this},b.add=function(a){if("number"==typeof a)return this._orient=a,this;var b=a;return b.day&&b.day-this.getDate()!==0&&this.setDate(b.day),b.milliseconds&&this.addMilliseconds(b.milliseconds),b.seconds&&this.addSeconds(b.seconds),b.minutes&&this.addMinutes(b.minutes),b.hours&&this.addHours(b.hours),b.weeks&&this.addWeeks(b.weeks),b.months&&this.addMonths(b.months),b.years&&this.addYears(b.years),b.days&&this.addDays(b.days),this},b.getWeek=function(a){var b,c=new Date(this.valueOf());a?(c.addMinutes(c.getTimezoneOffset()),b=c.clone()):b=this;var d=(b.getDay()+6)%7;c.setDate(c.getDate()-d+3);var e=c.valueOf();return c.setMonth(0,1),4!==c.getDay()&&c.setMonth(0,1+(4-c.getDay()+7)%7),1+Math.ceil((e-c)/6048e5)},b.getISOWeek=function(){return c(this.getWeek(!0))},b.setWeek=function(a){return a-this.getWeek()===0?1!==this.getDay()?this.moveToDayOfWeek(1,this.getDay()>1?-1:1):this:this.moveToDayOfWeek(1,this.getDay()>1?-1:1).addWeeks(a-this.getWeek())},b.setQuarter=function(a){var b=Math.abs(3*(a-1)+1);return this.setMonth(b,1)},b.getQuarter=function(){return Date.getQuarter(this)},b.getDaysLeftInQuarter=function(){return Date.getDaysLeftInQuarter(this)},b.moveToNthOccurrence=function(a,b){if("Weekday"===a){if(b>0)this.moveToFirstDayOfMonth(),this.is().weekday()&&(b-=1);else{if(!(0>b))return this;this.moveToLastDayOfMonth(),this.is().weekday()&&(b+=1)}return this.addWeekdays(b)}var c=0;if(b>0)c=b-1;else if(-1===b)return this.moveToLastDayOfMonth(),this.getDay()!==a&&this.moveToDayOfWeek(a,-1),this;return this.moveToFirstDayOfMonth().addDays(-1).moveToDayOfWeek(a,1).addWeeks(c)};var e=function(a,b,c){return function(d,e){var f=(d-this[a]()+c*(e||1))%c;return this[b](0===f?f+=c*(e||1):f)}};b.moveToDayOfWeek=e("getDay","addDays",7),b.moveToMonth=e("getMonth","addMonths",12),b.getOrdinate=function(){var a=this.getDate();return f(a)},b.getOrdinalNumber=function(){return Math.ceil((this.clone().clearTime()-new Date(this.getFullYear(),0,1))/864e5)+1},b.getTimezone=function(){return a.getTimezoneAbbreviation(this.getUTCOffset(),this.isDaylightSavingTime())},b.setTimezoneOffset=function(a){var b=this.getTimezoneOffset(),c=-6*Number(a)/10;return c||0===c?this.addMinutes(c-b):this},b.setTimezone=function(b){return this.setTimezoneOffset(a.getTimezoneOffset(b))},b.hasDaylightSavingTime=function(){return Date.today().set({month:0,day:1}).getTimezoneOffset()!==Date.today().set({month:6,day:1}).getTimezoneOffset()},b.isDaylightSavingTime=function(){return Date.today().set({month:0,day:1}).getTimezoneOffset()!==this.getTimezoneOffset()},b.getUTCOffset=function(a){var b,c=-10*(a||this.getTimezoneOffset())/6;return 0>c?(b=(c-1e4).toString(),b.charAt(0)+b.substr(2)):(b=(c+1e4).toString(),"+"+b.substr(1))},b.getElapsed=function(a){return(a||new Date)-this},b.set=function(a){a=d.call(this,a);var b;for(b in a)if(hasOwnProperty.call(a,b)){var c,e,f=b.charAt(0).toUpperCase()+b.slice(1);"week"!==b&&"month"!==b&&"timezone"!==b&&"timezoneOffset"!==b&&(f+="s"),c="add"+f,e="get"+f,"month"===b?c+="s":"year"===b&&(e="getFullYear"),"day"!==b&&"timezone"!==b&&"timezoneOffset"!==b&&"week"!==b&&"hour"!==b?this[c](a[b]-this[e]()):"timezone"!==b&&"timezoneOffset"!==b&&"week"!==b&&"hour"!==b||this["set"+f](a[b])}return a.day&&this.addDays(a.day-this.getDate()),this},b.moveToFirstDayOfMonth=function(){return this.set({day:1})},b.moveToLastDayOfMonth=function(){return this.set({day:a.getDaysInMonth(this.getFullYear(),this.getMonth())})};var f=function(a){switch(1*a){case 1:case 21:case 31:return"st";case 2:case 22:return"nd";case 3:case 23:return"rd";default:return"th"}},g=function(a){var b,c=Date.CultureInfo.formatPatterns;switch(a){case"d":return this.toString(c.shortDate);case"D":return this.toString(c.longDate);case"F":return this.toString(c.fullDateTime);case"m":return this.toString(c.monthDay);case"r":case"R":return b=this.clone().addMinutes(this.getTimezoneOffset()),b.toString(c.rfc1123)+" GMT";case"s":return this.toString(c.sortableDateTime);case"t":return this.toString(c.shortTime);case"T":return this.toString(c.longTime);case"u":return b=this.clone().addMinutes(this.getTimezoneOffset()),b.toString(c.universalSortableDateTime);case"y":return this.toString(c.yearMonth);default:return!1}},h=function(b){return function(d){if("\\"===d.charAt(0))return d.replace("\\","");switch(d){case"hh":return c(b.getHours()<13?0===b.getHours()?12:b.getHours():b.getHours()-12);case"h":return b.getHours()<13?0===b.getHours()?12:b.getHours():b.getHours()-12;case"HH":return c(b.getHours());case"H":return b.getHours();case"mm":return c(b.getMinutes());case"m":return b.getMinutes();case"ss":return c(b.getSeconds());case"s":return b.getSeconds();case"yyyy":return c(b.getFullYear(),4);case"yy":return c(b.getFullYear());case"y":return b.getFullYear();case"E":case"dddd":return Date.CultureInfo.dayNames[b.getDay()];case"ddd":return Date.CultureInfo.abbreviatedDayNames[b.getDay()];case"dd":return c(b.getDate());case"d":return b.getDate();case"MMMM":return Date.CultureInfo.monthNames[b.getMonth()];case"MMM":return Date.CultureInfo.abbreviatedMonthNames[b.getMonth()];case"MM":return c(b.getMonth()+1);case"M":return b.getMonth()+1;case"t":return b.getHours()<12?Date.CultureInfo.amDesignator.substring(0,1):Date.CultureInfo.pmDesignator.substring(0,1);case"tt":return b.getHours()<12?Date.CultureInfo.amDesignator:Date.CultureInfo.pmDesignator;case"S":return f(b.getDate());case"W":return b.getWeek();case"WW":return b.getISOWeek();case"Q":return"Q"+b.getQuarter();case"q":return String(b.getQuarter());case"z":return b.getTimezone();case"Z":case"X":return Date.getTimezoneOffset(b.getTimezone());case"ZZ":return-60*b.getTimezoneOffset();case"u":return b.getDay();case"L":return a.isLeapYear(b.getFullYear())?1:0;case"B":return"@"+(b.getUTCSeconds()+60*b.getUTCMinutes()+3600*(b.getUTCHours()+1))/86.4;default:return d}}};b.toString=function(a,b){if(!b&&a&&1===a.length&&(output=g.call(this,a),output))return output;var c=h(this);return a?a.replace(/((\\)?(dd?d?d?|MM?M?M?|yy?y?y?|hh?|HH?|mm?|ss?|tt?|S|q|Q|WW?W?W?)(?![^\[]*\]))/g,c).replace(/\[|\]/g,""):this._toString()}}(),function(){var a=Date,b=a.prototype,c=Number.prototype;b._orient=1,b._nth=null,b._is=!1,b._same=!1,b._isSecond=!1,c._dateElement="days",b.next=function(){return this._move=!0,this._orient=1,this},a.next=function(){return a.today().next()},b.last=b.prev=b.previous=function(){return this._move=!0,this._orient=-1,this},a.last=a.prev=a.previous=function(){return a.today().last()},b.is=function(){return this._is=!0,this},b.same=function(){return this._same=!0,this._isSecond=!1,this},b.today=function(){return this.same().day()},b.weekday=function(){return this._nth?j("Weekday").call(this):this._move?this.addWeekdays(this._orient):this._is?(this._is=!1,!this.is().sat()&&!this.is().sun()):!1},b.weekend=function(){return this._is?(this._is=!1,this.is().sat()||this.is().sun()):!1},b.at=function(b){return"string"==typeof b?a.parse(this.toString("d")+" "+b):this.set(b)},c.fromNow=c.after=function(a){var b={};return b[this._dateElement]=this,(a?a.clone():new Date).add(b)},c.ago=c.before=function(a){var b={},c="s"!==this._dateElement[this._dateElement.length-1]?this._dateElement+"s":this._dateElement;return b[c]=-1*this,(a?a.clone():new Date).add(b)};var d,e="sunday monday tuesday wednesday thursday friday saturday".split(/\s/),f="january february march april may june july august september october november december".split(/\s/),g="Millisecond Second Minute Hour Day Week Month Year Quarter Weekday".split(/\s/),h="Milliseconds Seconds Minutes Hours Date Week Month FullYear Quarter".split(/\s/),i="final first second third fourth fifth".split(/\s/);b.toObject=function(){for(var a={},b=0;b<g.length;b++)this["get"+h[b]]&&(a[g[b].toLowerCase()]=this["get"+h[b]]());return a},a.fromObject=function(a){return a.week=null,Date.today().set(a)};var j=function(b){return function(){if(this._is)return this._is=!1,this.getDay()===b;if(this._move&&(this._move=null),null!==this._nth){this._isSecond&&this.addSeconds(-1*this._orient),this._isSecond=!1;var c=this._nth;this._nth=null;var d=this.clone().moveToLastDayOfMonth();if(this.moveToNthOccurrence(b,c),this>d)throw new RangeError(a.getDayName(b)+" does not occur "+c+" times in the month of "+a.getMonthName(d.getMonth())+" "+d.getFullYear()+".");return this}return this.moveToDayOfWeek(b,this._orient)}},k=function(b){return function(){var c=a.today(),d=b-c.getDay();return 0===b&&1===Date.CultureInfo.firstDayOfWeek&&0!==c.getDay()&&(d+=7),c.addDays(d)}},l=function(a){return function(){return this._is?(this._is=!1,this.getMonth()===a):this.moveToMonth(a,this._orient)}},m=function(b){return function(){return a.today().set({month:b,day:1})}},n=function(c,d,e){for(var f=0;f<c.length;f++)a[c[f].toUpperCase()]=a[c[f].toUpperCase().substring(0,3)]=f,a[c[f]]=a[c[f].substring(0,3)]=d(f),b[c[f]]=b[c[f].substring(0,3)]=e(f)};n(e,k,j),n(f,m,l);for(var o=function(a){return function(){if(this._isSecond)return this._isSecond=!1,this;if(this._same){this._same=this._is=!1;var b=this.toObject(),c=(arguments[0]||new Date).toObject(),d="",e=a.toLowerCase();e="s"===e[e.length-1]?e.substring(0,e.length-1):e;for(var f=g.length-1;f>-1;f--){if(d=g[f].toLowerCase(),b[d]!==c[d])return!1;if(e===d)break}return!0}return"s"!==a.substring(a.length-1)&&(a+="s"),this._move&&(this._move=null),this["add"+a](this._orient)}},p=function(a){return function(){return this._dateElement=a,this}},q=0;q<g.length;q++)d=g[q].toLowerCase(),"weekday"!==d&&(b[d]=b[d+"s"]=o(g[q]),c[d]=c[d+"s"]=p(d+"s"));b._ss=o("Second");for(var r=function(a){return function(b){return this._same?this._ss(arguments[0]):b||0===b?this.moveToNthOccurrence(b,a):(this._nth=a,2!==a||void 0!==b&&null!==b?this:(this._isSecond=!0,this.addSeconds(this._orient)))}},s=0;s<i.length;s++)b[i[s]]=r(0===s?-1:s)}(),function(){"use strict";Date.Parsing={Exception:function(a){this.message="Parse error at '"+a.substring(0,10)+" ...'"}};var a=Date.Parsing,b={standard:[0,31,59,90,120,151,181,212,243,273,304,334],leap:[0,31,60,91,121,152,182,213,244,274,305,335]};a.isLeapYear=function(a){return a%4===0&&a%100!==0||a%400===0};var c={multiReplace:function(a,b){var c;for(c in b)if(Object.prototype.hasOwnProperty.call(b,c)){var d;"function"==typeof b[c]||(d=b[c]instanceof RegExp?b[c]:new RegExp(b[c],"g")),a=a.replace(d,c)}return a},getDayOfYearFromWeek:function(a){var b,c,d;return a.weekDay=a.weekDay||0===a.weekDay?a.weekDay:1,b=new Date(a.year,0,4),c=0===b.getDay()?7:b.getDay(),d=c+3,a.dayOfYear=7*a.week+(0===a.weekDay?7:a.weekDay)-d,a},getDayOfYear:function(a,b){a.dayOfYear||(a=c.getDayOfYearFromWeek(a));for(var d=0;d<=b.length;d++){if(a.dayOfYear<b[d]||d===b.length){a.day=a.day?a.day:a.dayOfYear-b[d-1];break}a.month=d}return a},adjustForTimeZone:function(a,b){var c;return"Z"===a.zone.toUpperCase()||0===a.zone_hours&&0===a.zone_minutes?c=-b.getTimezoneOffset():(c=60*a.zone_hours+(a.zone_minutes||0),"+"===a.zone_sign&&(c*=-1),c-=b.getTimezoneOffset()),b.setMinutes(b.getMinutes()+c),b},setDefaults:function(a){return a.year=a.year||Date.today().getFullYear(),a.hours=a.hours||0,a.minutes=a.minutes||0,a.seconds=a.seconds||0,a.milliseconds=a.milliseconds||0,(a.month||!a.week&&!a.dayOfYear)&&(a.month=a.month||0,a.day=a.day||1),a},dataNum:function(a,b,c,d){var e=1*a;return b?d?a?1*b(a):a:a?b(e):a:c?a&&"undefined"!=typeof a?e:a:a?e:a},timeDataProcess:function(a){var b={};for(var d in a.data)a.data.hasOwnProperty(d)&&(b[d]=a.ignore[d]?a.data[d]:c.dataNum(a.data[d],a.mods[d],a.explict[d],a.postProcess[d]));return a.data.secmins&&(a.data.secmins=60*a.data.secmins.replace(",","."),b.minutes?b.seconds||(b.seconds=a.data.secmins):b.minutes=a.data.secmins,delete a.secmins),b},buildTimeObjectFromData:function(a){var b=c.timeDataProcess({data:{year:a[1],month:a[5],day:a[7],week:a[8],dayOfYear:a[10],hours:a[15],zone_hours:a[23],zone_minutes:a[24],zone:a[21],zone_sign:a[22],weekDay:a[9],minutes:a[16],seconds:a[19],milliseconds:a[20],secmins:a[18]},mods:{month:function(a){return a-1},weekDay:function(a){return a=Math.abs(a),7===a?0:a},minutes:function(a){return a.replace(":","")},seconds:function(a){return Math.floor(1*a.replace(":","").replace(",","."))},milliseconds:function(a){return 1e3*a.replace(",",".")}},postProcess:{minutes:!0,seconds:!0,milliseconds:!0},explict:{zone_hours:!0,zone_minutes:!0},ignore:{zone:!0,zone_sign:!0,secmins:!0}});return b},addToHash:function(a,b,c){b=b,c=c;for(var d=b.length,e=0;d>e;e++)a[b[e]]=c[e];return a},combineRegex:function(a,b){return new RegExp("(("+a.source+")\\s("+b.source+"))")},getDateNthString:function(a,b,c){return a?Date.today().addDays(c).toString("d"):b?Date.today().last()[c]().toString("d"):void 0},buildRegexData:function(a){for(var b=[],c=a.length,d=0;c>d;d++)"[object Array]"===Object.prototype.toString.call(a[d])?b.push(this.combineRegex(a[d][0],a[d][1])):b.push(a[d]);
return b}};a.processTimeObject=function(d){var e,f;return c.setDefaults(d),f=a.isLeapYear(d.year)?b.leap:b.standard,d.month||!d.week&&!d.dayOfYear?d.dayOfYear=f[d.month]+d.day:c.getDayOfYear(d,f),e=new Date(d.year,d.month,d.day,d.hours,d.minutes,d.seconds,d.milliseconds),d.zone&&c.adjustForTimeZone(d,e),e},a.ISO={regex:/^([\+-]?\d{4}(?!\d{2}\b))((-?)((0[1-9]|1[0-2])(\3([12]\d|0[1-9]|3[01]))?|W([0-4]\d|5[0-3])(-?[1-7])?|(00[1-9]|0[1-9]\d|[12]\d{2}|3([0-5]\d|6[1-6])))([T\s]((([01]\d|2[0-4])((:?)[0-5]\d)?|24\:?00)([\.,]\d+(?!:))?)?(\17[0-5]\d([\.,]\d+)?)?\s?([zZ]|([\+-])([01]\d|2[0-3]):?([0-5]\d)?)?)?)?$/,parse:function(b){var d,e=b.match(this.regex);return e&&e.length?(d=c.buildTimeObjectFromData(e),d.year&&(d.year||d.month||d.day||d.week||d.dayOfYear)?a.processTimeObject(d):null):null}},a.Numeric={isNumeric:function(a){return!isNaN(parseFloat(a))&&isFinite(a)},regex:/\b([0-1]?[0-9])([0-3]?[0-9])([0-2]?[0-9]?[0-9][0-9])\b/i,parse:function(b){var c,d,e={},f=Date.CultureInfo.dateElementOrder.split("");if(!this.isNumeric(b)||"+"===b[0]&&"-"===b[0])return null;if(b.length<5&&b.indexOf(".")<0&&b.indexOf("/")<0)return e.year=b,a.processTimeObject(e);if(c=b.match(this.regex),!c||!c.length)return null;for(d=0;d<f.length;d++)switch(f[d]){case"d":e.day=c[d+1];break;case"m":e.month=c[d+1]-1;break;case"y":e.year=c[d+1]}return a.processTimeObject(e)}},a.Normalizer={regexData:function(){var a=Date.CultureInfo.regexPatterns;return c.buildRegexData([a.tomorrow,a.yesterday,[a.past,a.mon],[a.past,a.tue],[a.past,a.wed],[a.past,a.thu],[a.past,a.fri],[a.past,a.sat],[a.past,a.sun]])},basicReplaceHash:function(){var a=Date.CultureInfo.regexPatterns;return{January:a.jan.source,February:a.feb,March:a.mar,April:a.apr,May:a.may,June:a.jun,July:a.jul,August:a.aug,September:a.sep,October:a.oct,November:a.nov,December:a.dec,"":/\bat\b/gi," ":/\s{2,}/,am:a.inTheMorning,"9am":a.thisMorning,pm:a.inTheEvening,"7pm":a.thisEvening}},keys:function(){return[c.getDateNthString(!0,!1,1),c.getDateNthString(!0,!1,-1),c.getDateNthString(!1,!0,"monday"),c.getDateNthString(!1,!0,"tuesday"),c.getDateNthString(!1,!0,"wednesday"),c.getDateNthString(!1,!0,"thursday"),c.getDateNthString(!1,!0,"friday"),c.getDateNthString(!1,!0,"saturday"),c.getDateNthString(!1,!0,"sunday")]},buildRegexFunctions:function(){var a=Date.CultureInfo.regexPatterns,b=Date.i18n.__,c=new RegExp("(\\b\\d\\d?("+b("AM")+"|"+b("PM")+")? )("+a.tomorrow.source.slice(1)+")","i"),d=new RegExp(a.today.source+"(?!\\s*([+-]))\\b");this.replaceFuncs=[[d,function(a){return a.length>1?Date.today().toString("d"):a}],[c,function(a,b){var c=Date.today().addDays(1).toString("d");return c+" "+b}],[a.amThisMorning,function(a,b){return b}],[a.pmThisEvening,function(a,b){return b}]]},buildReplaceData:function(){this.buildRegexFunctions(),this.replaceHash=c.addToHash(this.basicReplaceHash(),this.keys(),this.regexData())},stringReplaceFuncs:function(a){for(var b=0;b<this.replaceFuncs.length;b++)a=a.replace(this.replaceFuncs[b][0],this.replaceFuncs[b][1]);return a},parse:function(b){b=this.stringReplaceFuncs(b),b=c.multiReplace(b,this.replaceHash);try{var d=b.split(/([\s\-\.\,\/\x27]+)/);3===d.length&&a.Numeric.isNumeric(d[0])&&a.Numeric.isNumeric(d[2])&&d[2].length>=4&&"d"===Date.CultureInfo.dateElementOrder[0]&&(b="1/"+d[0]+"/"+d[2])}catch(e){}return b}},a.Normalizer.buildReplaceData()}(),function(){for(var a=Date.Parsing,b=a.Operators={rtoken:function(b){return function(c){var d=c.match(b);if(d)return[d[0],c.substring(d[0].length)];throw new a.Exception(c)}},token:function(){return function(a){return b.rtoken(new RegExp("^\\s*"+a+"\\s*"))(a)}},stoken:function(a){return b.rtoken(new RegExp("^"+a))},until:function(a){return function(b){for(var c=[],d=null;b.length;){try{d=a.call(this,b)}catch(e){c.push(d[0]),b=d[1];continue}break}return[c,b]}},many:function(a){return function(b){for(var c=[],d=null;b.length;){try{d=a.call(this,b)}catch(e){return[c,b]}c.push(d[0]),b=d[1]}return[c,b]}},optional:function(a){return function(b){var c=null;try{c=a.call(this,b)}catch(d){return[null,b]}return[c[0],c[1]]}},not:function(b){return function(c){try{b.call(this,c)}catch(d){return[null,c]}throw new a.Exception(c)}},ignore:function(a){return a?function(b){var c=null;return c=a.call(this,b),[null,c[1]]}:null},product:function(){for(var a=arguments[0],c=Array.prototype.slice.call(arguments,1),d=[],e=0;e<a.length;e++)d.push(b.each(a[e],c));return d},cache:function(b){var c={},d=0,e=[],f=Date.Config.CACHE_MAX||1e5,g=null,h=function(){if(d===f)for(var a=0;10>a;a++){var b=e.shift();b&&(delete c[b],d--)}};return function(f){h();try{g=c[f]=c[f]||b.call(this,f)}catch(i){g=c[f]=i}if(d++,e.push(f),g instanceof a.Exception)throw g;return g}},any:function(){var b=arguments;return function(c){for(var d=null,e=0;e<b.length;e++)if(null!=b[e]){try{d=b[e].call(this,c)}catch(f){d=null}if(d)return d}throw new a.Exception(c)}},each:function(){var b=arguments;return function(c){for(var d=[],e=null,f=0;f<b.length;f++)if(null!=b[f]){try{e=b[f].call(this,c)}catch(g){throw new a.Exception(c)}d.push(e[0]),c=e[1]}return[d,c]}},all:function(){var a=arguments,b=b;return b.each(b.optional(a))},sequence:function(c,d,e){return d=d||b.rtoken(/^\s*/),e=e||null,1===c.length?c[0]:function(b){for(var f=null,g=null,h=[],i=0;i<c.length;i++){try{f=c[i].call(this,b)}catch(j){break}h.push(f[0]);try{g=d.call(this,f[1])}catch(k){g=null;break}b=g[1]}if(!f)throw new a.Exception(b);if(g)throw new a.Exception(g[1]);if(e)try{f=e.call(this,f[1])}catch(l){throw new a.Exception(f[1])}return[h,f?f[1]:b]}},between:function(a,c,d){d=d||a;var e=b.each(b.ignore(a),c,b.ignore(d));return function(a){var b=e.call(this,a);return[[b[0][0],r[0][2]],b[1]]}},list:function(a,c,d){return c=c||b.rtoken(/^\s*/),d=d||null,a instanceof Array?b.each(b.product(a.slice(0,-1),b.ignore(c)),a.slice(-1),b.ignore(d)):b.each(b.many(b.each(a,b.ignore(c))),px,b.ignore(d))},set:function(c,d,e){return d=d||b.rtoken(/^\s*/),e=e||null,function(f){for(var g=null,h=null,i=null,j=null,k=[[],f],l=!1,m=0;m<c.length;m++){i=null,h=null,g=null,l=1===c.length;try{g=c[m].call(this,f)}catch(n){continue}if(j=[[g[0]],g[1]],g[1].length>0&&!l)try{i=d.call(this,g[1])}catch(o){l=!0}else l=!0;if(l||0!==i[1].length||(l=!0),!l){for(var p=[],q=0;q<c.length;q++)m!==q&&p.push(c[q]);h=b.set(p,d).call(this,i[1]),h[0].length>0&&(j[0]=j[0].concat(h[0]),j[1]=h[1])}if(j[1].length<k[1].length&&(k=j),0===k[1].length)break}if(0===k[0].length)return k;if(e){try{i=e.call(this,k[1])}catch(r){throw new a.Exception(k[1])}k[1]=i[1]}return k}},forward:function(a,b){return function(c){return a[b].call(this,c)}},replace:function(a,b){return function(c){var d=a.call(this,c);return[b,d[1]]}},process:function(a,b){return function(c){var d=a.call(this,c);return[b.call(this,d[0]),d[1]]}},min:function(b,c){return function(d){var e=c.call(this,d);if(e[0].length<b)throw new a.Exception(d);return e}}},c=function(a){function b(){var b,c,d=null,e=[];return arguments.length>1?d=Array.prototype.slice.call(arguments):arguments[0]instanceof Array&&(d=arguments[0]),d?(b=d.shift(),b.length>0?(d.unshift(b[c]),e.push(a.apply(null,d)),d.shift(),e):void 0):a.apply(null,arguments)}return b},d="optional not ignore cache".split(/\s/),e=0;e<d.length;e++)b[d[e]]=c(b[d[e]]);for(var f=function(a){return function(){return arguments[0]instanceof Array?a.apply(null,arguments[0]):a.apply(null,arguments)}},g="each any all".split(/\s/),h=0;h<g.length;h++)b[g[h]]=f(b[g[h]])}(),function(){var a=Date,b=function(a){for(var c=[],d=0;d<a.length;d++)a[d]instanceof Array?c=c.concat(b(a[d])):a[d]&&c.push(a[d]);return c},c=function(){if(this.meridian&&(this.hour||0===this.hour)){if("a"===this.meridian&&this.hour>11&&Date.Config.strict24hr)throw"Invalid hour and meridian combination";if("p"===this.meridian&&this.hour<12&&Date.Config.strict24hr)throw"Invalid hour and meridian combination";"p"===this.meridian&&this.hour<12?this.hour=this.hour+12:"a"===this.meridian&&12===this.hour&&(this.hour=0)}},d=function(){var a=new Date;!this.hour&&!this.minute||this.month||this.year||this.day||(this.day=a.getDate()),this.year||(this.year=a.getFullYear()),this.month||0===this.month||(this.month=a.getMonth()),this.day||(this.day=1),this.hour||(this.hour=0),this.minute||(this.minute=0),this.second||(this.second=0),this.millisecond||(this.millisecond=0)},e={getToday:function(){return this.now||-1!=="hour minute second".indexOf(this.unit)?new Date:a.today()},setDaysFromWeekday:function(b,c){var d;return c=c||1,this.unit="day",d=a.getDayNumberFromName(this.weekday)-b.getDay(),this.days=d?(d+7*c)%7:7*c,this},setMonthsFromMonth:function(a,b){var c;return b=b||1,this.unit="month",c=this.month-a.getMonth(),this.months=c?(c+12*b)%12:12*b,this.month=null,this},setDMYFromWeekday:function(){var a=Date[this.weekday]();return this.day=a.getDate(),this.month||(this.month=a.getMonth()),this.year=a.getFullYear(),this},setUnitValue:function(a){!this.value&&this.operator&&null!==this.operator&&this[this.unit+"s"]&&null!==this[this.unit+"s"]?this[this.unit+"s"]=this[this.unit+"s"]+("add"===this.operator?1:-1)+(this.value||0)*a:null!=this[this.unit+"s"]&&null==this.operator||(this.value||(this.value=1),this[this.unit+"s"]=this.value*a)},generateDateFromWeeks:function(){var a=void 0!==this.weekday?this.weekday:"today",b=Date[a]().addWeeks(this.weeks);return this.now&&b.setTimeToNow(),b}};a.Translator={hour:function(a){return function(){this.hour=Number(a)}},minute:function(a){return function(){this.minute=Number(a)}},second:function(a){return function(){this.second=Number(a)}},secondAndMillisecond:function(a){return function(){var b=a.match(/^([0-5][0-9])\.([0-9]{1,3})/);this.second=Number(b[1]),this.millisecond=Number(b[2])}},meridian:function(a){return function(){this.meridian=a.slice(0,1).toLowerCase()}},timezone:function(a){return function(){var b=a.replace(/[^\d\+\-]/g,"");b.length?this.timezoneOffset=Number(b):this.timezone=a.toLowerCase()}},day:function(a){var b=a[0];return function(){if(this.day=Number(b.match(/\d+/)[0]),this.day<1)throw"invalid day"}},month:function(a){return function(){if(this.month=3===a.length?"jan feb mar apr may jun jul aug sep oct nov dec".indexOf(a)/4:Number(a)-1,this.month<0)throw"invalid month"}},year:function(a){return function(){var b=Number(a);this.year=a.length>2?b:b+(b+2e3<Date.CultureInfo.twoDigitYearMax?2e3:1900)}},rday:function(a){return function(){switch(a){case"yesterday":this.days=-1;break;case"tomorrow":this.days=1;break;case"today":this.days=0;break;case"now":this.days=0,this.now=!0}}},finishExact:function(b){var e;b=b instanceof Array?b:[b];for(var f=0;f<b.length;f++)b[f]&&b[f].call(this);if(d.call(this),c.call(this),this.day>a.getDaysInMonth(this.year,this.month))throw new RangeError(this.day+" is not a valid value for days.");return e=new Date(this.year,this.month,this.day,this.hour,this.minute,this.second,this.millisecond),this.year<100&&e.setFullYear(this.year),this.timezone?e.set({timezone:this.timezone}):this.timezoneOffset&&e.set({timezoneOffset:this.timezoneOffset}),e},finish:function(d){var f,g,h,i;if(d=d instanceof Array?b(d):[d],0===d.length)return null;for(var j=0;j<d.length;j++)"function"==typeof d[j]&&d[j].call(this);if(this.now&&!this.unit&&!this.operator)return new Date;if(f=e.getToday.call(this),g=!!(this.days&&null!==this.days||this.orient||this.operator),h="past"===this.orient||"subtract"===this.operator?-1:1,this.month&&"week"===this.unit&&(this.value=this.month+1,delete this.month,delete this.day),!this.month&&0!==this.month||-1==="year day hour minute second".indexOf(this.unit)||(this.value||(this.value=this.month+1),this.month=null,g=!0),g||!this.weekday||this.day||this.days||e.setDMYFromWeekday.call(this),g&&this.weekday&&"month"!==this.unit&&"week"!==this.unit&&e.setDaysFromWeekday.call(this,f,h),!this.weekday||"week"===this.unit||this.day||this.days||(i=Date[this.weekday](),this.day=i.getDate(),i.getMonth()!==f.getMonth()&&(this.month=i.getMonth())),this.month&&"day"===this.unit&&this.operator&&(this.value||(this.value=this.month+1),this.month=null),null!=this.value&&null!=this.month&&null!=this.year&&(this.day=1*this.value),this.month&&!this.day&&this.value&&(f.set({day:1*this.value}),g||(this.day=1*this.value)),this.month||!this.value||"month"!==this.unit||this.now||(this.month=this.value,g=!0),g&&(this.month||0===this.month)&&"year"!==this.unit&&e.setMonthsFromMonth.call(this,f,h),this.unit||(this.unit="day"),e.setUnitValue.call(this,h),c.call(this),!this.month&&0!==this.month||this.day||(this.day=1),!this.orient&&!this.operator&&"week"===this.unit&&this.value&&!this.day&&!this.month)return Date.today().setWeek(this.value);if("week"===this.unit&&this.weeks&&!this.day&&!this.month)return e.generateDateFromWeeks.call(this);if(g&&this.timezone&&this.day&&this.days&&(this.day=this.days),g?f.add(this):f.set(this),this.timezone){this.timezone=this.timezone.toUpperCase();var k,l=a.getTimezoneOffset(this.timezone);f.hasDaylightSavingTime()&&(k=a.getTimezoneAbbreviation(l,f.isDaylightSavingTime()),k!==this.timezone&&(f.isDaylightSavingTime()?f.addHours(-1):f.addHours(1))),f.setTimezoneOffset(l)}return f}}}(),function(){var a=Date;a.Grammar={};var b,c=a.Parsing.Operators,d=a.Grammar,e=a.Translator;b=function(){return c.each(c.any.apply(null,arguments),c.not(d.ctoken2("timeContext")))},d.datePartDelimiter=c.rtoken(/^([\s\-\.\,\/\x27]+)/),d.timePartDelimiter=c.stoken(":"),d.whiteSpace=c.rtoken(/^\s*/),d.generalDelimiter=c.rtoken(/^(([\s\,]|at|@|on)+)/);var f={};d.ctoken=function(a){var b=f[a];if(!b){for(var d=Date.CultureInfo.regexPatterns,e=a.split(/\s+/),g=[],h=0;h<e.length;h++)g.push(c.replace(c.rtoken(d[e[h]]),e[h]));b=f[a]=c.any.apply(null,g)}return b},d.ctoken2=function(a){return c.rtoken(Date.CultureInfo.regexPatterns[a])};var g=function(a,b,e,f){f?d[a]=c.cache(c.process(c.each(c.rtoken(b),c.optional(d.ctoken2(f))),e)):d[a]=c.cache(c.process(c.rtoken(b),e))},h=function(a,b){return c.cache(c.process(d.ctoken2(a),b))},i={},j=function(a){return i[a]=i[a]||d.format(a)[0],i[a]};d.allformats=function(a){var b=[];if(a instanceof Array)for(var c=0;c<a.length;c++)b.push(j(a[c]));else b.push(j(a));return b},d.formats=function(a){if(a instanceof Array){for(var b=[],d=0;d<a.length;d++)b.push(j(a[d]));return c.any.apply(null,b)}return j(a)};var k={timeFormats:function(){var a,b=["h","hh","H","HH","m","mm","s","ss","ss.s","z","zz"],f=[/^(0[0-9]|1[0-2]|[1-9])/,/^(0[0-9]|1[0-2])/,/^([0-1][0-9]|2[0-3]|[0-9])/,/^([0-1][0-9]|2[0-3])/,/^([0-5][0-9]|[0-9])/,/^[0-5][0-9]/,/^([0-5][0-9]|[0-9])/,/^[0-5][0-9]/,/^[0-5][0-9]\.[0-9]{1,3}/,/^((\+|\-)\s*\d\d\d\d)|((\+|\-)\d\d\:?\d\d)/,/^((\+|\-)\s*\d\d\d\d)|((\+|\-)\d\d\:?\d\d)/],i=[e.hour,e.hour,e.hour,e.minute,e.minute,e.second,e.second,e.secondAndMillisecond,e.timezone,e.timezone,e.timezone];for(a=0;a<b.length;a++)g(b[a],f[a],i[a]);d.hms=c.cache(c.sequence([d.H,d.m,d.s],d.timePartDelimiter)),d.t=h("shortMeridian",e.meridian),d.tt=h("longMeridian",e.meridian),d.zzz=h("timezone",e.timezone),d.timeSuffix=c.each(c.ignore(d.whiteSpace),c.set([d.tt,d.zzz])),d.time=c.each(c.optional(c.ignore(c.stoken("T"))),d.hms,d.timeSuffix)},dateFormats:function(){var a,f=function(){return c.set(arguments,d.datePartDelimiter)},h=["d","dd","M","MM","y","yy","yyy","yyyy"],i=[/^([0-2]\d|3[0-1]|\d)/,/^([0-2]\d|3[0-1])/,/^(1[0-2]|0\d|\d)/,/^(1[0-2]|0\d)/,/^(\d+)/,/^(\d\d)/,/^(\d\d?\d?\d?)/,/^(\d\d\d\d)/],j=[e.day,e.day,e.month,e.month,e.year,e.year,e.year,e.year],k=["ordinalSuffix","ordinalSuffix"];for(a=0;a<h.length;a++)g(h[a],i[a],j[a],k[a]);d.MMM=d.MMMM=c.cache(c.process(d.ctoken("jan feb mar apr may jun jul aug sep oct nov dec"),e.month)),d.ddd=d.dddd=c.cache(c.process(d.ctoken("sun mon tue wed thu fri sat"),function(a){return function(){this.weekday=a}})),d.day=b(d.d,d.dd),d.month=b(d.M,d.MMM),d.year=b(d.yyyy,d.yy),d.mdy=f(d.ddd,d.month,d.day,d.year),d.ymd=f(d.ddd,d.year,d.month,d.day),d.dmy=f(d.ddd,d.day,d.month,d.year),d.date=function(a){return(d[Date.CultureInfo.dateElementOrder]||d.mdy).call(this,a)}},relative:function(){d.orientation=c.process(d.ctoken("past future"),function(a){return function(){this.orient=a}}),d.operator=c.process(d.ctoken("add subtract"),function(a){return function(){this.operator=a}}),d.rday=c.process(d.ctoken("yesterday tomorrow today now"),e.rday),d.unit=c.process(d.ctoken("second minute hour day week month year"),function(a){return function(){this.unit=a}})}};d.buildGrammarFormats=function(){f={},k.timeFormats(),k.dateFormats(),k.relative(),d.value=c.process(c.rtoken(/^([-+]?\d+)?(st|nd|rd|th)?/),function(a){return function(){this.value=a.replace(/\D/g,"")}}),d.expression=c.set([d.rday,d.operator,d.value,d.unit,d.orientation,d.ddd,d.MMM]),d.format=c.process(c.many(c.any(c.process(c.rtoken(/^(dd?d?d?(?!e)|MM?M?M?|yy?y?y?|hh?|HH?|mm?|ss?|tt?|zz?z?)/),function(b){if(d[b])return d[b];throw a.Parsing.Exception(b)}),c.process(c.rtoken(/^[^dMyhHmstz]+/),function(a){return c.ignore(c.stoken(a))}))),function(a){return c.process(c.each.apply(null,a),e.finishExact)}),d._start=c.process(c.set([d.date,d.time,d.expression],d.generalDelimiter,d.whiteSpace),e.finish)},d.buildGrammarFormats(),d._formats=d.formats(['"yyyy-MM-ddTHH:mm:ssZ"',"yyyy-MM-ddTHH:mm:ss.sz","yyyy-MM-ddTHH:mm:ssZ","yyyy-MM-ddTHH:mm:ssz","yyyy-MM-ddTHH:mm:ss","yyyy-MM-ddTHH:mmZ","yyyy-MM-ddTHH:mmz","yyyy-MM-ddTHH:mm","ddd, MMM dd, yyyy H:mm:ss tt","ddd MMM d yyyy HH:mm:ss zzz","MMddyyyy","ddMMyyyy","Mddyyyy","ddMyyyy","Mdyyyy","dMyyyy","yyyy","Mdyy","dMyy","d"]),d.start=function(a){try{var b=d._formats.call({},a);if(0===b[1].length)return b}catch(c){}return d._start.call({},a)}}(),function(){function a(a){var d;return a?a instanceof Date?a.clone():(a.length>=4&&"0"!==a.charAt(0)&&"+"!==a.charAt(0)&&"-"!==a.charAt(0)&&(d=b.Parsing.ISO.parse(a)||b.Parsing.Numeric.parse(a)),d instanceof Date&&!isNaN(d.getTime())?d:(a=b.Parsing.Normalizer.parse(c.removeOrds(a)),d=c.grammarParser(a),null!==d?d:c.nativeFallback(a))):null}var b=Date,c={removeOrds:function(a){return ords=a.match(/\b(\d+)(?:st|nd|rd|th)\b/),a=ords&&2===ords.length?a.replace(ords[0],ords[1]):a},grammarParser:function(a){var c=null;try{c=b.Grammar.start.call({},a.replace(/^\s*(\S*(\s+\S+)*)\s*$/,"$1"))}catch(d){return null}return 0===c[1].length?c[0]:null},nativeFallback:function(a){var b;try{return b=Date._parse(a),b||0===b?new Date(b):null}catch(c){return null}}};b._parse||(b._parse=b.parse),b.parse=a,Date.getParseFunction=function(a){var b=Date.Grammar.allformats(a);return function(a){for(var c=null,d=0;d<b.length;d++){try{c=b[d].call({},a)}catch(e){continue}if(0===c[1].length)return c[0]}return null}},b.parseExact=function(a,c){return b.getParseFunction(c)(a)}}(),function(){var a=Date,b=a.prototype,c=function(a,b){return b||(b=2),("000"+a).slice(-1*b)},d={d:"dd","%d":"dd",D:"ddd","%a":"ddd",j:"dddd",l:"dddd","%A":"dddd",S:"S",F:"MMMM","%B":"MMMM",m:"MM","%m":"MM",M:"MMM","%b":"MMM","%h":"MMM",n:"M",Y:"yyyy","%Y":"yyyy",y:"yy","%y":"yy",g:"h","%I":"h",G:"H",h:"hh",H:"HH","%H":"HH",i:"mm","%M":"mm",s:"ss","%S":"ss","%r":"hh:mm tt","%R":"H:mm","%T":"H:mm:ss","%X":"t","%x":"d","%e":"d","%D":"MM/dd/yy","%n":"\\n","%t":"\\t",e:"z",T:"z","%z":"z","%Z":"z",Z:"ZZ",N:"u",w:"u","%w":"u",W:"W","%V":"W"},e={substitutes:function(a){return d[a]},interpreted:function(b,d){var e;switch(b){case"%u":return d.getDay()+1;case"z":return d.getOrdinalNumber();case"%j":return c(d.getOrdinalNumber(),3);case"%U":var f=d.clone().set({month:0,day:1}).addDays(-1).moveToDayOfWeek(0),g=d.clone().addDays(1).moveToDayOfWeek(0,-1);return f>g?"00":c((g.getOrdinalNumber()-f.getOrdinalNumber())/7+1);case"%W":return c(d.getWeek());case"t":return a.getDaysInMonth(d.getFullYear(),d.getMonth());case"o":case"%G":return d.setWeek(d.getISOWeek()).toString("yyyy");case"%g":return d._format("%G").slice(-2);case"a":case"%p":return t("tt").toLowerCase();case"A":return t("tt").toUpperCase();case"u":return c(d.getMilliseconds(),3);case"I":return d.isDaylightSavingTime()?1:0;case"O":return d.getUTCOffset();case"P":return e=d.getUTCOffset(),e.substring(0,e.length-2)+":"+e.substring(e.length-2);case"B":var h=new Date;return Math.floor((3600*h.getHours()+60*h.getMinutes()+h.getSeconds()+60*(h.getTimezoneOffset()+60))/86.4);case"c":return d.toISOString().replace(/\"/g,"");case"U":return a.strtotime("now");case"%c":return t("d")+" "+t("t");case"%C":return Math.floor(d.getFullYear()/100+1)}},shouldOverrideDefaults:function(a){switch(a){case"%e":return!0;default:return!1}},parse:function(a,b){var c,d=b||new Date;return(c=e.substitutes(a))?c:(c=e.interpreted(a,d),c?c:a)}};a.normalizeFormat=function(a,b){return a.replace(/(%|\\)?.|%%/g,function(a){return e.parse(a,b)})},a.strftime=function(a,b){var c=Date.parse(b);return c._format(a)},a.strtotime=function(b){var c=a.parse(b);return Math.round(a.UTC(c.getUTCFullYear(),c.getUTCMonth(),c.getUTCDate(),c.getUTCHours(),c.getUTCMinutes(),c.getUTCSeconds(),c.getUTCMilliseconds())/1e3)};var f=function(b){return function(c){var d,f=!1;return"\\"===c.charAt(0)||"%%"===c.substring(0,2)?c.replace("\\","").replace("%%","%"):(f=e.shouldOverrideDefaults(c),d=a.normalizeFormat(c,b),d?b.toString(d,f):void 0)}};b._format=function(a){var b=f(this);return a?a.replace(/(%|\\)?.|%%/g,b):this._toString()},b.format||(b.format=b._format)}(),function(){"use strict";var a=function(a){return function(){return this[a]}},b=function(a){return function(b){return this[a]=b,this}},c=["years","months","days","hours","minutes","seconds","milliseconds"],d=function(c,d){for(var e=0;e<d.length;e++){var f=d[e],g=f.slice(0,1).toUpperCase()+f.slice(1);c.prototype[f]=0,c.prototype["get"+g]=a(f),c.prototype["set"+g]=b(f)}},e=function(a,b,c,d,f){if(1===arguments.length&&"number"==typeof a){var g=0>a?-1:1,h=Math.abs(a);this.setDays(Math.floor(h/864e5)*g),h%=864e5,this.setHours(Math.floor(h/36e5)*g),h%=36e5,this.setMinutes(Math.floor(h/6e4)*g),h%=6e4,this.setSeconds(Math.floor(h/1e3)*g),h%=1e3,this.setMilliseconds(h*g)}else this.set(a,b,c,d,f);return this.getTotalMilliseconds=function(){return 864e5*this.getDays()+36e5*this.getHours()+6e4*this.getMinutes()+1e3*this.getSeconds()},this.compareTo=function(a){var b,c=new Date(1970,1,1,this.getHours(),this.getMinutes(),this.getSeconds());return b=null===a?new Date(1970,1,1,0,0,0):new Date(1970,1,1,a.getHours(),a.getMinutes(),a.getSeconds()),b>c?-1:c>b?1:0},this.equals=function(a){return 0===this.compareTo(a)},this.add=function(a){return null===a?this:this.addSeconds(a.getTotalMilliseconds()/1e3)},this.subtract=function(a){return null===a?this:this.addSeconds(-a.getTotalMilliseconds()/1e3)},this.addDays=function(a){return new e(this.getTotalMilliseconds()+864e5*a)},this.addHours=function(a){return new e(this.getTotalMilliseconds()+36e5*a)},this.addMinutes=function(a){return new e(this.getTotalMilliseconds()+6e4*a)},this.addSeconds=function(a){return new e(this.getTotalMilliseconds()+1e3*a)},this.addMilliseconds=function(a){return new e(this.getTotalMilliseconds()+a)},this.get12HourHour=function(){return this.getHours()>12?this.getHours()-12:0===this.getHours()?12:this.getHours()},this.getDesignator=function(){return this.getHours()<12?Date.CultureInfo.amDesignator:Date.CultureInfo.pmDesignator},this.toString=function(a){this._toString=function(){return null!==this.getDays()&&this.getDays()>0?this.getDays()+"."+this.getHours()+":"+this.p(this.getMinutes())+":"+this.p(this.getSeconds()):this.getHours()+":"+this.p(this.getMinutes())+":"+this.p(this.getSeconds())},this.p=function(a){return a.toString().length<2?"0"+a:a};var b=this;return a?a.replace(/dd?|HH?|hh?|mm?|ss?|tt?/g,function(a){switch(a){case"d":return b.getDays();case"dd":return b.p(b.getDays());case"H":return b.getHours();case"HH":return b.p(b.getHours());case"h":return b.get12HourHour();case"hh":return b.p(b.get12HourHour());case"m":return b.getMinutes();case"mm":return b.p(b.getMinutes());case"s":return b.getSeconds();case"ss":return b.p(b.getSeconds());case"t":return(b.getHours()<12?Date.CultureInfo.amDesignator:Date.CultureInfo.pmDesignator).substring(0,1);case"tt":return b.getHours()<12?Date.CultureInfo.amDesignator:Date.CultureInfo.pmDesignator}}):this._toString()},this};d(e,c.slice(2)),e.prototype.set=function(a,b,c,d,e){this.setDays(a||this.getDays()),this.setHours(b||this.getHours()),this.setMinutes(c||this.getMinutes()),this.setSeconds(d||this.getSeconds()),this.setMilliseconds(e||this.getMilliseconds())},Date.prototype.getTimeOfDay=function(){return new e(0,this.getHours(),this.getMinutes(),this.getSeconds(),this.getMilliseconds())},Date.TimeSpan=e,"undefined"!=typeof window&&(window.TimeSpan=e)}(),function(){"use strict";var a=["years","months","days","hours","minutes","seconds","milliseconds"],b=function(a){return function(){return this[a]}},c=function(a){return function(b){return this[a]=b,this}},d=function(a,d){for(var e=0;e<d.length;e++){var f=d[e],g=f.slice(0,1).toUpperCase()+f.slice(1);a.prototype[f]=0,a.prototype["get"+g]=b(f),a.prototype["set"+g]=c(f)}},e=function(a,b,c,d){function e(){b.addMonths(-a),d.months++,12===d.months&&(d.years++,d.months=0)}if(1===a)for(;b>c;)e();else for(;c>b;)e();d.months--,d.months*=a,d.years*=a},f=function(a,b,c){var d=!1==(b.isDaylightSavingTime()===c.isDaylightSavingTime());d&&1===a?b.addHours(-1):d&&b.addHours(1)},g=function(a,b,c,d,g,h,i){if(7===arguments.length)this.set(a,b,c,d,g,h,i);else if(2===arguments.length&&arguments[0]instanceof Date&&arguments[1]instanceof Date){var j=arguments[0].clone(),k=arguments[1].clone(),l=j>k?1:-1;this.dates={start:arguments[0].clone(),end:arguments[1].clone()},e(l,j,k,this),f(l,j,k);var m=k-j;if(0!==m){var n=new TimeSpan(m);this.set(this.years,this.months,n.getDays(),n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds())}}return this};d(g,a),g.prototype.set=function(a,b,c,d,e,f,g){this.setYears(a||this.getYears()),this.setMonths(b||this.getMonths()),this.setDays(c||this.getDays()),this.setHours(d||this.getHours()),this.setMinutes(e||this.getMinutes()),this.setSeconds(f||this.getSeconds()),this.setMilliseconds(g||this.getMilliseconds())},Date.TimePeriod=g,"undefined"!=typeof window&&(window.TimePeriod=g)}(),!function(){function a(a){return a&&(a.ownerDocument||a.document||a).documentElement}function b(a){return a&&(a.ownerDocument&&a.ownerDocument.defaultView||a.document&&a||a.defaultView)}function c(a,b){return b>a?-1:a>b?1:a>=b?0:NaN}function d(a){return null===a?NaN:+a}function e(a){return!isNaN(a)}function f(a){return{left:function(b,c,d,e){for(arguments.length<3&&(d=0),arguments.length<4&&(e=b.length);e>d;){var f=d+e>>>1;a(b[f],c)<0?d=f+1:e=f}return d},right:function(b,c,d,e){for(arguments.length<3&&(d=0),arguments.length<4&&(e=b.length);e>d;){var f=d+e>>>1;a(b[f],c)>0?e=f:d=f+1}return d}}}function g(a){return a.length}function h(a){for(var b=1;a*b%1;)b*=10;return b}function i(a,b){for(var c in b)Object.defineProperty(a.prototype,c,{value:b[c],enumerable:!1})}function j(){this._=Object.create(null)}function k(a){return(a+="")===og||a[0]===pg?pg+a:a}function l(a){return(a+="")[0]===pg?a.slice(1):a}function m(a){return k(a)in this._}function n(a){return(a=k(a))in this._&&delete this._[a]}function o(){var a=[];for(var b in this._)a.push(l(b));return a}function p(){var a=0;for(var b in this._)++a;return a}function q(){for(var a in this._)return!1;return!0}function r(){this._=Object.create(null)}function s(a){return a}function t(a,b,c){return function(){var d=c.apply(b,arguments);return d===b?a:d}}function u(a,b){if(b in a)return b;b=b.charAt(0).toUpperCase()+b.slice(1);for(var c=0,d=qg.length;d>c;++c){var e=qg[c]+b;if(e in a)return e}}function v(){}function w(){}function x(a){function b(){for(var b,d=c,e=-1,f=d.length;++e<f;)(b=d[e].on)&&b.apply(this,arguments);return a}var c=[],d=new j;return b.on=function(b,e){var f,g=d.get(b);return arguments.length<2?g&&g.on:(g&&(g.on=null,c=c.slice(0,f=c.indexOf(g)).concat(c.slice(f+1)),d.remove(b)),e&&c.push(d.set(b,{on:e})),a)},b}function y(){bg.event.preventDefault()}function z(){for(var a,b=bg.event;a=b.sourceEvent;)b=a;return b}function A(a){for(var b=new w,c=0,d=arguments.length;++c<d;)b[arguments[c]]=x(b);return b.of=function(c,d){return function(e){try{var f=e.sourceEvent=bg.event;e.target=a,bg.event=e,b[e.type].apply(c,d)}finally{bg.event=f}}},b}function B(a){return sg(a,wg),a}function C(a){return"function"==typeof a?a:function(){return tg(a,this)}}function D(a){return"function"==typeof a?a:function(){return ug(a,this)}}function E(a,b){function c(){this.removeAttribute(a)}function d(){this.removeAttributeNS(a.space,a.local)}function e(){this.setAttribute(a,b)}function f(){this.setAttributeNS(a.space,a.local,b)}function g(){var c=b.apply(this,arguments);null==c?this.removeAttribute(a):this.setAttribute(a,c)}function h(){var c=b.apply(this,arguments);null==c?this.removeAttributeNS(a.space,a.local):this.setAttributeNS(a.space,a.local,c)}return a=bg.ns.qualify(a),null==b?a.local?d:c:"function"==typeof b?a.local?h:g:a.local?f:e}function F(a){return a.trim().replace(/\s+/g," ")}function G(a){return new RegExp("(?:^|\\s+)"+bg.requote(a)+"(?:\\s+|$)","g")}function H(a){return(a+"").trim().split(/^|\s+/)}function I(a,b){function c(){for(var c=-1;++c<e;)a[c](this,b)}function d(){for(var c=-1,d=b.apply(this,arguments);++c<e;)a[c](this,d)}a=H(a).map(J);var e=a.length;return"function"==typeof b?d:c}function J(a){var b=G(a);return function(c,d){if(e=c.classList)return d?e.add(a):e.remove(a);var e=c.getAttribute("class")||"";d?(b.lastIndex=0,b.test(e)||c.setAttribute("class",F(e+" "+a))):c.setAttribute("class",F(e.replace(b," ")))}}function K(a,b,c){function d(){this.style.removeProperty(a)}function e(){this.style.setProperty(a,b,c)}function f(){var d=b.apply(this,arguments);null==d?this.style.removeProperty(a):this.style.setProperty(a,d,c)}return null==b?d:"function"==typeof b?f:e}function L(a,b){function c(){delete this[a]}function d(){this[a]=b}function e(){var c=b.apply(this,arguments);null==c?delete this[a]:this[a]=c}return null==b?c:"function"==typeof b?e:d}function M(a){function b(){var b=this.ownerDocument,c=this.namespaceURI;return c?b.createElementNS(c,a):b.createElement(a)}function c(){return this.ownerDocument.createElementNS(a.space,a.local)}return"function"==typeof a?a:(a=bg.ns.qualify(a)).local?c:b}function N(){var a=this.parentNode;a&&a.removeChild(this)}function O(a){return{__data__:a}}function P(a){return function(){return vg(this,a)}}function Q(a){return arguments.length||(a=c),function(b,c){return b&&c?a(b.__data__,c.__data__):!b-!c}}function R(a,b){for(var c=0,d=a.length;d>c;c++)for(var e,f=a[c],g=0,h=f.length;h>g;g++)(e=f[g])&&b(e,g,c);return a}function S(a){return sg(a,yg),a}function T(a){var b,c;return function(d,e,f){var g,h=a[f].update,i=h.length;for(f!=c&&(c=f,b=0),e>=b&&(b=e+1);!(g=h[b])&&++b<i;);return g}}function U(a,b,c){function d(){var b=this[g];b&&(this.removeEventListener(a,b,b.$),delete this[g])}function e(){var e=i(b,dg(arguments));d.call(this),this.addEventListener(a,this[g]=e,e.$=c),e._=b}function f(){var b,c=new RegExp("^__on([^.]+)"+bg.requote(a)+"$");for(var d in this)if(b=d.match(c)){var e=this[d];this.removeEventListener(b[1],e,e.$),delete this[d]}}var g="__on"+a,h=a.indexOf("."),i=V;h>0&&(a=a.slice(0,h));var j=zg.get(a);return j&&(a=j,i=W),h?b?e:d:b?v:f}function V(a,b){return function(c){var d=bg.event;bg.event=c,b[0]=this.__data__;try{a.apply(this,b)}finally{bg.event=d}}}function W(a,b){var c=V(a,b);return function(a){var b=this,d=a.relatedTarget;d&&(d===b||8&d.compareDocumentPosition(b))||c.call(b,a)}}function X(c){var d=".dragsuppress-"+ ++Bg,e="click"+d,f=bg.select(b(c)).on("touchmove"+d,y).on("dragstart"+d,y).on("selectstart"+d,y);if(null==Ag&&(Ag="onselectstart"in c?!1:u(c.style,"userSelect")),Ag){var g=a(c).style,h=g[Ag];g[Ag]="none"}return function(a){if(f.on(d,null),Ag&&(g[Ag]=h),a){var b=function(){f.on(e,null)};f.on(e,function(){y(),b()},!0),setTimeout(b,0)}}}function Y(a,c){c.changedTouches&&(c=c.changedTouches[0]);var d=a.ownerSVGElement||a;if(d.createSVGPoint){var e=d.createSVGPoint();if(0>Cg){var f=b(a);if(f.scrollX||f.scrollY){d=bg.select("body").append("svg").style({
position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important");var g=d[0][0].getScreenCTM();Cg=!(g.f||g.e),d.remove()}}return Cg?(e.x=c.pageX,e.y=c.pageY):(e.x=c.clientX,e.y=c.clientY),e=e.matrixTransform(a.getScreenCTM().inverse()),[e.x,e.y]}var h=a.getBoundingClientRect();return[c.clientX-h.left-a.clientLeft,c.clientY-h.top-a.clientTop]}function Z(){return bg.event.changedTouches[0].identifier}function $(a){return a>0?1:0>a?-1:0}function _(a,b,c){return(b[0]-a[0])*(c[1]-a[1])-(b[1]-a[1])*(c[0]-a[0])}function aa(a){return a>1?0:-1>a?Fg:Math.acos(a)}function ba(a){return a>1?Ig:-1>a?-Ig:Math.asin(a)}function ca(a){return((a=Math.exp(a))-1/a)/2}function da(a){return((a=Math.exp(a))+1/a)/2}function ea(a){return((a=Math.exp(2*a))-1)/(a+1)}function fa(a){return(a=Math.sin(a/2))*a}function ga(){}function ha(a,b,c){return this instanceof ha?(this.h=+a,this.s=+b,void(this.l=+c)):arguments.length<2?a instanceof ha?new ha(a.h,a.s,a.l):va(""+a,wa,ha):new ha(a,b,c)}function ia(a,b,c){function d(a){return a>360?a-=360:0>a&&(a+=360),60>a?f+(g-f)*a/60:180>a?g:240>a?f+(g-f)*(240-a)/60:f}function e(a){return Math.round(255*d(a))}var f,g;return a=isNaN(a)?0:(a%=360)<0?a+360:a,b=isNaN(b)?0:0>b?0:b>1?1:b,c=0>c?0:c>1?1:c,g=.5>=c?c*(1+b):c+b-c*b,f=2*c-g,new ra(e(a+120),e(a),e(a-120))}function ja(a,b,c){return this instanceof ja?(this.h=+a,this.c=+b,void(this.l=+c)):arguments.length<2?a instanceof ja?new ja(a.h,a.c,a.l):a instanceof la?na(a.l,a.a,a.b):na((a=xa((a=bg.rgb(a)).r,a.g,a.b)).l,a.a,a.b):new ja(a,b,c)}function ka(a,b,c){return isNaN(a)&&(a=0),isNaN(b)&&(b=0),new la(c,Math.cos(a*=Jg)*b,Math.sin(a)*b)}function la(a,b,c){return this instanceof la?(this.l=+a,this.a=+b,void(this.b=+c)):arguments.length<2?a instanceof la?new la(a.l,a.a,a.b):a instanceof ja?ka(a.h,a.c,a.l):xa((a=ra(a)).r,a.g,a.b):new la(a,b,c)}function ma(a,b,c){var d=(a+16)/116,e=d+b/500,f=d-c/200;return e=oa(e)*Ug,d=oa(d)*Vg,f=oa(f)*Wg,new ra(qa(3.2404542*e-1.5371385*d-.4985314*f),qa(-.969266*e+1.8760108*d+.041556*f),qa(.0556434*e-.2040259*d+1.0572252*f))}function na(a,b,c){return a>0?new ja(Math.atan2(c,b)*Kg,Math.sqrt(b*b+c*c),a):new ja(NaN,NaN,a)}function oa(a){return a>.206893034?a*a*a:(a-4/29)/7.787037}function pa(a){return a>.008856?Math.pow(a,1/3):7.787037*a+4/29}function qa(a){return Math.round(255*(.00304>=a?12.92*a:1.055*Math.pow(a,1/2.4)-.055))}function ra(a,b,c){return this instanceof ra?(this.r=~~a,this.g=~~b,void(this.b=~~c)):arguments.length<2?a instanceof ra?new ra(a.r,a.g,a.b):va(""+a,ra,ia):new ra(a,b,c)}function sa(a){return new ra(a>>16,a>>8&255,255&a)}function ta(a){return sa(a)+""}function ua(a){return 16>a?"0"+Math.max(0,a).toString(16):Math.min(255,a).toString(16)}function va(a,b,c){a=a.toLowerCase();var d,e,f,g=0,h=0,i=0;if(d=/([a-z]+)\((.*)\)/.exec(a))switch(e=d[2].split(","),d[1]){case"hsl":return c(parseFloat(e[0]),parseFloat(e[1])/100,parseFloat(e[2])/100);case"rgb":return b(za(e[0]),za(e[1]),za(e[2]))}return(f=Zg.get(a))?b(f.r,f.g,f.b):(null==a||"#"!==a.charAt(0)||isNaN(f=parseInt(a.slice(1),16))||(4===a.length?(g=(3840&f)>>4,g=g>>4|g,h=240&f,h=h>>4|h,i=15&f,i=i<<4|i):7===a.length&&(g=(16711680&f)>>16,h=(65280&f)>>8,i=255&f)),b(g,h,i))}function wa(a,b,c){var d,e,f=Math.min(a/=255,b/=255,c/=255),g=Math.max(a,b,c),h=g-f,i=(g+f)/2;return h?(e=.5>i?h/(g+f):h/(2-g-f),d=a==g?(b-c)/h+(c>b?6:0):b==g?(c-a)/h+2:(a-b)/h+4,d*=60):(d=NaN,e=i>0&&1>i?0:d),new ha(d,e,i)}function xa(a,b,c){a=ya(a),b=ya(b),c=ya(c);var d=pa((.4124564*a+.3575761*b+.1804375*c)/Ug),e=pa((.2126729*a+.7151522*b+.072175*c)/Vg),f=pa((.0193339*a+.119192*b+.9503041*c)/Wg);return la(116*e-16,500*(d-e),200*(e-f))}function ya(a){return(a/=255)<=.04045?a/12.92:Math.pow((a+.055)/1.055,2.4)}function za(a){var b=parseFloat(a);return"%"===a.charAt(a.length-1)?Math.round(2.55*b):b}function Aa(a){return"function"==typeof a?a:function(){return a}}function Ba(a){return function(b,c,d){return 2===arguments.length&&"function"==typeof c&&(d=c,c=null),Ca(b,c,a,d)}}function Ca(a,b,c,d){function e(){var a,b=i.status;if(!b&&Ea(i)||b>=200&&300>b||304===b){try{a=c.call(f,i)}catch(d){return void g.error.call(f,d)}g.load.call(f,a)}else g.error.call(f,i)}var f={},g=bg.dispatch("beforesend","progress","load","error"),h={},i=new XMLHttpRequest,j=null;return!this.XDomainRequest||"withCredentials"in i||!/^(http(s)?:)?\/\//.test(a)||(i=new XDomainRequest),"onload"in i?i.onload=i.onerror=e:i.onreadystatechange=function(){i.readyState>3&&e()},i.onprogress=function(a){var b=bg.event;bg.event=a;try{g.progress.call(f,i)}finally{bg.event=b}},f.header=function(a,b){return a=(a+"").toLowerCase(),arguments.length<2?h[a]:(null==b?delete h[a]:h[a]=b+"",f)},f.mimeType=function(a){return arguments.length?(b=null==a?null:a+"",f):b},f.responseType=function(a){return arguments.length?(j=a,f):j},f.response=function(a){return c=a,f},["get","post"].forEach(function(a){f[a]=function(){return f.send.apply(f,[a].concat(dg(arguments)))}}),f.send=function(c,d,e){if(2===arguments.length&&"function"==typeof d&&(e=d,d=null),i.open(c,a,!0),null==b||"accept"in h||(h.accept=b+",*/*"),i.setRequestHeader)for(var k in h)i.setRequestHeader(k,h[k]);return null!=b&&i.overrideMimeType&&i.overrideMimeType(b),null!=j&&(i.responseType=j),null!=e&&f.on("error",e).on("load",function(a){e(null,a)}),g.beforesend.call(f,i),i.send(null==d?null:d),f},f.abort=function(){return i.abort(),f},bg.rebind(f,g,"on"),null==d?f:f.get(Da(d))}function Da(a){return 1===a.length?function(b,c){a(null==b?c:null)}:a}function Ea(a){var b=a.responseType;return b&&"text"!==b?a.response:a.responseText}function Fa(){var a=Ga(),b=Ha()-a;b>24?(isFinite(b)&&(clearTimeout(bh),bh=setTimeout(Fa,b)),ah=0):(ah=1,dh(Fa))}function Ga(){var a=Date.now();for(ch=$g;ch;)a>=ch.t&&(ch.f=ch.c(a-ch.t)),ch=ch.n;return a}function Ha(){for(var a,b=$g,c=1/0;b;)b.f?b=a?a.n=b.n:$g=b.n:(b.t<c&&(c=b.t),b=(a=b).n);return _g=a,c}function Ia(a,b){return b-(a?Math.ceil(Math.log(a)/Math.LN10):1)}function Ja(a,b){var c=Math.pow(10,3*ng(8-b));return{scale:b>8?function(a){return a/c}:function(a){return a*c},symbol:a}}function Ka(a){var b=a.decimal,c=a.thousands,d=a.grouping,e=a.currency,f=d&&c?function(a,b){for(var e=a.length,f=[],g=0,h=d[0],i=0;e>0&&h>0&&(i+h+1>b&&(h=Math.max(1,b-i)),f.push(a.substring(e-=h,e+h)),!((i+=h+1)>b));)h=d[g=(g+1)%d.length];return f.reverse().join(c)}:s;return function(a){var c=fh.exec(a),d=c[1]||" ",g=c[2]||">",h=c[3]||"-",i=c[4]||"",j=c[5],k=+c[6],l=c[7],m=c[8],n=c[9],o=1,p="",q="",r=!1,s=!0;switch(m&&(m=+m.substring(1)),(j||"0"===d&&"="===g)&&(j=d="0",g="="),n){case"n":l=!0,n="g";break;case"%":o=100,q="%",n="f";break;case"p":o=100,q="%",n="r";break;case"b":case"o":case"x":case"X":"#"===i&&(p="0"+n.toLowerCase());case"c":s=!1;case"d":r=!0,m=0;break;case"s":o=-1,n="r"}"$"===i&&(p=e[0],q=e[1]),"r"!=n||m||(n="g"),null!=m&&("g"==n?m=Math.max(1,Math.min(21,m)):"e"!=n&&"f"!=n||(m=Math.max(0,Math.min(20,m)))),n=gh.get(n)||La;var t=j&&l;return function(a){var c=q;if(r&&a%1)return"";var e=0>a||0===a&&0>1/a?(a=-a,"-"):"-"===h?"":h;if(0>o){var i=bg.formatPrefix(a,m);a=i.scale(a),c=i.symbol+q}else a*=o;a=n(a,m);var u,v,w=a.lastIndexOf(".");if(0>w){var x=s?a.lastIndexOf("e"):-1;0>x?(u=a,v=""):(u=a.substring(0,x),v=a.substring(x))}else u=a.substring(0,w),v=b+a.substring(w+1);!j&&l&&(u=f(u,1/0));var y=p.length+u.length+v.length+(t?0:e.length),z=k>y?new Array(y=k-y+1).join(d):"";return t&&(u=f(z+u,z.length?k-v.length:1/0)),e+=p,a=u+v,("<"===g?e+a+z:">"===g?z+e+a:"^"===g?z.substring(0,y>>=1)+e+a+z.substring(y):e+(t?a:z+a))+c}}}function La(a){return a+""}function Ma(){this._=new Date(arguments.length>1?Date.UTC.apply(this,arguments):arguments[0])}function Na(a,b,c){function d(b){var c=a(b),d=f(c,1);return d-b>b-c?c:d}function e(c){return b(c=a(new ih(c-1)),1),c}function f(a,c){return b(a=new ih(+a),c),a}function g(a,d,f){var g=e(a),h=[];if(f>1)for(;d>g;)c(g)%f||h.push(new Date(+g)),b(g,1);else for(;d>g;)h.push(new Date(+g)),b(g,1);return h}function h(a,b,c){try{ih=Ma;var d=new Ma;return d._=a,g(d,b,c)}finally{ih=Date}}a.floor=a,a.round=d,a.ceil=e,a.offset=f,a.range=g;var i=a.utc=Oa(a);return i.floor=i,i.round=Oa(d),i.ceil=Oa(e),i.offset=Oa(f),i.range=h,a}function Oa(a){return function(b,c){try{ih=Ma;var d=new Ma;return d._=b,a(d,c)._}finally{ih=Date}}}function Pa(a){function b(a){function b(b){for(var c,e,f,g=[],h=-1,i=0;++h<d;)37===a.charCodeAt(h)&&(g.push(a.slice(i,h)),null!=(e=kh[c=a.charAt(++h)])&&(c=a.charAt(++h)),(f=C[c])&&(c=f(b,null==e?"e"===c?" ":"0":e)),g.push(c),i=h+1);return g.push(a.slice(i,h)),g.join("")}var d=a.length;return b.parse=function(b){var d={y:1900,m:0,d:1,H:0,M:0,S:0,L:0,Z:null},e=c(d,a,b,0);if(e!=b.length)return null;"p"in d&&(d.H=d.H%12+12*d.p);var f=null!=d.Z&&ih!==Ma,g=new(f?Ma:ih);return"j"in d?g.setFullYear(d.y,0,d.j):"w"in d&&("W"in d||"U"in d)?(g.setFullYear(d.y,0,1),g.setFullYear(d.y,0,"W"in d?(d.w+6)%7+7*d.W-(g.getDay()+5)%7:d.w+7*d.U-(g.getDay()+6)%7)):g.setFullYear(d.y,d.m,d.d),g.setHours(d.H+(d.Z/100|0),d.M+d.Z%100,d.S,d.L),f?g._:g},b.toString=function(){return a},b}function c(a,b,c,d){for(var e,f,g,h=0,i=b.length,j=c.length;i>h;){if(d>=j)return-1;if(e=b.charCodeAt(h++),37===e){if(g=b.charAt(h++),f=D[g in kh?b.charAt(h++):g],!f||(d=f(a,c,d))<0)return-1}else if(e!=c.charCodeAt(d++))return-1}return d}function d(a,b,c){w.lastIndex=0;var d=w.exec(b.slice(c));return d?(a.w=x.get(d[0].toLowerCase()),c+d[0].length):-1}function e(a,b,c){u.lastIndex=0;var d=u.exec(b.slice(c));return d?(a.w=v.get(d[0].toLowerCase()),c+d[0].length):-1}function f(a,b,c){A.lastIndex=0;var d=A.exec(b.slice(c));return d?(a.m=B.get(d[0].toLowerCase()),c+d[0].length):-1}function g(a,b,c){y.lastIndex=0;var d=y.exec(b.slice(c));return d?(a.m=z.get(d[0].toLowerCase()),c+d[0].length):-1}function h(a,b,d){return c(a,C.c.toString(),b,d)}function i(a,b,d){return c(a,C.x.toString(),b,d)}function j(a,b,d){return c(a,C.X.toString(),b,d)}function k(a,b,c){var d=t.get(b.slice(c,c+=2).toLowerCase());return null==d?-1:(a.p=d,c)}var l=a.dateTime,m=a.date,n=a.time,o=a.periods,p=a.days,q=a.shortDays,r=a.months,s=a.shortMonths;b.utc=function(a){function c(a){try{ih=Ma;var b=new ih;return b._=a,d(b)}finally{ih=Date}}var d=b(a);return c.parse=function(a){try{ih=Ma;var b=d.parse(a);return b&&b._}finally{ih=Date}},c.toString=d.toString,c},b.multi=b.utc.multi=hb;var t=bg.map(),u=Ra(p),v=Sa(p),w=Ra(q),x=Sa(q),y=Ra(r),z=Sa(r),A=Ra(s),B=Sa(s);o.forEach(function(a,b){t.set(a.toLowerCase(),b)});var C={a:function(a){return q[a.getDay()]},A:function(a){return p[a.getDay()]},b:function(a){return s[a.getMonth()]},B:function(a){return r[a.getMonth()]},c:b(l),d:function(a,b){return Qa(a.getDate(),b,2)},e:function(a,b){return Qa(a.getDate(),b,2)},H:function(a,b){return Qa(a.getHours(),b,2)},I:function(a,b){return Qa(a.getHours()%12||12,b,2)},j:function(a,b){return Qa(1+hh.dayOfYear(a),b,3)},L:function(a,b){return Qa(a.getMilliseconds(),b,3)},m:function(a,b){return Qa(a.getMonth()+1,b,2)},M:function(a,b){return Qa(a.getMinutes(),b,2)},p:function(a){return o[+(a.getHours()>=12)]},S:function(a,b){return Qa(a.getSeconds(),b,2)},U:function(a,b){return Qa(hh.sundayOfYear(a),b,2)},w:function(a){return a.getDay()},W:function(a,b){return Qa(hh.mondayOfYear(a),b,2)},x:b(m),X:b(n),y:function(a,b){return Qa(a.getFullYear()%100,b,2)},Y:function(a,b){return Qa(a.getFullYear()%1e4,b,4)},Z:fb,"%":function(){return"%"}},D={a:d,A:e,b:f,B:g,c:h,d:_a,e:_a,H:bb,I:bb,j:ab,L:eb,m:$a,M:cb,p:k,S:db,U:Ua,w:Ta,W:Va,x:i,X:j,y:Xa,Y:Wa,Z:Ya,"%":gb};return b}function Qa(a,b,c){var d=0>a?"-":"",e=(d?-a:a)+"",f=e.length;return d+(c>f?new Array(c-f+1).join(b)+e:e)}function Ra(a){return new RegExp("^(?:"+a.map(bg.requote).join("|")+")","i")}function Sa(a){for(var b=new j,c=-1,d=a.length;++c<d;)b.set(a[c].toLowerCase(),c);return b}function Ta(a,b,c){lh.lastIndex=0;var d=lh.exec(b.slice(c,c+1));return d?(a.w=+d[0],c+d[0].length):-1}function Ua(a,b,c){lh.lastIndex=0;var d=lh.exec(b.slice(c));return d?(a.U=+d[0],c+d[0].length):-1}function Va(a,b,c){lh.lastIndex=0;var d=lh.exec(b.slice(c));return d?(a.W=+d[0],c+d[0].length):-1}function Wa(a,b,c){lh.lastIndex=0;var d=lh.exec(b.slice(c,c+4));return d?(a.y=+d[0],c+d[0].length):-1}function Xa(a,b,c){lh.lastIndex=0;var d=lh.exec(b.slice(c,c+2));return d?(a.y=Za(+d[0]),c+d[0].length):-1}function Ya(a,b,c){return/^[+-]\d{4}$/.test(b=b.slice(c,c+5))?(a.Z=-b,c+5):-1}function Za(a){return a+(a>68?1900:2e3)}function $a(a,b,c){lh.lastIndex=0;var d=lh.exec(b.slice(c,c+2));return d?(a.m=d[0]-1,c+d[0].length):-1}function _a(a,b,c){lh.lastIndex=0;var d=lh.exec(b.slice(c,c+2));return d?(a.d=+d[0],c+d[0].length):-1}function ab(a,b,c){lh.lastIndex=0;var d=lh.exec(b.slice(c,c+3));return d?(a.j=+d[0],c+d[0].length):-1}function bb(a,b,c){lh.lastIndex=0;var d=lh.exec(b.slice(c,c+2));return d?(a.H=+d[0],c+d[0].length):-1}function cb(a,b,c){lh.lastIndex=0;var d=lh.exec(b.slice(c,c+2));return d?(a.M=+d[0],c+d[0].length):-1}function db(a,b,c){lh.lastIndex=0;var d=lh.exec(b.slice(c,c+2));return d?(a.S=+d[0],c+d[0].length):-1}function eb(a,b,c){lh.lastIndex=0;var d=lh.exec(b.slice(c,c+3));return d?(a.L=+d[0],c+d[0].length):-1}function fb(a){var b=a.getTimezoneOffset(),c=b>0?"-":"+",d=ng(b)/60|0,e=ng(b)%60;return c+Qa(d,"0",2)+Qa(e,"0",2)}function gb(a,b,c){mh.lastIndex=0;var d=mh.exec(b.slice(c,c+1));return d?c+d[0].length:-1}function hb(a){for(var b=a.length,c=-1;++c<b;)a[c][0]=this(a[c][0]);return function(b){for(var c=0,d=a[c];!d[1](b);)d=a[++c];return d[0](b)}}function ib(){}function jb(a,b,c){var d=c.s=a+b,e=d-a,f=d-e;c.t=a-f+(b-e)}function kb(a,b){a&&qh.hasOwnProperty(a.type)&&qh[a.type](a,b)}function lb(a,b,c){var d,e=-1,f=a.length-c;for(b.lineStart();++e<f;)d=a[e],b.point(d[0],d[1],d[2]);b.lineEnd()}function mb(a,b){var c=-1,d=a.length;for(b.polygonStart();++c<d;)lb(a[c],b,1);b.polygonEnd()}function nb(){function a(a,b){a*=Jg,b=b*Jg/2+Fg/4;var c=a-d,g=c>=0?1:-1,h=g*c,i=Math.cos(b),j=Math.sin(b),k=f*j,l=e*i+k*Math.cos(h),m=k*g*Math.sin(h);sh.add(Math.atan2(m,l)),d=a,e=i,f=j}var b,c,d,e,f;th.point=function(g,h){th.point=a,d=(b=g)*Jg,e=Math.cos(h=(c=h)*Jg/2+Fg/4),f=Math.sin(h)},th.lineEnd=function(){a(b,c)}}function ob(a){var b=a[0],c=a[1],d=Math.cos(c);return[d*Math.cos(b),d*Math.sin(b),Math.sin(c)]}function pb(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]}function qb(a,b){return[a[1]*b[2]-a[2]*b[1],a[2]*b[0]-a[0]*b[2],a[0]*b[1]-a[1]*b[0]]}function rb(a,b){a[0]+=b[0],a[1]+=b[1],a[2]+=b[2]}function sb(a,b){return[a[0]*b,a[1]*b,a[2]*b]}function tb(a){var b=Math.sqrt(a[0]*a[0]+a[1]*a[1]+a[2]*a[2]);a[0]/=b,a[1]/=b,a[2]/=b}function ub(a){return[Math.atan2(a[1],a[0]),ba(a[2])]}function vb(a,b){return ng(a[0]-b[0])<Dg&&ng(a[1]-b[1])<Dg}function wb(a,b){a*=Jg;var c=Math.cos(b*=Jg);xb(c*Math.cos(a),c*Math.sin(a),Math.sin(b))}function xb(a,b,c){++uh,wh+=(a-wh)/uh,xh+=(b-xh)/uh,yh+=(c-yh)/uh}function yb(){function a(a,e){a*=Jg;var f=Math.cos(e*=Jg),g=f*Math.cos(a),h=f*Math.sin(a),i=Math.sin(e),j=Math.atan2(Math.sqrt((j=c*i-d*h)*j+(j=d*g-b*i)*j+(j=b*h-c*g)*j),b*g+c*h+d*i);vh+=j,zh+=j*(b+(b=g)),Ah+=j*(c+(c=h)),Bh+=j*(d+(d=i)),xb(b,c,d)}var b,c,d;Fh.point=function(e,f){e*=Jg;var g=Math.cos(f*=Jg);b=g*Math.cos(e),c=g*Math.sin(e),d=Math.sin(f),Fh.point=a,xb(b,c,d)}}function zb(){Fh.point=wb}function Ab(){function a(a,b){a*=Jg;var c=Math.cos(b*=Jg),g=c*Math.cos(a),h=c*Math.sin(a),i=Math.sin(b),j=e*i-f*h,k=f*g-d*i,l=d*h-e*g,m=Math.sqrt(j*j+k*k+l*l),n=d*g+e*h+f*i,o=m&&-aa(n)/m,p=Math.atan2(m,n);Ch+=o*j,Dh+=o*k,Eh+=o*l,vh+=p,zh+=p*(d+(d=g)),Ah+=p*(e+(e=h)),Bh+=p*(f+(f=i)),xb(d,e,f)}var b,c,d,e,f;Fh.point=function(g,h){b=g,c=h,Fh.point=a,g*=Jg;var i=Math.cos(h*=Jg);d=i*Math.cos(g),e=i*Math.sin(g),f=Math.sin(h),xb(d,e,f)},Fh.lineEnd=function(){a(b,c),Fh.lineEnd=zb,Fh.point=wb}}function Bb(a,b){function c(c,d){return c=a(c,d),b(c[0],c[1])}return a.invert&&b.invert&&(c.invert=function(c,d){return c=b.invert(c,d),c&&a.invert(c[0],c[1])}),c}function Cb(){return!0}function Db(a,b,c,d,e){var f=[],g=[];if(a.forEach(function(a){if(!((b=a.length-1)<=0)){var b,c=a[0],d=a[b];if(vb(c,d)){e.lineStart();for(var h=0;b>h;++h)e.point((c=a[h])[0],c[1]);return void e.lineEnd()}var i=new Fb(c,a,null,!0),j=new Fb(c,null,i,!1);i.o=j,f.push(i),g.push(j),i=new Fb(d,a,null,!1),j=new Fb(d,null,i,!0),i.o=j,f.push(i),g.push(j)}}),g.sort(b),Eb(f),Eb(g),f.length){for(var h=0,i=c,j=g.length;j>h;++h)g[h].e=i=!i;for(var k,l,m=f[0];;){for(var n=m,o=!0;n.v;)if((n=n.n)===m)return;k=n.z,e.lineStart();do{if(n.v=n.o.v=!0,n.e){if(o)for(var h=0,j=k.length;j>h;++h)e.point((l=k[h])[0],l[1]);else d(n.x,n.n.x,1,e);n=n.n}else{if(o){k=n.p.z;for(var h=k.length-1;h>=0;--h)e.point((l=k[h])[0],l[1])}else d(n.x,n.p.x,-1,e);n=n.p}n=n.o,k=n.z,o=!o}while(!n.v);e.lineEnd()}}}function Eb(a){if(b=a.length){for(var b,c,d=0,e=a[0];++d<b;)e.n=c=a[d],c.p=e,e=c;e.n=c=a[0],c.p=e}}function Fb(a,b,c,d){this.x=a,this.z=b,this.o=c,this.e=d,this.v=!1,this.n=this.p=null}function Gb(a,b,c,d){return function(e,f){function g(b,c){var d=e(b,c);a(b=d[0],c=d[1])&&f.point(b,c)}function h(a,b){var c=e(a,b);q.point(c[0],c[1])}function i(){s.point=h,q.lineStart()}function j(){s.point=g,q.lineEnd()}function k(a,b){p.push([a,b]);var c=e(a,b);u.point(c[0],c[1])}function l(){u.lineStart(),p=[]}function m(){k(p[0][0],p[0][1]),u.lineEnd();var a,b=u.clean(),c=t.buffer(),d=c.length;if(p.pop(),o.push(p),p=null,d)if(1&b){a=c[0];var e,d=a.length-1,g=-1;if(d>0){for(v||(f.polygonStart(),v=!0),f.lineStart();++g<d;)f.point((e=a[g])[0],e[1]);f.lineEnd()}}else d>1&&2&b&&c.push(c.pop().concat(c.shift())),n.push(c.filter(Hb))}var n,o,p,q=b(f),r=e.invert(d[0],d[1]),s={point:g,lineStart:i,lineEnd:j,polygonStart:function(){s.point=k,s.lineStart=l,s.lineEnd=m,n=[],o=[]},polygonEnd:function(){s.point=g,s.lineStart=i,s.lineEnd=j,n=bg.merge(n);var a=Nb(r,o);n.length?(v||(f.polygonStart(),v=!0),Db(n,Jb,a,c,f)):a&&(v||(f.polygonStart(),v=!0),f.lineStart(),c(null,null,1,f),f.lineEnd()),v&&(f.polygonEnd(),v=!1),n=o=null},sphere:function(){f.polygonStart(),f.lineStart(),c(null,null,1,f),f.lineEnd(),f.polygonEnd()}},t=Ib(),u=b(t),v=!1;return s}}function Hb(a){return a.length>1}function Ib(){var a,b=[];return{lineStart:function(){b.push(a=[])},point:function(b,c){a.push([b,c])},lineEnd:v,buffer:function(){var c=b;return b=[],a=null,c},rejoin:function(){b.length>1&&b.push(b.pop().concat(b.shift()))}}}function Jb(a,b){return((a=a.x)[0]<0?a[1]-Ig-Dg:Ig-a[1])-((b=b.x)[0]<0?b[1]-Ig-Dg:Ig-b[1])}function Kb(a){var b,c=NaN,d=NaN,e=NaN;return{lineStart:function(){a.lineStart(),b=1},point:function(f,g){var h=f>0?Fg:-Fg,i=ng(f-c);ng(i-Fg)<Dg?(a.point(c,d=(d+g)/2>0?Ig:-Ig),a.point(e,d),a.lineEnd(),a.lineStart(),a.point(h,d),a.point(f,d),b=0):e!==h&&i>=Fg&&(ng(c-e)<Dg&&(c-=e*Dg),ng(f-h)<Dg&&(f-=h*Dg),d=Lb(c,d,f,g),a.point(e,d),a.lineEnd(),a.lineStart(),a.point(h,d),b=0),a.point(c=f,d=g),e=h},lineEnd:function(){a.lineEnd(),c=d=NaN},clean:function(){return 2-b}}}function Lb(a,b,c,d){var e,f,g=Math.sin(a-c);return ng(g)>Dg?Math.atan((Math.sin(b)*(f=Math.cos(d))*Math.sin(c)-Math.sin(d)*(e=Math.cos(b))*Math.sin(a))/(e*f*g)):(b+d)/2}function Mb(a,b,c,d){var e;if(null==a)e=c*Ig,d.point(-Fg,e),d.point(0,e),d.point(Fg,e),d.point(Fg,0),d.point(Fg,-e),d.point(0,-e),d.point(-Fg,-e),d.point(-Fg,0),d.point(-Fg,e);else if(ng(a[0]-b[0])>Dg){var f=a[0]<b[0]?Fg:-Fg;e=c*f/2,d.point(-f,e),d.point(0,e),d.point(f,e)}else d.point(b[0],b[1])}function Nb(a,b){var c=a[0],d=a[1],e=[Math.sin(c),-Math.cos(c),0],f=0,g=0;sh.reset();for(var h=0,i=b.length;i>h;++h){var j=b[h],k=j.length;if(k)for(var l=j[0],m=l[0],n=l[1]/2+Fg/4,o=Math.sin(n),p=Math.cos(n),q=1;;){q===k&&(q=0),a=j[q];var r=a[0],s=a[1]/2+Fg/4,t=Math.sin(s),u=Math.cos(s),v=r-m,w=v>=0?1:-1,x=w*v,y=x>Fg,z=o*t;if(sh.add(Math.atan2(z*w*Math.sin(x),p*u+z*Math.cos(x))),f+=y?v+w*Gg:v,y^m>=c^r>=c){var A=qb(ob(l),ob(a));tb(A);var B=qb(e,A);tb(B);var C=(y^v>=0?-1:1)*ba(B[2]);(d>C||d===C&&(A[0]||A[1]))&&(g+=y^v>=0?1:-1)}if(!q++)break;m=r,o=t,p=u,l=a}}return(-Dg>f||Dg>f&&0>sh)^1&g}function Ob(a){function b(a,b){return Math.cos(a)*Math.cos(b)>f}function c(a){var c,f,i,j,k;return{lineStart:function(){j=i=!1,k=1},point:function(l,m){var n,o=[l,m],p=b(l,m),q=g?p?0:e(l,m):p?e(l+(0>l?Fg:-Fg),m):0;if(!c&&(j=i=p)&&a.lineStart(),p!==i&&(n=d(c,o),(vb(c,n)||vb(o,n))&&(o[0]+=Dg,o[1]+=Dg,p=b(o[0],o[1]))),p!==i)k=0,p?(a.lineStart(),n=d(o,c),a.point(n[0],n[1])):(n=d(c,o),a.point(n[0],n[1]),a.lineEnd()),c=n;else if(h&&c&&g^p){var r;q&f||!(r=d(o,c,!0))||(k=0,g?(a.lineStart(),a.point(r[0][0],r[0][1]),a.point(r[1][0],r[1][1]),a.lineEnd()):(a.point(r[1][0],r[1][1]),a.lineEnd(),a.lineStart(),a.point(r[0][0],r[0][1])))}!p||c&&vb(c,o)||a.point(o[0],o[1]),c=o,i=p,f=q},lineEnd:function(){i&&a.lineEnd(),c=null},clean:function(){return k|(j&&i)<<1}}}function d(a,b,c){var d=ob(a),e=ob(b),g=[1,0,0],h=qb(d,e),i=pb(h,h),j=h[0],k=i-j*j;if(!k)return!c&&a;var l=f*i/k,m=-f*j/k,n=qb(g,h),o=sb(g,l),p=sb(h,m);rb(o,p);var q=n,r=pb(o,q),s=pb(q,q),t=r*r-s*(pb(o,o)-1);if(!(0>t)){var u=Math.sqrt(t),v=sb(q,(-r-u)/s);if(rb(v,o),v=ub(v),!c)return v;var w,x=a[0],y=b[0],z=a[1],A=b[1];x>y&&(w=x,x=y,y=w);var B=y-x,C=ng(B-Fg)<Dg,D=C||Dg>B;if(!C&&z>A&&(w=z,z=A,A=w),D?C?z+A>0^v[1]<(ng(v[0]-x)<Dg?z:A):z<=v[1]&&v[1]<=A:B>Fg^(x<=v[0]&&v[0]<=y)){var E=sb(q,(-r+u)/s);return rb(E,o),[v,ub(E)]}}}function e(b,c){var d=g?a:Fg-a,e=0;return-d>b?e|=1:b>d&&(e|=2),-d>c?e|=4:c>d&&(e|=8),e}var f=Math.cos(a),g=f>0,h=ng(f)>Dg,i=nc(a,6*Jg);return Gb(b,c,i,g?[0,-a]:[-Fg,a-Fg])}function Pb(a,b,c,d){return function(e){var f,g=e.a,h=e.b,i=g.x,j=g.y,k=h.x,l=h.y,m=0,n=1,o=k-i,p=l-j;if(f=a-i,o||!(f>0)){if(f/=o,0>o){if(m>f)return;n>f&&(n=f)}else if(o>0){if(f>n)return;f>m&&(m=f)}if(f=c-i,o||!(0>f)){if(f/=o,0>o){if(f>n)return;f>m&&(m=f)}else if(o>0){if(m>f)return;n>f&&(n=f)}if(f=b-j,p||!(f>0)){if(f/=p,0>p){if(m>f)return;n>f&&(n=f)}else if(p>0){if(f>n)return;f>m&&(m=f)}if(f=d-j,p||!(0>f)){if(f/=p,0>p){if(f>n)return;f>m&&(m=f)}else if(p>0){if(m>f)return;n>f&&(n=f)}return m>0&&(e.a={x:i+m*o,y:j+m*p}),1>n&&(e.b={x:i+n*o,y:j+n*p}),e}}}}}}function Qb(a,b,c,d){function e(d,e){return ng(d[0]-a)<Dg?e>0?0:3:ng(d[0]-c)<Dg?e>0?2:1:ng(d[1]-b)<Dg?e>0?1:0:e>0?3:2}function f(a,b){return g(a.x,b.x)}function g(a,b){var c=e(a,1),d=e(b,1);return c!==d?c-d:0===c?b[1]-a[1]:1===c?a[0]-b[0]:2===c?a[1]-b[1]:b[0]-a[0]}return function(h){function i(a){for(var b=0,c=q.length,d=a[1],e=0;c>e;++e)for(var f,g=1,h=q[e],i=h.length,j=h[0];i>g;++g)f=h[g],j[1]<=d?f[1]>d&&_(j,f,a)>0&&++b:f[1]<=d&&_(j,f,a)<0&&--b,j=f;return 0!==b}function j(f,h,i,j){var k=0,l=0;if(null==f||(k=e(f,i))!==(l=e(h,i))||g(f,h)<0^i>0){do j.point(0===k||3===k?a:c,k>1?d:b);while((k=(k+i+4)%4)!==l)}else j.point(h[0],h[1])}function k(e,f){return e>=a&&c>=e&&f>=b&&d>=f}function l(a,b){k(a,b)&&h.point(a,b)}function m(){D.point=o,q&&q.push(r=[]),y=!0,x=!1,v=w=NaN}function n(){p&&(o(s,t),u&&x&&B.rejoin(),p.push(B.buffer())),D.point=l,x&&h.lineEnd()}function o(a,b){a=Math.max(-Hh,Math.min(Hh,a)),b=Math.max(-Hh,Math.min(Hh,b));var c=k(a,b);if(q&&r.push([a,b]),y)s=a,t=b,u=c,y=!1,c&&(h.lineStart(),h.point(a,b));else if(c&&x)h.point(a,b);else{var d={a:{x:v,y:w},b:{x:a,y:b}};C(d)?(x||(h.lineStart(),h.point(d.a.x,d.a.y)),h.point(d.b.x,d.b.y),c||h.lineEnd(),z=!1):c&&(h.lineStart(),h.point(a,b),z=!1)}v=a,w=b,x=c}var p,q,r,s,t,u,v,w,x,y,z,A=h,B=Ib(),C=Pb(a,b,c,d),D={point:l,lineStart:m,lineEnd:n,polygonStart:function(){h=B,p=[],q=[],z=!0},polygonEnd:function(){h=A,p=bg.merge(p);var b=i([a,d]),c=z&&b,e=p.length;(c||e)&&(h.polygonStart(),c&&(h.lineStart(),j(null,null,1,h),h.lineEnd()),e&&Db(p,f,b,j,h),h.polygonEnd()),p=q=r=null}};return D}}function Rb(a){var b=0,c=Fg/3,d=fc(a),e=d(b,c);return e.parallels=function(a){return arguments.length?d(b=a[0]*Fg/180,c=a[1]*Fg/180):[b/Fg*180,c/Fg*180]},e}function Sb(a,b){function c(a,b){var c=Math.sqrt(f-2*e*Math.sin(b))/e;return[c*Math.sin(a*=e),g-c*Math.cos(a)]}var d=Math.sin(a),e=(d+Math.sin(b))/2,f=1+d*(2*e-d),g=Math.sqrt(f)/e;return c.invert=function(a,b){var c=g-b;return[Math.atan2(a,c)/e,ba((f-(a*a+c*c)*e*e)/(2*e))]},c}function Tb(){function a(a,b){Jh+=e*a-d*b,d=a,e=b}var b,c,d,e;Oh.point=function(f,g){Oh.point=a,b=d=f,c=e=g},Oh.lineEnd=function(){a(b,c)}}function Ub(a,b){Kh>a&&(Kh=a),a>Mh&&(Mh=a),Lh>b&&(Lh=b),b>Nh&&(Nh=b)}function Vb(){function a(a,b){g.push("M",a,",",b,f)}function b(a,b){g.push("M",a,",",b),h.point=c}function c(a,b){g.push("L",a,",",b)}function d(){h.point=a}function e(){g.push("Z")}var f=Wb(4.5),g=[],h={point:a,lineStart:function(){h.point=b},lineEnd:d,polygonStart:function(){h.lineEnd=e},polygonEnd:function(){h.lineEnd=d,h.point=a},pointRadius:function(a){return f=Wb(a),h},result:function(){if(g.length){var a=g.join("");return g=[],a}}};return h}function Wb(a){return"m0,"+a+"a"+a+","+a+" 0 1,1 0,"+-2*a+"a"+a+","+a+" 0 1,1 0,"+2*a+"z"}function Xb(a,b){wh+=a,xh+=b,++yh}function Yb(){function a(a,d){var e=a-b,f=d-c,g=Math.sqrt(e*e+f*f);zh+=g*(b+a)/2,Ah+=g*(c+d)/2,Bh+=g,Xb(b=a,c=d)}var b,c;Qh.point=function(d,e){Qh.point=a,Xb(b=d,c=e)}}function Zb(){Qh.point=Xb}function $b(){function a(a,b){var c=a-d,f=b-e,g=Math.sqrt(c*c+f*f);zh+=g*(d+a)/2,Ah+=g*(e+b)/2,Bh+=g,g=e*a-d*b,Ch+=g*(d+a),Dh+=g*(e+b),Eh+=3*g,Xb(d=a,e=b)}var b,c,d,e;Qh.point=function(f,g){Qh.point=a,Xb(b=d=f,c=e=g)},Qh.lineEnd=function(){a(b,c)}}function _b(a){function b(b,c){a.moveTo(b+g,c),a.arc(b,c,g,0,Gg)}function c(b,c){a.moveTo(b,c),h.point=d}function d(b,c){a.lineTo(b,c)}function e(){h.point=b}function f(){a.closePath()}var g=4.5,h={point:b,lineStart:function(){h.point=c},lineEnd:e,polygonStart:function(){h.lineEnd=f},polygonEnd:function(){h.lineEnd=e,h.point=b},pointRadius:function(a){return g=a,h},result:v};return h}function ac(a){function b(a){return(h?d:c)(a)}function c(b){return dc(b,function(c,d){c=a(c,d),b.point(c[0],c[1])})}function d(b){function c(c,d){c=a(c,d),b.point(c[0],c[1])}function d(){t=NaN,y.point=f,b.lineStart()}function f(c,d){var f=ob([c,d]),g=a(c,d);e(t,u,s,v,w,x,t=g[0],u=g[1],s=c,v=f[0],w=f[1],x=f[2],h,b),b.point(t,u)}function g(){y.point=c,b.lineEnd()}function i(){d(),y.point=j,y.lineEnd=k}function j(a,b){f(l=a,m=b),n=t,o=u,p=v,q=w,r=x,y.point=f}function k(){e(t,u,s,v,w,x,n,o,l,p,q,r,h,b),y.lineEnd=g,g()}var l,m,n,o,p,q,r,s,t,u,v,w,x,y={point:c,lineStart:d,lineEnd:g,polygonStart:function(){b.polygonStart(),y.lineStart=i},polygonEnd:function(){b.polygonEnd(),y.lineStart=d}};return y}function e(b,c,d,h,i,j,k,l,m,n,o,p,q,r){var s=k-b,t=l-c,u=s*s+t*t;if(u>4*f&&q--){var v=h+n,w=i+o,x=j+p,y=Math.sqrt(v*v+w*w+x*x),z=Math.asin(x/=y),A=ng(ng(x)-1)<Dg||ng(d-m)<Dg?(d+m)/2:Math.atan2(w,v),B=a(A,z),C=B[0],D=B[1],E=C-b,F=D-c,G=t*E-s*F;(G*G/u>f||ng((s*E+t*F)/u-.5)>.3||g>h*n+i*o+j*p)&&(e(b,c,d,h,i,j,C,D,A,v/=y,w/=y,x,q,r),r.point(C,D),e(C,D,A,v,w,x,k,l,m,n,o,p,q,r))}}var f=.5,g=Math.cos(30*Jg),h=16;return b.precision=function(a){return arguments.length?(h=(f=a*a)>0&&16,b):Math.sqrt(f)},b}function bc(a){var b=ac(function(b,c){return a([b*Kg,c*Kg])});return function(a){return gc(b(a))}}function cc(a){this.stream=a}function dc(a,b){return{point:b,sphere:function(){a.sphere()},lineStart:function(){a.lineStart()},lineEnd:function(){a.lineEnd()},polygonStart:function(){a.polygonStart()},polygonEnd:function(){a.polygonEnd()}}}function ec(a){return fc(function(){return a})()}function fc(a){function b(a){return a=h(a[0]*Jg,a[1]*Jg),[a[0]*m+i,j-a[1]*m]}function c(a){return a=h.invert((a[0]-i)/m,(j-a[1])/m),a&&[a[0]*Kg,a[1]*Kg]}function d(){h=Bb(g=jc(r,t,u),f);var a=f(p,q);return i=n-a[0]*m,j=o+a[1]*m,e()}function e(){return k&&(k.valid=!1,k=null),b}var f,g,h,i,j,k,l=ac(function(a,b){return a=f(a,b),[a[0]*m+i,j-a[1]*m]}),m=150,n=480,o=250,p=0,q=0,r=0,t=0,u=0,v=Gh,w=s,x=null,y=null;return b.stream=function(a){return k&&(k.valid=!1),k=gc(v(g,l(w(a)))),k.valid=!0,k},b.clipAngle=function(a){return arguments.length?(v=null==a?(x=a,Gh):Ob((x=+a)*Jg),e()):x},b.clipExtent=function(a){return arguments.length?(y=a,w=a?Qb(a[0][0],a[0][1],a[1][0],a[1][1]):s,e()):y},b.scale=function(a){return arguments.length?(m=+a,d()):m},b.translate=function(a){return arguments.length?(n=+a[0],o=+a[1],d()):[n,o]},b.center=function(a){return arguments.length?(p=a[0]%360*Jg,q=a[1]%360*Jg,d()):[p*Kg,q*Kg]},b.rotate=function(a){return arguments.length?(r=a[0]%360*Jg,t=a[1]%360*Jg,u=a.length>2?a[2]%360*Jg:0,d()):[r*Kg,t*Kg,u*Kg]},bg.rebind(b,l,"precision"),function(){return f=a.apply(this,arguments),b.invert=f.invert&&c,d()}}function gc(a){return dc(a,function(b,c){a.point(b*Jg,c*Jg)})}function hc(a,b){return[a,b]}function ic(a,b){return[a>Fg?a-Gg:-Fg>a?a+Gg:a,b]}function jc(a,b,c){return a?b||c?Bb(lc(a),mc(b,c)):lc(a):b||c?mc(b,c):ic}function kc(a){return function(b,c){return b+=a,[b>Fg?b-Gg:-Fg>b?b+Gg:b,c]}}function lc(a){var b=kc(a);return b.invert=kc(-a),b}function mc(a,b){function c(a,b){var c=Math.cos(b),h=Math.cos(a)*c,i=Math.sin(a)*c,j=Math.sin(b),k=j*d+h*e;return[Math.atan2(i*f-k*g,h*d-j*e),ba(k*f+i*g)]}var d=Math.cos(a),e=Math.sin(a),f=Math.cos(b),g=Math.sin(b);return c.invert=function(a,b){var c=Math.cos(b),h=Math.cos(a)*c,i=Math.sin(a)*c,j=Math.sin(b),k=j*f-i*g;return[Math.atan2(i*f+j*g,h*d+k*e),ba(k*d-h*e)]},c}function nc(a,b){var c=Math.cos(a),d=Math.sin(a);return function(e,f,g,h){var i=g*b;null!=e?(e=oc(c,e),f=oc(c,f),(g>0?f>e:e>f)&&(e+=g*Gg)):(e=a+g*Gg,f=a-.5*i);for(var j,k=e;g>0?k>f:f>k;k-=i)h.point((j=ub([c,-d*Math.cos(k),-d*Math.sin(k)]))[0],j[1])}}function oc(a,b){var c=ob(b);c[0]-=a,tb(c);var d=aa(-c[1]);return((-c[2]<0?-d:d)+2*Math.PI-Dg)%(2*Math.PI)}function pc(a,b,c){var d=bg.range(a,b-Dg,c).concat(b);return function(a){return d.map(function(b){return[a,b]})}}function qc(a,b,c){var d=bg.range(a,b-Dg,c).concat(b);return function(a){return d.map(function(b){return[b,a]})}}function rc(a){return a.source}function sc(a){return a.target}function tc(a,b,c,d){var e=Math.cos(b),f=Math.sin(b),g=Math.cos(d),h=Math.sin(d),i=e*Math.cos(a),j=e*Math.sin(a),k=g*Math.cos(c),l=g*Math.sin(c),m=2*Math.asin(Math.sqrt(fa(d-b)+e*g*fa(c-a))),n=1/Math.sin(m),o=m?function(a){var b=Math.sin(a*=m)*n,c=Math.sin(m-a)*n,d=c*i+b*k,e=c*j+b*l,g=c*f+b*h;return[Math.atan2(e,d)*Kg,Math.atan2(g,Math.sqrt(d*d+e*e))*Kg]}:function(){return[a*Kg,b*Kg]};return o.distance=m,o}function uc(){function a(a,e){var f=Math.sin(e*=Jg),g=Math.cos(e),h=ng((a*=Jg)-b),i=Math.cos(h);Rh+=Math.atan2(Math.sqrt((h=g*Math.sin(h))*h+(h=d*f-c*g*i)*h),c*f+d*g*i),b=a,c=f,d=g}var b,c,d;Sh.point=function(e,f){b=e*Jg,c=Math.sin(f*=Jg),d=Math.cos(f),Sh.point=a},Sh.lineEnd=function(){Sh.point=Sh.lineEnd=v}}function vc(a,b){function c(b,c){var d=Math.cos(b),e=Math.cos(c),f=a(d*e);return[f*e*Math.sin(b),f*Math.sin(c)]}return c.invert=function(a,c){var d=Math.sqrt(a*a+c*c),e=b(d),f=Math.sin(e),g=Math.cos(e);return[Math.atan2(a*f,d*g),Math.asin(d&&c*f/d)]},c}function wc(a,b){function c(a,b){g>0?-Ig+Dg>b&&(b=-Ig+Dg):b>Ig-Dg&&(b=Ig-Dg);var c=g/Math.pow(e(b),f);return[c*Math.sin(f*a),g-c*Math.cos(f*a)]}var d=Math.cos(a),e=function(a){return Math.tan(Fg/4+a/2)},f=a===b?Math.sin(a):Math.log(d/Math.cos(b))/Math.log(e(b)/e(a)),g=d*Math.pow(e(a),f)/f;return f?(c.invert=function(a,b){var c=g-b,d=$(f)*Math.sqrt(a*a+c*c);return[Math.atan2(a,c)/f,2*Math.atan(Math.pow(g/d,1/f))-Ig]},c):yc}function xc(a,b){function c(a,b){var c=f-b;return[c*Math.sin(e*a),f-c*Math.cos(e*a)]}var d=Math.cos(a),e=a===b?Math.sin(a):(d-Math.cos(b))/(b-a),f=d/e+a;return ng(e)<Dg?hc:(c.invert=function(a,b){var c=f-b;return[Math.atan2(a,c)/e,f-$(e)*Math.sqrt(a*a+c*c)]},c)}function yc(a,b){return[a,Math.log(Math.tan(Fg/4+b/2))]}function zc(a){var b,c=ec(a),d=c.scale,e=c.translate,f=c.clipExtent;return c.scale=function(){var a=d.apply(c,arguments);return a===c?b?c.clipExtent(null):c:a},c.translate=function(){var a=e.apply(c,arguments);return a===c?b?c.clipExtent(null):c:a},c.clipExtent=function(a){var g=f.apply(c,arguments);if(g===c){if(b=null==a){var h=Fg*d(),i=e();f([[i[0]-h,i[1]-h],[i[0]+h,i[1]+h]])}}else b&&(g=null);return g},c.clipExtent(null)}function Ac(a,b){return[Math.log(Math.tan(Fg/4+b/2)),-a]}function Bc(a){return a[0]}function Cc(a){return a[1]}function Dc(a){for(var b=a.length,c=[0,1],d=2,e=2;b>e;e++){for(;d>1&&_(a[c[d-2]],a[c[d-1]],a[e])<=0;)--d;c[d++]=e}return c.slice(0,d)}function Ec(a,b){return a[0]-b[0]||a[1]-b[1]}function Fc(a,b,c){return(c[0]-b[0])*(a[1]-b[1])<(c[1]-b[1])*(a[0]-b[0]);
}function Gc(a,b,c,d){var e=a[0],f=c[0],g=b[0]-e,h=d[0]-f,i=a[1],j=c[1],k=b[1]-i,l=d[1]-j,m=(h*(i-j)-l*(e-f))/(l*g-h*k);return[e+m*g,i+m*k]}function Hc(a){var b=a[0],c=a[a.length-1];return!(b[0]-c[0]||b[1]-c[1])}function Ic(){bd(this),this.edge=this.site=this.circle=null}function Jc(a){var b=ci.pop()||new Ic;return b.site=a,b}function Kc(a){Uc(a),_h.remove(a),ci.push(a),bd(a)}function Lc(a){var b=a.circle,c=b.x,d=b.cy,e={x:c,y:d},f=a.P,g=a.N,h=[a];Kc(a);for(var i=f;i.circle&&ng(c-i.circle.x)<Dg&&ng(d-i.circle.cy)<Dg;)f=i.P,h.unshift(i),Kc(i),i=f;h.unshift(i),Uc(i);for(var j=g;j.circle&&ng(c-j.circle.x)<Dg&&ng(d-j.circle.cy)<Dg;)g=j.N,h.push(j),Kc(j),j=g;h.push(j),Uc(j);var k,l=h.length;for(k=1;l>k;++k)j=h[k],i=h[k-1],$c(j.edge,i.site,j.site,e);i=h[0],j=h[l-1],j.edge=Yc(i.site,j.site,null,e),Tc(i),Tc(j)}function Mc(a){for(var b,c,d,e,f=a.x,g=a.y,h=_h._;h;)if(d=Nc(h,g)-f,d>Dg)h=h.L;else{if(e=f-Oc(h,g),!(e>Dg)){d>-Dg?(b=h.P,c=h):e>-Dg?(b=h,c=h.N):b=c=h;break}if(!h.R){b=h;break}h=h.R}var i=Jc(a);if(_h.insert(b,i),b||c){if(b===c)return Uc(b),c=Jc(b.site),_h.insert(i,c),i.edge=c.edge=Yc(b.site,i.site),Tc(b),void Tc(c);if(!c)return void(i.edge=Yc(b.site,i.site));Uc(b),Uc(c);var j=b.site,k=j.x,l=j.y,m=a.x-k,n=a.y-l,o=c.site,p=o.x-k,q=o.y-l,r=2*(m*q-n*p),s=m*m+n*n,t=p*p+q*q,u={x:(q*s-n*t)/r+k,y:(m*t-p*s)/r+l};$c(c.edge,j,o,u),i.edge=Yc(j,a,null,u),c.edge=Yc(a,o,null,u),Tc(b),Tc(c)}}function Nc(a,b){var c=a.site,d=c.x,e=c.y,f=e-b;if(!f)return d;var g=a.P;if(!g)return-(1/0);c=g.site;var h=c.x,i=c.y,j=i-b;if(!j)return h;var k=h-d,l=1/f-1/j,m=k/j;return l?(-m+Math.sqrt(m*m-2*l*(k*k/(-2*j)-i+j/2+e-f/2)))/l+d:(d+h)/2}function Oc(a,b){var c=a.N;if(c)return Nc(c,b);var d=a.site;return d.y===b?d.x:1/0}function Pc(a){this.site=a,this.edges=[]}function Qc(a){for(var b,c,d,e,f,g,h,i,j,k,l=a[0][0],m=a[1][0],n=a[0][1],o=a[1][1],p=$h,q=p.length;q--;)if(f=p[q],f&&f.prepare())for(h=f.edges,i=h.length,g=0;i>g;)k=h[g].end(),d=k.x,e=k.y,j=h[++g%i].start(),b=j.x,c=j.y,(ng(d-b)>Dg||ng(e-c)>Dg)&&(h.splice(g,0,new _c(Zc(f.site,k,ng(d-l)<Dg&&o-e>Dg?{x:l,y:ng(b-l)<Dg?c:o}:ng(e-o)<Dg&&m-d>Dg?{x:ng(c-o)<Dg?b:m,y:o}:ng(d-m)<Dg&&e-n>Dg?{x:m,y:ng(b-m)<Dg?c:n}:ng(e-n)<Dg&&d-l>Dg?{x:ng(c-n)<Dg?b:l,y:n}:null),f.site,null)),++i)}function Rc(a,b){return b.angle-a.angle}function Sc(){bd(this),this.x=this.y=this.arc=this.site=this.cy=null}function Tc(a){var b=a.P,c=a.N;if(b&&c){var d=b.site,e=a.site,f=c.site;if(d!==f){var g=e.x,h=e.y,i=d.x-g,j=d.y-h,k=f.x-g,l=f.y-h,m=2*(i*l-j*k);if(!(m>=-Eg)){var n=i*i+j*j,o=k*k+l*l,p=(l*n-j*o)/m,q=(i*o-k*n)/m,l=q+h,r=di.pop()||new Sc;r.arc=a,r.site=e,r.x=p+g,r.y=l+Math.sqrt(p*p+q*q),r.cy=l,a.circle=r;for(var s=null,t=bi._;t;)if(r.y<t.y||r.y===t.y&&r.x<=t.x){if(!t.L){s=t.P;break}t=t.L}else{if(!t.R){s=t;break}t=t.R}bi.insert(s,r),s||(ai=r)}}}}function Uc(a){var b=a.circle;b&&(b.P||(ai=b.N),bi.remove(b),di.push(b),bd(b),a.circle=null)}function Vc(a){for(var b,c=Zh,d=Pb(a[0][0],a[0][1],a[1][0],a[1][1]),e=c.length;e--;)b=c[e],(!Wc(b,a)||!d(b)||ng(b.a.x-b.b.x)<Dg&&ng(b.a.y-b.b.y)<Dg)&&(b.a=b.b=null,c.splice(e,1))}function Wc(a,b){var c=a.b;if(c)return!0;var d,e,f=a.a,g=b[0][0],h=b[1][0],i=b[0][1],j=b[1][1],k=a.l,l=a.r,m=k.x,n=k.y,o=l.x,p=l.y,q=(m+o)/2,r=(n+p)/2;if(p===n){if(g>q||q>=h)return;if(m>o){if(f){if(f.y>=j)return}else f={x:q,y:i};c={x:q,y:j}}else{if(f){if(f.y<i)return}else f={x:q,y:j};c={x:q,y:i}}}else if(d=(m-o)/(p-n),e=r-d*q,-1>d||d>1)if(m>o){if(f){if(f.y>=j)return}else f={x:(i-e)/d,y:i};c={x:(j-e)/d,y:j}}else{if(f){if(f.y<i)return}else f={x:(j-e)/d,y:j};c={x:(i-e)/d,y:i}}else if(p>n){if(f){if(f.x>=h)return}else f={x:g,y:d*g+e};c={x:h,y:d*h+e}}else{if(f){if(f.x<g)return}else f={x:h,y:d*h+e};c={x:g,y:d*g+e}}return a.a=f,a.b=c,!0}function Xc(a,b){this.l=a,this.r=b,this.a=this.b=null}function Yc(a,b,c,d){var e=new Xc(a,b);return Zh.push(e),c&&$c(e,a,b,c),d&&$c(e,b,a,d),$h[a.i].edges.push(new _c(e,a,b)),$h[b.i].edges.push(new _c(e,b,a)),e}function Zc(a,b,c){var d=new Xc(a,null);return d.a=b,d.b=c,Zh.push(d),d}function $c(a,b,c,d){a.a||a.b?a.l===c?a.b=d:a.a=d:(a.a=d,a.l=b,a.r=c)}function _c(a,b,c){var d=a.a,e=a.b;this.edge=a,this.site=b,this.angle=c?Math.atan2(c.y-b.y,c.x-b.x):a.l===b?Math.atan2(e.x-d.x,d.y-e.y):Math.atan2(d.x-e.x,e.y-d.y)}function ad(){this._=null}function bd(a){a.U=a.C=a.L=a.R=a.P=a.N=null}function cd(a,b){var c=b,d=b.R,e=c.U;e?e.L===c?e.L=d:e.R=d:a._=d,d.U=e,c.U=d,c.R=d.L,c.R&&(c.R.U=c),d.L=c}function dd(a,b){var c=b,d=b.L,e=c.U;e?e.L===c?e.L=d:e.R=d:a._=d,d.U=e,c.U=d,c.L=d.R,c.L&&(c.L.U=c),d.R=c}function ed(a){for(;a.L;)a=a.L;return a}function fd(a,b){var c,d,e,f=a.sort(gd).pop();for(Zh=[],$h=new Array(a.length),_h=new ad,bi=new ad;;)if(e=ai,f&&(!e||f.y<e.y||f.y===e.y&&f.x<e.x))f.x===c&&f.y===d||($h[f.i]=new Pc(f),Mc(f),c=f.x,d=f.y),f=a.pop();else{if(!e)break;Lc(e.arc)}b&&(Vc(b),Qc(b));var g={cells:$h,edges:Zh};return _h=bi=Zh=$h=null,g}function gd(a,b){return b.y-a.y||b.x-a.x}function hd(a,b,c){return(a.x-c.x)*(b.y-a.y)-(a.x-b.x)*(c.y-a.y)}function id(a){return a.x}function jd(a){return a.y}function kd(){return{leaf:!0,nodes:[],point:null,x:null,y:null}}function ld(a,b,c,d,e,f){if(!a(b,c,d,e,f)){var g=.5*(c+e),h=.5*(d+f),i=b.nodes;i[0]&&ld(a,i[0],c,d,g,h),i[1]&&ld(a,i[1],g,d,e,h),i[2]&&ld(a,i[2],c,h,g,f),i[3]&&ld(a,i[3],g,h,e,f)}}function md(a,b,c,d,e,f,g){var h,i=1/0;return function j(a,k,l,m,n){if(!(k>f||l>g||d>m||e>n)){if(o=a.point){var o,p=b-a.x,q=c-a.y,r=p*p+q*q;if(i>r){var s=Math.sqrt(i=r);d=b-s,e=c-s,f=b+s,g=c+s,h=o}}for(var t=a.nodes,u=.5*(k+m),v=.5*(l+n),w=b>=u,x=c>=v,y=x<<1|w,z=y+4;z>y;++y)if(a=t[3&y])switch(3&y){case 0:j(a,k,l,u,v);break;case 1:j(a,u,l,m,v);break;case 2:j(a,k,v,u,n);break;case 3:j(a,u,v,m,n)}}}(a,d,e,f,g),h}function nd(a,b){a=bg.rgb(a),b=bg.rgb(b);var c=a.r,d=a.g,e=a.b,f=b.r-c,g=b.g-d,h=b.b-e;return function(a){return"#"+ua(Math.round(c+f*a))+ua(Math.round(d+g*a))+ua(Math.round(e+h*a))}}function od(a,b){var c,d={},e={};for(c in a)c in b?d[c]=rd(a[c],b[c]):e[c]=a[c];for(c in b)c in a||(e[c]=b[c]);return function(a){for(c in d)e[c]=d[c](a);return e}}function pd(a,b){return a=+a,b=+b,function(c){return a*(1-c)+b*c}}function qd(a,b){var c,d,e,f=fi.lastIndex=gi.lastIndex=0,g=-1,h=[],i=[];for(a+="",b+="";(c=fi.exec(a))&&(d=gi.exec(b));)(e=d.index)>f&&(e=b.slice(f,e),h[g]?h[g]+=e:h[++g]=e),(c=c[0])===(d=d[0])?h[g]?h[g]+=d:h[++g]=d:(h[++g]=null,i.push({i:g,x:pd(c,d)})),f=gi.lastIndex;return f<b.length&&(e=b.slice(f),h[g]?h[g]+=e:h[++g]=e),h.length<2?i[0]?(b=i[0].x,function(a){return b(a)+""}):function(){return b}:(b=i.length,function(a){for(var c,d=0;b>d;++d)h[(c=i[d]).i]=c.x(a);return h.join("")})}function rd(a,b){for(var c,d=bg.interpolators.length;--d>=0&&!(c=bg.interpolators[d](a,b)););return c}function sd(a,b){var c,d=[],e=[],f=a.length,g=b.length,h=Math.min(a.length,b.length);for(c=0;h>c;++c)d.push(rd(a[c],b[c]));for(;f>c;++c)e[c]=a[c];for(;g>c;++c)e[c]=b[c];return function(a){for(c=0;h>c;++c)e[c]=d[c](a);return e}}function td(a){return function(b){return 0>=b?0:b>=1?1:a(b)}}function ud(a){return function(b){return 1-a(1-b)}}function vd(a){return function(b){return.5*(.5>b?a(2*b):2-a(2-2*b))}}function wd(a){return a*a}function xd(a){return a*a*a}function yd(a){if(0>=a)return 0;if(a>=1)return 1;var b=a*a,c=b*a;return 4*(.5>a?c:3*(a-b)+c-.75)}function zd(a){return function(b){return Math.pow(b,a)}}function Ad(a){return 1-Math.cos(a*Ig)}function Bd(a){return Math.pow(2,10*(a-1))}function Cd(a){return 1-Math.sqrt(1-a*a)}function Dd(a,b){var c;return arguments.length<2&&(b=.45),arguments.length?c=b/Gg*Math.asin(1/a):(a=1,c=b/4),function(d){return 1+a*Math.pow(2,-10*d)*Math.sin((d-c)*Gg/b)}}function Ed(a){return a||(a=1.70158),function(b){return b*b*((a+1)*b-a)}}function Fd(a){return 1/2.75>a?7.5625*a*a:2/2.75>a?7.5625*(a-=1.5/2.75)*a+.75:2.5/2.75>a?7.5625*(a-=2.25/2.75)*a+.9375:7.5625*(a-=2.625/2.75)*a+.984375}function Gd(a,b){a=bg.hcl(a),b=bg.hcl(b);var c=a.h,d=a.c,e=a.l,f=b.h-c,g=b.c-d,h=b.l-e;return isNaN(g)&&(g=0,d=isNaN(d)?b.c:d),isNaN(f)?(f=0,c=isNaN(c)?b.h:c):f>180?f-=360:-180>f&&(f+=360),function(a){return ka(c+f*a,d+g*a,e+h*a)+""}}function Hd(a,b){a=bg.hsl(a),b=bg.hsl(b);var c=a.h,d=a.s,e=a.l,f=b.h-c,g=b.s-d,h=b.l-e;return isNaN(g)&&(g=0,d=isNaN(d)?b.s:d),isNaN(f)?(f=0,c=isNaN(c)?b.h:c):f>180?f-=360:-180>f&&(f+=360),function(a){return ia(c+f*a,d+g*a,e+h*a)+""}}function Id(a,b){a=bg.lab(a),b=bg.lab(b);var c=a.l,d=a.a,e=a.b,f=b.l-c,g=b.a-d,h=b.b-e;return function(a){return ma(c+f*a,d+g*a,e+h*a)+""}}function Jd(a,b){return b-=a,function(c){return Math.round(a+b*c)}}function Kd(a){var b=[a.a,a.b],c=[a.c,a.d],d=Md(b),e=Ld(b,c),f=Md(Nd(c,b,-e))||0;b[0]*c[1]<c[0]*b[1]&&(b[0]*=-1,b[1]*=-1,d*=-1,e*=-1),this.rotate=(d?Math.atan2(b[1],b[0]):Math.atan2(-c[0],c[1]))*Kg,this.translate=[a.e,a.f],this.scale=[d,f],this.skew=f?Math.atan2(e,f)*Kg:0}function Ld(a,b){return a[0]*b[0]+a[1]*b[1]}function Md(a){var b=Math.sqrt(Ld(a,a));return b&&(a[0]/=b,a[1]/=b),b}function Nd(a,b,c){return a[0]+=c*b[0],a[1]+=c*b[1],a}function Od(a,b){var c,d=[],e=[],f=bg.transform(a),g=bg.transform(b),h=f.translate,i=g.translate,j=f.rotate,k=g.rotate,l=f.skew,m=g.skew,n=f.scale,o=g.scale;return h[0]!=i[0]||h[1]!=i[1]?(d.push("translate(",null,",",null,")"),e.push({i:1,x:pd(h[0],i[0])},{i:3,x:pd(h[1],i[1])})):i[0]||i[1]?d.push("translate("+i+")"):d.push(""),j!=k?(j-k>180?k+=360:k-j>180&&(j+=360),e.push({i:d.push(d.pop()+"rotate(",null,")")-2,x:pd(j,k)})):k&&d.push(d.pop()+"rotate("+k+")"),l!=m?e.push({i:d.push(d.pop()+"skewX(",null,")")-2,x:pd(l,m)}):m&&d.push(d.pop()+"skewX("+m+")"),n[0]!=o[0]||n[1]!=o[1]?(c=d.push(d.pop()+"scale(",null,",",null,")"),e.push({i:c-4,x:pd(n[0],o[0])},{i:c-2,x:pd(n[1],o[1])})):1==o[0]&&1==o[1]||d.push(d.pop()+"scale("+o+")"),c=e.length,function(a){for(var b,f=-1;++f<c;)d[(b=e[f]).i]=b.x(a);return d.join("")}}function Pd(a,b){return b=(b-=a=+a)||1/b,function(c){return(c-a)/b}}function Qd(a,b){return b=(b-=a=+a)||1/b,function(c){return Math.max(0,Math.min(1,(c-a)/b))}}function Rd(a){for(var b=a.source,c=a.target,d=Td(b,c),e=[b];b!==d;)b=b.parent,e.push(b);for(var f=e.length;c!==d;)e.splice(f,0,c),c=c.parent;return e}function Sd(a){for(var b=[],c=a.parent;null!=c;)b.push(a),a=c,c=c.parent;return b.push(a),b}function Td(a,b){if(a===b)return a;for(var c=Sd(a),d=Sd(b),e=c.pop(),f=d.pop(),g=null;e===f;)g=e,e=c.pop(),f=d.pop();return g}function Ud(a){a.fixed|=2}function Vd(a){a.fixed&=-7}function Wd(a){a.fixed|=4,a.px=a.x,a.py=a.y}function Xd(a){a.fixed&=-5}function Yd(a,b,c){var d=0,e=0;if(a.charge=0,!a.leaf)for(var f,g=a.nodes,h=g.length,i=-1;++i<h;)f=g[i],null!=f&&(Yd(f,b,c),a.charge+=f.charge,d+=f.charge*f.cx,e+=f.charge*f.cy);if(a.point){a.leaf||(a.point.x+=Math.random()-.5,a.point.y+=Math.random()-.5);var j=b*c[a.point.index];a.charge+=a.pointCharge=j,d+=j*a.point.x,e+=j*a.point.y}a.cx=d/a.charge,a.cy=e/a.charge}function Zd(a,b){return bg.rebind(a,b,"sort","children","value"),a.nodes=a,a.links=de,a}function $d(a,b){for(var c=[a];null!=(a=c.pop());)if(b(a),(e=a.children)&&(d=e.length))for(var d,e;--d>=0;)c.push(e[d])}function _d(a,b){for(var c=[a],d=[];null!=(a=c.pop());)if(d.push(a),(f=a.children)&&(e=f.length))for(var e,f,g=-1;++g<e;)c.push(f[g]);for(;null!=(a=d.pop());)b(a)}function ae(a){return a.children}function be(a){return a.value}function ce(a,b){return b.value-a.value}function de(a){return bg.merge(a.map(function(a){return(a.children||[]).map(function(b){return{source:a,target:b}})}))}function ee(a){return a.x}function fe(a){return a.y}function ge(a,b,c){a.y0=b,a.y=c}function he(a){return bg.range(a.length)}function ie(a){for(var b=-1,c=a[0].length,d=[];++b<c;)d[b]=0;return d}function je(a){for(var b,c=1,d=0,e=a[0][1],f=a.length;f>c;++c)(b=a[c][1])>e&&(d=c,e=b);return d}function ke(a){return a.reduce(le,0)}function le(a,b){return a+b[1]}function me(a,b){return ne(a,Math.ceil(Math.log(b.length)/Math.LN2+1))}function ne(a,b){for(var c=-1,d=+a[0],e=(a[1]-d)/b,f=[];++c<=b;)f[c]=e*c+d;return f}function oe(a){return[bg.min(a),bg.max(a)]}function pe(a,b){return a.value-b.value}function qe(a,b){var c=a._pack_next;a._pack_next=b,b._pack_prev=a,b._pack_next=c,c._pack_prev=b}function re(a,b){a._pack_next=b,b._pack_prev=a}function se(a,b){var c=b.x-a.x,d=b.y-a.y,e=a.r+b.r;return.999*e*e>c*c+d*d}function te(a){function b(a){k=Math.min(a.x-a.r,k),l=Math.max(a.x+a.r,l),m=Math.min(a.y-a.r,m),n=Math.max(a.y+a.r,n)}if((c=a.children)&&(j=c.length)){var c,d,e,f,g,h,i,j,k=1/0,l=-(1/0),m=1/0,n=-(1/0);if(c.forEach(ue),d=c[0],d.x=-d.r,d.y=0,b(d),j>1&&(e=c[1],e.x=e.r,e.y=0,b(e),j>2))for(f=c[2],xe(d,e,f),b(f),qe(d,f),d._pack_prev=f,qe(f,e),e=d._pack_next,g=3;j>g;g++){xe(d,e,f=c[g]);var o=0,p=1,q=1;for(h=e._pack_next;h!==e;h=h._pack_next,p++)if(se(h,f)){o=1;break}if(1==o)for(i=d._pack_prev;i!==h._pack_prev&&!se(i,f);i=i._pack_prev,q++);o?(q>p||p==q&&e.r<d.r?re(d,e=h):re(d=i,e),g--):(qe(d,f),e=f,b(f))}var r=(k+l)/2,s=(m+n)/2,t=0;for(g=0;j>g;g++)f=c[g],f.x-=r,f.y-=s,t=Math.max(t,f.r+Math.sqrt(f.x*f.x+f.y*f.y));a.r=t,c.forEach(ve)}}function ue(a){a._pack_next=a._pack_prev=a}function ve(a){delete a._pack_next,delete a._pack_prev}function we(a,b,c,d){var e=a.children;if(a.x=b+=d*a.x,a.y=c+=d*a.y,a.r*=d,e)for(var f=-1,g=e.length;++f<g;)we(e[f],b,c,d)}function xe(a,b,c){var d=a.r+c.r,e=b.x-a.x,f=b.y-a.y;if(d&&(e||f)){var g=b.r+c.r,h=e*e+f*f;g*=g,d*=d;var i=.5+(d-g)/(2*h),j=Math.sqrt(Math.max(0,2*g*(d+h)-(d-=h)*d-g*g))/(2*h);c.x=a.x+i*e+j*f,c.y=a.y+i*f-j*e}else c.x=a.x+d,c.y=a.y}function ye(a,b){return a.parent==b.parent?1:2}function ze(a){var b=a.children;return b.length?b[0]:a.t}function Ae(a){var b,c=a.children;return(b=c.length)?c[b-1]:a.t}function Be(a,b,c){var d=c/(b.i-a.i);b.c-=d,b.s+=c,a.c+=d,b.z+=c,b.m+=c}function Ce(a){for(var b,c=0,d=0,e=a.children,f=e.length;--f>=0;)b=e[f],b.z+=c,b.m+=c,c+=b.s+(d+=b.c)}function De(a,b,c){return a.a.parent===b.parent?a.a:c}function Ee(a){return 1+bg.max(a,function(a){return a.y})}function Fe(a){return a.reduce(function(a,b){return a+b.x},0)/a.length}function Ge(a){var b=a.children;return b&&b.length?Ge(b[0]):a}function He(a){var b,c=a.children;return c&&(b=c.length)?He(c[b-1]):a}function Ie(a){return{x:a.x,y:a.y,dx:a.dx,dy:a.dy}}function Je(a,b){var c=a.x+b[3],d=a.y+b[0],e=a.dx-b[1]-b[3],f=a.dy-b[0]-b[2];return 0>e&&(c+=e/2,e=0),0>f&&(d+=f/2,f=0),{x:c,y:d,dx:e,dy:f}}function Ke(a){var b=a[0],c=a[a.length-1];return c>b?[b,c]:[c,b]}function Le(a){return a.rangeExtent?a.rangeExtent():Ke(a.range())}function Me(a,b,c,d){var e=c(a[0],a[1]),f=d(b[0],b[1]);return function(a){return f(e(a))}}function Ne(a,b){var c,d=0,e=a.length-1,f=a[d],g=a[e];return f>g&&(c=d,d=e,e=c,c=f,f=g,g=c),a[d]=b.floor(f),a[e]=b.ceil(g),a}function Oe(a){return a?{floor:function(b){return Math.floor(b/a)*a},ceil:function(b){return Math.ceil(b/a)*a}}:ri}function Pe(a,b,c,d){var e=[],f=[],g=0,h=Math.min(a.length,b.length)-1;for(a[h]<a[0]&&(a=a.slice().reverse(),b=b.slice().reverse());++g<=h;)e.push(c(a[g-1],a[g])),f.push(d(b[g-1],b[g]));return function(b){var c=bg.bisect(a,b,1,h)-1;return f[c](e[c](b))}}function Qe(a,b,c,d){function e(){var e=Math.min(a.length,b.length)>2?Pe:Me,i=d?Qd:Pd;return g=e(a,b,i,c),h=e(b,a,i,rd),f}function f(a){return g(a)}var g,h;return f.invert=function(a){return h(a)},f.domain=function(b){return arguments.length?(a=b.map(Number),e()):a},f.range=function(a){return arguments.length?(b=a,e()):b},f.rangeRound=function(a){return f.range(a).interpolate(Jd)},f.clamp=function(a){return arguments.length?(d=a,e()):d},f.interpolate=function(a){return arguments.length?(c=a,e()):c},f.ticks=function(b){return Ue(a,b)},f.tickFormat=function(b,c){return Ve(a,b,c)},f.nice=function(b){return Se(a,b),e()},f.copy=function(){return Qe(a,b,c,d)},e()}function Re(a,b){return bg.rebind(a,b,"range","rangeRound","interpolate","clamp")}function Se(a,b){return Ne(a,Oe(Te(a,b)[2]))}function Te(a,b){null==b&&(b=10);var c=Ke(a),d=c[1]-c[0],e=Math.pow(10,Math.floor(Math.log(d/b)/Math.LN10)),f=b/d*e;return.15>=f?e*=10:.35>=f?e*=5:.75>=f&&(e*=2),c[0]=Math.ceil(c[0]/e)*e,c[1]=Math.floor(c[1]/e)*e+.5*e,c[2]=e,c}function Ue(a,b){return bg.range.apply(bg,Te(a,b))}function Ve(a,b,c){var d=Te(a,b);if(c){var e=fh.exec(c);if(e.shift(),"s"===e[8]){var f=bg.formatPrefix(Math.max(ng(d[0]),ng(d[1])));return e[7]||(e[7]="."+We(f.scale(d[2]))),e[8]="f",c=bg.format(e.join("")),function(a){return c(f.scale(a))+f.symbol}}e[7]||(e[7]="."+Xe(e[8],d)),c=e.join("")}else c=",."+We(d[2])+"f";return bg.format(c)}function We(a){return-Math.floor(Math.log(a)/Math.LN10+.01)}function Xe(a,b){var c=We(b[2]);return a in si?Math.abs(c-We(Math.max(ng(b[0]),ng(b[1]))))+ +("e"!==a):c-2*("%"===a)}function Ye(a,b,c,d){function e(a){return(c?Math.log(0>a?0:a):-Math.log(a>0?0:-a))/Math.log(b)}function f(a){return c?Math.pow(b,a):-Math.pow(b,-a)}function g(b){return a(e(b))}return g.invert=function(b){return f(a.invert(b))},g.domain=function(b){return arguments.length?(c=b[0]>=0,a.domain((d=b.map(Number)).map(e)),g):d},g.base=function(c){return arguments.length?(b=+c,a.domain(d.map(e)),g):b},g.nice=function(){var b=Ne(d.map(e),c?Math:ui);return a.domain(b),d=b.map(f),g},g.ticks=function(){var a=Ke(d),g=[],h=a[0],i=a[1],j=Math.floor(e(h)),k=Math.ceil(e(i)),l=b%1?2:b;if(isFinite(k-j)){if(c){for(;k>j;j++)for(var m=1;l>m;m++)g.push(f(j)*m);g.push(f(j))}else for(g.push(f(j));j++<k;)for(var m=l-1;m>0;m--)g.push(f(j)*m);for(j=0;g[j]<h;j++);for(k=g.length;g[k-1]>i;k--);g=g.slice(j,k)}return g},g.tickFormat=function(a,b){if(!arguments.length)return ti;arguments.length<2?b=ti:"function"!=typeof b&&(b=bg.format(b));var d,h=Math.max(.1,a/g.ticks().length),i=c?(d=1e-12,Math.ceil):(d=-1e-12,Math.floor);return function(a){return a/f(i(e(a)+d))<=h?b(a):""}},g.copy=function(){return Ye(a.copy(),b,c,d)},Re(g,a)}function Ze(a,b,c){function d(b){return a(e(b))}var e=$e(b),f=$e(1/b);return d.invert=function(b){return f(a.invert(b))},d.domain=function(b){return arguments.length?(a.domain((c=b.map(Number)).map(e)),d):c},d.ticks=function(a){return Ue(c,a)},d.tickFormat=function(a,b){return Ve(c,a,b)},d.nice=function(a){return d.domain(Se(c,a))},d.exponent=function(g){return arguments.length?(e=$e(b=g),f=$e(1/b),a.domain(c.map(e)),d):b},d.copy=function(){return Ze(a.copy(),b,c)},Re(d,a)}function $e(a){return function(b){return 0>b?-Math.pow(-b,a):Math.pow(b,a)}}function _e(a,b){function c(c){return f[((e.get(c)||("range"===b.t?e.set(c,a.push(c)):NaN))-1)%f.length]}function d(b,c){return bg.range(a.length).map(function(a){return b+c*a})}var e,f,g;return c.domain=function(d){if(!arguments.length)return a;a=[],e=new j;for(var f,g=-1,h=d.length;++g<h;)e.has(f=d[g])||e.set(f,a.push(f));return c[b.t].apply(c,b.a)},c.range=function(a){return arguments.length?(f=a,g=0,b={t:"range",a:arguments},c):f},c.rangePoints=function(e,h){arguments.length<2&&(h=0);var i=e[0],j=e[1],k=a.length<2?(i=(i+j)/2,0):(j-i)/(a.length-1+h);return f=d(i+k*h/2,k),g=0,b={t:"rangePoints",a:arguments},c},c.rangeRoundPoints=function(e,h){arguments.length<2&&(h=0);var i=e[0],j=e[1],k=a.length<2?(i=j=Math.round((i+j)/2),0):(j-i)/(a.length-1+h)|0;return f=d(i+Math.round(k*h/2+(j-i-(a.length-1+h)*k)/2),k),g=0,b={t:"rangeRoundPoints",a:arguments},c},c.rangeBands=function(e,h,i){arguments.length<2&&(h=0),arguments.length<3&&(i=h);var j=e[1]<e[0],k=e[j-0],l=e[1-j],m=(l-k)/(a.length-h+2*i);return f=d(k+m*i,m),j&&f.reverse(),g=m*(1-h),b={t:"rangeBands",a:arguments},c},c.rangeRoundBands=function(e,h,i){arguments.length<2&&(h=0),arguments.length<3&&(i=h);var j=e[1]<e[0],k=e[j-0],l=e[1-j],m=Math.floor((l-k)/(a.length-h+2*i));return f=d(k+Math.round((l-k-(a.length-h)*m)/2),m),j&&f.reverse(),g=Math.round(m*(1-h)),b={t:"rangeRoundBands",a:arguments},c},c.rangeBand=function(){return g},c.rangeExtent=function(){return Ke(b.a[0])},c.copy=function(){return _e(a,b)},c.domain(a)}function af(a,b){function f(){var c=0,d=b.length;for(h=[];++c<d;)h[c-1]=bg.quantile(a,c/d);return g}function g(a){return isNaN(a=+a)?void 0:b[bg.bisect(h,a)]}var h;return g.domain=function(b){return arguments.length?(a=b.map(d).filter(e).sort(c),f()):a},g.range=function(a){return arguments.length?(b=a,f()):b},g.quantiles=function(){return h},g.invertExtent=function(c){return c=b.indexOf(c),0>c?[NaN,NaN]:[c>0?h[c-1]:a[0],c<h.length?h[c]:a[a.length-1]]},g.copy=function(){return af(a,b)},f()}function bf(a,b,c){function d(b){return c[Math.max(0,Math.min(g,Math.floor(f*(b-a))))]}function e(){return f=c.length/(b-a),g=c.length-1,d}var f,g;return d.domain=function(c){return arguments.length?(a=+c[0],b=+c[c.length-1],e()):[a,b]},d.range=function(a){return arguments.length?(c=a,e()):c},d.invertExtent=function(b){return b=c.indexOf(b),b=0>b?NaN:b/f+a,[b,b+1/f]},d.copy=function(){return bf(a,b,c)},e()}function cf(a,b){function c(c){return c>=c?b[bg.bisect(a,c)]:void 0}return c.domain=function(b){return arguments.length?(a=b,c):a},c.range=function(a){return arguments.length?(b=a,c):b},c.invertExtent=function(c){return c=b.indexOf(c),[a[c-1],a[c]]},c.copy=function(){return cf(a,b)},c}function df(a){function b(a){return+a}return b.invert=b,b.domain=b.range=function(c){return arguments.length?(a=c.map(b),b):a},b.ticks=function(b){return Ue(a,b)},b.tickFormat=function(b,c){return Ve(a,b,c)},b.copy=function(){return df(a)},b}function ef(){return 0}function ff(a){return a.innerRadius}function gf(a){return a.outerRadius}function hf(a){return a.startAngle}function jf(a){return a.endAngle}function kf(a){return a&&a.padAngle}function lf(a,b,c,d){return(a-c)*b-(b-d)*a>0?0:1}function mf(a,b,c,d,e){var f=a[0]-b[0],g=a[1]-b[1],h=(e?d:-d)/Math.sqrt(f*f+g*g),i=h*g,j=-h*f,k=a[0]+i,l=a[1]+j,m=b[0]+i,n=b[1]+j,o=(k+m)/2,p=(l+n)/2,q=m-k,r=n-l,s=q*q+r*r,t=c-d,u=k*n-m*l,v=(0>r?-1:1)*Math.sqrt(t*t*s-u*u),w=(u*r-q*v)/s,x=(-u*q-r*v)/s,y=(u*r+q*v)/s,z=(-u*q+r*v)/s,A=w-o,B=x-p,C=y-o,D=z-p;return A*A+B*B>C*C+D*D&&(w=y,x=z),[[w-i,x-j],[w*c/t,x*c/t]]}function nf(a){function b(b){function g(){j.push("M",f(a(k),h))}for(var i,j=[],k=[],l=-1,m=b.length,n=Aa(c),o=Aa(d);++l<m;)e.call(this,i=b[l],l)?k.push([+n.call(this,i,l),+o.call(this,i,l)]):k.length&&(g(),k=[]);return k.length&&g(),j.length?j.join(""):null}var c=Bc,d=Cc,e=Cb,f=of,g=f.key,h=.7;return b.x=function(a){return arguments.length?(c=a,b):c},b.y=function(a){return arguments.length?(d=a,b):d},b.defined=function(a){return arguments.length?(e=a,b):e},b.interpolate=function(a){return arguments.length?(g="function"==typeof a?f=a:(f=Ai.get(a)||of).key,b):g},b.tension=function(a){return arguments.length?(h=a,b):h},b}function of(a){return a.join("L")}function pf(a){return of(a)+"Z"}function qf(a){for(var b=0,c=a.length,d=a[0],e=[d[0],",",d[1]];++b<c;)e.push("H",(d[0]+(d=a[b])[0])/2,"V",d[1]);return c>1&&e.push("H",d[0]),e.join("")}function rf(a){for(var b=0,c=a.length,d=a[0],e=[d[0],",",d[1]];++b<c;)e.push("V",(d=a[b])[1],"H",d[0]);return e.join("")}function sf(a){for(var b=0,c=a.length,d=a[0],e=[d[0],",",d[1]];++b<c;)e.push("H",(d=a[b])[0],"V",d[1]);return e.join("")}function tf(a,b){return a.length<4?of(a):a[1]+wf(a.slice(1,-1),xf(a,b))}function uf(a,b){return a.length<3?of(a):a[0]+wf((a.push(a[0]),a),xf([a[a.length-2]].concat(a,[a[1]]),b))}function vf(a,b){return a.length<3?of(a):a[0]+wf(a,xf(a,b))}function wf(a,b){if(b.length<1||a.length!=b.length&&a.length!=b.length+2)return of(a);var c=a.length!=b.length,d="",e=a[0],f=a[1],g=b[0],h=g,i=1;if(c&&(d+="Q"+(f[0]-2*g[0]/3)+","+(f[1]-2*g[1]/3)+","+f[0]+","+f[1],e=a[1],i=2),b.length>1){h=b[1],f=a[i],i++,d+="C"+(e[0]+g[0])+","+(e[1]+g[1])+","+(f[0]-h[0])+","+(f[1]-h[1])+","+f[0]+","+f[1];for(var j=2;j<b.length;j++,i++)f=a[i],h=b[j],d+="S"+(f[0]-h[0])+","+(f[1]-h[1])+","+f[0]+","+f[1]}if(c){var k=a[i];d+="Q"+(f[0]+2*h[0]/3)+","+(f[1]+2*h[1]/3)+","+k[0]+","+k[1]}return d}function xf(a,b){for(var c,d=[],e=(1-b)/2,f=a[0],g=a[1],h=1,i=a.length;++h<i;)c=f,f=g,g=a[h],d.push([e*(g[0]-c[0]),e*(g[1]-c[1])]);return d}function yf(a){if(a.length<3)return of(a);var b=1,c=a.length,d=a[0],e=d[0],f=d[1],g=[e,e,e,(d=a[1])[0]],h=[f,f,f,d[1]],i=[e,",",f,"L",Cf(Di,g),",",Cf(Di,h)];for(a.push(a[c-1]);++b<=c;)d=a[b],g.shift(),g.push(d[0]),h.shift(),h.push(d[1]),Df(i,g,h);return a.pop(),i.push("L",d),i.join("")}function zf(a){if(a.length<4)return of(a);for(var b,c=[],d=-1,e=a.length,f=[0],g=[0];++d<3;)b=a[d],f.push(b[0]),g.push(b[1]);for(c.push(Cf(Di,f)+","+Cf(Di,g)),--d;++d<e;)b=a[d],f.shift(),f.push(b[0]),g.shift(),g.push(b[1]),Df(c,f,g);return c.join("")}function Af(a){for(var b,c,d=-1,e=a.length,f=e+4,g=[],h=[];++d<4;)c=a[d%e],g.push(c[0]),h.push(c[1]);for(b=[Cf(Di,g),",",Cf(Di,h)],--d;++d<f;)c=a[d%e],g.shift(),g.push(c[0]),h.shift(),h.push(c[1]),Df(b,g,h);return b.join("")}function Bf(a,b){var c=a.length-1;if(c)for(var d,e,f=a[0][0],g=a[0][1],h=a[c][0]-f,i=a[c][1]-g,j=-1;++j<=c;)d=a[j],e=j/c,d[0]=b*d[0]+(1-b)*(f+e*h),d[1]=b*d[1]+(1-b)*(g+e*i);return yf(a)}function Cf(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]}function Df(a,b,c){a.push("C",Cf(Bi,b),",",Cf(Bi,c),",",Cf(Ci,b),",",Cf(Ci,c),",",Cf(Di,b),",",Cf(Di,c))}function Ef(a,b){return(b[1]-a[1])/(b[0]-a[0])}function Ff(a){for(var b=0,c=a.length-1,d=[],e=a[0],f=a[1],g=d[0]=Ef(e,f);++b<c;)d[b]=(g+(g=Ef(e=f,f=a[b+1])))/2;return d[b]=g,d}function Gf(a){for(var b,c,d,e,f=[],g=Ff(a),h=-1,i=a.length-1;++h<i;)b=Ef(a[h],a[h+1]),ng(b)<Dg?g[h]=g[h+1]=0:(c=g[h]/b,d=g[h+1]/b,e=c*c+d*d,e>9&&(e=3*b/Math.sqrt(e),g[h]=e*c,g[h+1]=e*d));for(h=-1;++h<=i;)e=(a[Math.min(i,h+1)][0]-a[Math.max(0,h-1)][0])/(6*(1+g[h]*g[h])),f.push([e||0,g[h]*e||0]);return f}function Hf(a){return a.length<3?of(a):a[0]+wf(a,Gf(a))}function If(a){for(var b,c,d,e=-1,f=a.length;++e<f;)b=a[e],c=b[0],d=b[1]-Ig,b[0]=c*Math.cos(d),b[1]=c*Math.sin(d);return a}function Jf(a){function b(b){function i(){p.push("M",h(a(r),l),k,j(a(q.reverse()),l),"Z")}for(var m,n,o,p=[],q=[],r=[],s=-1,t=b.length,u=Aa(c),v=Aa(e),w=c===d?function(){return n}:Aa(d),x=e===f?function(){return o}:Aa(f);++s<t;)g.call(this,m=b[s],s)?(q.push([n=+u.call(this,m,s),o=+v.call(this,m,s)]),r.push([+w.call(this,m,s),+x.call(this,m,s)])):q.length&&(i(),q=[],r=[]);return q.length&&i(),p.length?p.join(""):null}var c=Bc,d=Bc,e=0,f=Cc,g=Cb,h=of,i=h.key,j=h,k="L",l=.7;return b.x=function(a){return arguments.length?(c=d=a,b):d},b.x0=function(a){return arguments.length?(c=a,b):c},b.x1=function(a){return arguments.length?(d=a,b):d},b.y=function(a){return arguments.length?(e=f=a,b):f},b.y0=function(a){return arguments.length?(e=a,b):e},b.y1=function(a){return arguments.length?(f=a,b):f},b.defined=function(a){return arguments.length?(g=a,b):g},b.interpolate=function(a){return arguments.length?(i="function"==typeof a?h=a:(h=Ai.get(a)||of).key,j=h.reverse||h,k=h.closed?"M":"L",b):i},b.tension=function(a){return arguments.length?(l=a,b):l},b}function Kf(a){return a.radius}function Lf(a){return[a.x,a.y]}function Mf(a){return function(){var b=a.apply(this,arguments),c=b[0],d=b[1]-Ig;return[c*Math.cos(d),c*Math.sin(d)]}}function Nf(){return 64}function Of(){return"circle"}function Pf(a){var b=Math.sqrt(a/Fg);return"M0,"+b+"A"+b+","+b+" 0 1,1 0,"+-b+"A"+b+","+b+" 0 1,1 0,"+b+"Z"}function Qf(a){return function(){var b,c;(b=this[a])&&(c=b[b.active])&&(--b.count?delete b[b.active]:delete this[a],b.active+=.5,c.event&&c.event.interrupt.call(this,this.__data__,c.index))}}function Rf(a,b,c){return sg(a,Ki),a.namespace=b,a.id=c,a}function Sf(a,b,c,d){var e=a.id,f=a.namespace;return R(a,"function"==typeof c?function(a,g,h){a[f][e].tween.set(b,d(c.call(a,a.__data__,g,h)))}:(c=d(c),function(a){a[f][e].tween.set(b,c)}))}function Tf(a){return null==a&&(a=""),function(){this.textContent=a}}function Uf(a){return null==a?"__transition__":"__transition_"+a+"__"}function Vf(a,b,c,d,e){var f=a[c]||(a[c]={active:0,count:0}),g=f[d];if(!g){var h=e.time;g=f[d]={tween:new j,time:h,delay:e.delay,duration:e.duration,ease:e.ease,index:b},e=null,++f.count,bg.timer(function(e){function i(c){if(f.active>d)return k();var e=f[f.active];e&&(--f.count,delete f[f.active],e.event&&e.event.interrupt.call(a,a.__data__,e.index)),f.active=d,g.event&&g.event.start.call(a,a.__data__,b),g.tween.forEach(function(c,d){(d=d.call(a,a.__data__,b))&&p.push(d)}),m=g.ease,l=g.duration,bg.timer(function(){return o.c=j(c||1)?Cb:j,1},0,h)}function j(c){if(f.active!==d)return 1;for(var e=c/l,h=m(e),i=p.length;i>0;)p[--i].call(a,h);return e>=1?(g.event&&g.event.end.call(a,a.__data__,b),k()):void 0}function k(){return--f.count?delete f[d]:delete a[c],1}var l,m,n=g.delay,o=ch,p=[];return o.t=n+h,e>=n?i(e-n):void(o.c=i)},0,h)}}function Wf(a,b,c){a.attr("transform",function(a){var d=b(a);return"translate("+(isFinite(d)?d:c(a))+",0)"})}function Xf(a,b,c){a.attr("transform",function(a){var d=b(a);return"translate(0,"+(isFinite(d)?d:c(a))+")"})}function Yf(a){return a.toISOString()}function Zf(a,b,c){function d(b){return a(b)}function e(a,c){var d=a[1]-a[0],e=d/c,f=bg.bisect(Ti,e);return f==Ti.length?[b.year,Te(a.map(function(a){return a/31536e6}),c)[2]]:f?b[e/Ti[f-1]<Ti[f]/e?f-1:f]:[Wi,Te(a,c)[2]]}return d.invert=function(b){return $f(a.invert(b))},d.domain=function(b){return arguments.length?(a.domain(b),d):a.domain().map($f)},d.nice=function(a,b){function c(c){return!isNaN(c)&&!a.range(c,$f(+c+1),b).length}var f=d.domain(),g=Ke(f),h=null==a?e(g,10):"number"==typeof a&&e(g,a);return h&&(a=h[0],b=h[1]),d.domain(Ne(f,b>1?{floor:function(b){for(;c(b=a.floor(b));)b=$f(b-1);return b},ceil:function(b){for(;c(b=a.ceil(b));)b=$f(+b+1);return b}}:a))},d.ticks=function(a,b){var c=Ke(d.domain()),f=null==a?e(c,10):"number"==typeof a?e(c,a):!a.range&&[{range:a},b];return f&&(a=f[0],b=f[1]),a.range(c[0],$f(+c[1]+1),1>b?1:b)},d.tickFormat=function(){return c},d.copy=function(){return Zf(a.copy(),b,c)},Re(d,a)}function $f(a){return new Date(a)}function _f(a){return JSON.parse(a.responseText)}function ag(a){var b=eg.createRange();return b.selectNode(eg.body),b.createContextualFragment(a.responseText)}var bg={version:"3.5.6"},cg=[].slice,dg=function(a){return cg.call(a)},eg=this.document;if(eg)try{dg(eg.documentElement.childNodes)[0].nodeType}catch(fg){dg=function(a){for(var b=a.length,c=new Array(b);b--;)c[b]=a[b];return c}}if(Date.now||(Date.now=function(){return+new Date}),eg)try{eg.createElement("DIV").style.setProperty("opacity",0,"")}catch(gg){var hg=this.Element.prototype,ig=hg.setAttribute,jg=hg.setAttributeNS,kg=this.CSSStyleDeclaration.prototype,lg=kg.setProperty;hg.setAttribute=function(a,b){ig.call(this,a,b+"")},hg.setAttributeNS=function(a,b,c){jg.call(this,a,b,c+"")},kg.setProperty=function(a,b,c){lg.call(this,a,b+"",c)}}bg.ascending=c,bg.descending=function(a,b){return a>b?-1:b>a?1:b>=a?0:NaN},bg.min=function(a,b){var c,d,e=-1,f=a.length;if(1===arguments.length){for(;++e<f;)if(null!=(d=a[e])&&d>=d){c=d;break}for(;++e<f;)null!=(d=a[e])&&c>d&&(c=d)}else{for(;++e<f;)if(null!=(d=b.call(a,a[e],e))&&d>=d){c=d;break}for(;++e<f;)null!=(d=b.call(a,a[e],e))&&c>d&&(c=d)}return c},bg.max=function(a,b){var c,d,e=-1,f=a.length;if(1===arguments.length){for(;++e<f;)if(null!=(d=a[e])&&d>=d){c=d;break}for(;++e<f;)null!=(d=a[e])&&d>c&&(c=d)}else{for(;++e<f;)if(null!=(d=b.call(a,a[e],e))&&d>=d){c=d;break}for(;++e<f;)null!=(d=b.call(a,a[e],e))&&d>c&&(c=d)}return c},bg.extent=function(a,b){var c,d,e,f=-1,g=a.length;if(1===arguments.length){for(;++f<g;)if(null!=(d=a[f])&&d>=d){c=e=d;break}for(;++f<g;)null!=(d=a[f])&&(c>d&&(c=d),d>e&&(e=d))}else{for(;++f<g;)if(null!=(d=b.call(a,a[f],f))&&d>=d){c=e=d;break}for(;++f<g;)null!=(d=b.call(a,a[f],f))&&(c>d&&(c=d),d>e&&(e=d))}return[c,e]},bg.sum=function(a,b){var c,d=0,f=a.length,g=-1;if(1===arguments.length)for(;++g<f;)e(c=+a[g])&&(d+=c);else for(;++g<f;)e(c=+b.call(a,a[g],g))&&(d+=c);return d},bg.mean=function(a,b){var c,f=0,g=a.length,h=-1,i=g;if(1===arguments.length)for(;++h<g;)e(c=d(a[h]))?f+=c:--i;else for(;++h<g;)e(c=d(b.call(a,a[h],h)))?f+=c:--i;return i?f/i:void 0},bg.quantile=function(a,b){var c=(a.length-1)*b+1,d=Math.floor(c),e=+a[d-1],f=c-d;return f?e+f*(a[d]-e):e},bg.median=function(a,b){var f,g=[],h=a.length,i=-1;if(1===arguments.length)for(;++i<h;)e(f=d(a[i]))&&g.push(f);else for(;++i<h;)e(f=d(b.call(a,a[i],i)))&&g.push(f);return g.length?bg.quantile(g.sort(c),.5):void 0},bg.variance=function(a,b){var c,f,g=a.length,h=0,i=0,j=-1,k=0;if(1===arguments.length)for(;++j<g;)e(c=d(a[j]))&&(f=c-h,
h+=f/++k,i+=f*(c-h));else for(;++j<g;)e(c=d(b.call(a,a[j],j)))&&(f=c-h,h+=f/++k,i+=f*(c-h));return k>1?i/(k-1):void 0},bg.deviation=function(){var a=bg.variance.apply(this,arguments);return a?Math.sqrt(a):a};var mg=f(c);bg.bisectLeft=mg.left,bg.bisect=bg.bisectRight=mg.right,bg.bisector=function(a){return f(1===a.length?function(b,d){return c(a(b),d)}:a)},bg.shuffle=function(a,b,c){(f=arguments.length)<3&&(c=a.length,2>f&&(b=0));for(var d,e,f=c-b;f;)e=Math.random()*f--|0,d=a[f+b],a[f+b]=a[e+b],a[e+b]=d;return a},bg.permute=function(a,b){for(var c=b.length,d=new Array(c);c--;)d[c]=a[b[c]];return d},bg.pairs=function(a){for(var b,c=0,d=a.length-1,e=a[0],f=new Array(0>d?0:d);d>c;)f[c]=[b=e,e=a[++c]];return f},bg.zip=function(){if(!(d=arguments.length))return[];for(var a=-1,b=bg.min(arguments,g),c=new Array(b);++a<b;)for(var d,e=-1,f=c[a]=new Array(d);++e<d;)f[e]=arguments[e][a];return c},bg.transpose=function(a){return bg.zip.apply(bg,a)},bg.keys=function(a){var b=[];for(var c in a)b.push(c);return b},bg.values=function(a){var b=[];for(var c in a)b.push(a[c]);return b},bg.entries=function(a){var b=[];for(var c in a)b.push({key:c,value:a[c]});return b},bg.merge=function(a){for(var b,c,d,e=a.length,f=-1,g=0;++f<e;)g+=a[f].length;for(c=new Array(g);--e>=0;)for(d=a[e],b=d.length;--b>=0;)c[--g]=d[b];return c};var ng=Math.abs;bg.range=function(a,b,c){if(arguments.length<3&&(c=1,arguments.length<2&&(b=a,a=0)),(b-a)/c===1/0)throw new Error("infinite range");var d,e=[],f=h(ng(c)),g=-1;if(a*=f,b*=f,c*=f,0>c)for(;(d=a+c*++g)>b;)e.push(d/f);else for(;(d=a+c*++g)<b;)e.push(d/f);return e},bg.map=function(a,b){var c=new j;if(a instanceof j)a.forEach(function(a,b){c.set(a,b)});else if(Array.isArray(a)){var d,e=-1,f=a.length;if(1===arguments.length)for(;++e<f;)c.set(e,a[e]);else for(;++e<f;)c.set(b.call(a,d=a[e],e),d)}else for(var g in a)c.set(g,a[g]);return c};var og="__proto__",pg="\x00";i(j,{has:m,get:function(a){return this._[k(a)]},set:function(a,b){return this._[k(a)]=b},remove:n,keys:o,values:function(){var a=[];for(var b in this._)a.push(this._[b]);return a},entries:function(){var a=[];for(var b in this._)a.push({key:l(b),value:this._[b]});return a},size:p,empty:q,forEach:function(a){for(var b in this._)a.call(this,l(b),this._[b])}}),bg.nest=function(){function a(b,g,h){if(h>=f.length)return d?d.call(e,g):c?g.sort(c):g;for(var i,k,l,m,n=-1,o=g.length,p=f[h++],q=new j;++n<o;)(m=q.get(i=p(k=g[n])))?m.push(k):q.set(i,[k]);return b?(k=b(),l=function(c,d){k.set(c,a(b,d,h))}):(k={},l=function(c,d){k[c]=a(b,d,h)}),q.forEach(l),k}function b(a,c){if(c>=f.length)return a;var d=[],e=g[c++];return a.forEach(function(a,e){d.push({key:a,values:b(e,c)})}),e?d.sort(function(a,b){return e(a.key,b.key)}):d}var c,d,e={},f=[],g=[];return e.map=function(b,c){return a(c,b,0)},e.entries=function(c){return b(a(bg.map,c,0),0)},e.key=function(a){return f.push(a),e},e.sortKeys=function(a){return g[f.length-1]=a,e},e.sortValues=function(a){return c=a,e},e.rollup=function(a){return d=a,e},e},bg.set=function(a){var b=new r;if(a)for(var c=0,d=a.length;d>c;++c)b.add(a[c]);return b},i(r,{has:m,add:function(a){return this._[k(a+="")]=!0,a},remove:n,values:o,size:p,empty:q,forEach:function(a){for(var b in this._)a.call(this,l(b))}}),bg.behavior={},bg.rebind=function(a,b){for(var c,d=1,e=arguments.length;++d<e;)a[c=arguments[d]]=t(a,b,b[c]);return a};var qg=["webkit","ms","moz","Moz","o","O"];bg.dispatch=function(){for(var a=new w,b=-1,c=arguments.length;++b<c;)a[arguments[b]]=x(a);return a},w.prototype.on=function(a,b){var c=a.indexOf("."),d="";if(c>=0&&(d=a.slice(c+1),a=a.slice(0,c)),a)return arguments.length<2?this[a].on(d):this[a].on(d,b);if(2===arguments.length){if(null==b)for(a in this)this.hasOwnProperty(a)&&this[a].on(d,null);return this}},bg.event=null,bg.requote=function(a){return a.replace(rg,"\\$&")};var rg=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,sg={}.__proto__?function(a,b){a.__proto__=b}:function(a,b){for(var c in b)a[c]=b[c]},tg=function(a,b){return b.querySelector(a)},ug=function(a,b){return b.querySelectorAll(a)},vg=function(a,b){var c=a.matches||a[u(a,"matchesSelector")];return(vg=function(a,b){return c.call(a,b)})(a,b)};"function"==typeof Sizzle&&(tg=function(a,b){return Sizzle(a,b)[0]||null},ug=Sizzle,vg=Sizzle.matchesSelector),bg.selection=function(){return bg.select(eg.documentElement)};var wg=bg.selection.prototype=[];wg.select=function(a){var b,c,d,e,f=[];a=C(a);for(var g=-1,h=this.length;++g<h;){f.push(b=[]),b.parentNode=(d=this[g]).parentNode;for(var i=-1,j=d.length;++i<j;)(e=d[i])?(b.push(c=a.call(e,e.__data__,i,g)),c&&"__data__"in e&&(c.__data__=e.__data__)):b.push(null)}return B(f)},wg.selectAll=function(a){var b,c,d=[];a=D(a);for(var e=-1,f=this.length;++e<f;)for(var g=this[e],h=-1,i=g.length;++h<i;)(c=g[h])&&(d.push(b=dg(a.call(c,c.__data__,h,e))),b.parentNode=c);return B(d)};var xg={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};bg.ns={prefix:xg,qualify:function(a){var b=a.indexOf(":"),c=a;return b>=0&&(c=a.slice(0,b),a=a.slice(b+1)),xg.hasOwnProperty(c)?{space:xg[c],local:a}:a}},wg.attr=function(a,b){if(arguments.length<2){if("string"==typeof a){var c=this.node();return a=bg.ns.qualify(a),a.local?c.getAttributeNS(a.space,a.local):c.getAttribute(a)}for(b in a)this.each(E(b,a[b]));return this}return this.each(E(a,b))},wg.classed=function(a,b){if(arguments.length<2){if("string"==typeof a){var c=this.node(),d=(a=H(a)).length,e=-1;if(b=c.classList){for(;++e<d;)if(!b.contains(a[e]))return!1}else for(b=c.getAttribute("class");++e<d;)if(!G(a[e]).test(b))return!1;return!0}for(b in a)this.each(I(b,a[b]));return this}return this.each(I(a,b))},wg.style=function(a,c,d){var e=arguments.length;if(3>e){if("string"!=typeof a){2>e&&(c="");for(d in a)this.each(K(d,a[d],c));return this}if(2>e){var f=this.node();return b(f).getComputedStyle(f,null).getPropertyValue(a)}d=""}return this.each(K(a,c,d))},wg.property=function(a,b){if(arguments.length<2){if("string"==typeof a)return this.node()[a];for(b in a)this.each(L(b,a[b]));return this}return this.each(L(a,b))},wg.text=function(a){return arguments.length?this.each("function"==typeof a?function(){var b=a.apply(this,arguments);this.textContent=null==b?"":b}:null==a?function(){this.textContent=""}:function(){this.textContent=a}):this.node().textContent},wg.html=function(a){return arguments.length?this.each("function"==typeof a?function(){var b=a.apply(this,arguments);this.innerHTML=null==b?"":b}:null==a?function(){this.innerHTML=""}:function(){this.innerHTML=a}):this.node().innerHTML},wg.append=function(a){return a=M(a),this.select(function(){return this.appendChild(a.apply(this,arguments))})},wg.insert=function(a,b){return a=M(a),b=C(b),this.select(function(){return this.insertBefore(a.apply(this,arguments),b.apply(this,arguments)||null)})},wg.remove=function(){return this.each(N)},wg.data=function(a,b){function c(a,c){var d,e,f,g=a.length,l=c.length,m=Math.min(g,l),n=new Array(l),o=new Array(l),p=new Array(g);if(b){var q,r=new j,s=new Array(g);for(d=-1;++d<g;)r.has(q=b.call(e=a[d],e.__data__,d))?p[d]=e:r.set(q,e),s[d]=q;for(d=-1;++d<l;)(e=r.get(q=b.call(c,f=c[d],d)))?e!==!0&&(n[d]=e,e.__data__=f):o[d]=O(f),r.set(q,!0);for(d=-1;++d<g;)r.get(s[d])!==!0&&(p[d]=a[d])}else{for(d=-1;++d<m;)e=a[d],f=c[d],e?(e.__data__=f,n[d]=e):o[d]=O(f);for(;l>d;++d)o[d]=O(c[d]);for(;g>d;++d)p[d]=a[d]}o.update=n,o.parentNode=n.parentNode=p.parentNode=a.parentNode,h.push(o),i.push(n),k.push(p)}var d,e,f=-1,g=this.length;if(!arguments.length){for(a=new Array(g=(d=this[0]).length);++f<g;)(e=d[f])&&(a[f]=e.__data__);return a}var h=S([]),i=B([]),k=B([]);if("function"==typeof a)for(;++f<g;)c(d=this[f],a.call(d,d.parentNode.__data__,f));else for(;++f<g;)c(d=this[f],a);return i.enter=function(){return h},i.exit=function(){return k},i},wg.datum=function(a){return arguments.length?this.property("__data__",a):this.property("__data__")},wg.filter=function(a){var b,c,d,e=[];"function"!=typeof a&&(a=P(a));for(var f=0,g=this.length;g>f;f++){e.push(b=[]),b.parentNode=(c=this[f]).parentNode;for(var h=0,i=c.length;i>h;h++)(d=c[h])&&a.call(d,d.__data__,h,f)&&b.push(d)}return B(e)},wg.order=function(){for(var a=-1,b=this.length;++a<b;)for(var c,d=this[a],e=d.length-1,f=d[e];--e>=0;)(c=d[e])&&(f&&f!==c.nextSibling&&f.parentNode.insertBefore(c,f),f=c);return this},wg.sort=function(a){a=Q.apply(this,arguments);for(var b=-1,c=this.length;++b<c;)this[b].sort(a);return this.order()},wg.each=function(a){return R(this,function(b,c,d){a.call(b,b.__data__,c,d)})},wg.call=function(a){var b=dg(arguments);return a.apply(b[0]=this,b),this},wg.empty=function(){return!this.node()},wg.node=function(){for(var a=0,b=this.length;b>a;a++)for(var c=this[a],d=0,e=c.length;e>d;d++){var f=c[d];if(f)return f}return null},wg.size=function(){var a=0;return R(this,function(){++a}),a};var yg=[];bg.selection.enter=S,bg.selection.enter.prototype=yg,yg.append=wg.append,yg.empty=wg.empty,yg.node=wg.node,yg.call=wg.call,yg.size=wg.size,yg.select=function(a){for(var b,c,d,e,f,g=[],h=-1,i=this.length;++h<i;){d=(e=this[h]).update,g.push(b=[]),b.parentNode=e.parentNode;for(var j=-1,k=e.length;++j<k;)(f=e[j])?(b.push(d[j]=c=a.call(e.parentNode,f.__data__,j,h)),c.__data__=f.__data__):b.push(null)}return B(g)},yg.insert=function(a,b){return arguments.length<2&&(b=T(this)),wg.insert.call(this,a,b)},bg.select=function(b){var c;return"string"==typeof b?(c=[tg(b,eg)],c.parentNode=eg.documentElement):(c=[b],c.parentNode=a(b)),B([c])},bg.selectAll=function(a){var b;return"string"==typeof a?(b=dg(ug(a,eg)),b.parentNode=eg.documentElement):(b=a,b.parentNode=null),B([b])},wg.on=function(a,b,c){var d=arguments.length;if(3>d){if("string"!=typeof a){2>d&&(b=!1);for(c in a)this.each(U(c,a[c],b));return this}if(2>d)return(d=this.node()["__on"+a])&&d._;c=!1}return this.each(U(a,b,c))};var zg=bg.map({mouseenter:"mouseover",mouseleave:"mouseout"});eg&&zg.forEach(function(a){"on"+a in eg&&zg.remove(a)});var Ag,Bg=0;bg.mouse=function(a){return Y(a,z())};var Cg=this.navigator&&/WebKit/.test(this.navigator.userAgent)?-1:0;bg.touch=function(a,b,c){if(arguments.length<3&&(c=b,b=z().changedTouches),b)for(var d,e=0,f=b.length;f>e;++e)if((d=b[e]).identifier===c)return Y(a,d)},bg.behavior.drag=function(){function a(){this.on("mousedown.drag",f).on("touchstart.drag",g)}function c(a,b,c,f,g){return function(){function h(){var a,c,d=b(m,p);d&&(a=d[0]-t[0],c=d[1]-t[1],o|=a|c,t=d,n({type:"drag",x:d[0]+j[0],y:d[1]+j[1],dx:a,dy:c}))}function i(){b(m,p)&&(r.on(f+q,null).on(g+q,null),s(o&&bg.event.target===l),n({type:"dragend"}))}var j,k=this,l=bg.event.target,m=k.parentNode,n=d.of(k,arguments),o=0,p=a(),q=".drag"+(null==p?"":"-"+p),r=bg.select(c(l)).on(f+q,h).on(g+q,i),s=X(l),t=b(m,p);e?(j=e.apply(k,arguments),j=[j.x-t[0],j.y-t[1]]):j=[0,0],n({type:"dragstart"})}}var d=A(a,"drag","dragstart","dragend"),e=null,f=c(v,bg.mouse,b,"mousemove","mouseup"),g=c(Z,bg.touch,s,"touchmove","touchend");return a.origin=function(b){return arguments.length?(e=b,a):e},bg.rebind(a,d,"on")},bg.touches=function(a,b){return arguments.length<2&&(b=z().touches),b?dg(b).map(function(b){var c=Y(a,b);return c.identifier=b.identifier,c}):[]};var Dg=1e-6,Eg=Dg*Dg,Fg=Math.PI,Gg=2*Fg,Hg=Gg-Dg,Ig=Fg/2,Jg=Fg/180,Kg=180/Fg,Lg=Math.SQRT2,Mg=2,Ng=4;bg.interpolateZoom=function(a,b){function c(a){var b=a*s;if(r){var c=da(p),g=f/(Mg*m)*(c*ea(Lg*b+p)-ca(p));return[d+g*j,e+g*k,f*c/da(Lg*b+p)]}return[d+a*j,e+a*k,f*Math.exp(Lg*b)]}var d=a[0],e=a[1],f=a[2],g=b[0],h=b[1],i=b[2],j=g-d,k=h-e,l=j*j+k*k,m=Math.sqrt(l),n=(i*i-f*f+Ng*l)/(2*f*Mg*m),o=(i*i-f*f-Ng*l)/(2*i*Mg*m),p=Math.log(Math.sqrt(n*n+1)-n),q=Math.log(Math.sqrt(o*o+1)-o),r=q-p,s=(r||Math.log(i/f))/Lg;return c.duration=1e3*s,c},bg.behavior.zoom=function(){function a(a){a.on(F,l).on(Pg+".zoom",n).on("dblclick.zoom",o).on(I,m)}function c(a){return[(a[0]-z.x)/z.k,(a[1]-z.y)/z.k]}function d(a){return[a[0]*z.k+z.x,a[1]*z.k+z.y]}function e(a){z.k=Math.max(C[0],Math.min(C[1],a))}function f(a,b){b=d(b),z.x+=a[0]-b[0],z.y+=a[1]-b[1]}function g(b,c,d,g){b.__chart__={x:z.x,y:z.y,k:z.k},e(Math.pow(2,g)),f(q=c,d),b=bg.select(b),D>0&&(b=b.transition().duration(D)),b.call(a.event)}function h(){v&&v.domain(u.range().map(function(a){return(a-z.x)/z.k}).map(u.invert)),x&&x.domain(w.range().map(function(a){return(a-z.y)/z.k}).map(w.invert))}function i(a){E++||a({type:"zoomstart"})}function j(a){h(),a({type:"zoom",scale:z.k,translate:[z.x,z.y]})}function k(a){--E||(a({type:"zoomend"}),q=null)}function l(){function a(){l=1,f(bg.mouse(e),n),j(h)}function d(){m.on(G,null).on(H,null),o(l&&bg.event.target===g),k(h)}var e=this,g=bg.event.target,h=J.of(e,arguments),l=0,m=bg.select(b(e)).on(G,a).on(H,d),n=c(bg.mouse(e)),o=X(e);Ji.call(e),i(h)}function m(){function a(){var a=bg.touches(o);return n=z.k,a.forEach(function(a){a.identifier in q&&(q[a.identifier]=c(a))}),a}function b(){var b=bg.event.target;bg.select(b).on(u,d).on(v,h),w.push(b);for(var c=bg.event.changedTouches,e=0,f=c.length;f>e;++e)q[c[e].identifier]=null;var i=a(),j=Date.now();if(1===i.length){if(500>j-t){var k=i[0];g(o,k,q[k.identifier],Math.floor(Math.log(z.k)/Math.LN2)+1),y()}t=j}else if(i.length>1){var k=i[0],l=i[1],m=k[0]-l[0],n=k[1]-l[1];r=m*m+n*n}}function d(){var a,b,c,d,g=bg.touches(o);Ji.call(o);for(var h=0,i=g.length;i>h;++h,d=null)if(c=g[h],d=q[c.identifier]){if(b)break;a=c,b=d}if(d){var k=(k=c[0]-a[0])*k+(k=c[1]-a[1])*k,l=r&&Math.sqrt(k/r);a=[(a[0]+c[0])/2,(a[1]+c[1])/2],b=[(b[0]+d[0])/2,(b[1]+d[1])/2],e(l*n)}t=null,f(a,b),j(p)}function h(){if(bg.event.touches.length){for(var b=bg.event.changedTouches,c=0,d=b.length;d>c;++c)delete q[b[c].identifier];for(var e in q)return void a()}bg.selectAll(w).on(s,null),x.on(F,l).on(I,m),A(),k(p)}var n,o=this,p=J.of(o,arguments),q={},r=0,s=".zoom-"+bg.event.changedTouches[0].identifier,u="touchmove"+s,v="touchend"+s,w=[],x=bg.select(o),A=X(o);b(),i(p),x.on(F,null).on(I,b)}function n(){var a=J.of(this,arguments);s?clearTimeout(s):(Ji.call(this),p=c(q=r||bg.mouse(this)),i(a)),s=setTimeout(function(){s=null,k(a)},50),y(),e(Math.pow(2,.002*Og())*z.k),f(q,p),j(a)}function o(){var a=bg.mouse(this),b=Math.log(z.k)/Math.LN2;g(this,a,c(a),bg.event.shiftKey?Math.ceil(b)-1:Math.floor(b)+1)}var p,q,r,s,t,u,v,w,x,z={x:0,y:0,k:1},B=[960,500],C=Qg,D=250,E=0,F="mousedown.zoom",G="mousemove.zoom",H="mouseup.zoom",I="touchstart.zoom",J=A(a,"zoomstart","zoom","zoomend");return Pg||(Pg="onwheel"in eg?(Og=function(){return-bg.event.deltaY*(bg.event.deltaMode?120:1)},"wheel"):"onmousewheel"in eg?(Og=function(){return bg.event.wheelDelta},"mousewheel"):(Og=function(){return-bg.event.detail},"MozMousePixelScroll")),a.event=function(a){a.each(function(){var a=J.of(this,arguments),b=z;Hi?bg.select(this).transition().each("start.zoom",function(){z=this.__chart__||{x:0,y:0,k:1},i(a)}).tween("zoom:zoom",function(){var c=B[0],d=B[1],e=q?q[0]:c/2,f=q?q[1]:d/2,g=bg.interpolateZoom([(e-z.x)/z.k,(f-z.y)/z.k,c/z.k],[(e-b.x)/b.k,(f-b.y)/b.k,c/b.k]);return function(b){var d=g(b),h=c/d[2];this.__chart__=z={x:e-d[0]*h,y:f-d[1]*h,k:h},j(a)}}).each("interrupt.zoom",function(){k(a)}).each("end.zoom",function(){k(a)}):(this.__chart__=z,i(a),j(a),k(a))})},a.translate=function(b){return arguments.length?(z={x:+b[0],y:+b[1],k:z.k},h(),a):[z.x,z.y]},a.scale=function(b){return arguments.length?(z={x:z.x,y:z.y,k:+b},h(),a):z.k},a.scaleExtent=function(b){return arguments.length?(C=null==b?Qg:[+b[0],+b[1]],a):C},a.center=function(b){return arguments.length?(r=b&&[+b[0],+b[1]],a):r},a.size=function(b){return arguments.length?(B=b&&[+b[0],+b[1]],a):B},a.duration=function(b){return arguments.length?(D=+b,a):D},a.x=function(b){return arguments.length?(v=b,u=b.copy(),z={x:0,y:0,k:1},a):v},a.y=function(b){return arguments.length?(x=b,w=b.copy(),z={x:0,y:0,k:1},a):x},bg.rebind(a,J,"on")};var Og,Pg,Qg=[0,1/0];bg.color=ga,ga.prototype.toString=function(){return this.rgb()+""},bg.hsl=ha;var Rg=ha.prototype=new ga;Rg.brighter=function(a){return a=Math.pow(.7,arguments.length?a:1),new ha(this.h,this.s,this.l/a)},Rg.darker=function(a){return a=Math.pow(.7,arguments.length?a:1),new ha(this.h,this.s,a*this.l)},Rg.rgb=function(){return ia(this.h,this.s,this.l)},bg.hcl=ja;var Sg=ja.prototype=new ga;Sg.brighter=function(a){return new ja(this.h,this.c,Math.min(100,this.l+Tg*(arguments.length?a:1)))},Sg.darker=function(a){return new ja(this.h,this.c,Math.max(0,this.l-Tg*(arguments.length?a:1)))},Sg.rgb=function(){return ka(this.h,this.c,this.l).rgb()},bg.lab=la;var Tg=18,Ug=.95047,Vg=1,Wg=1.08883,Xg=la.prototype=new ga;Xg.brighter=function(a){return new la(Math.min(100,this.l+Tg*(arguments.length?a:1)),this.a,this.b)},Xg.darker=function(a){return new la(Math.max(0,this.l-Tg*(arguments.length?a:1)),this.a,this.b)},Xg.rgb=function(){return ma(this.l,this.a,this.b)},bg.rgb=ra;var Yg=ra.prototype=new ga;Yg.brighter=function(a){a=Math.pow(.7,arguments.length?a:1);var b=this.r,c=this.g,d=this.b,e=30;return b||c||d?(b&&e>b&&(b=e),c&&e>c&&(c=e),d&&e>d&&(d=e),new ra(Math.min(255,b/a),Math.min(255,c/a),Math.min(255,d/a))):new ra(e,e,e)},Yg.darker=function(a){return a=Math.pow(.7,arguments.length?a:1),new ra(a*this.r,a*this.g,a*this.b)},Yg.hsl=function(){return wa(this.r,this.g,this.b)},Yg.toString=function(){return"#"+ua(this.r)+ua(this.g)+ua(this.b)};var Zg=bg.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});Zg.forEach(function(a,b){Zg.set(a,sa(b))}),bg.functor=Aa,bg.xhr=Ba(s),bg.dsv=function(a,b){function c(a,c,f){arguments.length<3&&(f=c,c=null);var g=Ca(a,b,null==c?d:e(c),f);return g.row=function(a){return arguments.length?g.response(null==(c=a)?d:e(a)):c},g}function d(a){return c.parse(a.responseText)}function e(a){return function(b){return c.parse(b.responseText,a)}}function f(b){return b.map(g).join(a)}function g(a){return h.test(a)?'"'+a.replace(/\"/g,'""')+'"':a}var h=new RegExp('["'+a+"\n]"),i=a.charCodeAt(0);return c.parse=function(a,b){var d;return c.parseRows(a,function(a,c){if(d)return d(a,c-1);var e=new Function("d","return {"+a.map(function(a,b){return JSON.stringify(a)+": d["+b+"]"}).join(",")+"}");d=b?function(a,c){return b(e(a),c)}:e})},c.parseRows=function(a,b){function c(){if(k>=j)return g;if(e)return e=!1,f;var b=k;if(34===a.charCodeAt(b)){for(var c=b;c++<j;)if(34===a.charCodeAt(c)){if(34!==a.charCodeAt(c+1))break;++c}k=c+2;var d=a.charCodeAt(c+1);return 13===d?(e=!0,10===a.charCodeAt(c+2)&&++k):10===d&&(e=!0),a.slice(b+1,c).replace(/""/g,'"')}for(;j>k;){var d=a.charCodeAt(k++),h=1;if(10===d)e=!0;else if(13===d)e=!0,10===a.charCodeAt(k)&&(++k,++h);else if(d!==i)continue;return a.slice(b,k-h)}return a.slice(b)}for(var d,e,f={},g={},h=[],j=a.length,k=0,l=0;(d=c())!==g;){for(var m=[];d!==f&&d!==g;)m.push(d),d=c();b&&null==(m=b(m,l++))||h.push(m)}return h},c.format=function(b){if(Array.isArray(b[0]))return c.formatRows(b);var d=new r,e=[];return b.forEach(function(a){for(var b in a)d.has(b)||e.push(d.add(b))}),[e.map(g).join(a)].concat(b.map(function(b){return e.map(function(a){return g(b[a])}).join(a)})).join("\n")},c.formatRows=function(a){return a.map(f).join("\n")},c},bg.csv=bg.dsv(",","text/csv"),bg.tsv=bg.dsv("	","text/tab-separated-values");var $g,_g,ah,bh,ch,dh=this[u(this,"requestAnimationFrame")]||function(a){setTimeout(a,17)};bg.timer=function(a,b,c){var d=arguments.length;2>d&&(b=0),3>d&&(c=Date.now());var e=c+b,f={c:a,t:e,f:!1,n:null};_g?_g.n=f:$g=f,_g=f,ah||(bh=clearTimeout(bh),ah=1,dh(Fa))},bg.timer.flush=function(){Ga(),Ha()},bg.round=function(a,b){return b?Math.round(a*(b=Math.pow(10,b)))/b:Math.round(a)};var eh=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"].map(Ja);bg.formatPrefix=function(a,b){var c=0;return a&&(0>a&&(a*=-1),b&&(a=bg.round(a,Ia(a,b))),c=1+Math.floor(1e-12+Math.log(a)/Math.LN10),c=Math.max(-24,Math.min(24,3*Math.floor((c-1)/3)))),eh[8+c/3]};var fh=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i,gh=bg.map({b:function(a){return a.toString(2)},c:function(a){return String.fromCharCode(a)},o:function(a){return a.toString(8)},x:function(a){return a.toString(16)},X:function(a){return a.toString(16).toUpperCase()},g:function(a,b){return a.toPrecision(b)},e:function(a,b){return a.toExponential(b)},f:function(a,b){return a.toFixed(b)},r:function(a,b){return(a=bg.round(a,Ia(a,b))).toFixed(Math.max(0,Math.min(20,Ia(a*(1+1e-15),b))))}}),hh=bg.time={},ih=Date;Ma.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){jh.setUTCDate.apply(this._,arguments)},setDay:function(){jh.setUTCDay.apply(this._,arguments)},setFullYear:function(){jh.setUTCFullYear.apply(this._,arguments)},setHours:function(){jh.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){jh.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){jh.setUTCMinutes.apply(this._,arguments)},setMonth:function(){jh.setUTCMonth.apply(this._,arguments)},setSeconds:function(){jh.setUTCSeconds.apply(this._,arguments)},setTime:function(){jh.setTime.apply(this._,arguments)}};var jh=Date.prototype;hh.year=Na(function(a){return a=hh.day(a),a.setMonth(0,1),a},function(a,b){a.setFullYear(a.getFullYear()+b)},function(a){return a.getFullYear()}),hh.years=hh.year.range,hh.years.utc=hh.year.utc.range,hh.day=Na(function(a){var b=new ih(2e3,0);return b.setFullYear(a.getFullYear(),a.getMonth(),a.getDate()),b},function(a,b){a.setDate(a.getDate()+b)},function(a){return a.getDate()-1}),hh.days=hh.day.range,hh.days.utc=hh.day.utc.range,hh.dayOfYear=function(a){var b=hh.year(a);return Math.floor((a-b-6e4*(a.getTimezoneOffset()-b.getTimezoneOffset()))/864e5)},["sunday","monday","tuesday","wednesday","thursday","friday","saturday"].forEach(function(a,b){b=7-b;var c=hh[a]=Na(function(a){return(a=hh.day(a)).setDate(a.getDate()-(a.getDay()+b)%7),a},function(a,b){a.setDate(a.getDate()+7*Math.floor(b))},function(a){var c=hh.year(a).getDay();return Math.floor((hh.dayOfYear(a)+(c+b)%7)/7)-(c!==b)});hh[a+"s"]=c.range,hh[a+"s"].utc=c.utc.range,hh[a+"OfYear"]=function(a){var c=hh.year(a).getDay();return Math.floor((hh.dayOfYear(a)+(c+b)%7)/7)}}),hh.week=hh.sunday,hh.weeks=hh.sunday.range,hh.weeks.utc=hh.sunday.utc.range,hh.weekOfYear=hh.sundayOfYear;var kh={"-":"",_:" ",0:"0"},lh=/^\s*\d+/,mh=/^%/;bg.locale=function(a){return{numberFormat:Ka(a),timeFormat:Pa(a)}};var nh=bg.locale({decimal:".",thousands:",",grouping:[3],currency:["$",""],dateTime:"%a %b %e %X %Y",date:"%m/%d/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});bg.format=nh.numberFormat,bg.geo={},ib.prototype={s:0,t:0,add:function(a){jb(a,this.t,oh),jb(oh.s,this.s,this),this.s?this.t+=oh.t:this.s=oh.t},reset:function(){this.s=this.t=0},valueOf:function(){return this.s}};var oh=new ib;bg.geo.stream=function(a,b){a&&ph.hasOwnProperty(a.type)?ph[a.type](a,b):kb(a,b)};var ph={Feature:function(a,b){kb(a.geometry,b)},FeatureCollection:function(a,b){for(var c=a.features,d=-1,e=c.length;++d<e;)kb(c[d].geometry,b)}},qh={Sphere:function(a,b){b.sphere()},Point:function(a,b){a=a.coordinates,b.point(a[0],a[1],a[2])},MultiPoint:function(a,b){for(var c=a.coordinates,d=-1,e=c.length;++d<e;)a=c[d],b.point(a[0],a[1],a[2])},LineString:function(a,b){lb(a.coordinates,b,0)},MultiLineString:function(a,b){for(var c=a.coordinates,d=-1,e=c.length;++d<e;)lb(c[d],b,0)},Polygon:function(a,b){mb(a.coordinates,b)},MultiPolygon:function(a,b){for(var c=a.coordinates,d=-1,e=c.length;++d<e;)mb(c[d],b)},GeometryCollection:function(a,b){for(var c=a.geometries,d=-1,e=c.length;++d<e;)kb(c[d],b)}};bg.geo.area=function(a){return rh=0,bg.geo.stream(a,th),rh};var rh,sh=new ib,th={sphere:function(){rh+=4*Fg},point:v,lineStart:v,lineEnd:v,polygonStart:function(){sh.reset(),th.lineStart=nb},polygonEnd:function(){var a=2*sh;rh+=0>a?4*Fg+a:a,th.lineStart=th.lineEnd=th.point=v}};bg.geo.bounds=function(){function a(a,b){t.push(u=[k=a,m=a]),l>b&&(l=b),b>n&&(n=b)}function b(b,c){var d=ob([b*Jg,c*Jg]);if(r){var e=qb(r,d),f=[e[1],-e[0],0],g=qb(f,e);tb(g),g=ub(g);var i=b-o,j=i>0?1:-1,p=g[0]*Kg*j,q=ng(i)>180;if(q^(p>j*o&&j*b>p)){var s=g[1]*Kg;s>n&&(n=s)}else if(p=(p+360)%360-180,q^(p>j*o&&j*b>p)){var s=-g[1]*Kg;l>s&&(l=s)}else l>c&&(l=c),c>n&&(n=c);q?o>b?h(k,b)>h(k,m)&&(m=b):h(b,m)>h(k,m)&&(k=b):m>=k?(k>b&&(k=b),b>m&&(m=b)):b>o?h(k,b)>h(k,m)&&(m=b):h(b,m)>h(k,m)&&(k=b)}else a(b,c);r=d,o=b}function c(){v.point=b}function d(){u[0]=k,u[1]=m,v.point=a,r=null}function e(a,c){if(r){var d=a-o;s+=ng(d)>180?d+(d>0?360:-360):d}else p=a,q=c;th.point(a,c),b(a,c)}function f(){th.lineStart()}function g(){e(p,q),th.lineEnd(),ng(s)>Dg&&(k=-(m=180)),u[0]=k,u[1]=m,r=null}function h(a,b){return(b-=a)<0?b+360:b}function i(a,b){return a[0]-b[0]}function j(a,b){return b[0]<=b[1]?b[0]<=a&&a<=b[1]:a<b[0]||b[1]<a}var k,l,m,n,o,p,q,r,s,t,u,v={point:a,lineStart:c,lineEnd:d,polygonStart:function(){v.point=e,v.lineStart=f,v.lineEnd=g,s=0,th.polygonStart()},polygonEnd:function(){th.polygonEnd(),v.point=a,v.lineStart=c,v.lineEnd=d,0>sh?(k=-(m=180),l=-(n=90)):s>Dg?n=90:-Dg>s&&(l=-90),u[0]=k,u[1]=m}};return function(a){n=m=-(k=l=1/0),t=[],bg.geo.stream(a,v);var b=t.length;if(b){t.sort(i);for(var c,d=1,e=t[0],f=[e];b>d;++d)c=t[d],j(c[0],e)||j(c[1],e)?(h(e[0],c[1])>h(e[0],e[1])&&(e[1]=c[1]),h(c[0],e[1])>h(e[0],e[1])&&(e[0]=c[0])):f.push(e=c);for(var g,c,o=-(1/0),b=f.length-1,d=0,e=f[b];b>=d;e=c,++d)c=f[d],(g=h(e[1],c[0]))>o&&(o=g,k=c[0],m=e[1])}return t=u=null,k===1/0||l===1/0?[[NaN,NaN],[NaN,NaN]]:[[k,l],[m,n]]}}(),bg.geo.centroid=function(a){uh=vh=wh=xh=yh=zh=Ah=Bh=Ch=Dh=Eh=0,bg.geo.stream(a,Fh);var b=Ch,c=Dh,d=Eh,e=b*b+c*c+d*d;return Eg>e&&(b=zh,c=Ah,d=Bh,Dg>vh&&(b=wh,c=xh,d=yh),e=b*b+c*c+d*d,Eg>e)?[NaN,NaN]:[Math.atan2(c,b)*Kg,ba(d/Math.sqrt(e))*Kg]};var uh,vh,wh,xh,yh,zh,Ah,Bh,Ch,Dh,Eh,Fh={sphere:v,point:wb,lineStart:yb,lineEnd:zb,polygonStart:function(){Fh.lineStart=Ab},polygonEnd:function(){Fh.lineStart=yb}},Gh=Gb(Cb,Kb,Mb,[-Fg,-Fg/2]),Hh=1e9;bg.geo.clipExtent=function(){var a,b,c,d,e,f,g={stream:function(a){return e&&(e.valid=!1),e=f(a),e.valid=!0,e},extent:function(h){return arguments.length?(f=Qb(a=+h[0][0],b=+h[0][1],c=+h[1][0],d=+h[1][1]),e&&(e.valid=!1,e=null),g):[[a,b],[c,d]]}};return g.extent([[0,0],[960,500]])},(bg.geo.conicEqualArea=function(){return Rb(Sb)}).raw=Sb,bg.geo.albers=function(){return bg.geo.conicEqualArea().rotate([96,0]).center([-.6,38.7]).parallels([29.5,45.5]).scale(1070)},bg.geo.albersUsa=function(){function a(a){var f=a[0],g=a[1];return b=null,c(f,g),b||(d(f,g),b)||e(f,g),b}var b,c,d,e,f=bg.geo.albers(),g=bg.geo.conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]),h=bg.geo.conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]),i={point:function(a,c){b=[a,c]}};return a.invert=function(a){var b=f.scale(),c=f.translate(),d=(a[0]-c[0])/b,e=(a[1]-c[1])/b;return(e>=.12&&.234>e&&d>=-.425&&-.214>d?g:e>=.166&&.234>e&&d>=-.214&&-.115>d?h:f).invert(a)},a.stream=function(a){var b=f.stream(a),c=g.stream(a),d=h.stream(a);return{point:function(a,e){b.point(a,e),c.point(a,e),d.point(a,e)},sphere:function(){b.sphere(),c.sphere(),d.sphere()},lineStart:function(){b.lineStart(),c.lineStart(),d.lineStart()},lineEnd:function(){b.lineEnd(),c.lineEnd(),d.lineEnd()},polygonStart:function(){b.polygonStart(),c.polygonStart(),d.polygonStart()},polygonEnd:function(){b.polygonEnd(),c.polygonEnd(),d.polygonEnd()}}},a.precision=function(b){return arguments.length?(f.precision(b),g.precision(b),h.precision(b),a):f.precision()},a.scale=function(b){return arguments.length?(f.scale(b),g.scale(.35*b),h.scale(b),a.translate(f.translate())):f.scale()},a.translate=function(b){if(!arguments.length)return f.translate();var j=f.scale(),k=+b[0],l=+b[1];return c=f.translate(b).clipExtent([[k-.455*j,l-.238*j],[k+.455*j,l+.238*j]]).stream(i).point,d=g.translate([k-.307*j,l+.201*j]).clipExtent([[k-.425*j+Dg,l+.12*j+Dg],[k-.214*j-Dg,l+.234*j-Dg]]).stream(i).point,e=h.translate([k-.205*j,l+.212*j]).clipExtent([[k-.214*j+Dg,l+.166*j+Dg],[k-.115*j-Dg,l+.234*j-Dg]]).stream(i).point,a},a.scale(1070)};var Ih,Jh,Kh,Lh,Mh,Nh,Oh={point:v,lineStart:v,lineEnd:v,polygonStart:function(){Jh=0,Oh.lineStart=Tb},polygonEnd:function(){Oh.lineStart=Oh.lineEnd=Oh.point=v,Ih+=ng(Jh/2)}},Ph={point:Ub,lineStart:v,lineEnd:v,polygonStart:v,polygonEnd:v},Qh={point:Xb,lineStart:Yb,lineEnd:Zb,polygonStart:function(){Qh.lineStart=$b},polygonEnd:function(){Qh.point=Xb,Qh.lineStart=Yb,Qh.lineEnd=Zb}};bg.geo.path=function(){function a(a){return a&&("function"==typeof h&&f.pointRadius(+h.apply(this,arguments)),g&&g.valid||(g=e(f)),bg.geo.stream(a,g)),f.result()}function b(){return g=null,a}var c,d,e,f,g,h=4.5;return a.area=function(a){
return Ih=0,bg.geo.stream(a,e(Oh)),Ih},a.centroid=function(a){return wh=xh=yh=zh=Ah=Bh=Ch=Dh=Eh=0,bg.geo.stream(a,e(Qh)),Eh?[Ch/Eh,Dh/Eh]:Bh?[zh/Bh,Ah/Bh]:yh?[wh/yh,xh/yh]:[NaN,NaN]},a.bounds=function(a){return Mh=Nh=-(Kh=Lh=1/0),bg.geo.stream(a,e(Ph)),[[Kh,Lh],[Mh,Nh]]},a.projection=function(a){return arguments.length?(e=(c=a)?a.stream||bc(a):s,b()):c},a.context=function(a){return arguments.length?(f=null==(d=a)?new Vb:new _b(a),"function"!=typeof h&&f.pointRadius(h),b()):d},a.pointRadius=function(b){return arguments.length?(h="function"==typeof b?b:(f.pointRadius(+b),+b),a):h},a.projection(bg.geo.albersUsa()).context(null)},bg.geo.transform=function(a){return{stream:function(b){var c=new cc(b);for(var d in a)c[d]=a[d];return c}}},cc.prototype={point:function(a,b){this.stream.point(a,b)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}},bg.geo.projection=ec,bg.geo.projectionMutator=fc,(bg.geo.equirectangular=function(){return ec(hc)}).raw=hc.invert=hc,bg.geo.rotation=function(a){function b(b){return b=a(b[0]*Jg,b[1]*Jg),b[0]*=Kg,b[1]*=Kg,b}return a=jc(a[0]%360*Jg,a[1]*Jg,a.length>2?a[2]*Jg:0),b.invert=function(b){return b=a.invert(b[0]*Jg,b[1]*Jg),b[0]*=Kg,b[1]*=Kg,b},b},ic.invert=hc,bg.geo.circle=function(){function a(){var a="function"==typeof d?d.apply(this,arguments):d,b=jc(-a[0]*Jg,-a[1]*Jg,0).invert,e=[];return c(null,null,1,{point:function(a,c){e.push(a=b(a,c)),a[0]*=Kg,a[1]*=Kg}}),{type:"Polygon",coordinates:[e]}}var b,c,d=[0,0],e=6;return a.origin=function(b){return arguments.length?(d=b,a):d},a.angle=function(d){return arguments.length?(c=nc((b=+d)*Jg,e*Jg),a):b},a.precision=function(d){return arguments.length?(c=nc(b*Jg,(e=+d)*Jg),a):e},a.angle(90)},bg.geo.distance=function(a,b){var c,d=(b[0]-a[0])*Jg,e=a[1]*Jg,f=b[1]*Jg,g=Math.sin(d),h=Math.cos(d),i=Math.sin(e),j=Math.cos(e),k=Math.sin(f),l=Math.cos(f);return Math.atan2(Math.sqrt((c=l*g)*c+(c=j*k-i*l*h)*c),i*k+j*l*h)},bg.geo.graticule=function(){function a(){return{type:"MultiLineString",coordinates:b()}}function b(){return bg.range(Math.ceil(f/q)*q,e,q).map(m).concat(bg.range(Math.ceil(j/r)*r,i,r).map(n)).concat(bg.range(Math.ceil(d/o)*o,c,o).filter(function(a){return ng(a%q)>Dg}).map(k)).concat(bg.range(Math.ceil(h/p)*p,g,p).filter(function(a){return ng(a%r)>Dg}).map(l))}var c,d,e,f,g,h,i,j,k,l,m,n,o=10,p=o,q=90,r=360,s=2.5;return a.lines=function(){return b().map(function(a){return{type:"LineString",coordinates:a}})},a.outline=function(){return{type:"Polygon",coordinates:[m(f).concat(n(i).slice(1),m(e).reverse().slice(1),n(j).reverse().slice(1))]}},a.extent=function(b){return arguments.length?a.majorExtent(b).minorExtent(b):a.minorExtent()},a.majorExtent=function(b){return arguments.length?(f=+b[0][0],e=+b[1][0],j=+b[0][1],i=+b[1][1],f>e&&(b=f,f=e,e=b),j>i&&(b=j,j=i,i=b),a.precision(s)):[[f,j],[e,i]]},a.minorExtent=function(b){return arguments.length?(d=+b[0][0],c=+b[1][0],h=+b[0][1],g=+b[1][1],d>c&&(b=d,d=c,c=b),h>g&&(b=h,h=g,g=b),a.precision(s)):[[d,h],[c,g]]},a.step=function(b){return arguments.length?a.majorStep(b).minorStep(b):a.minorStep()},a.majorStep=function(b){return arguments.length?(q=+b[0],r=+b[1],a):[q,r]},a.minorStep=function(b){return arguments.length?(o=+b[0],p=+b[1],a):[o,p]},a.precision=function(b){return arguments.length?(s=+b,k=pc(h,g,90),l=qc(d,c,s),m=pc(j,i,90),n=qc(f,e,s),a):s},a.majorExtent([[-180,-90+Dg],[180,90-Dg]]).minorExtent([[-180,-80-Dg],[180,80+Dg]])},bg.geo.greatArc=function(){function a(){return{type:"LineString",coordinates:[b||d.apply(this,arguments),c||e.apply(this,arguments)]}}var b,c,d=rc,e=sc;return a.distance=function(){return bg.geo.distance(b||d.apply(this,arguments),c||e.apply(this,arguments))},a.source=function(c){return arguments.length?(d=c,b="function"==typeof c?null:c,a):d},a.target=function(b){return arguments.length?(e=b,c="function"==typeof b?null:b,a):e},a.precision=function(){return arguments.length?a:0},a},bg.geo.interpolate=function(a,b){return tc(a[0]*Jg,a[1]*Jg,b[0]*Jg,b[1]*Jg)},bg.geo.length=function(a){return Rh=0,bg.geo.stream(a,Sh),Rh};var Rh,Sh={sphere:v,point:v,lineStart:uc,lineEnd:v,polygonStart:v,polygonEnd:v},Th=vc(function(a){return Math.sqrt(2/(1+a))},function(a){return 2*Math.asin(a/2)});(bg.geo.azimuthalEqualArea=function(){return ec(Th)}).raw=Th;var Uh=vc(function(a){var b=Math.acos(a);return b&&b/Math.sin(b)},s);(bg.geo.azimuthalEquidistant=function(){return ec(Uh)}).raw=Uh,(bg.geo.conicConformal=function(){return Rb(wc)}).raw=wc,(bg.geo.conicEquidistant=function(){return Rb(xc)}).raw=xc;var Vh=vc(function(a){return 1/a},Math.atan);(bg.geo.gnomonic=function(){return ec(Vh)}).raw=Vh,yc.invert=function(a,b){return[a,2*Math.atan(Math.exp(b))-Ig]},(bg.geo.mercator=function(){return zc(yc)}).raw=yc;var Wh=vc(function(){return 1},Math.asin);(bg.geo.orthographic=function(){return ec(Wh)}).raw=Wh;var Xh=vc(function(a){return 1/(1+a)},function(a){return 2*Math.atan(a)});(bg.geo.stereographic=function(){return ec(Xh)}).raw=Xh,Ac.invert=function(a,b){return[-b,2*Math.atan(Math.exp(a))-Ig]},(bg.geo.transverseMercator=function(){var a=zc(Ac),b=a.center,c=a.rotate;return a.center=function(a){return a?b([-a[1],a[0]]):(a=b(),[a[1],-a[0]])},a.rotate=function(a){return a?c([a[0],a[1],a.length>2?a[2]+90:90]):(a=c(),[a[0],a[1],a[2]-90])},c([0,0,90])}).raw=Ac,bg.geom={},bg.geom.hull=function(a){function b(a){if(a.length<3)return[];var b,e=Aa(c),f=Aa(d),g=a.length,h=[],i=[];for(b=0;g>b;b++)h.push([+e.call(this,a[b],b),+f.call(this,a[b],b),b]);for(h.sort(Ec),b=0;g>b;b++)i.push([h[b][0],-h[b][1]]);var j=Dc(h),k=Dc(i),l=k[0]===j[0],m=k[k.length-1]===j[j.length-1],n=[];for(b=j.length-1;b>=0;--b)n.push(a[h[j[b]][2]]);for(b=+l;b<k.length-m;++b)n.push(a[h[k[b]][2]]);return n}var c=Bc,d=Cc;return arguments.length?b(a):(b.x=function(a){return arguments.length?(c=a,b):c},b.y=function(a){return arguments.length?(d=a,b):d},b)},bg.geom.polygon=function(a){return sg(a,Yh),a};var Yh=bg.geom.polygon.prototype=[];Yh.area=function(){for(var a,b=-1,c=this.length,d=this[c-1],e=0;++b<c;)a=d,d=this[b],e+=a[1]*d[0]-a[0]*d[1];return.5*e},Yh.centroid=function(a){var b,c,d=-1,e=this.length,f=0,g=0,h=this[e-1];for(arguments.length||(a=-1/(6*this.area()));++d<e;)b=h,h=this[d],c=b[0]*h[1]-h[0]*b[1],f+=(b[0]+h[0])*c,g+=(b[1]+h[1])*c;return[f*a,g*a]},Yh.clip=function(a){for(var b,c,d,e,f,g,h=Hc(a),i=-1,j=this.length-Hc(this),k=this[j-1];++i<j;){for(b=a.slice(),a.length=0,e=this[i],f=b[(d=b.length-h)-1],c=-1;++c<d;)g=b[c],Fc(g,k,e)?(Fc(f,k,e)||a.push(Gc(f,g,k,e)),a.push(g)):Fc(f,k,e)&&a.push(Gc(f,g,k,e)),f=g;h&&a.push(a[0]),k=e}return a};var Zh,$h,_h,ai,bi,ci=[],di=[];Pc.prototype.prepare=function(){for(var a,b=this.edges,c=b.length;c--;)a=b[c].edge,a.b&&a.a||b.splice(c,1);return b.sort(Rc),b.length},_c.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}},ad.prototype={insert:function(a,b){var c,d,e;if(a){if(b.P=a,b.N=a.N,a.N&&(a.N.P=b),a.N=b,a.R){for(a=a.R;a.L;)a=a.L;a.L=b}else a.R=b;c=a}else this._?(a=ed(this._),b.P=null,b.N=a,a.P=a.L=b,c=a):(b.P=b.N=null,this._=b,c=null);for(b.L=b.R=null,b.U=c,b.C=!0,a=b;c&&c.C;)d=c.U,c===d.L?(e=d.R,e&&e.C?(c.C=e.C=!1,d.C=!0,a=d):(a===c.R&&(cd(this,c),a=c,c=a.U),c.C=!1,d.C=!0,dd(this,d))):(e=d.L,e&&e.C?(c.C=e.C=!1,d.C=!0,a=d):(a===c.L&&(dd(this,c),a=c,c=a.U),c.C=!1,d.C=!0,cd(this,d))),c=a.U;this._.C=!1},remove:function(a){a.N&&(a.N.P=a.P),a.P&&(a.P.N=a.N),a.N=a.P=null;var b,c,d,e=a.U,f=a.L,g=a.R;if(c=f?g?ed(g):f:g,e?e.L===a?e.L=c:e.R=c:this._=c,f&&g?(d=c.C,c.C=a.C,c.L=f,f.U=c,c!==g?(e=c.U,c.U=a.U,a=c.R,e.L=a,c.R=g,g.U=c):(c.U=e,e=c,a=c.R)):(d=a.C,a=c),a&&(a.U=e),!d){if(a&&a.C)return void(a.C=!1);do{if(a===this._)break;if(a===e.L){if(b=e.R,b.C&&(b.C=!1,e.C=!0,cd(this,e),b=e.R),b.L&&b.L.C||b.R&&b.R.C){b.R&&b.R.C||(b.L.C=!1,b.C=!0,dd(this,b),b=e.R),b.C=e.C,e.C=b.R.C=!1,cd(this,e),a=this._;break}}else if(b=e.L,b.C&&(b.C=!1,e.C=!0,dd(this,e),b=e.L),b.L&&b.L.C||b.R&&b.R.C){b.L&&b.L.C||(b.R.C=!1,b.C=!0,cd(this,b),b=e.L),b.C=e.C,e.C=b.L.C=!1,dd(this,e),a=this._;break}b.C=!0,a=e,e=e.U}while(!a.C);a&&(a.C=!1)}}},bg.geom.voronoi=function(a){function b(a){var b=new Array(a.length),d=h[0][0],e=h[0][1],f=h[1][0],g=h[1][1];return fd(c(a),h).cells.forEach(function(c,h){var i=c.edges,j=c.site,k=b[h]=i.length?i.map(function(a){var b=a.start();return[b.x,b.y]}):j.x>=d&&j.x<=f&&j.y>=e&&j.y<=g?[[d,g],[f,g],[f,e],[d,e]]:[];k.point=a[h]}),b}function c(a){return a.map(function(a,b){return{x:Math.round(f(a,b)/Dg)*Dg,y:Math.round(g(a,b)/Dg)*Dg,i:b}})}var d=Bc,e=Cc,f=d,g=e,h=ei;return a?b(a):(b.links=function(a){return fd(c(a)).edges.filter(function(a){return a.l&&a.r}).map(function(b){return{source:a[b.l.i],target:a[b.r.i]}})},b.triangles=function(a){var b=[];return fd(c(a)).cells.forEach(function(c,d){for(var e,f,g=c.site,h=c.edges.sort(Rc),i=-1,j=h.length,k=h[j-1].edge,l=k.l===g?k.r:k.l;++i<j;)e=k,f=l,k=h[i].edge,l=k.l===g?k.r:k.l,d<f.i&&d<l.i&&hd(g,f,l)<0&&b.push([a[d],a[f.i],a[l.i]])}),b},b.x=function(a){return arguments.length?(f=Aa(d=a),b):d},b.y=function(a){return arguments.length?(g=Aa(e=a),b):e},b.clipExtent=function(a){return arguments.length?(h=null==a?ei:a,b):h===ei?null:h},b.size=function(a){return arguments.length?b.clipExtent(a&&[[0,0],a]):h===ei?null:h&&h[1]},b)};var ei=[[-1e6,-1e6],[1e6,1e6]];bg.geom.delaunay=function(a){return bg.geom.voronoi().triangles(a)},bg.geom.quadtree=function(a,b,c,d,e){function f(a){function f(a,b,c,d,e,f,g,h){if(!isNaN(c)&&!isNaN(d))if(a.leaf){var i=a.x,k=a.y;if(null!=i)if(ng(i-c)+ng(k-d)<.01)j(a,b,c,d,e,f,g,h);else{var l=a.point;a.x=a.y=a.point=null,j(a,l,i,k,e,f,g,h),j(a,b,c,d,e,f,g,h)}else a.x=c,a.y=d,a.point=b}else j(a,b,c,d,e,f,g,h)}function j(a,b,c,d,e,g,h,i){var j=.5*(e+h),k=.5*(g+i),l=c>=j,m=d>=k,n=m<<1|l;a.leaf=!1,a=a.nodes[n]||(a.nodes[n]=kd()),l?e=j:h=j,m?g=k:i=k,f(a,b,c,d,e,g,h,i)}var k,l,m,n,o,p,q,r,s,t=Aa(h),u=Aa(i);if(null!=b)p=b,q=c,r=d,s=e;else if(r=s=-(p=q=1/0),l=[],m=[],o=a.length,g)for(n=0;o>n;++n)k=a[n],k.x<p&&(p=k.x),k.y<q&&(q=k.y),k.x>r&&(r=k.x),k.y>s&&(s=k.y),l.push(k.x),m.push(k.y);else for(n=0;o>n;++n){var v=+t(k=a[n],n),w=+u(k,n);p>v&&(p=v),q>w&&(q=w),v>r&&(r=v),w>s&&(s=w),l.push(v),m.push(w)}var x=r-p,y=s-q;x>y?s=q+x:r=p+y;var z=kd();if(z.add=function(a){f(z,a,+t(a,++n),+u(a,n),p,q,r,s)},z.visit=function(a){ld(a,z,p,q,r,s)},z.find=function(a){return md(z,a[0],a[1],p,q,r,s)},n=-1,null==b){for(;++n<o;)f(z,a[n],l[n],m[n],p,q,r,s);--n}else a.forEach(z.add);return l=m=a=k=null,z}var g,h=Bc,i=Cc;return(g=arguments.length)?(h=id,i=jd,3===g&&(e=c,d=b,c=b=0),f(a)):(f.x=function(a){return arguments.length?(h=a,f):h},f.y=function(a){return arguments.length?(i=a,f):i},f.extent=function(a){return arguments.length?(null==a?b=c=d=e=null:(b=+a[0][0],c=+a[0][1],d=+a[1][0],e=+a[1][1]),f):null==b?null:[[b,c],[d,e]]},f.size=function(a){return arguments.length?(null==a?b=c=d=e=null:(b=c=0,d=+a[0],e=+a[1]),f):null==b?null:[d-b,e-c]},f)},bg.interpolateRgb=nd,bg.interpolateObject=od,bg.interpolateNumber=pd,bg.interpolateString=qd;var fi=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,gi=new RegExp(fi.source,"g");bg.interpolate=rd,bg.interpolators=[function(a,b){var c=typeof b;return("string"===c?Zg.has(b.toLowerCase())||/^(#|rgb\(|hsl\()/i.test(b)?nd:qd:b instanceof ga?nd:Array.isArray(b)?sd:"object"===c&&isNaN(b)?od:pd)(a,b)}],bg.interpolateArray=sd;var hi=function(){return s},ii=bg.map({linear:hi,poly:zd,quad:function(){return wd},cubic:function(){return xd},sin:function(){return Ad},exp:function(){return Bd},circle:function(){return Cd},elastic:Dd,back:Ed,bounce:function(){return Fd}}),ji=bg.map({"in":s,out:ud,"in-out":vd,"out-in":function(a){return vd(ud(a))}});bg.ease=function(a){var b=a.indexOf("-"),c=b>=0?a.slice(0,b):a,d=b>=0?a.slice(b+1):"in";return c=ii.get(c)||hi,d=ji.get(d)||s,td(d(c.apply(null,cg.call(arguments,1))))},bg.interpolateHcl=Gd,bg.interpolateHsl=Hd,bg.interpolateLab=Id,bg.interpolateRound=Jd,bg.transform=function(a){var b=eg.createElementNS(bg.ns.prefix.svg,"g");return(bg.transform=function(a){if(null!=a){b.setAttribute("transform",a);var c=b.transform.baseVal.consolidate()}return new Kd(c?c.matrix:ki)})(a)},Kd.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var ki={a:1,b:0,c:0,d:1,e:0,f:0};bg.interpolateTransform=Od,bg.layout={},bg.layout.bundle=function(){return function(a){for(var b=[],c=-1,d=a.length;++c<d;)b.push(Rd(a[c]));return b}},bg.layout.chord=function(){function a(){var a,j,l,m,n,o={},p=[],q=bg.range(f),r=[];for(c=[],d=[],a=0,m=-1;++m<f;){for(j=0,n=-1;++n<f;)j+=e[m][n];p.push(j),r.push(bg.range(f)),a+=j}for(g&&q.sort(function(a,b){return g(p[a],p[b])}),h&&r.forEach(function(a,b){a.sort(function(a,c){return h(e[b][a],e[b][c])})}),a=(Gg-k*f)/a,j=0,m=-1;++m<f;){for(l=j,n=-1;++n<f;){var s=q[m],t=r[s][n],u=e[s][t],v=j,w=j+=u*a;o[s+"-"+t]={index:s,subindex:t,startAngle:v,endAngle:w,value:u}}d[s]={index:s,startAngle:l,endAngle:j,value:(j-l)/a},j+=k}for(m=-1;++m<f;)for(n=m-1;++n<f;){var x=o[m+"-"+n],y=o[n+"-"+m];(x.value||y.value)&&c.push(x.value<y.value?{source:y,target:x}:{source:x,target:y})}i&&b()}function b(){c.sort(function(a,b){return i((a.source.value+a.target.value)/2,(b.source.value+b.target.value)/2)})}var c,d,e,f,g,h,i,j={},k=0;return j.matrix=function(a){return arguments.length?(f=(e=a)&&e.length,c=d=null,j):e},j.padding=function(a){return arguments.length?(k=a,c=d=null,j):k},j.sortGroups=function(a){return arguments.length?(g=a,c=d=null,j):g},j.sortSubgroups=function(a){return arguments.length?(h=a,c=null,j):h},j.sortChords=function(a){return arguments.length?(i=a,c&&b(),j):i},j.chords=function(){return c||a(),c},j.groups=function(){return d||a(),d},j},bg.layout.force=function(){function a(a){return function(b,c,d,e){if(b.point!==a){var f=b.cx-a.x,g=b.cy-a.y,h=e-c,i=f*f+g*g;if(i>h*h/q){if(o>i){var j=b.charge/i;a.px-=f*j,a.py-=g*j}return!0}if(b.point&&i&&o>i){var j=b.pointCharge/i;a.px-=f*j,a.py-=g*j}}return!b.charge}}function b(a){a.px=bg.event.x,a.py=bg.event.y,h.resume()}var c,d,e,f,g,h={},i=bg.dispatch("start","tick","end"),j=[1,1],k=.9,l=li,m=mi,n=-30,o=ni,p=.1,q=.64,r=[],t=[];return h.tick=function(){if((d*=.99)<.005)return i.end({type:"end",alpha:d=0}),!0;var b,c,h,l,m,o,q,s,u,v=r.length,w=t.length;for(c=0;w>c;++c)h=t[c],l=h.source,m=h.target,s=m.x-l.x,u=m.y-l.y,(o=s*s+u*u)&&(o=d*f[c]*((o=Math.sqrt(o))-e[c])/o,s*=o,u*=o,m.x-=s*(q=l.weight/(m.weight+l.weight)),m.y-=u*q,l.x+=s*(q=1-q),l.y+=u*q);if((q=d*p)&&(s=j[0]/2,u=j[1]/2,c=-1,q))for(;++c<v;)h=r[c],h.x+=(s-h.x)*q,h.y+=(u-h.y)*q;if(n)for(Yd(b=bg.geom.quadtree(r),d,g),c=-1;++c<v;)(h=r[c]).fixed||b.visit(a(h));for(c=-1;++c<v;)h=r[c],h.fixed?(h.x=h.px,h.y=h.py):(h.x-=(h.px-(h.px=h.x))*k,h.y-=(h.py-(h.py=h.y))*k);i.tick({type:"tick",alpha:d})},h.nodes=function(a){return arguments.length?(r=a,h):r},h.links=function(a){return arguments.length?(t=a,h):t},h.size=function(a){return arguments.length?(j=a,h):j},h.linkDistance=function(a){return arguments.length?(l="function"==typeof a?a:+a,h):l},h.distance=h.linkDistance,h.linkStrength=function(a){return arguments.length?(m="function"==typeof a?a:+a,h):m},h.friction=function(a){return arguments.length?(k=+a,h):k},h.charge=function(a){return arguments.length?(n="function"==typeof a?a:+a,h):n},h.chargeDistance=function(a){return arguments.length?(o=a*a,h):Math.sqrt(o)},h.gravity=function(a){return arguments.length?(p=+a,h):p},h.theta=function(a){return arguments.length?(q=a*a,h):Math.sqrt(q)},h.alpha=function(a){return arguments.length?(a=+a,d?d=a>0?a:0:a>0&&(i.start({type:"start",alpha:d=a}),bg.timer(h.tick)),h):d},h.start=function(){function a(a,d){if(!c){for(c=new Array(i),h=0;i>h;++h)c[h]=[];for(h=0;k>h;++h){var e=t[h];c[e.source.index].push(e.target),c[e.target.index].push(e.source)}}for(var f,g=c[b],h=-1,j=g.length;++h<j;)if(!isNaN(f=g[h][a]))return f;return Math.random()*d}var b,c,d,i=r.length,k=t.length,o=j[0],p=j[1];for(b=0;i>b;++b)(d=r[b]).index=b,d.weight=0;for(b=0;k>b;++b)d=t[b],"number"==typeof d.source&&(d.source=r[d.source]),"number"==typeof d.target&&(d.target=r[d.target]),++d.source.weight,++d.target.weight;for(b=0;i>b;++b)d=r[b],isNaN(d.x)&&(d.x=a("x",o)),isNaN(d.y)&&(d.y=a("y",p)),isNaN(d.px)&&(d.px=d.x),isNaN(d.py)&&(d.py=d.y);if(e=[],"function"==typeof l)for(b=0;k>b;++b)e[b]=+l.call(this,t[b],b);else for(b=0;k>b;++b)e[b]=l;if(f=[],"function"==typeof m)for(b=0;k>b;++b)f[b]=+m.call(this,t[b],b);else for(b=0;k>b;++b)f[b]=m;if(g=[],"function"==typeof n)for(b=0;i>b;++b)g[b]=+n.call(this,r[b],b);else for(b=0;i>b;++b)g[b]=n;return h.resume()},h.resume=function(){return h.alpha(.1)},h.stop=function(){return h.alpha(0)},h.drag=function(){return c||(c=bg.behavior.drag().origin(s).on("dragstart.force",Ud).on("drag.force",b).on("dragend.force",Vd)),arguments.length?void this.on("mouseover.force",Wd).on("mouseout.force",Xd).call(c):c},bg.rebind(h,i,"on")};var li=20,mi=1,ni=1/0;bg.layout.hierarchy=function(){function a(e){var f,g=[e],h=[];for(e.depth=0;null!=(f=g.pop());)if(h.push(f),(j=c.call(a,f,f.depth))&&(i=j.length)){for(var i,j,k;--i>=0;)g.push(k=j[i]),k.parent=f,k.depth=f.depth+1;d&&(f.value=0),f.children=j}else d&&(f.value=+d.call(a,f,f.depth)||0),delete f.children;return _d(e,function(a){var c,e;b&&(c=a.children)&&c.sort(b),d&&(e=a.parent)&&(e.value+=a.value)}),h}var b=ce,c=ae,d=be;return a.sort=function(c){return arguments.length?(b=c,a):b},a.children=function(b){return arguments.length?(c=b,a):c},a.value=function(b){return arguments.length?(d=b,a):d},a.revalue=function(b){return d&&($d(b,function(a){a.children&&(a.value=0)}),_d(b,function(b){var c;b.children||(b.value=+d.call(a,b,b.depth)||0),(c=b.parent)&&(c.value+=b.value)})),b},a},bg.layout.partition=function(){function a(b,c,d,e){var f=b.children;if(b.x=c,b.y=b.depth*e,b.dx=d,b.dy=e,f&&(g=f.length)){var g,h,i,j=-1;for(d=b.value?d/b.value:0;++j<g;)a(h=f[j],c,i=h.value*d,e),c+=i}}function b(a){var c=a.children,d=0;if(c&&(e=c.length))for(var e,f=-1;++f<e;)d=Math.max(d,b(c[f]));return 1+d}function c(c,f){var g=d.call(this,c,f);return a(g[0],0,e[0],e[1]/b(g[0])),g}var d=bg.layout.hierarchy(),e=[1,1];return c.size=function(a){return arguments.length?(e=a,c):e},Zd(c,d)},bg.layout.pie=function(){function a(g){var h,i=g.length,j=g.map(function(c,d){return+b.call(a,c,d)}),k=+("function"==typeof d?d.apply(this,arguments):d),l=("function"==typeof e?e.apply(this,arguments):e)-k,m=Math.min(Math.abs(l)/i,+("function"==typeof f?f.apply(this,arguments):f)),n=m*(0>l?-1:1),o=(l-i*n)/bg.sum(j),p=bg.range(i),q=[];return null!=c&&p.sort(c===oi?function(a,b){return j[b]-j[a]}:function(a,b){return c(g[a],g[b])}),p.forEach(function(a){q[a]={data:g[a],value:h=j[a],startAngle:k,endAngle:k+=h*o+n,padAngle:m}}),q}var b=Number,c=oi,d=0,e=Gg,f=0;return a.value=function(c){return arguments.length?(b=c,a):b},a.sort=function(b){return arguments.length?(c=b,a):c},a.startAngle=function(b){return arguments.length?(d=b,a):d},a.endAngle=function(b){return arguments.length?(e=b,a):e},a.padAngle=function(b){return arguments.length?(f=b,a):f},a};var oi={};bg.layout.stack=function(){function a(h,i){if(!(m=h.length))return h;var j=h.map(function(c,d){return b.call(a,c,d)}),k=j.map(function(b){return b.map(function(b,c){return[f.call(a,b,c),g.call(a,b,c)]})}),l=c.call(a,k,i);j=bg.permute(j,l),k=bg.permute(k,l);var m,n,o,p,q=d.call(a,k,i),r=j[0].length;for(o=0;r>o;++o)for(e.call(a,j[0][o],p=q[o],k[0][o][1]),n=1;m>n;++n)e.call(a,j[n][o],p+=k[n-1][o][1],k[n][o][1]);return h}var b=s,c=he,d=ie,e=ge,f=ee,g=fe;return a.values=function(c){return arguments.length?(b=c,a):b},a.order=function(b){return arguments.length?(c="function"==typeof b?b:pi.get(b)||he,a):c},a.offset=function(b){return arguments.length?(d="function"==typeof b?b:qi.get(b)||ie,a):d},a.x=function(b){return arguments.length?(f=b,a):f},a.y=function(b){return arguments.length?(g=b,a):g},a.out=function(b){return arguments.length?(e=b,a):e},a};var pi=bg.map({"inside-out":function(a){var b,c,d=a.length,e=a.map(je),f=a.map(ke),g=bg.range(d).sort(function(a,b){return e[a]-e[b]}),h=0,i=0,j=[],k=[];for(b=0;d>b;++b)c=g[b],i>h?(h+=f[c],j.push(c)):(i+=f[c],k.push(c));return k.reverse().concat(j)},reverse:function(a){return bg.range(a.length).reverse()},"default":he}),qi=bg.map({silhouette:function(a){var b,c,d,e=a.length,f=a[0].length,g=[],h=0,i=[];for(c=0;f>c;++c){for(b=0,d=0;e>b;b++)d+=a[b][c][1];d>h&&(h=d),g.push(d)}for(c=0;f>c;++c)i[c]=(h-g[c])/2;return i},wiggle:function(a){var b,c,d,e,f,g,h,i,j,k=a.length,l=a[0],m=l.length,n=[];for(n[0]=i=j=0,c=1;m>c;++c){for(b=0,e=0;k>b;++b)e+=a[b][c][1];for(b=0,f=0,h=l[c][0]-l[c-1][0];k>b;++b){for(d=0,g=(a[b][c][1]-a[b][c-1][1])/(2*h);b>d;++d)g+=(a[d][c][1]-a[d][c-1][1])/h;f+=g*a[b][c][1]}n[c]=i-=e?f/e*h:0,j>i&&(j=i)}for(c=0;m>c;++c)n[c]-=j;return n},expand:function(a){var b,c,d,e=a.length,f=a[0].length,g=1/e,h=[];for(c=0;f>c;++c){for(b=0,d=0;e>b;b++)d+=a[b][c][1];if(d)for(b=0;e>b;b++)a[b][c][1]/=d;else for(b=0;e>b;b++)a[b][c][1]=g}for(c=0;f>c;++c)h[c]=0;return h},zero:ie});bg.layout.histogram=function(){function a(a,f){for(var g,h,i=[],j=a.map(c,this),k=d.call(this,j,f),l=e.call(this,k,j,f),f=-1,m=j.length,n=l.length-1,o=b?1:1/m;++f<n;)g=i[f]=[],g.dx=l[f+1]-(g.x=l[f]),g.y=0;if(n>0)for(f=-1;++f<m;)h=j[f],h>=k[0]&&h<=k[1]&&(g=i[bg.bisect(l,h,1,n)-1],g.y+=o,g.push(a[f]));return i}var b=!0,c=Number,d=oe,e=me;return a.value=function(b){return arguments.length?(c=b,a):c},a.range=function(b){return arguments.length?(d=Aa(b),a):d},a.bins=function(b){return arguments.length?(e="number"==typeof b?function(a){return ne(a,b)}:Aa(b),a):e},a.frequency=function(c){return arguments.length?(b=!!c,a):b},a},bg.layout.pack=function(){function a(a,f){var g=c.call(this,a,f),h=g[0],i=e[0],j=e[1],k=null==b?Math.sqrt:"function"==typeof b?b:function(){return b};if(h.x=h.y=0,_d(h,function(a){a.r=+k(a.value)}),_d(h,te),d){var l=d*(b?1:Math.max(2*h.r/i,2*h.r/j))/2;_d(h,function(a){a.r+=l}),_d(h,te),_d(h,function(a){a.r-=l})}return we(h,i/2,j/2,b?1:1/Math.max(2*h.r/i,2*h.r/j)),g}var b,c=bg.layout.hierarchy().sort(pe),d=0,e=[1,1];return a.size=function(b){return arguments.length?(e=b,a):e},a.radius=function(c){return arguments.length?(b=null==c||"function"==typeof c?c:+c,a):b},a.padding=function(b){return arguments.length?(d=+b,a):d},Zd(a,c)},bg.layout.tree=function(){function a(a,e){var k=g.call(this,a,e),l=k[0],m=b(l);if(_d(m,c),m.parent.m=-m.z,$d(m,d),j)$d(l,f);else{var n=l,o=l,p=l;$d(l,function(a){a.x<n.x&&(n=a),a.x>o.x&&(o=a),a.depth>p.depth&&(p=a)});var q=h(n,o)/2-n.x,r=i[0]/(o.x+h(o,n)/2+q),s=i[1]/(p.depth||1);$d(l,function(a){a.x=(a.x+q)*r,a.y=a.depth*s})}return k}function b(a){for(var b,c={A:null,children:[a]},d=[c];null!=(b=d.pop());)for(var e,f=b.children,g=0,h=f.length;h>g;++g)d.push((f[g]=e={_:f[g],parent:b,children:(e=f[g].children)&&e.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:g}).a=e);return c.children[0]}function c(a){var b=a.children,c=a.parent.children,d=a.i?c[a.i-1]:null;if(b.length){Ce(a);var f=(b[0].z+b[b.length-1].z)/2;d?(a.z=d.z+h(a._,d._),a.m=a.z-f):a.z=f}else d&&(a.z=d.z+h(a._,d._));a.parent.A=e(a,d,a.parent.A||c[0])}function d(a){a._.x=a.z+a.parent.m,a.m+=a.parent.m}function e(a,b,c){if(b){for(var d,e=a,f=a,g=b,i=e.parent.children[0],j=e.m,k=f.m,l=g.m,m=i.m;g=Ae(g),e=ze(e),g&&e;)i=ze(i),f=Ae(f),f.a=a,d=g.z+l-e.z-j+h(g._,e._),d>0&&(Be(De(g,a,c),a,d),j+=d,k+=d),l+=g.m,j+=e.m,m+=i.m,k+=f.m;g&&!Ae(f)&&(f.t=g,f.m+=l-k),e&&!ze(i)&&(i.t=e,i.m+=j-m,c=a)}return c}function f(a){a.x*=i[0],a.y=a.depth*i[1]}var g=bg.layout.hierarchy().sort(null).value(null),h=ye,i=[1,1],j=null;return a.separation=function(b){return arguments.length?(h=b,a):h},a.size=function(b){return arguments.length?(j=null==(i=b)?f:null,a):j?null:i},a.nodeSize=function(b){return arguments.length?(j=null==(i=b)?null:f,a):j?i:null},Zd(a,g)},bg.layout.cluster=function(){function a(a,f){var g,h=b.call(this,a,f),i=h[0],j=0;_d(i,function(a){var b=a.children;b&&b.length?(a.x=Fe(b),a.y=Ee(b)):(a.x=g?j+=c(a,g):0,a.y=0,g=a)});var k=Ge(i),l=He(i),m=k.x-c(k,l)/2,n=l.x+c(l,k)/2;return _d(i,e?function(a){a.x=(a.x-i.x)*d[0],a.y=(i.y-a.y)*d[1]}:function(a){a.x=(a.x-m)/(n-m)*d[0],a.y=(1-(i.y?a.y/i.y:1))*d[1]}),h}var b=bg.layout.hierarchy().sort(null).value(null),c=ye,d=[1,1],e=!1;return a.separation=function(b){return arguments.length?(c=b,a):c},a.size=function(b){return arguments.length?(e=null==(d=b),a):e?null:d},a.nodeSize=function(b){return arguments.length?(e=null!=(d=b),a):e?d:null},Zd(a,b)},bg.layout.treemap=function(){function a(a,b){for(var c,d,e=-1,f=a.length;++e<f;)d=(c=a[e]).value*(0>b?0:b),c.area=isNaN(d)||0>=d?0:d}function b(c){var f=c.children;if(f&&f.length){var g,h,i,j=l(c),k=[],m=f.slice(),o=1/0,p="slice"===n?j.dx:"dice"===n?j.dy:"slice-dice"===n?1&c.depth?j.dy:j.dx:Math.min(j.dx,j.dy);for(a(m,j.dx*j.dy/c.value),k.area=0;(i=m.length)>0;)k.push(g=m[i-1]),k.area+=g.area,"squarify"!==n||(h=d(k,p))<=o?(m.pop(),o=h):(k.area-=k.pop().area,e(k,p,j,!1),p=Math.min(j.dx,j.dy),k.length=k.area=0,o=1/0);k.length&&(e(k,p,j,!0),k.length=k.area=0),f.forEach(b)}}function c(b){var d=b.children;if(d&&d.length){var f,g=l(b),h=d.slice(),i=[];for(a(h,g.dx*g.dy/b.value),i.area=0;f=h.pop();)i.push(f),i.area+=f.area,null!=f.z&&(e(i,f.z?g.dx:g.dy,g,!h.length),i.length=i.area=0);d.forEach(c)}}function d(a,b){for(var c,d=a.area,e=0,f=1/0,g=-1,h=a.length;++g<h;)(c=a[g].area)&&(f>c&&(f=c),c>e&&(e=c));return d*=d,b*=b,d?Math.max(b*e*o/d,d/(b*f*o)):1/0}function e(a,b,c,d){var e,f=-1,g=a.length,h=c.x,j=c.y,k=b?i(a.area/b):0;if(b==c.dx){for((d||k>c.dy)&&(k=c.dy);++f<g;)e=a[f],e.x=h,e.y=j,e.dy=k,h+=e.dx=Math.min(c.x+c.dx-h,k?i(e.area/k):0);e.z=!0,e.dx+=c.x+c.dx-h,c.y+=k,c.dy-=k}else{for((d||k>c.dx)&&(k=c.dx);++f<g;)e=a[f],e.x=h,e.y=j,e.dx=k,j+=e.dy=Math.min(c.y+c.dy-j,k?i(e.area/k):0);e.z=!1,e.dy+=c.y+c.dy-j,c.x+=k,c.dx-=k}}function f(d){var e=g||h(d),f=e[0];return f.x=0,f.y=0,f.dx=j[0],f.dy=j[1],g&&h.revalue(f),a([f],f.dx*f.dy/f.value),(g?c:b)(f),m&&(g=e),e}var g,h=bg.layout.hierarchy(),i=Math.round,j=[1,1],k=null,l=Ie,m=!1,n="squarify",o=.5*(1+Math.sqrt(5));return f.size=function(a){return arguments.length?(j=a,f):j},f.padding=function(a){function b(b){var c=a.call(f,b,b.depth);return null==c?Ie(b):Je(b,"number"==typeof c?[c,c,c,c]:c)}function c(b){return Je(b,a)}if(!arguments.length)return k;var d;return l=null==(k=a)?Ie:"function"==(d=typeof a)?b:"number"===d?(a=[a,a,a,a],c):c,f},f.round=function(a){return arguments.length?(i=a?Math.round:Number,f):i!=Number},f.sticky=function(a){return arguments.length?(m=a,g=null,f):m},f.ratio=function(a){return arguments.length?(o=a,f):o},f.mode=function(a){return arguments.length?(n=a+"",f):n},Zd(f,h)},bg.random={normal:function(a,b){var c=arguments.length;return 2>c&&(b=1),1>c&&(a=0),function(){var c,d,e;do c=2*Math.random()-1,d=2*Math.random()-1,e=c*c+d*d;while(!e||e>1);return a+b*c*Math.sqrt(-2*Math.log(e)/e)}},logNormal:function(){var a=bg.random.normal.apply(bg,arguments);return function(){return Math.exp(a())}},bates:function(a){var b=bg.random.irwinHall(a);return function(){return b()/a}},irwinHall:function(a){return function(){for(var b=0,c=0;a>c;c++)b+=Math.random();return b}}},bg.scale={};var ri={floor:s,ceil:s};bg.scale.linear=function(){return Qe([0,1],[0,1],rd,!1)};var si={s:1,g:1,p:1,r:1,e:1};bg.scale.log=function(){return Ye(bg.scale.linear().domain([0,1]),10,!0,[1,10])};var ti=bg.format(".0e"),ui={floor:function(a){return-Math.ceil(-a)},ceil:function(a){return-Math.floor(-a)}};bg.scale.pow=function(){return Ze(bg.scale.linear(),1,[0,1])},bg.scale.sqrt=function(){return bg.scale.pow().exponent(.5)},bg.scale.ordinal=function(){return _e([],{t:"range",a:[[]]})},bg.scale.category10=function(){return bg.scale.ordinal().range(vi)},bg.scale.category20=function(){return bg.scale.ordinal().range(wi)},bg.scale.category20b=function(){return bg.scale.ordinal().range(xi)},bg.scale.category20c=function(){return bg.scale.ordinal().range(yi)};var vi=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(ta),wi=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(ta),xi=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(ta),yi=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(ta);bg.scale.quantile=function(){return af([],[])},bg.scale.quantize=function(){return bf(0,1,[0,1])},bg.scale.threshold=function(){return cf([.5],[0,1])},bg.scale.identity=function(){return df([0,1])},bg.svg={},bg.svg.arc=function(){function a(){var a=Math.max(0,+c.apply(this,arguments)),j=Math.max(0,+d.apply(this,arguments)),k=g.apply(this,arguments)-Ig,l=h.apply(this,arguments)-Ig,m=Math.abs(l-k),n=k>l?0:1;if(a>j&&(o=j,j=a,a=o),m>=Hg)return b(j,n)+(a?b(a,1-n):"")+"Z";var o,p,q,r,s,t,u,v,w,x,y,z,A=0,B=0,C=[];if((r=(+i.apply(this,arguments)||0)/2)&&(q=f===zi?Math.sqrt(a*a+j*j):+f.apply(this,arguments),n||(B*=-1),j&&(B=ba(q/j*Math.sin(r))),a&&(A=ba(q/a*Math.sin(r)))),j){s=j*Math.cos(k+B),t=j*Math.sin(k+B),u=j*Math.cos(l-B),v=j*Math.sin(l-B);var D=Math.abs(l-k-2*B)<=Fg?0:1;if(B&&lf(s,t,u,v)===n^D){var E=(k+l)/2;s=j*Math.cos(E),t=j*Math.sin(E),u=v=null}}else s=t=0;if(a){w=a*Math.cos(l-A),x=a*Math.sin(l-A),y=a*Math.cos(k+A),z=a*Math.sin(k+A);var F=Math.abs(k-l+2*A)<=Fg?0:1;if(A&&lf(w,x,y,z)===1-n^F){var G=(k+l)/2;w=a*Math.cos(G),x=a*Math.sin(G),y=z=null}}else w=x=0;if((o=Math.min(Math.abs(j-a)/2,+e.apply(this,arguments)))>.001){p=j>a^n?0:1;var H=null==y?[w,x]:null==u?[s,t]:Gc([s,t],[y,z],[u,v],[w,x]),I=s-H[0],J=t-H[1],K=u-H[0],L=v-H[1],M=1/Math.sin(Math.acos((I*K+J*L)/(Math.sqrt(I*I+J*J)*Math.sqrt(K*K+L*L)))/2),N=Math.sqrt(H[0]*H[0]+H[1]*H[1]);if(null!=u){var O=Math.min(o,(j-N)/(M+1)),P=mf(null==y?[w,x]:[y,z],[s,t],j,O,n),Q=mf([u,v],[w,x],j,O,n);o===O?C.push("M",P[0],"A",O,",",O," 0 0,",p," ",P[1],"A",j,",",j," 0 ",1-n^lf(P[1][0],P[1][1],Q[1][0],Q[1][1]),",",n," ",Q[1],"A",O,",",O," 0 0,",p," ",Q[0]):C.push("M",P[0],"A",O,",",O," 0 1,",p," ",Q[0])}else C.push("M",s,",",t);if(null!=y){var R=Math.min(o,(a-N)/(M-1)),S=mf([s,t],[y,z],a,-R,n),T=mf([w,x],null==u?[s,t]:[u,v],a,-R,n);o===R?C.push("L",T[0],"A",R,",",R," 0 0,",p," ",T[1],"A",a,",",a," 0 ",n^lf(T[1][0],T[1][1],S[1][0],S[1][1]),",",1-n," ",S[1],"A",R,",",R," 0 0,",p," ",S[0]):C.push("L",T[0],"A",R,",",R," 0 0,",p," ",S[0])}else C.push("L",w,",",x)}else C.push("M",s,",",t),null!=u&&C.push("A",j,",",j," 0 ",D,",",n," ",u,",",v),C.push("L",w,",",x),null!=y&&C.push("A",a,",",a," 0 ",F,",",1-n," ",y,",",z);return C.push("Z"),C.join("")}function b(a,b){return"M0,"+a+"A"+a+","+a+" 0 1,"+b+" 0,"+-a+"A"+a+","+a+" 0 1,"+b+" 0,"+a}var c=ff,d=gf,e=ef,f=zi,g=hf,h=jf,i=kf;return a.innerRadius=function(b){return arguments.length?(c=Aa(b),a):c},a.outerRadius=function(b){return arguments.length?(d=Aa(b),a):d},a.cornerRadius=function(b){return arguments.length?(e=Aa(b),a):e},a.padRadius=function(b){return arguments.length?(f=b==zi?zi:Aa(b),a):f},a.startAngle=function(b){return arguments.length?(g=Aa(b),a):g},a.endAngle=function(b){return arguments.length?(h=Aa(b),a):h},a.padAngle=function(b){return arguments.length?(i=Aa(b),a):i},a.centroid=function(){var a=(+c.apply(this,arguments)+ +d.apply(this,arguments))/2,b=(+g.apply(this,arguments)+ +h.apply(this,arguments))/2-Ig;return[Math.cos(b)*a,Math.sin(b)*a]},a};var zi="auto";bg.svg.line=function(){return nf(s)};var Ai=bg.map({linear:of,"linear-closed":pf,step:qf,"step-before":rf,"step-after":sf,basis:yf,"basis-open":zf,"basis-closed":Af,bundle:Bf,cardinal:vf,"cardinal-open":tf,"cardinal-closed":uf,monotone:Hf});Ai.forEach(function(a,b){b.key=a,b.closed=/-closed$/.test(a)});var Bi=[0,2/3,1/3,0],Ci=[0,1/3,2/3,0],Di=[0,1/6,2/3,1/6];
bg.svg.line.radial=function(){var a=nf(If);return a.radius=a.x,delete a.x,a.angle=a.y,delete a.y,a},rf.reverse=sf,sf.reverse=rf,bg.svg.area=function(){return Jf(s)},bg.svg.area.radial=function(){var a=Jf(If);return a.radius=a.x,delete a.x,a.innerRadius=a.x0,delete a.x0,a.outerRadius=a.x1,delete a.x1,a.angle=a.y,delete a.y,a.startAngle=a.y0,delete a.y0,a.endAngle=a.y1,delete a.y1,a},bg.svg.chord=function(){function a(a,h){var i=b(this,f,a,h),j=b(this,g,a,h);return"M"+i.p0+d(i.r,i.p1,i.a1-i.a0)+(c(i,j)?e(i.r,i.p1,i.r,i.p0):e(i.r,i.p1,j.r,j.p0)+d(j.r,j.p1,j.a1-j.a0)+e(j.r,j.p1,i.r,i.p0))+"Z"}function b(a,b,c,d){var e=b.call(a,c,d),f=h.call(a,e,d),g=i.call(a,e,d)-Ig,k=j.call(a,e,d)-Ig;return{r:f,a0:g,a1:k,p0:[f*Math.cos(g),f*Math.sin(g)],p1:[f*Math.cos(k),f*Math.sin(k)]}}function c(a,b){return a.a0==b.a0&&a.a1==b.a1}function d(a,b,c){return"A"+a+","+a+" 0 "+ +(c>Fg)+",1 "+b}function e(a,b,c,d){return"Q 0,0 "+d}var f=rc,g=sc,h=Kf,i=hf,j=jf;return a.radius=function(b){return arguments.length?(h=Aa(b),a):h},a.source=function(b){return arguments.length?(f=Aa(b),a):f},a.target=function(b){return arguments.length?(g=Aa(b),a):g},a.startAngle=function(b){return arguments.length?(i=Aa(b),a):i},a.endAngle=function(b){return arguments.length?(j=Aa(b),a):j},a},bg.svg.diagonal=function(){function a(a,e){var f=b.call(this,a,e),g=c.call(this,a,e),h=(f.y+g.y)/2,i=[f,{x:f.x,y:h},{x:g.x,y:h},g];return i=i.map(d),"M"+i[0]+"C"+i[1]+" "+i[2]+" "+i[3]}var b=rc,c=sc,d=Lf;return a.source=function(c){return arguments.length?(b=Aa(c),a):b},a.target=function(b){return arguments.length?(c=Aa(b),a):c},a.projection=function(b){return arguments.length?(d=b,a):d},a},bg.svg.diagonal.radial=function(){var a=bg.svg.diagonal(),b=Lf,c=a.projection;return a.projection=function(a){return arguments.length?c(Mf(b=a)):b},a},bg.svg.symbol=function(){function a(a,d){return(Ei.get(b.call(this,a,d))||Pf)(c.call(this,a,d))}var b=Of,c=Nf;return a.type=function(c){return arguments.length?(b=Aa(c),a):b},a.size=function(b){return arguments.length?(c=Aa(b),a):c},a};var Ei=bg.map({circle:Pf,cross:function(a){var b=Math.sqrt(a/5)/2;return"M"+-3*b+","+-b+"H"+-b+"V"+-3*b+"H"+b+"V"+-b+"H"+3*b+"V"+b+"H"+b+"V"+3*b+"H"+-b+"V"+b+"H"+-3*b+"Z"},diamond:function(a){var b=Math.sqrt(a/(2*Gi)),c=b*Gi;return"M0,"+-b+"L"+c+",0 0,"+b+" "+-c+",0Z"},square:function(a){var b=Math.sqrt(a)/2;return"M"+-b+","+-b+"L"+b+","+-b+" "+b+","+b+" "+-b+","+b+"Z"},"triangle-down":function(a){var b=Math.sqrt(a/Fi),c=b*Fi/2;return"M0,"+c+"L"+b+","+-c+" "+-b+","+-c+"Z"},"triangle-up":function(a){var b=Math.sqrt(a/Fi),c=b*Fi/2;return"M0,"+-c+"L"+b+","+c+" "+-b+","+c+"Z"}});bg.svg.symbolTypes=Ei.keys();var Fi=Math.sqrt(3),Gi=Math.tan(30*Jg);wg.transition=function(a){for(var b,c,d=Hi||++Li,e=Uf(a),f=[],g=Ii||{time:Date.now(),ease:yd,delay:0,duration:250},h=-1,i=this.length;++h<i;){f.push(b=[]);for(var j=this[h],k=-1,l=j.length;++k<l;)(c=j[k])&&Vf(c,k,e,d,g),b.push(c)}return Rf(f,e,d)},wg.interrupt=function(a){return this.each(null==a?Ji:Qf(Uf(a)))};var Hi,Ii,Ji=Qf(Uf()),Ki=[],Li=0;Ki.call=wg.call,Ki.empty=wg.empty,Ki.node=wg.node,Ki.size=wg.size,bg.transition=function(a,b){return a&&a.transition?Hi?a.transition(b):a:bg.selection().transition(a)},bg.transition.prototype=Ki,Ki.select=function(a){var b,c,d,e=this.id,f=this.namespace,g=[];a=C(a);for(var h=-1,i=this.length;++h<i;){g.push(b=[]);for(var j=this[h],k=-1,l=j.length;++k<l;)(d=j[k])&&(c=a.call(d,d.__data__,k,h))?("__data__"in d&&(c.__data__=d.__data__),Vf(c,k,f,e,d[f][e]),b.push(c)):b.push(null)}return Rf(g,f,e)},Ki.selectAll=function(a){var b,c,d,e,f,g=this.id,h=this.namespace,i=[];a=D(a);for(var j=-1,k=this.length;++j<k;)for(var l=this[j],m=-1,n=l.length;++m<n;)if(d=l[m]){f=d[h][g],c=a.call(d,d.__data__,m,j),i.push(b=[]);for(var o=-1,p=c.length;++o<p;)(e=c[o])&&Vf(e,o,h,g,f),b.push(e)}return Rf(i,h,g)},Ki.filter=function(a){var b,c,d,e=[];"function"!=typeof a&&(a=P(a));for(var f=0,g=this.length;g>f;f++){e.push(b=[]);for(var c=this[f],h=0,i=c.length;i>h;h++)(d=c[h])&&a.call(d,d.__data__,h,f)&&b.push(d)}return Rf(e,this.namespace,this.id)},Ki.tween=function(a,b){var c=this.id,d=this.namespace;return arguments.length<2?this.node()[d][c].tween.get(a):R(this,null==b?function(b){b[d][c].tween.remove(a)}:function(e){e[d][c].tween.set(a,b)})},Ki.attr=function(a,b){function c(){this.removeAttribute(h)}function d(){this.removeAttributeNS(h.space,h.local)}function e(a){return null==a?c:(a+="",function(){var b,c=this.getAttribute(h);return c!==a&&(b=g(c,a),function(a){this.setAttribute(h,b(a))})})}function f(a){return null==a?d:(a+="",function(){var b,c=this.getAttributeNS(h.space,h.local);return c!==a&&(b=g(c,a),function(a){this.setAttributeNS(h.space,h.local,b(a))})})}if(arguments.length<2){for(b in a)this.attr(b,a[b]);return this}var g="transform"==a?Od:rd,h=bg.ns.qualify(a);return Sf(this,"attr."+a,b,h.local?f:e)},Ki.attrTween=function(a,b){function c(a,c){var d=b.call(this,a,c,this.getAttribute(e));return d&&function(a){this.setAttribute(e,d(a))}}function d(a,c){var d=b.call(this,a,c,this.getAttributeNS(e.space,e.local));return d&&function(a){this.setAttributeNS(e.space,e.local,d(a))}}var e=bg.ns.qualify(a);return this.tween("attr."+a,e.local?d:c)},Ki.style=function(a,c,d){function e(){this.style.removeProperty(a)}function f(c){return null==c?e:(c+="",function(){var e,f=b(this).getComputedStyle(this,null).getPropertyValue(a);return f!==c&&(e=rd(f,c),function(b){this.style.setProperty(a,e(b),d)})})}var g=arguments.length;if(3>g){if("string"!=typeof a){2>g&&(c="");for(d in a)this.style(d,a[d],c);return this}d=""}return Sf(this,"style."+a,c,f)},Ki.styleTween=function(a,c,d){function e(e,f){var g=c.call(this,e,f,b(this).getComputedStyle(this,null).getPropertyValue(a));return g&&function(b){this.style.setProperty(a,g(b),d)}}return arguments.length<3&&(d=""),this.tween("style."+a,e)},Ki.text=function(a){return Sf(this,"text",a,Tf)},Ki.remove=function(){var a=this.namespace;return this.each("end.transition",function(){var b;this[a].count<2&&(b=this.parentNode)&&b.removeChild(this)})},Ki.ease=function(a){var b=this.id,c=this.namespace;return arguments.length<1?this.node()[c][b].ease:("function"!=typeof a&&(a=bg.ease.apply(bg,arguments)),R(this,function(d){d[c][b].ease=a}))},Ki.delay=function(a){var b=this.id,c=this.namespace;return arguments.length<1?this.node()[c][b].delay:R(this,"function"==typeof a?function(d,e,f){d[c][b].delay=+a.call(d,d.__data__,e,f)}:(a=+a,function(d){d[c][b].delay=a}))},Ki.duration=function(a){var b=this.id,c=this.namespace;return arguments.length<1?this.node()[c][b].duration:R(this,"function"==typeof a?function(d,e,f){d[c][b].duration=Math.max(1,a.call(d,d.__data__,e,f))}:(a=Math.max(1,a),function(d){d[c][b].duration=a}))},Ki.each=function(a,b){var c=this.id,d=this.namespace;if(arguments.length<2){var e=Ii,f=Hi;try{Hi=c,R(this,function(b,e,f){Ii=b[d][c],a.call(b,b.__data__,e,f)})}finally{Ii=e,Hi=f}}else R(this,function(e){var f=e[d][c];(f.event||(f.event=bg.dispatch("start","end","interrupt"))).on(a,b)});return this},Ki.transition=function(){for(var a,b,c,d,e=this.id,f=++Li,g=this.namespace,h=[],i=0,j=this.length;j>i;i++){h.push(a=[]);for(var b=this[i],k=0,l=b.length;l>k;k++)(c=b[k])&&(d=c[g][e],Vf(c,k,g,f,{time:d.time,ease:d.ease,delay:d.delay+d.duration,duration:d.duration})),a.push(c)}return Rf(h,g,f)},bg.svg.axis=function(){function a(a){a.each(function(){var a,j=bg.select(this),k=this.__chart__||c,l=this.__chart__=c.copy(),m=null==i?l.ticks?l.ticks.apply(l,h):l.domain():i,n=null==b?l.tickFormat?l.tickFormat.apply(l,h):s:b,o=j.selectAll(".tick").data(m,l),p=o.enter().insert("g",".domain").attr("class","tick").style("opacity",Dg),q=bg.transition(o.exit()).style("opacity",Dg).remove(),r=bg.transition(o.order()).style("opacity",1),t=Math.max(e,0)+g,u=Le(l),v=j.selectAll(".domain").data([0]),w=(v.enter().append("path").attr("class","domain"),bg.transition(v));p.append("line"),p.append("text");var x,y,z,A,B=p.select("line"),C=r.select("line"),D=o.select("text").text(n),E=p.select("text"),F=r.select("text"),G="top"===d||"left"===d?-1:1;if("bottom"===d||"top"===d?(a=Wf,x="x",z="y",y="x2",A="y2",D.attr("dy",0>G?"0em":".71em").style("text-anchor","middle"),w.attr("d","M"+u[0]+","+G*f+"V0H"+u[1]+"V"+G*f)):(a=Xf,x="y",z="x",y="y2",A="x2",D.attr("dy",".32em").style("text-anchor",0>G?"end":"start"),w.attr("d","M"+G*f+","+u[0]+"H0V"+u[1]+"H"+G*f)),B.attr(A,G*e),E.attr(z,G*t),C.attr(y,0).attr(A,G*e),F.attr(x,0).attr(z,G*t),l.rangeBand){var H=l,I=H.rangeBand()/2;k=l=function(a){return H(a)+I}}else k.rangeBand?k=l:q.call(a,l,k);p.call(a,k,l),r.call(a,l,l)})}var b,c=bg.scale.linear(),d=Mi,e=6,f=6,g=3,h=[10],i=null;return a.scale=function(b){return arguments.length?(c=b,a):c},a.orient=function(b){return arguments.length?(d=b in Ni?b+"":Mi,a):d},a.ticks=function(){return arguments.length?(h=arguments,a):h},a.tickValues=function(b){return arguments.length?(i=b,a):i},a.tickFormat=function(c){return arguments.length?(b=c,a):b},a.tickSize=function(b){var c=arguments.length;return c?(e=+b,f=+arguments[c-1],a):e},a.innerTickSize=function(b){return arguments.length?(e=+b,a):e},a.outerTickSize=function(b){return arguments.length?(f=+b,a):f},a.tickPadding=function(b){return arguments.length?(g=+b,a):g},a.tickSubdivide=function(){return arguments.length&&a},a};var Mi="bottom",Ni={top:1,right:1,bottom:1,left:1};bg.svg.brush=function(){function a(b){b.each(function(){var b=bg.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",f).on("touchstart.brush",f),g=b.selectAll(".background").data([0]);g.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),b.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var h=b.selectAll(".resize").data(p,s);h.exit().remove(),h.enter().append("g").attr("class",function(a){return"resize "+a}).style("cursor",function(a){return Oi[a]}).append("rect").attr("x",function(a){return/[ew]$/.test(a)?-3:null}).attr("y",function(a){return/^[ns]/.test(a)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden"),h.style("display",a.empty()?"none":null);var i,l=bg.transition(b),m=bg.transition(g);j&&(i=Le(j),m.attr("x",i[0]).attr("width",i[1]-i[0]),d(l)),k&&(i=Le(k),m.attr("y",i[0]).attr("height",i[1]-i[0]),e(l)),c(l)})}function c(a){a.selectAll(".resize").attr("transform",function(a){return"translate("+l[+/e$/.test(a)]+","+m[+/^s/.test(a)]+")"})}function d(a){a.select(".extent").attr("x",l[0]),a.selectAll(".extent,.n>rect,.s>rect").attr("width",l[1]-l[0])}function e(a){a.select(".extent").attr("y",m[0]),a.selectAll(".extent,.e>rect,.w>rect").attr("height",m[1]-m[0])}function f(){function f(){32==bg.event.keyCode&&(D||(t=null,F[0]-=l[1],F[1]-=m[1],D=2),y())}function p(){32==bg.event.keyCode&&2==D&&(F[0]+=l[1],F[1]+=m[1],D=0,y())}function q(){var a=bg.mouse(v),b=!1;u&&(a[0]+=u[0],a[1]+=u[1]),D||(bg.event.altKey?(t||(t=[(l[0]+l[1])/2,(m[0]+m[1])/2]),F[0]=l[+(a[0]<t[0])],F[1]=m[+(a[1]<t[1])]):t=null),B&&r(a,j,0)&&(d(z),b=!0),C&&r(a,k,1)&&(e(z),b=!0),b&&(c(z),x({type:"brush",mode:D?"move":"resize"}))}function r(a,b,c){var d,e,f=Le(b),i=f[0],j=f[1],k=F[c],p=c?m:l,q=p[1]-p[0];return D&&(i-=k,j-=q+k),d=(c?o:n)?Math.max(i,Math.min(j,a[c])):a[c],D?e=(d+=k)+q:(t&&(k=Math.max(i,Math.min(j,2*t[c]-d))),d>k?(e=d,d=k):e=k),p[0]!=d||p[1]!=e?(c?h=null:g=null,p[0]=d,p[1]=e,!0):void 0}function s(){q(),z.style("pointer-events","all").selectAll(".resize").style("display",a.empty()?"none":null),bg.select("body").style("cursor",null),G.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),E(),x({type:"brushend"})}var t,u,v=this,w=bg.select(bg.event.target),x=i.of(v,arguments),z=bg.select(v),A=w.datum(),B=!/^(n|s)$/.test(A)&&j,C=!/^(e|w)$/.test(A)&&k,D=w.classed("extent"),E=X(v),F=bg.mouse(v),G=bg.select(b(v)).on("keydown.brush",f).on("keyup.brush",p);if(bg.event.changedTouches?G.on("touchmove.brush",q).on("touchend.brush",s):G.on("mousemove.brush",q).on("mouseup.brush",s),z.interrupt().selectAll("*").interrupt(),D)F[0]=l[0]-F[0],F[1]=m[0]-F[1];else if(A){var H=+/w$/.test(A),I=+/^n/.test(A);u=[l[1-H]-F[0],m[1-I]-F[1]],F[0]=l[H],F[1]=m[I]}else bg.event.altKey&&(t=F.slice());z.style("pointer-events","none").selectAll(".resize").style("display",null),bg.select("body").style("cursor",w.style("cursor")),x({type:"brushstart"}),q()}var g,h,i=A(a,"brushstart","brush","brushend"),j=null,k=null,l=[0,0],m=[0,0],n=!0,o=!0,p=Pi[0];return a.event=function(a){a.each(function(){var a=i.of(this,arguments),b={x:l,y:m,i:g,j:h},c=this.__chart__||b;this.__chart__=b,Hi?bg.select(this).transition().each("start.brush",function(){g=c.i,h=c.j,l=c.x,m=c.y,a({type:"brushstart"})}).tween("brush:brush",function(){var c=sd(l,b.x),d=sd(m,b.y);return g=h=null,function(e){l=b.x=c(e),m=b.y=d(e),a({type:"brush",mode:"resize"})}}).each("end.brush",function(){g=b.i,h=b.j,a({type:"brush",mode:"resize"}),a({type:"brushend"})}):(a({type:"brushstart"}),a({type:"brush",mode:"resize"}),a({type:"brushend"}))})},a.x=function(b){return arguments.length?(j=b,p=Pi[!j<<1|!k],a):j},a.y=function(b){return arguments.length?(k=b,p=Pi[!j<<1|!k],a):k},a.clamp=function(b){return arguments.length?(j&&k?(n=!!b[0],o=!!b[1]):j?n=!!b:k&&(o=!!b),a):j&&k?[n,o]:j?n:k?o:null},a.extent=function(b){var c,d,e,f,i;return arguments.length?(j&&(c=b[0],d=b[1],k&&(c=c[0],d=d[0]),g=[c,d],j.invert&&(c=j(c),d=j(d)),c>d&&(i=c,c=d,d=i),c==l[0]&&d==l[1]||(l=[c,d])),k&&(e=b[0],f=b[1],j&&(e=e[1],f=f[1]),h=[e,f],k.invert&&(e=k(e),f=k(f)),e>f&&(i=e,e=f,f=i),e==m[0]&&f==m[1]||(m=[e,f])),a):(j&&(g?(c=g[0],d=g[1]):(c=l[0],d=l[1],j.invert&&(c=j.invert(c),d=j.invert(d)),c>d&&(i=c,c=d,d=i))),k&&(h?(e=h[0],f=h[1]):(e=m[0],f=m[1],k.invert&&(e=k.invert(e),f=k.invert(f)),e>f&&(i=e,e=f,f=i))),j&&k?[[c,e],[d,f]]:j?[c,d]:k&&[e,f])},a.clear=function(){return a.empty()||(l=[0,0],m=[0,0],g=h=null),a},a.empty=function(){return!!j&&l[0]==l[1]||!!k&&m[0]==m[1]},bg.rebind(a,i,"on")};var Oi={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},Pi=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]],Qi=hh.format=nh.timeFormat,Ri=Qi.utc,Si=Ri("%Y-%m-%dT%H:%M:%S.%LZ");Qi.iso=Date.prototype.toISOString&&+new Date("2000-01-01T00:00:00.000Z")?Yf:Si,Yf.parse=function(a){var b=new Date(a);return isNaN(b)?null:b},Yf.toString=Si.toString,hh.second=Na(function(a){return new ih(1e3*Math.floor(a/1e3))},function(a,b){a.setTime(a.getTime()+1e3*Math.floor(b))},function(a){return a.getSeconds()}),hh.seconds=hh.second.range,hh.seconds.utc=hh.second.utc.range,hh.minute=Na(function(a){return new ih(6e4*Math.floor(a/6e4))},function(a,b){a.setTime(a.getTime()+6e4*Math.floor(b))},function(a){return a.getMinutes()}),hh.minutes=hh.minute.range,hh.minutes.utc=hh.minute.utc.range,hh.hour=Na(function(a){var b=a.getTimezoneOffset()/60;return new ih(36e5*(Math.floor(a/36e5-b)+b))},function(a,b){a.setTime(a.getTime()+36e5*Math.floor(b))},function(a){return a.getHours()}),hh.hours=hh.hour.range,hh.hours.utc=hh.hour.utc.range,hh.month=Na(function(a){return a=hh.day(a),a.setDate(1),a},function(a,b){a.setMonth(a.getMonth()+b)},function(a){return a.getMonth()}),hh.months=hh.month.range,hh.months.utc=hh.month.utc.range;var Ti=[1e3,5e3,15e3,3e4,6e4,3e5,9e5,18e5,36e5,108e5,216e5,432e5,864e5,1728e5,6048e5,2592e6,7776e6,31536e6],Ui=[[hh.second,1],[hh.second,5],[hh.second,15],[hh.second,30],[hh.minute,1],[hh.minute,5],[hh.minute,15],[hh.minute,30],[hh.hour,1],[hh.hour,3],[hh.hour,6],[hh.hour,12],[hh.day,1],[hh.day,2],[hh.week,1],[hh.month,1],[hh.month,3],[hh.year,1]],Vi=Qi.multi([[".%L",function(a){return a.getMilliseconds()}],[":%S",function(a){return a.getSeconds()}],["%I:%M",function(a){return a.getMinutes()}],["%I %p",function(a){return a.getHours()}],["%a %d",function(a){return a.getDay()&&1!=a.getDate()}],["%b %d",function(a){return 1!=a.getDate()}],["%B",function(a){return a.getMonth()}],["%Y",Cb]]),Wi={range:function(a,b,c){return bg.range(Math.ceil(a/c)*c,+b,c).map($f)},floor:s,ceil:s};Ui.year=hh.year,hh.scale=function(){return Zf(bg.scale.linear(),Ui,Vi)};var Xi=Ui.map(function(a){return[a[0].utc,a[1]]}),Yi=Ri.multi([[".%L",function(a){return a.getUTCMilliseconds()}],[":%S",function(a){return a.getUTCSeconds()}],["%I:%M",function(a){return a.getUTCMinutes()}],["%I %p",function(a){return a.getUTCHours()}],["%a %d",function(a){return a.getUTCDay()&&1!=a.getUTCDate()}],["%b %d",function(a){return 1!=a.getUTCDate()}],["%B",function(a){return a.getUTCMonth()}],["%Y",Cb]]);Xi.year=hh.year.utc,hh.scale.utc=function(){return Zf(bg.scale.linear(),Xi,Yi)},bg.text=Ba(function(a){return a.responseText}),bg.json=function(a,b){return Ca(a,"application/json",_f,b)},bg.html=function(a,b){return Ca(a,"text/html",ag,b)},bg.xml=Ba(function(a){return a.responseXML}),"function"==typeof define&&define.amd?define(bg):"object"==typeof module&&module.exports&&(module.exports=bg),this.d3=bg}(),function(){function a(a,c){return{type:"Feature",id:a.id,properties:a.properties,geometry:b(a.geometry,c)}}function b(a,c){if(!a)return null;if("GeometryCollection"===a.type)return{type:"GeometryCollection",geometries:object.geometries.map(function(a){return b(a,c)})};if(!ob.hasOwnProperty(a.type))return null;var d=ob[a.type];return d3.geo.stream(a,c(d)),d.result()}function c(){}function d(a){if((b=a.length)<4)return!1;for(var b,c=0,d=a[b-1][1]*a[0][0]-a[b-1][0]*a[0][1];++c<b;)d+=a[c-1][1]*a[c][0]-a[c-1][0]*a[c][1];return 0>=d}function e(a,b){for(var c=b[0],d=b[1],e=!1,f=0,g=a.length,h=g-1;g>f;h=f++){var i=a[f],j=i[0],k=i[1],l=a[h],m=l[0],n=l[1];k>d^n>d&&(m-j)*(d-k)/(n-k)+j>c&&(e=!e)}return e}function f(a){return a?a/Math.sin(a):1}function g(a){return a>0?1:0>a?-1:0}function h(a){return a>1?sb:-1>a?-sb:Math.asin(a)}function i(a){return a>1?0:-1>a?rb:Math.acos(a)}function j(a){return a>0?Math.sqrt(a):0}function k(a){function b(a,b){var c=Math.cos(a),e=Math.cos(b),f=Math.sin(b),g=e*c,h=-((1-g?Math.log(.5*(1+g))/(1-g):-.5)+d/(1+g));return[h*e*Math.sin(a),h*f]}var c=Math.tan(.5*a),d=2*Math.log(Math.cos(.5*a))/(c*c);return b.invert=function(b,c){var e,f=Math.sqrt(b*b+c*c),g=a*-.5,i=50;if(!f)return[0,0];do{var j=.5*g,k=Math.cos(j),l=Math.sin(j),m=Math.tan(j),n=Math.log(1/k);g-=e=(2/m*n-d*m-f)/(-n/(l*l)+1-d/(2*k*k))}while(Math.abs(e)>pb&&--i>0);var o=Math.sin(g);return[Math.atan2(b*o,f*Math.cos(g)),h(c*o/f)]},b}function l(){var a=sb,b=xb(k),c=b(a);return c.radius=function(c){return arguments.length?b(a=c*rb/180):a/rb*180},c}function m(a,b){var c=Math.cos(b),d=f(i(c*Math.cos(a/=2)));return[2*c*Math.sin(a)*d,Math.sin(b)*d]}function n(a){function b(a,b){var h=Math.cos(b),i=Math.cos(a/=2);return[(1+h)*Math.sin(a),(e*b>-Math.atan2(i,f)-.001?0:10*-e)+g+Math.sin(b)*d-(1+h)*c*i]}var c=Math.sin(a),d=Math.cos(a),e=a>0?1:-1,f=Math.tan(e*a),g=(1+c-d)/2;return b.invert=function(a,b){var h=0,i=0,j=50;do{var k=Math.cos(h),l=Math.sin(h),m=Math.cos(i),n=Math.sin(i),o=1+m,p=o*l-a,q=g+n*d-o*c*k-b,r=.5*o*k,s=-l*n,t=.5*c*o*l,u=d*m+c*k*n,v=s*t-u*r,w=.5*(q*s-p*u)/v,x=(p*t-q*r)/v;h-=w,i-=x}while((Math.abs(w)>pb||Math.abs(x)>pb)&&--j>0);return e*i>-Math.atan2(Math.cos(h),f)-.001?[2*h,i]:null},b}function o(){var a=rb/9,b=a>0?1:-1,c=Math.tan(b*a),d=xb(n),e=d(a),f=e.stream;return e.parallel=function(e){return arguments.length?(c=Math.tan((b=(a=e*rb/180)>0?1:-1)*a),d(a)):a/rb*180},e.stream=function(d){var g=e.rotate(),h=f(d),i=(e.rotate([0,0]),f(d));return e.rotate(g),h.sphere=function(){i.polygonStart(),i.lineStart();for(var d=-180*b;180>b*d;d+=90*b)i.point(d,90*b);for(;b*(d-=a)>=-180;)i.point(d,b*-Math.atan2(Math.cos(d*ub/2),c)*vb);i.lineEnd(),i.polygonEnd()},h},e}function p(a){return a=Math.exp(2*a),(a-1)/(a+1)}function q(a){return.5*(Math.exp(a)-Math.exp(-a))}function r(a){return.5*(Math.exp(a)+Math.exp(-a))}function s(a){return Math.log(a+j(a*a+1))}function t(a){return Math.log(a+j(a*a-1))}function u(a,b){var c=Math.tan(b/2),d=j(1-c*c),e=1+d*Math.cos(a/=2),f=Math.sin(a)*d/e,g=c/e,h=f*f,i=g*g;return[4/3*f*(3+h-3*i),4/3*g*(3+3*h-i)]}function v(a,b){var c=Math.abs(b);return rb/4>c?[a,Math.log(Math.tan(rb/4+b/2))]:[a*Math.cos(c)*(2*Math.SQRT2-1/Math.sin(c)),g(b)*(2*Math.SQRT2*(c-rb/4)-Math.log(Math.tan(c/2)))]}function w(a){function b(a,b){var d=zb(a,b);if(Math.abs(a)>sb){var e=Math.atan2(d[1],d[0]),f=Math.sqrt(d[0]*d[0]+d[1]*d[1]),g=c*Math.round((e-sb)/c)+sb,i=Math.atan2(Math.sin(e-=g),2-Math.cos(e));e=g+h(rb/f*Math.sin(i))-i,d[0]=f*Math.cos(e),d[1]=f*Math.sin(e)}return d}var c=2*rb/a;return b.invert=function(a,b){var d=Math.sqrt(a*a+b*b);if(d>sb){var e=Math.atan2(b,a),f=c*Math.round((e-sb)/c)+sb,g=e>f?-1:1,h=d*Math.cos(f-e),i=1/Math.tan(g*Math.acos((h-rb)/Math.sqrt(rb*(rb-2*h)+d*d)));e=f+2*Math.atan((i+g*Math.sqrt(i*i-3))/3),a=d*Math.cos(e),b=d*Math.sin(e)}return zb.invert(a,b)},b}function x(){var a=5,b=xb(w),c=b(a),d=c.stream,e=.01,f=-Math.cos(e*ub),g=Math.sin(e*ub);return c.lobes=function(c){return arguments.length?b(a=+c):a},c.stream=function(b){var i=c.rotate(),j=d(b),k=(c.rotate([0,0]),d(b));return c.rotate(i),j.sphere=function(){k.polygonStart(),k.lineStart();for(var b=0,c=360/a,d=2*rb/a,i=90-180/a,j=sb;a>b;++b,i-=c,j-=d)k.point(Math.atan2(g*Math.cos(j),f)*vb,h(g*Math.sin(j))*vb),-90>i?(k.point(-90,-180-i-e),k.point(-90,-180-i+e)):(k.point(90,i+e),k.point(90,i-e));k.lineEnd(),k.polygonEnd()},j},c}function y(a){return function(b){var c,d=a*Math.sin(b),e=30;do b-=c=(b+Math.sin(b)-d)/(1+Math.cos(b));while(Math.abs(c)>pb&&--e>0);return b/2}}function z(a,b,c){function d(c,d){return[a*c*Math.cos(d=e(d)),b*Math.sin(d)]}var e=y(c);return d.invert=function(d,e){var f=h(e/b);return[d/(a*Math.cos(f)),h((2*f+Math.sin(2*f))/c)]},d}function A(a,b){var c=2.00276,d=Ab(b);return[c*a/(1/Math.cos(b)+1.11072/Math.cos(d)),(b+Math.SQRT2*Math.sin(d))/c]}function B(a){var b=0,c=xb(a),d=c(b);return d.parallel=function(a){return arguments.length?c(b=a*rb/180):b/rb*180},d}function C(a,b){return[a*Math.cos(b),b]}function D(a){function b(b,d){var e=c+a-d,f=e?b*Math.cos(d)/e:e;return[e*Math.sin(f),c-e*Math.cos(f)]}if(!a)return C;var c=1/Math.tan(a);return b.invert=function(b,d){var e=Math.sqrt(b*b+(d=c-d)*d),f=c+a-e;return[e/Math.cos(f)*Math.atan2(b,d),f]},b}function E(a){function b(a,b){var d=sb-b,e=d?a*c*Math.sin(d)/d:d;return[d*Math.sin(e)/c,sb-d*Math.cos(e)]}var c=Math.sin(a);return b.invert=function(a,b){var d=a*c,e=sb-b,f=Math.sqrt(d*d+e*e),g=Math.atan2(d,e);return[(f?f/Math.sin(f):1)*g/c,sb-f]},b}function F(a){function b(b,c){for(var d=Math.sin(c),e=Math.cos(c),f=new Array(3),j=0;3>j;++j){var k=a[j];if(f[j]=H(c-k[1],k[3],k[2],e,d,b-k[0]),!f[j][0])return k.point;f[j][1]=J(f[j][1]-k.v[1])}for(var l=i.slice(),j=0;3>j;++j){var m=2==j?0:j+1,n=I(a[j].v[0],f[j][0],f[m][0]);f[j][1]<0&&(n=-n),j?1==j?(n=g-n,l[0]-=f[j][0]*Math.cos(n),l[1]-=f[j][0]*Math.sin(n)):(n=h-n,l[0]+=f[j][0]*Math.cos(n),l[1]+=f[j][0]*Math.sin(n)):(l[0]+=f[j][0]*Math.cos(n),l[1]-=f[j][0]*Math.sin(n))}return l[0]/=3,l[1]/=3,l}a=a.map(function(a){return[a[0],a[1],Math.sin(a[1]),Math.cos(a[1])]});for(var c,d=a[2],e=0;3>e;++e,d=c)c=a[e],d.v=H(c[1]-d[1],d[3],d[2],c[3],c[2],c[0]-d[0]),d.point=[0,0];var f=I(a[0].v[0],a[2].v[0],a[1].v[0]),g=I(a[0].v[0],a[1].v[0],a[2].v[0]),h=rb-f;a[2].point[1]=0,a[0].point[0]=-(a[1].point[0]=.5*a[0].v[0]);var i=[a[2].point[0]=a[0].point[0]+a[2].v[0]*Math.cos(f),2*(a[0].point[1]=a[1].point[1]=a[2].v[0]*Math.sin(f))];return b}function G(){var a=[[0,0],[0,0],[0,0]],b=xb(F),c=b(a),d=c.rotate;return delete c.rotate,c.points=function(e){if(!arguments.length)return a;a=e;var f=d3.geo.centroid({type:"MultiPoint",coordinates:a}),g=[-f[0],-f[1]];return d.call(c,g),b(a.map(d3.geo.rotation(g)).map(K))},c.points([[-150,55],[-35,55],[-92.5,10]])}function H(a,b,c,d,e,f){var g,j=Math.cos(f);if(Math.abs(a)>1||Math.abs(f)>1)g=i(c*e+b*d*j);else{var k=Math.sin(.5*a),l=Math.sin(.5*f);g=2*h(Math.sqrt(k*k+b*d*l*l))}return Math.abs(g)>pb?[g,Math.atan2(d*Math.sin(f),b*e-c*d*j)]:[0,0]}function I(a,b,c){return i(.5*(a*a+b*b-c*c)/(a*b))}function J(a){return a-2*rb*Math.floor((a+rb)/(2*rb))}function K(a){return[a[0]*ub,a[1]*ub]}function L(a,b){var c=j(1-Math.sin(b));return[2/tb*a*c,tb*(1-c)]}function M(a){function b(a,b){return[a,(a?a/Math.sin(a):1)*(Math.sin(b)*Math.cos(a)-c*Math.cos(b))]}var c=Math.tan(a);return b.invert=c?function(a,b){a&&(b*=Math.sin(a)/a);var d=Math.cos(a);return[a,2*Math.atan2(Math.sqrt(d*d+c*c-b*b)-d,c-b)]}:function(a,b){return[a,h(a?b*Math.tan(a)/a:b)]},b}function N(a,b){var c=Math.sqrt(3);return[c*a*(2*Math.cos(2*b/3)-1)/tb,c*tb*Math.sin(b/3)]}function O(a){function b(a,b){return[a*c,Math.sin(b)/c]}var c=Math.cos(a);return b.invert=function(a,b){return[a/c,h(b*c)]},b}function P(a){function b(a,b){return[a*c,(1+c)*Math.tan(.5*b)]}var c=Math.cos(a);return b.invert=function(a,b){return[a/c,2*Math.atan(b/(1+c))]},b}function Q(a,b){var c=Math.sqrt(8/(3*rb));return[c*a*(1-Math.abs(b)/rb),c*b]}function R(a,b){var c=Math.sqrt(4-3*Math.sin(Math.abs(b)));return[2/Math.sqrt(6*rb)*a*c,g(b)*Math.sqrt(2*rb/3)*(2-c)]}function S(a,b){var c=Math.sqrt(rb*(4+rb));return[2/c*a*(1+Math.sqrt(1-4*b*b/(rb*rb))),4/c*b]}function T(a,b){var c=(2+sb)*Math.sin(b);b/=2;for(var d=0,e=1/0;10>d&&Math.abs(e)>pb;d++){var f=Math.cos(b);b-=e=(b+Math.sin(b)*(f+2)-c)/(2*f*(1+f))}return[2/Math.sqrt(rb*(4+rb))*a*(1+Math.cos(b)),2*Math.sqrt(rb/(4+rb))*Math.sin(b)]}function U(a,b){return[a*(1+Math.cos(b))/Math.sqrt(2+rb),2*b/Math.sqrt(2+rb)]}function V(a,b){for(var c=(1+sb)*Math.sin(b),d=0,e=1/0;10>d&&Math.abs(e)>pb;d++)b-=e=(b+Math.sin(b)-c)/(1+Math.cos(b));return c=Math.sqrt(2+rb),[a*(1+Math.cos(b))/c,2*b/c]}function W(a,b){var c=Math.sin(a/=2),d=Math.cos(a),e=Math.sqrt(Math.cos(b)),f=Math.cos(b/=2),g=Math.sin(b)/(f+Math.SQRT2*d*e),h=Math.sqrt(2/(1+g*g)),i=Math.sqrt((Math.SQRT2*f+(d+c)*e)/(Math.SQRT2*f+(d-c)*e));return[Db*(h*(i-1/i)-2*Math.log(i)),Db*(h*g*(i+1/i)-2*Math.atan(g))]}function X(a,b){var c=Math.tan(b/2);return[a*Eb*j(1-c*c),(1+Eb)*c]}function Y(a,b){var c=b/2,d=Math.cos(c);return[2*a/tb*Math.cos(b)*d*d,tb*Math.tan(c)]}function Z(a,b){function c(b,c){var f=Fb(b,c),g=f[0],h=f[1],i=g*g+h*h;if(i>e){var j=Math.sqrt(i),k=Math.atan2(h,g),l=d*Math.round(k/d),m=k-l,n=a*Math.cos(m),o=(a*Math.sin(m)-m*Math.sin(n))/(sb-n),p=$(m,o),q=(rb-a)/aa(p,n,rb);g=j;var r,s=50;do g-=r=(a+aa(p,n,g)*q-j)/(p(g)*q);while(Math.abs(r)>pb&&--s>0);h=m*Math.sin(g),sb>g&&(h-=o*(g-sb));var t=Math.sin(l),u=Math.cos(l);f[0]=g*u-h*t,f[1]=g*t+h*u}return f}var d=2*rb/b,e=a*a;return c.invert=function(b,c){var f=b*b+c*c;if(f>e){var g=Math.sqrt(f),h=Math.atan2(c,b),i=d*Math.round(h/d),j=h-i,b=g*Math.cos(j);c=g*Math.sin(j);for(var k=b-sb,l=Math.sin(b),m=c/l,n=sb>b?1/0:0,o=10;;){var p=a*Math.sin(m),q=a*Math.cos(m),r=Math.sin(q),s=sb-q,t=(p-m*r)/s,u=$(m,t);if(Math.abs(n)<qb||!--o)break;m-=n=(m*l-t*k-c)/(l-2*k*(s*(q+m*p*Math.cos(q)-r)-p*(p-m*r))/(s*s))}g=a+aa(u,q,b)*(rb-a)/aa(u,q,rb),h=i+m,b=g*Math.cos(h),c=g*Math.sin(h)}return Fb.invert(b,c)},c}function $(a,b){return function(c){var d=a*Math.cos(c);return sb>c&&(d-=b),Math.sqrt(1+d*d)}}function _(){var a=6,b=30*ub,c=Math.cos(b),d=Math.sin(b),e=xb(Z),f=e(b,a),g=f.stream,h=.01,i=-Math.cos(h*ub),j=Math.sin(h*ub);return f.radius=function(f){return arguments.length?(c=Math.cos(b=f*ub),d=Math.sin(b),e(b,a)):b*vb},f.lobes=function(c){return arguments.length?e(b,a=+c):a},f.stream=function(b){var e=f.rotate(),h=g(b),k=(f.rotate([0,0]),g(b));return f.rotate(e),h.sphere=function(){k.polygonStart(),k.lineStart();for(var b=0,e=2*rb/a,f=0;a>b;++b,f-=e)k.point(Math.atan2(j*Math.cos(f),i)*vb,Math.asin(j*Math.sin(f))*vb),k.point(Math.atan2(d*Math.cos(f-e/2),c)*vb,Math.asin(d*Math.sin(f-e/2))*vb);k.lineEnd(),k.polygonEnd()},h},f}function aa(a,b,c){for(var d=50,e=(c-b)/d,f=a(b)+a(c),g=1,h=b;d>g;++g)f+=2*a(h+=e);return.5*f*e}function ba(a,b,c,d,e,f,g,h){function i(i,j){if(!j)return[a*i/rb,0];var k=j*j,l=a+k*(b+k*(c+k*d)),m=j*(e-1+k*(f-h+k*g)),n=(l*l+m*m)/(2*m),o=i*Math.asin(l/n)/rb;return[n*Math.sin(o),j*(1+k*h)+n*(1-Math.cos(o))]}return arguments.length<8&&(h=0),i.invert=function(i,k){var l,m,n=rb*i/a,o=k,p=50;do{var q=o*o,r=a+q*(b+q*(c+q*d)),s=o*(e-1+q*(f-h+q*g)),t=r*r+s*s,u=2*s,v=t/u,w=v*v,x=Math.asin(r/v)/rb,y=n*x;if(xB2=r*r,dxBdφ=(2*b+q*(4*c+6*q*d))*o,dyBdφ=e+q*(3*f+5*q*g),dpdφ=2*(r*dxBdφ+s*(dyBdφ-1)),dqdφ=2*(dyBdφ-1),dmdφ=(dpdφ*u-t*dqdφ)/(u*u),cosα=Math.cos(y),sinα=Math.sin(y),mcosα=v*cosα,msinα=v*sinα,dαdφ=n/rb*(1/j(1-xB2/w))*(dxBdφ*v-r*dmdφ)/w,fx=msinα-i,fy=o*(1+q*h)+v-mcosα-k,δxδφ=dmdφ*sinα+mcosα*dαdφ,δxδλ=mcosα*x,δyδφ=1+dmdφ-(dmdφ*cosα-msinα*dαdφ),δyδλ=msinα*x,denominator=δxδφ*δyδλ-δyδφ*δxδλ,!denominator)break;n-=l=(fy*δxδφ-fx*δyδφ)/denominator,o-=m=(fx*δyδλ-fy*δxδλ)/denominator}while((Math.abs(l)>pb||Math.abs(m)>pb)&&--p>0);return[n,o]},i}function ca(a,b){var c=a*a,d=b*b;return[a*(1-.162388*d)*(.87-952426e-9*c*c),b*(1+d/12)]}function da(a){function b(){var a=!1,b=xb(c),d=b(a);return d.quincuncial=function(c){return arguments.length?b(a=!!c):a},d}function c(b){var c=b?function(b,c){var e=Math.abs(b)<sb,f=a(e?b:b>0?b-rb:b+rb,c),h=(f[0]-f[1])*Math.SQRT1_2,i=(f[0]+f[1])*Math.SQRT1_2;if(e)return[h,i];var j=d*Math.SQRT1_2,k=h>0^i>0?-1:1;return[k*h-g(i)*j,k*i-g(h)*j]}:function(b,c){var e=b>0?-.5:.5,f=a(b+e*rb,c);return f[0]-=e*d,f};return a.invert&&(c.invert=b?function(b,c){var e=(b+c)*Math.SQRT1_2,f=(c-b)*Math.SQRT1_2,g=Math.abs(e)<.5*d&&Math.abs(f)<.5*d;if(!g){var h=d*Math.SQRT1_2,i=e>0^f>0?-1:1,j=-i*(b+(f>0?1:-1)*h),k=-i*(c+(e>0?1:-1)*h);e=(-j-k)*Math.SQRT1_2,f=(j-k)*Math.SQRT1_2}var l=a.invert(e,f);return g||(l[0]+=e>0?rb:-rb),l}:function(b,c){var e=b>0?-.5:.5,f=a.invert(b+e*d,c),g=f[0]-e*rb;return-rb>g?g+=2*rb:g>rb&&(g-=2*rb),f[0]=g,f}),c}var d=a(sb,0)[0]-a(-sb,0)[0];return b.raw=c,b}function ea(a,b){var c=g(a),d=g(b),e=Math.cos(b),f=Math.cos(a)*e,i=Math.sin(a)*e,j=Math.sin(d*b);a=Math.abs(Math.atan2(i,j)),b=h(f),Math.abs(a-sb)>pb&&(a%=sb);var k=fa(a>rb/4?sb-a:a,b);return a>rb/4&&(j=k[0],k[0]=-k[1],k[1]=-j),k[0]*=c,k[1]*=-d,k}function fa(a,b){if(b===sb)return[0,0];var c=Math.sin(b),d=c*c,e=d*d,f=1+e,g=1+3*e,i=1-e,k=h(1/Math.sqrt(f)),l=i+d*f*k,m=(1-c)/l,n=Math.sqrt(m),o=m*f,p=Math.sqrt(o),q=n*i;if(0===a)return[0,-(q+d*p)];var r=Math.cos(b),s=1/r,t=2*c*r,u=(-3*d+k*g)*t,v=(-l*r-(1-c)*u)/(l*l),w=.5*v/n,x=i*w-2*d*n*t,y=d*f*v+m*g*t,z=-s*t,A=-s*y,B=-2*s*x,C=4*a/rb;if(a>.222*rb||rb/4>b&&a>.175*rb){var D=(q+d*j(o*(1+e)-q*q))/(1+e);if(a>rb/4)return[D,D];var E=D,F=.5*D,G=50;D=.5*(F+E);do{var H=Math.sqrt(o-D*D),I=D*(B+z*H)+A*h(D/p)-C;if(!I)break;0>I?F=D:E=D,D=.5*(F+E)}while(Math.abs(E-F)>pb&&--G>0)}else{var J,D=pb,G=25;do{var K=D*D,H=j(o-K),L=B+z*H,I=D*L+A*h(D/p)-C,M=L+(A-z*K)/H;D-=J=H?I/M:0}while(Math.abs(J)>pb&&--G>0)}return[D,-q-d*j(o-D*D)]}function ga(a,b){for(var c=0,d=1,e=.5,f=50;;){var g=e*e,h=Math.sqrt(e),i=Math.asin(1/Math.sqrt(1+g)),j=1-g+e*(1+g)*i,k=(1-h)/j,l=Math.sqrt(k),m=k*(1+g),n=l*(1-g),o=m-a*a,p=Math.sqrt(o),q=b+n+e*p;if(Math.abs(d-c)<qb||0===--f||0===q)break;q>0?c=e:d=e,e=.5*(c+d)}if(!f)return null;var r=Math.asin(h),s=Math.cos(r),t=1/s,u=2*h*s,v=(-3*e+i*(1+3*g))*u,w=(-j*s-(1-h)*v)/(j*j),x=.5*w/l,y=(1-g)*x-2*e*l*u,z=-2*t*y,A=-t*u,B=-t*(e*(1+g)*w+k*(1+3*g)*u);return[rb/4*(a*(z+A*p)+B*Math.asin(a/Math.sqrt(m))),r]}function ha(a,b,c){if(!a){var d=ia(b,1-c);return[[0,d[0]/d[1]],[1/d[1],0],[d[2]/d[1],0]]}var e=ia(a,c);if(!b)return[[e[0],0],[e[1],0],[e[2],0]];var d=ia(b,1-c),f=d[1]*d[1]+c*e[0]*e[0]*d[0]*d[0];return[[e[0]*d[2]/f,e[1]*e[2]*d[0]*d[1]/f],[e[1]*d[1]/f,-e[0]*e[2]*d[0]*d[2]/f],[e[2]*d[1]*d[2]/f,-c*e[0]*e[1]*d[0]/f]]}function ia(a,b){var c,d,e,f,g;if(pb>b)return f=Math.sin(a),d=Math.cos(a),c=.25*b*(a-f*d),[f-c*d,d+c*f,1-.5*b*f*f,a-c];if(b>=1-pb)return c=.25*(1-b),d=r(a),f=p(a),e=1/d,g=d*q(a),[f+c*(g-a)/(d*d),e-c*f*e*(g-a),e+c*f*e*(g+a),2*Math.atan(Math.exp(a))-sb+c*(g-a)/d];var i=[1,0,0,0,0,0,0,0,0],k=[Math.sqrt(b),0,0,0,0,0,0,0,0],l=0;for(d=Math.sqrt(1-b),g=1;Math.abs(k[l]/i[l])>pb&&8>l;)c=i[l++],k[l]=.5*(c-d),i[l]=.5*(c+d),d=j(c*d),g*=2;e=g*i[l]*a;do f=k[l]*Math.sin(d=e)/i[l],e=.5*(h(f)+e);while(--l);return[Math.sin(e),f=Math.cos(e),f/Math.cos(e-d),e];
}function ja(a,b,c){var d=Math.abs(a),e=Math.abs(b),f=q(e);if(d){var h=1/Math.sin(d),i=1/(Math.tan(d)*Math.tan(d)),k=-(i+c*f*f*h*h-1+c),l=(c-1)*i,m=.5*(-k+Math.sqrt(k*k-4*l));return[ka(Math.atan(1/Math.sqrt(m)),c)*g(a),ka(Math.atan(j((m/i-1)/c)),1-c)*g(b)]}return[0,ka(Math.atan(f),1-c)*g(b)]}function ka(a,b){if(!b)return a;if(1===b)return Math.log(Math.tan(a/2+rb/4));for(var c=1,d=Math.sqrt(1-b),e=Math.sqrt(b),f=0;Math.abs(e)>pb;f++){if(a%rb){var g=Math.atan(d*Math.tan(a)/c);0>g&&(g+=rb),a+=g+~~(a/rb)*rb}else a+=a;e=(c+d)/2,d=Math.sqrt(c*d),e=((c=e)-d)/2}return a/(Math.pow(2,f)*c)}function la(a,b){var c=(Math.SQRT2-1)/(Math.SQRT2+1),d=Math.sqrt(1-c*c),e=ka(sb,d*d),f=-1,g=Math.log(Math.tan(rb/4+Math.abs(b)/2)),h=Math.exp(f*g)/Math.sqrt(c),i=ma(h*Math.cos(f*a),h*Math.sin(f*a)),j=ja(i[0],i[1],d*d);return[-j[1],(b>=0?1:-1)*(.5*e-j[0])]}function ma(a,b){var c=a*a,d=b+1,e=1-c-b*b;return[.5*((a>=0?sb:-sb)-Math.atan2(e,2*a)),-.25*Math.log(e*e+4*c)+.5*Math.log(d*d+c)]}function na(a,b){var c=b[0]*b[0]+b[1]*b[1];return[(a[0]*b[0]+a[1]*b[1])/c,(a[1]*b[0]-a[0]*b[1])/c]}function oa(a){function b(a,b){var f=e(a,b);a=f[0],b=f[1];var g=Math.sin(b),h=Math.cos(b),j=Math.cos(a),k=i(c*g+d*h*j),l=Math.sin(k),m=Math.abs(l)>pb?k/l:1;return[m*d*Math.sin(a),(Math.abs(a)>sb?m:-m)*(c*h-d*g*j)]}var c=Math.sin(a),d=Math.cos(a),e=pa(a);return e.invert=pa(-a),b.invert=function(a,b){var d=Math.sqrt(a*a+b*b),f=-Math.sin(d),g=Math.cos(d),h=d*g,i=-b*f,k=d*c,l=j(h*h+i*i-k*k),m=Math.atan2(h*k+i*l,i*k-h*l),n=(d>sb?-1:1)*Math.atan2(a*f,d*Math.cos(m)*g+b*Math.sin(m)*f);return e.invert(n,m)},b}function pa(a){var b=Math.sin(a),c=Math.cos(a);return function(a,d){var e=Math.cos(d),f=Math.cos(a)*e,g=Math.sin(a)*e,i=Math.sin(d);return[Math.atan2(g,f*c-i*b),h(i*c+f*b)]}}function qa(){var a=0,b=xb(oa),c=b(a),d=c.rotate,e=c.stream,f=d3.geo.circle();return c.parallel=function(d){if(!arguments.length)return a/rb*180;var e=c.rotate();return b(a=d*rb/180).rotate(e)},c.rotate=function(b){return arguments.length?(d.call(c,[b[0],b[1]-a/rb*180]),f.origin([-b[0],-b[1]]),c):(b=d.call(c),b[1]+=a/rb*180,b)},c.stream=function(a){return a=e(a),a.sphere=function(){a.polygonStart();var b,c=.01,d=f.angle(90-c)().coordinates[0],e=d.length-1,g=-1;for(a.lineStart();++g<e;)a.point((b=d[g])[0],b[1]);for(a.lineEnd(),d=f.angle(90+c)().coordinates[0],e=d.length-1,a.lineStart();--g>=0;)a.point((b=d[g])[0],b[1]);a.lineEnd(),a.polygonEnd()},a},c}function ra(a,b){function c(c,d){var e=Kb(c/b,d);return e[0]*=a,e}return arguments.length<2&&(b=a),1===b?Kb:b===1/0?ta:(c.invert=function(c,d){var e=Kb.invert(c/a,d);return e[0]*=b,e},c)}function sa(){var a=2,b=xb(ra),c=b(a);return c.coefficient=function(c){return arguments.length?b(a=+c):a},c}function ta(a,b){return[a*Math.cos(b)/Math.cos(b/=2),2*Math.sin(b)]}function ua(a,b){for(var c,d=Math.sin(b)*(0>b?2.43763:2.67595),e=0;20>e&&(b-=c=(b+Math.sin(b)-d)/(1+Math.cos(b)),!(Math.abs(c)<pb));e++);return[.85*a*Math.cos(b*=.5),Math.sin(b)*(0>b?1.93052:1.75859)]}function va(a){function b(b,k){var l,m=Math.abs(k);if(m>d){var n=Math.min(a-1,Math.max(0,Math.floor((b+rb)/j)));b+=rb*(a-1)/a-n*j,l=d3.geo.collignon.raw(b,m),l[0]=l[0]*e/f-e*(a-1)/(2*a)+n*e/a,l[1]=g+4*(l[1]-h)*i/e,0>k&&(l[1]=-l[1])}else l=c(b,k);return l[0]/=2,l}var c=d3.geo.cylindricalEqualArea.raw(0),d=Lb*rb/180,e=2*rb,f=d3.geo.collignon.raw(rb,d)[0]-d3.geo.collignon.raw(-rb,d)[0],g=c(0,d)[1],h=d3.geo.collignon.raw(0,d)[1],i=d3.geo.collignon.raw(0,sb)[1]-h,j=2*rb/a;return b.invert=function(b,d){b*=2;var k=Math.abs(d);if(k>g){var l=Math.min(a-1,Math.max(0,Math.floor((b+rb)/j)));b=(b+rb*(a-1)/a-l*j)*f/e;var m=d3.geo.collignon.raw.invert(b,.25*(k-g)*e/i+h);return m[0]-=rb*(a-1)/a-l*j,0>d&&(m[1]=-m[1]),m}return c.invert(b,d)},b}function wa(){function a(){var a=180/b;return{type:"Polygon",coordinates:[d3.range(-180,180+a/2,a).map(function(a,b){return[a,1&b?90-1e-6:Lb]}).concat(d3.range(180,-180-a/2,-a).map(function(a,b){return[a,1&b?-90+1e-6:-Lb]}))]}}var b=2,c=xb(va),d=c(b),e=d.stream;return d.lobes=function(a){return arguments.length?c(b=+a):b},d.stream=function(b){var c=d.rotate(),f=e(b),g=(d.rotate([0,0]),e(b));return d.rotate(c),f.sphere=function(){d3.geo.stream(a(),g)},f},d}function xa(a){function b(b,e){var h,i,m=1-Math.sin(e);if(m&&2>m){var n,o=sb-e,p=25;do{var q=Math.sin(o),r=Math.cos(o),s=f+Math.atan2(q,d-r),t=1+l-2*d*r;o-=n=(o-k*f-d*q+t*s-.5*m*c)/(2*d*q*s)}while(Math.abs(n)>qb&&--p>0);h=g*Math.sqrt(t),i=b*s/rb}else h=g*(a+m),i=b*f/rb;return[h*Math.sin(i),j-h*Math.cos(i)]}var c,d=1+a,e=Math.sin(1/d),f=h(e),g=2*Math.sqrt(rb/(c=rb+4*f*d)),j=.5*g*(d+Math.sqrt(a*(2+a))),k=a*a,l=d*d;return b.invert=function(a,b){var e=a*a+(b-=j)*b,m=(1+l-e/(g*g))/(2*d),n=i(m),o=Math.sin(n),p=f+Math.atan2(o,d-m);return[h(a/Math.sqrt(e))*rb/p,h(1-2*(n-k*f-d*o+(1+l-2*d*m)*p)/c)]},b}function ya(){var a=1,b=xb(xa),c=b(a);return c.ratio=function(c){return arguments.length?b(a=+c):a},c}function za(a,b){return b>-Mb?(a=Bb(a,b),a[1]+=Nb,a):C(a,b)}function Aa(a,b){return Math.abs(b)>Mb?(a=Bb(a,b),a[1]-=b>0?Nb:-Nb,a):C(a,b)}function Ba(a,b){return[3*a/(2*rb)*Math.sqrt(rb*rb/3-b*b),b]}function Ca(a){function b(b,c){if(Math.abs(Math.abs(c)-sb)<pb)return[0,0>c?-2:2];var d=Math.sin(c),e=Math.pow((1+d)/(1-d),a/2),f=.5*(e+1/e)+Math.cos(b*=a);return[2*Math.sin(b)/f,(e-1/e)/f]}return b.invert=function(b,c){var d=Math.abs(c);if(Math.abs(d-2)<pb)return b?null:[0,g(c)*sb];if(d>2)return null;b/=2,c/=2;var e=b*b,f=c*c,i=2*c/(1+e+f);return i=Math.pow((1+i)/(1-i),1/a),[Math.atan2(2*b,1-e-f)/a,h((i-1)/(i+1))]},b}function Da(){var a=.5,b=xb(Ca),c=b(a);return c.spacing=function(c){return arguments.length?b(a=+c):a},c}function Ea(a,b){return[a*(1+Math.sqrt(Math.cos(b)))/2,b/(Math.cos(b/2)*Math.cos(a/6))]}function Fa(a,b){var c=a*a,d=b*b;return[a*(.975534+d*(-.119161+c*-.0143059+d*-.0547009)),b*(1.00384+c*(.0802894+d*-.02855+199025e-9*c)+d*(.0998909+d*-.0491032))]}function Ga(a,b){return[Math.sin(a)/Math.cos(b),Math.tan(b)*Math.cos(a)]}function Ha(a){function b(b,e){var f=e-a,g=Math.abs(f)<pb?b*c:Math.abs(g=rb/4+e/2)<pb||Math.abs(Math.abs(g)-sb)<pb?0:b*f/Math.log(Math.tan(g)/d);return[g,f]}var c=Math.cos(a),d=Math.tan(rb/4+a/2);return b.invert=function(b,e){var f,g=e+a;return[Math.abs(e)<pb?b/c:Math.abs(f=rb/4+g/2)<pb||Math.abs(Math.abs(f)-sb)<pb?0:b*Math.log(Math.tan(f)/d)/e,g]},b}function Ia(a,b){return[a,1.25*Math.log(Math.tan(rb/4+.4*b))]}function Ja(a){function b(b,d){for(var e,f=Math.cos(d),g=2/(1+f*Math.cos(b)),h=g*f*Math.sin(b),i=g*Math.sin(d),j=c,k=a[j],l=k[0],m=k[1];--j>=0;)k=a[j],l=k[0]+h*(e=l)-i*m,m=k[1]+h*m+i*e;return l=h*(e=l)-i*m,m=h*m+i*e,[l,m]}var c=a.length-1;return b.invert=function(b,d){var e=20,f=b,g=d;do{for(var i,j=c,k=a[j],l=k[0],m=k[1],n=0,o=0;--j>=0;)k=a[j],n=l+f*(i=n)-g*o,o=m+f*o+g*i,l=k[0]+f*(i=l)-g*m,m=k[1]+f*m+g*i;n=l+f*(i=n)-g*o,o=m+f*o+g*i,l=f*(i=l)-g*m-b,m=f*m+g*i-d;var p,q,r=n*n+o*o;f-=p=(l*n+m*o)/r,g-=q=(m*n-l*o)/r}while(Math.abs(p)+Math.abs(q)>pb*pb&&--e>0);if(e){var s=Math.sqrt(f*f+g*g),t=2*Math.atan(.5*s),u=Math.sin(t);return[Math.atan2(f*u,s*Math.cos(t)),s?h(g*u/s):0]}},b}function Ka(){var a=Ob.miller,b=xb(Ja),c=b(a);return c.coefficients=function(c){return arguments.length?b(a="string"==typeof c?Ob[c]:c):a},c}function La(a,b){var c=Math.sqrt(6),d=Math.sqrt(7),e=Math.asin(7*Math.sin(b)/(3*c));return[c*a*(2*Math.cos(2*e/3)-1)/d,9*Math.sin(e/3)/d]}function Ma(a,b){for(var c,d=(1+Math.SQRT1_2)*Math.sin(b),e=b,f=0;25>f&&(e-=c=(Math.sin(e/2)+Math.sin(e)-d)/(.5*Math.cos(e/2)+Math.cos(e)),!(Math.abs(c)<pb));f++);return[a*(1+2*Math.cos(e)/Math.cos(e/2))/(3*Math.SQRT2),2*Math.sqrt(3)*Math.sin(e/2)/Math.sqrt(2+Math.SQRT2)]}function Na(a,b){for(var c,d=Math.sqrt(6/(4+rb)),e=(1+rb/4)*Math.sin(b),f=b/2,g=0;25>g&&(f-=c=(f/2+Math.sin(f)-e)/(.5+Math.cos(f)),!(Math.abs(c)<pb));g++);return[d*(.5+Math.cos(f))*a/1.5,d*f]}function Oa(a,b){var c=b*b,d=c*c;return[a*(.8707-.131979*c+d*(-.013791+d*(.003971*c-.001529*d))),b*(1.007226+c*(.015085+d*(-.044475+.028874*c-.005916*d)))]}function Pa(a,b){return[a*(1+Math.cos(b))/2,2*(b-Math.tan(b/2))]}function Qa(a,b){var c=b*b;return[a,b*(Pb+c*c*(Qb+c*(Rb+Sb*c)))]}function Ra(a,b){if(Math.abs(b)<pb)return[a,0];var c=Math.tan(b),d=a*Math.sin(b);return[Math.sin(d)/c,b+(1-Math.cos(d))/c]}function Sa(a){function b(b,d){var e=c?Math.tan(b*c/2)/c:b/2;if(!d)return[2*e,-a];var f=2*Math.atan(e*Math.sin(d)),g=1/Math.tan(d);return[Math.sin(f)*g,d+(1-Math.cos(f))*g-a]}var c=Math.sin(a);return b.invert=function(b,d){if(Math.abs(d+=a)<pb)return[c?2*Math.atan(c*b/2)/c:b,0];var e,f=b*b+d*d,g=0,j=10;do{var k=Math.tan(g),l=1/Math.cos(g),m=f-2*d*g+g*g;g-=e=(k*m+2*(g-d))/(2+m*l*l+2*(g-d)*k)}while(Math.abs(e)>pb&&--j>0);var n=b*(k=Math.tan(g)),o=Math.tan(Math.abs(d)<Math.abs(g+1/k)?.5*h(n):.5*i(n)+rb/4)/Math.sin(g);return[c?2*Math.atan(c*o)/c:2*o,g]},b}function Ta(a,b){var c,d=Math.min(18,36*Math.abs(b)/rb),e=Math.floor(d),f=d-e,g=(c=Zb[e])[0],h=c[1],i=(c=Zb[++e])[0],j=c[1],k=(c=Zb[Math.min(19,++e)])[0],l=c[1];return[a*(i+f*(k-g)/2+f*f*(k-2*i+g)/2),(b>0?sb:-sb)*(j+f*(l-h)/2+f*f*(l-2*j+h)/2)]}function Ua(a){function b(b,c){var d=Math.cos(c),e=(a-1)/(a-d*Math.cos(b));return[e*d*Math.sin(b),e*Math.sin(c)]}return b.invert=function(b,c){var d=b*b+c*c,e=Math.sqrt(d),f=(a-Math.sqrt(1-d*(a+1)/(a-1)))/((a-1)/e+e/(a-1));return[Math.atan2(b*f,e*Math.sqrt(1-f*f)),e?h(c*f/e):0]},b}function Va(a,b){function c(b,c){var g=d(b,c),h=g[1],i=h*f/(a-1)+e;return[g[0]*e/i,h/i]}var d=Ua(a);if(!b)return d;var e=Math.cos(b),f=Math.sin(b);return c.invert=function(b,c){var g=(a-1)/(a-1-c*f);return d.invert(g*b,g*c*e)},c}function Wa(){var a=1.4,b=0,c=xb(Va),d=c(a,b);return d.distance=function(d){return arguments.length?c(a=+d,b):a},d.tilt=function(d){return arguments.length?c(a,b=d*rb/180):180*b/rb},d}function Xa(a,b){var c=Math.tan(b/2),d=Math.sin(rb/4*c);return[a*(.74482-.34588*d*d),1.70711*c]}function Ya(a){function b(b,f){var g=i(Math.cos(f)*Math.cos(b-c)),h=i(Math.cos(f)*Math.cos(b-d)),k=0>f?-1:1;return g*=g,h*=h,[(g-h)/(2*a),k*j(4*e*h-(e-g+h)*(e-g+h))/(2*a)]}if(!a)return d3.geo.azimuthalEquidistant.raw;var c=-a/2,d=-c,e=a*a,f=Math.tan(d),g=.5/Math.sin(d);return b.invert=function(a,b){var e,h,j=b*b,k=Math.cos(Math.sqrt(j+(e=a+c)*e)),l=Math.cos(Math.sqrt(j+(e=a+d)*e));return[Math.atan2(h=k-l,e=(k+l)*f),(0>b?-1:1)*i(Math.sqrt(e*e+h*h)*g)]},b}function Za(){var a=[[0,0],[0,0]],b=xb(Ya),c=b(0),d=c.rotate;return delete c.rotate,c.points=function(c){if(!arguments.length)return a;a=c;var e=d3.geo.interpolate(c[0],c[1]),f=e(.5),g=d3.geo.rotation([-f[0],-f[1]])(c[0]),i=.5*e.distance,j=-h(Math.sin(g[1]*ub)/Math.sin(i));return g[0]>0&&(j=rb-j),d.call(g,[-f[0],-f[1],-j*vb]),b(2*i)},c}function $a(a){function b(a,b){var d=d3.geo.gnomonic.raw(a,b);return d[0]*=c,d}var c=Math.cos(a);return b.invert=function(a,b){return d3.geo.gnomonic.raw.invert(a/c,b)},b}function _a(){var a=[[0,0],[0,0]],b=xb($a),c=b(0),d=c.rotate;return delete c.rotate,c.points=function(c){if(!arguments.length)return a;a=c;var e=d3.geo.interpolate(c[0],c[1]),f=e(.5),g=d3.geo.rotation([-f[0],-f[1]])(c[0]),i=.5*e.distance,j=-h(Math.sin(g[1]*ub)/Math.sin(i));return g[0]>0&&(j=rb-j),d.call(g,[-f[0],-f[1],-j*vb]),b(i)},c}function ab(a,b){if(Math.abs(b)<pb)return[a,0];var c=Math.abs(b/sb),d=h(c);if(Math.abs(a)<pb||Math.abs(Math.abs(b)-sb)<pb)return[0,g(b)*rb*Math.tan(d/2)];var e=Math.cos(d),f=Math.abs(rb/a-a/rb)/2,i=f*f,j=e/(c+e-1),k=j*(2/c-1),l=k*k,m=l+i,n=j-l,o=i+j;return[g(a)*rb*(f*n+Math.sqrt(i*n*n-m*(j*j-l)))/m,g(b)*rb*(k*o-f*Math.sqrt((i+1)*m-o*o))/m]}function bb(a,b){if(Math.abs(b)<pb)return[a,0];var c=Math.abs(b/sb),d=h(c);if(Math.abs(a)<pb||Math.abs(Math.abs(b)-sb)<pb)return[0,g(b)*rb*Math.tan(d/2)];var e=Math.cos(d),f=Math.abs(rb/a-a/rb)/2,i=f*f,k=e*(Math.sqrt(1+i)-f*e)/(1+i*c*c);return[g(a)*rb*k,g(b)*rb*j(1-k*(2*f+k))]}function cb(a,b){if(Math.abs(b)<pb)return[a,0];var c=b/sb,d=h(c);if(Math.abs(a)<pb||Math.abs(Math.abs(b)-sb)<pb)return[0,rb*Math.tan(d/2)];var e=(rb/a-a/rb)/2,f=c/(1+Math.cos(d));return[rb*(g(a)*j(e*e+1-f*f)-e),rb*f]}function db(a,b){if(!b)return[a,0];var c=Math.abs(b);if(!a||c===sb)return[0,b];var d=c/sb,e=d*d,f=(8*d-e*(e+2)-5)/(2*e*(d-1)),h=f*f,i=d*f,k=e+h+2*i,l=d+3*f,m=a/sb,n=m+1/m,o=g(Math.abs(a)-sb)*Math.sqrt(n*n-4),p=o*o,q=k*(e+h*p-1)+(1-e)*(e*(l*l+4*h)+12*i*h+4*h*h),r=(o*(k+h-1)+2*j(q))/(4*k+p);return[g(a)*sb*r,g(b)*sb*j(1+o*Math.abs(r)-r*r)]}function eb(a,b){return[a*Math.sqrt(1-3*b*b/(rb*rb)),b]}function fb(a,b){var c=.90631*Math.sin(b),d=Math.sqrt(1-c*c),e=Math.sqrt(2/(1+d*Math.cos(a/=3)));return[2.66723*d*e*Math.sin(a),1.24104*c*e]}function gb(a,b){var c=Math.cos(b),d=Math.cos(a)*c,e=1-d,f=Math.cos(a=Math.atan2(Math.sin(a)*c,-Math.sin(b))),g=Math.sin(a);return c=j(1-d*d),[g*c-f*e,-f*c-g*e]}function hb(a,b){var c=m(a,b);return[(c[0]+a/sb)/2,(c[1]+b)/2]}d3.geo.project=function(a,c){var d=c.stream;if(!d)throw new Error("not yet supported");return(a&&ib.hasOwnProperty(a.type)?ib[a.type]:b)(a,d)};var ib={Feature:a,FeatureCollection:function(b,c){return{type:"FeatureCollection",features:b.features.map(function(b){return a(b,c)})}}},jb=[],kb=[],lb={point:function(a,b){jb.push([a,b])},result:function(){var a=jb.length?jb.length<2?{type:"Point",coordinates:jb[0]}:{type:"MultiPoint",coordinates:jb}:null;return jb=[],a}},mb={lineStart:c,point:function(a,b){jb.push([a,b])},lineEnd:function(){jb.length&&(kb.push(jb),jb=[])},result:function(){var a=kb.length?kb.length<2?{type:"LineString",coordinates:kb[0]}:{type:"MultiLineString",coordinates:kb}:null;return kb=[],a}},nb={polygonStart:c,lineStart:c,point:function(a,b){jb.push([a,b])},lineEnd:function(){var a=jb.length;if(a){do jb.push(jb[0].slice());while(++a<4);kb.push(jb),jb=[]}},polygonEnd:c,result:function(){if(!kb.length)return null;var a=[],b=[];return kb.forEach(function(c){d(c)?a.push([c]):b.push(c)}),b.forEach(function(b){var c=b[0];a.some(function(a){return e(a[0],c)?(a.push(b),!0):void 0})||a.push([b])}),kb=[],a.length?a.length>1?{type:"MultiPolygon",coordinates:a}:{type:"Polygon",coordinates:a[0]}:null}},ob={Point:lb,MultiPoint:lb,LineString:mb,MultiLineString:mb,Polygon:nb,MultiPolygon:nb,Sphere:nb},pb=1e-6,qb=pb*pb,rb=Math.PI,sb=rb/2,tb=Math.sqrt(rb),ub=rb/180,vb=180/rb,wb=d3.geo.projection,xb=d3.geo.projectionMutator;d3.geo.interrupt=function(a){function b(b,c){for(var d=0>c?-1:1,e=h[+(0>c)],f=0,g=e.length-1;g>f&&b>e[f][2][0];++f);var i=a(b-e[f][1][0],c);return i[0]+=a(e[f][1][0],d*c>d*e[f][0][1]?e[f][0][1]:c)[0],i}function c(){g=h.map(function(b){return b.map(function(b){var c,d=a(b[0][0],b[0][1])[0],e=a(b[2][0],b[2][1])[0],f=a(b[1][0],b[0][1])[1],g=a(b[1][0],b[1][1])[1];return f>g&&(c=f,f=g,g=c),[[d,f],[e,g]]})})}function d(){for(var a=1e-6,b=[],c=0,d=h[0].length;d>c;++c){var f=h[0][c],g=180*f[0][0]/rb,i=180*f[0][1]/rb,j=180*f[1][1]/rb,k=180*f[2][0]/rb,l=180*f[2][1]/rb;b.push(e([[g+a,i+a],[g+a,j-a],[k-a,j-a],[k-a,l+a]],30))}for(var c=h[1].length-1;c>=0;--c){var f=h[1][c],g=180*f[0][0]/rb,i=180*f[0][1]/rb,j=180*f[1][1]/rb,k=180*f[2][0]/rb,l=180*f[2][1]/rb;b.push(e([[k-a,l-a],[k-a,j+a],[g+a,j+a],[g+a,i-a]],30))}return{type:"Polygon",coordinates:[d3.merge(b)]}}function e(a,b){for(var c,d,e,f=-1,g=a.length,h=a[0],i=[];++f<g;){c=a[f],d=(c[0]-h[0])/b,e=(c[1]-h[1])/b;for(var j=0;b>j;++j)i.push([h[0]+j*d,h[1]+j*e]);h=c}return i.push(c),i}function f(a,b){return Math.abs(a[0]-b[0])<pb&&Math.abs(a[1]-b[1])<pb}var g,h=[[[[-rb,0],[0,sb],[rb,0]]],[[[-rb,0],[0,-sb],[rb,0]]]];a.invert&&(b.invert=function(c,d){for(var e=g[+(0>d)],i=h[+(0>d)],j=0,k=e.length;k>j;++j){var l=e[j];if(l[0][0]<=c&&c<l[1][0]&&l[0][1]<=d&&d<l[1][1]){var m=a.invert(c-a(i[j][1][0],0)[0],d);return m[0]+=i[j][1][0],f(b(m[0],m[1]),[c,d])?m:null}}});var i=d3.geo.projection(b),j=i.stream;return i.stream=function(a){var b=i.rotate(),c=j(a),e=(i.rotate([0,0]),j(a));return i.rotate(b),c.sphere=function(){d3.geo.stream(d(),e)},c},i.lobes=function(a){return arguments.length?(h=a.map(function(a){return a.map(function(a){return[[a[0][0]*rb/180,a[0][1]*rb/180],[a[1][0]*rb/180,a[1][1]*rb/180],[a[2][0]*rb/180,a[2][1]*rb/180]]})}),c(),i):h.map(function(a){return a.map(function(a){return[[180*a[0][0]/rb,180*a[0][1]/rb],[180*a[1][0]/rb,180*a[1][1]/rb],[180*a[2][0]/rb,180*a[2][1]/rb]]})})},i},(d3.geo.airy=l).raw=k,m.invert=function(a,b){if(!(a*a+4*b*b>rb*rb+pb)){var c=a,d=b,e=25;do{var f,g=Math.sin(c),h=Math.sin(c/2),j=Math.cos(c/2),k=Math.sin(d),l=Math.cos(d),m=Math.sin(2*d),n=k*k,o=l*l,p=h*h,q=1-o*j*j,r=q?i(l*j)*Math.sqrt(f=1/q):f=0,s=2*r*l*h-a,t=r*k-b,u=f*(o*p+r*l*j*n),v=f*(.5*g*m-2*r*k*h),w=.25*f*(m*h-r*k*o*g),x=f*(n*j+r*p*l),y=v*w-x*u;if(!y)break;var z=(t*v-s*x)/y,A=(s*w-t*u)/y;c-=z,d-=A}while((Math.abs(z)>pb||Math.abs(A)>pb)&&--e>0);return[c,d]}},(d3.geo.aitoff=function(){return wb(m)}).raw=m,(d3.geo.armadillo=o).raw=n,u.invert=function(a,b){if(a*=3/8,b*=3/8,!a&&Math.abs(b)>1)return null;var c=a*a,d=b*b,e=1+c+d,f=Math.sqrt(.5*(e-Math.sqrt(e*e-4*b*b))),i=h(f)/3,j=f?t(Math.abs(b/f))/3:s(Math.abs(a))/3,k=Math.cos(i),l=r(j),m=l*l-k*k;return[2*g(a)*Math.atan2(q(j)*k,.25-m),2*g(b)*Math.atan2(l*Math.sin(i),.25+m)]},(d3.geo.august=function(){return wb(u)}).raw=u;var yb=Math.log(1+Math.SQRT2);v.invert=function(a,b){if((d=Math.abs(b))<yb)return[a,2*Math.atan(Math.exp(b))-sb];var c,d,e=Math.sqrt(8),f=rb/4,h=25;do{var i=Math.cos(f/2),j=Math.tan(f/2);f-=c=(e*(f-rb/4)-Math.log(j)-d)/(e-.5*i*i/j)}while(Math.abs(c)>qb&&--h>0);return[a/(Math.cos(f)*(e-1/Math.sin(f))),g(b)*f]},(d3.geo.baker=function(){return wb(v)}).raw=v;var zb=d3.geo.azimuthalEquidistant.raw;(d3.geo.berghaus=x).raw=w;var Ab=y(rb),Bb=z(Math.SQRT2/sb,Math.SQRT2,rb);(d3.geo.mollweide=function(){return wb(Bb)}).raw=Bb,A.invert=function(a,b){var c,d,e=2.00276,f=e*b,g=0>b?-rb/4:rb/4,h=25;do d=f-Math.SQRT2*Math.sin(g),g-=c=(Math.sin(2*g)+2*g-rb*Math.sin(d))/(2*Math.cos(2*g)+2+rb*Math.cos(d)*Math.SQRT2*Math.cos(g));while(Math.abs(c)>pb&&--h>0);return d=f-Math.SQRT2*Math.sin(g),[a*(1/Math.cos(d)+1.11072/Math.cos(g))/e,d]},(d3.geo.boggs=function(){return wb(A)}).raw=A,C.invert=function(a,b){return[a/Math.cos(b),b]},(d3.geo.sinusoidal=function(){return wb(C)}).raw=C,(d3.geo.bonne=function(){return B(D).parallel(45)}).raw=D,(d3.geo.bottomley=function(){var a=rb/6,b=d3.geo.projectionMutator(E),c=b(a);return c.variant=function(c){return arguments.length?b(a=+c):a},c}).raw=E;var Cb=z(1,4/rb,rb);(d3.geo.bromley=function(){return wb(Cb)}).raw=Cb,(d3.geo.chamberlin=G).raw=F,L.invert=function(a,b){var c=(c=b/tb-1)*c;return[c>0?a*Math.sqrt(rb/c)/2:0,h(1-c)]},(d3.geo.collignon=function(){return wb(L)}).raw=L,(d3.geo.craig=function(){return B(M)}).raw=M,N.invert=function(a,b){var c=Math.sqrt(3),d=3*h(b/(c*tb));return[tb*a/(c*(2*Math.cos(2*d/3)-1)),d]},(d3.geo.craster=function(){return wb(N)}).raw=N,(d3.geo.cylindricalEqualArea=function(){return B(O)}).raw=O,(d3.geo.cylindricalStereographic=function(){return B(P)}).raw=P,Q.invert=function(a,b){var c=Math.sqrt(8/(3*rb)),d=b/c;return[a/(c*(1-Math.abs(d)/rb)),d]},(d3.geo.eckert1=function(){return wb(Q)}).raw=Q,R.invert=function(a,b){var c=2-Math.abs(b)/Math.sqrt(2*rb/3);return[a*Math.sqrt(6*rb)/(2*c),g(b)*h((4-c*c)/3)]},(d3.geo.eckert2=function(){return wb(R)}).raw=R,S.invert=function(a,b){var c=Math.sqrt(rb*(4+rb))/2;return[a*c/(1+j(1-b*b*(4+rb)/(4*rb))),b*c/2]},(d3.geo.eckert3=function(){return wb(S)}).raw=S,T.invert=function(a,b){var c=.5*b*Math.sqrt((4+rb)/rb),d=h(c),e=Math.cos(d);return[a/(2/Math.sqrt(rb*(4+rb))*(1+e)),h((d+c*(e+2))/(2+sb))]},(d3.geo.eckert4=function(){return wb(T)}).raw=T,U.invert=function(a,b){var c=Math.sqrt(2+rb),d=b*c/2;return[c*a/(1+Math.cos(d)),d]},(d3.geo.eckert5=function(){return wb(U)}).raw=U,V.invert=function(a,b){var c=1+sb,d=Math.sqrt(c/2);return[2*a*d/(1+Math.cos(b*=d)),h((b+Math.sin(b))/c)]},(d3.geo.eckert6=function(){return wb(V)}).raw=V,W.invert=function(a,b){var c=d3.geo.august.raw.invert(a/1.2,1.065*b);if(!c)return null;var d=c[0],e=c[1],f=20;a/=Db,b/=Db;do{var g=d/2,h=e/2,i=Math.sin(g),j=Math.cos(g),k=Math.sin(h),l=Math.cos(h),m=Math.cos(e),n=Math.sqrt(m),o=k/(l+Math.SQRT2*j*n),p=o*o,q=Math.sqrt(2/(1+p)),r=Math.SQRT2*l+(j+i)*n,s=Math.SQRT2*l+(j-i)*n,t=r/s,u=Math.sqrt(t),v=u-1/u,w=u+1/u,x=q*v-2*Math.log(u)-a,y=q*o*w-2*Math.atan(o)-b,z=k&&Math.SQRT1_2*n*i*p/k,A=(Math.SQRT2*j*l+n)/(2*(l+Math.SQRT2*j*n)*(l+Math.SQRT2*j*n)*n),B=-.5*o*q*q*q,C=B*z,D=B*A,E=(E=2*l+Math.SQRT2*n*(j-i))*E*u,F=(Math.SQRT2*j*l*n+m)/E,G=-(Math.SQRT2*i*k)/(n*E),H=v*C-2*F/u+q*(F+F/t),I=v*D-2*G/u+q*(G+G/t),J=o*w*C-2*z/(1+p)+q*w*z+q*o*(F-F/t),K=o*w*D-2*A/(1+p)+q*w*A+q*o*(G-G/t),L=I*J-K*H;if(!L)break;var M=(y*I-x*K)/L,N=(x*J-y*H)/L;d-=M,e=Math.max(-sb,Math.min(sb,e-N))}while((Math.abs(M)>pb||Math.abs(N)>pb)&&--f>0);return Math.abs(Math.abs(e)-sb)<pb?[0,e]:f&&[d,e]};var Db=3+2*Math.SQRT2;(d3.geo.eisenlohr=function(){return wb(W)}).raw=W,X.invert=function(a,b){var c=b/(1+Eb);return[a?a/(Eb*j(1-c*c)):0,2*Math.atan(c)]};var Eb=Math.cos(35*ub);(d3.geo.fahey=function(){return wb(X)}).raw=X,Y.invert=function(a,b){var c=Math.atan(b/tb),d=Math.cos(c),e=2*c;return[a*tb*.5/(Math.cos(e)*d*d),e]},(d3.geo.foucaut=function(){return wb(Y)}).raw=Y,d3.geo.gilbert=function(a){function b(b){return a([.5*b[0],h(Math.tan(.5*b[1]*ub))*vb])}var c=d3.geo.equirectangular().scale(vb).translate([0,0]);return a.invert&&(b.invert=function(b){return b=a.invert(b),b[0]*=2,b[1]=2*Math.atan(Math.sin(b[1]*ub))*vb,b}),b.stream=function(b){b=a.stream(b);var d=c.stream({point:function(a,c){b.point(.5*a,h(Math.tan(.5*-c*ub))*vb)},lineStart:function(){b.lineStart()},lineEnd:function(){b.lineEnd()},polygonStart:function(){b.polygonStart()},polygonEnd:function(){b.polygonEnd()}});return d.sphere=function(){b.sphere()},d.valid=!1,d},b};var Fb=d3.geo.azimuthalEquidistant.raw;(d3.geo.gingery=_).raw=Z;var Gb=ba(2.8284,-1.6988,.75432,-.18071,1.76003,-.38914,.042555);(d3.geo.ginzburg4=function(){return wb(Gb)}).raw=Gb;var Hb=ba(2.583819,-.835827,.170354,-.038094,1.543313,-.411435,.082742);(d3.geo.ginzburg5=function(){return wb(Hb)}).raw=Hb;var Ib=ba(5/6*rb,-.62636,-.0344,0,1.3493,-.05524,0,.045);(d3.geo.ginzburg6=function(){return wb(Ib)}).raw=Ib,ca.invert=function(a,b){var c,d=a,e=b,f=50;do{var g=e*e;e-=c=(e*(1+g/12)-b)/(1+g/4)}while(Math.abs(c)>pb&&--f>0);f=50,a/=1-.162388*g;do{var h=(h=d*d)*h;d-=c=(d*(.87-952426e-9*h)-a)/(.87-.00476213*h)}while(Math.abs(c)>pb&&--f>0);return[d,e]},(d3.geo.ginzburg8=function(){return wb(ca)}).raw=ca;var Jb=ba(2.6516,-.76534,.19123,-.047094,1.36289,-.13965,.031762);(d3.geo.ginzburg9=function(){return wb(Jb)}).raw=Jb,ea.invert=function(a,b){var c=g(a),d=g(b),e=-c*a,f=-d*b,i=1>f/e,j=ga(i?f:e,i?e:f),k=j[0],l=j[1];i&&(k=-sb-k);var m=Math.cos(l),a=Math.cos(k)*m,b=Math.sin(k)*m,n=Math.sin(l);return[c*(Math.atan2(b,-n)+rb),d*h(a)]},d3.geo.gringorten=da(ea),la.invert=function(a,b){var c=(Math.SQRT2-1)/(Math.SQRT2+1),d=Math.sqrt(1-c*c),e=ka(sb,d*d),f=-1,g=ha(.5*e-b,-a,d*d),h=na(g[0],g[1]),i=Math.atan2(h[1],h[0])/f;return[i,2*Math.atan(Math.exp(.5/f*Math.log(c*h[0]*h[0]+c*h[1]*h[1])))-sb]},d3.geo.guyou=da(la),(d3.geo.hammerRetroazimuthal=qa).raw=oa;var Kb=d3.geo.azimuthalEqualArea.raw;ta.invert=function(a,b){var c=2*h(b/2);return[a*Math.cos(c/2)/Math.cos(c),c]},(d3.geo.hammer=sa).raw=ra,ua.invert=function(a,b){var c=Math.abs(c=b*(0>b?.5179951515653813:.5686373742600607))>1-pb?c>0?sb:-sb:h(c);return[1.1764705882352942*a/Math.cos(c),Math.abs(c=((c+=c)+Math.sin(c))*(0>b?.4102345310814193:.3736990601468637))>1-pb?c>0?sb:-sb:h(c)]},(d3.geo.hatano=function(){return wb(ua)}).raw=ua;var Lb=41+48/36+37/3600;(d3.geo.healpix=wa).raw=va,(d3.geo.hill=ya).raw=xa;var Mb=.7109889596207567,Nb=.0528035274542;za.invert=function(a,b){return b>-Mb?Bb.invert(a,b-Nb):C.invert(a,b)},(d3.geo.sinuMollweide=function(){return wb(za).rotate([-20,-55])}).raw=za,Aa.invert=function(a,b){return Math.abs(b)>Mb?Bb.invert(a,b+(b>0?Nb:-Nb)):C.invert(a,b)},(d3.geo.homolosine=function(){return wb(Aa)}).raw=Aa,Ba.invert=function(a,b){return[2/3*rb*a/Math.sqrt(rb*rb/3-b*b),b]},(d3.geo.kavrayskiy7=function(){return wb(Ba)}).raw=Ba,(d3.geo.lagrange=Da).raw=Ca,Ea.invert=function(a,b){var c=Math.abs(a),d=Math.abs(b),e=rb/Math.SQRT2,f=pb,g=sb;e>d?g*=d/e:f+=6*i(e/d);for(var h=0;25>h;h++){var k=Math.sin(g),l=j(Math.cos(g)),m=Math.sin(g/2),n=Math.cos(g/2),o=Math.sin(f/6),p=Math.cos(f/6),q=.5*f*(1+l)-c,r=g/(n*p)-d,s=l?-.25*f*k/l:0,t=.5*(1+l),u=(1+.5*g*m/n)/(n*p),v=g/n*(o/6)/(p*p),w=s*v-u*t,x=(q*v-r*t)/w,y=(r*s-q*u)/w;if(g-=x,f-=y,Math.abs(x)<pb&&Math.abs(y)<pb)break}return[0>a?-f:f,0>b?-g:g]},(d3.geo.larrivee=function(){return wb(Ea)}).raw=Ea,Fa.invert=function(a,b){var c=g(a)*rb,d=b/2,e=50;do{var f=c*c,h=d*d,i=c*d,j=c*(.975534+h*(-.119161+f*-.0143059+h*-.0547009))-a,k=d*(1.00384+f*(.0802894+h*-.02855+199025e-9*f)+h*(.0998909+h*-.0491032))-b,l=.975534-h*(.119161+3*f*.0143059+.0547009*h),m=-i*(.238322+.2188036*h+.0286118*f),n=i*(.1605788+7961e-7*f+-0.0571*h),o=1.00384+f*(.0802894+199025e-9*f)+h*(3*(.0998909-.02855*f)-.245516*h),p=m*n-o*l,q=(k*m-j*o)/p,r=(j*n-k*l)/p;c-=q,d-=r}while((Math.abs(q)>pb||Math.abs(r)>pb)&&--e>0);return e&&[c,d]},(d3.geo.laskowski=function(){return wb(Fa)}).raw=Fa,Ga.invert=function(a,b){var c=a*a,d=b*b,e=d+1,f=a?Math.SQRT1_2*Math.sqrt((e-Math.sqrt(c*c+2*c*(d-1)+e*e))/c+1):1/Math.sqrt(e);return[h(a*f),g(b)*i(f)]},(d3.geo.littrow=function(){return wb(Ga)}).raw=Ga,(d3.geo.loximuthal=function(){return B(Ha).parallel(40)}).raw=Ha,Ia.invert=function(a,b){return[a,2.5*Math.atan(Math.exp(.8*b))-.625*rb]},(d3.geo.miller=function(){return wb(Ia)}).raw=Ia;var Ob={alaska:[[.9972523,0],[.0052513,-.0041175],[.0074606,.0048125],[-.0153783,-.1968253],[.0636871,-.1408027],[.3660976,-.2937382]],gs48:[[.98879,0],[0,0],[-.050909,0],[0,0],[.075528,0]],gs50:[[.984299,0],[.0211642,.0037608],[-.1036018,-.0575102],[-.0329095,-.0320119],[.0499471,.1223335],[.026046,.0899805],[7388e-7,-.1435792],[.0075848,-.1334108],[-.0216473,.0776645],[-.0225161,.0853673]],miller:[[.9245,0],[0,0],[.01943,0]],lee:[[.721316,0],[0,0],[-.00881625,-.00617325]]};(d3.geo.modifiedStereographic=Ka).raw=Ja,La.invert=function(a,b){var c=Math.sqrt(6),d=Math.sqrt(7),e=3*h(b*d/9);return[a*d/(c*(2*Math.cos(2*e/3)-1)),h(3*Math.sin(e)*c/7)]},(d3.geo.mtFlatPolarParabolic=function(){return wb(La)}).raw=La,Ma.invert=function(a,b){var c=b*Math.sqrt(2+Math.SQRT2)/(2*Math.sqrt(3)),d=2*h(c);return[3*Math.SQRT2*a/(1+2*Math.cos(d)/Math.cos(d/2)),h((c+Math.sin(d))/(1+Math.SQRT1_2))]},(d3.geo.mtFlatPolarQuartic=function(){return wb(Ma)}).raw=Ma,Na.invert=function(a,b){var c=Math.sqrt(6/(4+rb)),d=b/c;return Math.abs(Math.abs(d)-sb)<pb&&(d=0>d?-sb:sb),[1.5*a/(c*(.5+Math.cos(d))),h((d/2+Math.sin(d))/(1+rb/4))]},(d3.geo.mtFlatPolarSinusoidal=function(){return wb(Na)}).raw=Na,Oa.invert=function(a,b){var c,d=b,e=25;do{var f=d*d,g=f*f;d-=c=(d*(1.007226+f*(.015085+g*(-.044475+.028874*f-.005916*g)))-b)/(1.007226+f*(.045255+g*(-0.311325+.259866*f-.005916*11*g)))}while(Math.abs(c)>pb&&--e>0);return[a/(.8707+(f=d*d)*(-.131979+f*(-.013791+f*f*f*(.003971-.001529*f)))),d]},(d3.geo.naturalEarth=function(){return wb(Oa)}).raw=Oa,Pa.invert=function(a,b){for(var c=b/2,d=0,e=1/0;10>d&&Math.abs(e)>pb;d++){var f=Math.cos(b/2);b-=e=(b-Math.tan(b/2)-c)/(1-.5/(f*f))}return[2*a/(1+Math.cos(b)),b]},(d3.geo.nellHammer=function(){return wb(Pa)}).raw=Pa;var Pb=1.0148,Qb=.23185,Rb=-.14499,Sb=.02406,Tb=Pb,Ub=5*Qb,Vb=7*Rb,Wb=9*Sb,Xb=1.790857183;Qa.invert=function(a,b){b>Xb?b=Xb:-Xb>b&&(b=-Xb);var c,d=b;do{var e=d*d;d-=c=(d*(Pb+e*e*(Qb+e*(Rb+Sb*e)))-b)/(Tb+e*e*(Ub+e*(Vb+Wb*e)))}while(Math.abs(c)>pb);return[a,d]},(d3.geo.patterson=function(){return wb(Qa)}).raw=Qa;var Yb=da(la);(d3.geo.peirceQuincuncial=function(){return Yb().quincuncial(!0).rotate([-90,-90,45]).clipAngle(180-1e-6)}).raw=Yb.raw,Ra.invert=function(a,b){if(Math.abs(b)<pb)return[a,0];var c,d=a*a+b*b,e=.5*b,f=10;do{var j=Math.tan(e),k=1/Math.cos(e),l=d-2*b*e+e*e;e-=c=(j*l+2*(e-b))/(2+l*k*k+2*(e-b)*j)}while(Math.abs(c)>pb&&--f>0);return j=Math.tan(e),[(Math.abs(b)<Math.abs(e+1/j)?h(a*j):g(a)*(i(Math.abs(a*j))+sb))/Math.sin(e),e]},(d3.geo.polyconic=function(){return wb(Ra)}).raw=Ra,(d3.geo.rectangularPolyconic=function(){return B(Sa)}).raw=Sa;var Zb=[[.9986,-.062],[1,0],[.9986,.062],[.9954,.124],[.99,.186],[.9822,.248],[.973,.31],[.96,.372],[.9427,.434],[.9216,.4958],[.8962,.5571],[.8679,.6176],[.835,.6769],[.7986,.7346],[.7597,.7903],[.7186,.8435],[.6732,.8936],[.6213,.9394],[.5722,.9761],[.5322,1]];Zb.forEach(function(a){a[1]*=1.0144}),Ta.invert=function(a,b){var c=b/sb,d=90*c,e=Math.min(18,Math.abs(d/5)),f=Math.max(0,Math.floor(e));do{var g=Zb[f][1],h=Zb[f+1][1],i=Zb[Math.min(19,f+2)][1],j=i-g,k=i-2*h+g,l=2*(Math.abs(c)-h)/j,m=k/j,n=l*(1-m*l*(1-2*m*l));if(n>=0||1===f){d=(b>=0?5:-5)*(n+e);var o,p=50;do e=Math.min(18,Math.abs(d)/5),f=Math.floor(e),n=e-f,g=Zb[f][1],h=Zb[f+1][1],i=Zb[Math.min(19,f+2)][1],d-=(o=(b>=0?sb:-sb)*(h+n*(i-g)/2+n*n*(i-2*h+g)/2)-b)*vb;while(Math.abs(o)>qb&&--p>0);break}}while(--f>=0);var q=Zb[f][0],r=Zb[f+1][0],s=Zb[Math.min(19,f+2)][0];return[a/(r+n*(s-q)/2+n*n*(s-2*r+q)/2),d*ub]},(d3.geo.robinson=function(){return wb(Ta)}).raw=Ta,(d3.geo.satellite=Wa).raw=Va,Xa.invert=function(a,b){var c=b/1.70711,d=Math.sin(rb/4*c);return[a/(.74482-.34588*d*d),2*Math.atan(c)]},(d3.geo.times=function(){return wb(Xa)}).raw=Xa,(d3.geo.twoPointEquidistant=Za).raw=Ya,(d3.geo.twoPointAzimuthal=_a).raw=$a,ab.invert=function(a,b){if(Math.abs(b)<pb)return[a,0];if(Math.abs(a)<pb)return[0,sb*Math.sin(2*Math.atan(b/rb))];var c=(a/=rb)*a,d=(b/=rb)*b,e=c+d,f=e*e,h=-Math.abs(b)*(1+e),j=h-2*d+c,k=-2*h+1+2*d+f,l=d/k+(2*j*j*j/(k*k*k)-9*h*j/(k*k))/27,m=(h-j*j/(3*k))/k,n=2*Math.sqrt(-m/3),o=i(3*l/(m*n))/3;return[rb*(e-1+Math.sqrt(1+2*(c-d)+f))/(2*a),g(b)*rb*(-n*Math.cos(o+rb/3)-j/(3*k))]},(d3.geo.vanDerGrinten=function(){return wb(ab)}).raw=ab,bb.invert=function(a,b){if(!a)return[0,sb*Math.sin(2*Math.atan(b/rb))];var c=Math.abs(a/rb),d=(1-c*c-(b/=rb)*b)/(2*c),e=d*d,f=Math.sqrt(e+1);return[g(a)*rb*(f-d),g(b)*sb*Math.sin(2*Math.atan2(Math.sqrt((1-2*d*c)*(d+f)-c),Math.sqrt(f+d+c)))]},(d3.geo.vanDerGrinten2=function(){return wb(bb)}).raw=bb,cb.invert=function(a,b){if(!b)return[a,0];var c=b/rb,d=(rb*rb*(1-c*c)-a*a)/(2*rb*a);return[a?rb*(g(a)*Math.sqrt(d*d+1)-d):0,sb*Math.sin(2*Math.atan(c))]},(d3.geo.vanDerGrinten3=function(){return wb(cb)}).raw=cb,db.invert=function(a,b){if(!a||!b)return[a,b];b/=rb;var c=g(a)*a/sb,d=(c*c-1+4*b*b)/Math.abs(c),e=d*d,f=2*b,h=50;do{var i=f*f,j=(8*f-i*(i+2)-5)/(2*i*(f-1)),k=(3*f-i*f-10)/(2*i*f),l=j*j,m=f*j,n=f+j,o=n*n,p=f+3*j,q=o*(i+l*e-1)+(1-i)*(i*(p*p+4*l)+l*(12*m+4*l)),r=-2*n*(4*m*l+(1-4*i+3*i*i)*(1+k)+l*(-6+14*i-e+(-8+8*i-2*e)*k)+m*(-8+12*i+(-10+10*i-e)*k)),s=Math.sqrt(q),t=d*(o+l-1)+2*s-c*(4*o+e),u=d*(2*j*k+2*n*(1+k))+r/s-8*n*(d*(-1+l+o)+2*s)*(1+k)/(e+4*o);f-=δ=t/u}while(δ>pb&&--h>0);return[g(a)*(Math.sqrt(d*d+4)+d)*rb/4,sb*f]},(d3.geo.vanDerGrinten4=function(){return wb(db)}).raw=db;var $b=function(){var a=4*rb+3*Math.sqrt(3),b=2*Math.sqrt(2*rb*Math.sqrt(3)/a);return z(b*Math.sqrt(3)/rb,b,a/6)}();(d3.geo.wagner4=function(){return wb($b)}).raw=$b,eb.invert=function(a,b){return[a/Math.sqrt(1-3*b*b/(rb*rb)),b]},(d3.geo.wagner6=function(){return wb(eb)}).raw=eb,fb.invert=function(a,b){var c=a/2.66723,d=b/1.24104,e=Math.sqrt(c*c+d*d),f=2*h(e/2);return[3*Math.atan2(a*Math.tan(f),2.66723*e),e&&h(b*Math.sin(f)/(1.24104*.90631*e))]},(d3.geo.wagner7=function(){return wb(fb)}).raw=fb,gb.invert=function(a,b){var c=-.5*(a*a+b*b),d=Math.sqrt(-c*(2+c)),e=b*c+a*d,f=a*c-b*d,g=Math.sqrt(f*f+e*e);return[Math.atan2(d*e,g*(1+c)),g?-h(d*f/g):0]},(d3.geo.wiechel=function(){return wb(gb)}).raw=gb,hb.invert=function(a,b){var c=a,d=b,e=25;do{var f,g=Math.cos(d),h=Math.sin(d),j=Math.sin(2*d),k=h*h,l=g*g,m=Math.sin(c),n=Math.cos(c/2),o=Math.sin(c/2),p=o*o,q=1-l*n*n,r=q?i(g*n)*Math.sqrt(f=1/q):f=0,s=.5*(2*r*g*o+c/sb)-a,t=.5*(r*h+d)-b,u=.5*f*(l*p+r*g*n*k)+.5/sb,v=f*(m*j/4-r*h*o),w=.125*f*(j*o-r*h*l*m),x=.5*f*(k*n+r*p*g)+.5,y=v*w-x*u,z=(t*v-s*x)/y,A=(s*w-t*u)/y;c-=z,d-=A}while((Math.abs(z)>pb||Math.abs(A)>pb)&&--e>0);return[c,d]},(d3.geo.winkel3=function(){return wb(hb)}).raw=hb}(),function(a,b){"function"==typeof define&&define.amd?define(["d3"],b):"object"==typeof module&&module.exports?module.exports=function(a){return a.tip=b(a),a.tip}:a.d3.tip=b(a.d3)}(this,function(a){return function(){function b(a){v=o(a),w=v.createSVGPoint(),document.body.appendChild(u);
}function c(){return"n"}function d(){return[0,0]}function e(){return" "}function f(){var a=q();return{top:a.n.y-u.offsetHeight,left:a.n.x-u.offsetWidth/2}}function g(){var a=q();return{top:a.s.y,left:a.s.x-u.offsetWidth/2}}function h(){var a=q();return{top:a.e.y-u.offsetHeight/2,left:a.e.x}}function i(){var a=q();return{top:a.w.y-u.offsetHeight/2,left:a.w.x-u.offsetWidth}}function j(){var a=q();return{top:a.nw.y-u.offsetHeight,left:a.nw.x-u.offsetWidth}}function k(){var a=q();return{top:a.ne.y-u.offsetHeight,left:a.ne.x}}function l(){var a=q();return{top:a.sw.y,left:a.sw.x-u.offsetWidth}}function m(){var a=q();return{top:a.se.y,left:a.e.x}}function n(){var b=a.select(document.createElement("div"));return b.style({position:"absolute",top:0,opacity:0,"pointer-events":"none","box-sizing":"border-box"}),b.node()}function o(a){return a=a.node(),"svg"===a.tagName.toLowerCase()?a:a.ownerSVGElement}function p(){return null===u&&(u=n(),document.body.appendChild(u)),a.select(u)}function q(){for(var b=x||a.event.target;"undefined"==typeof b.getScreenCTM&&"undefined"===b.parentNode;)b=b.parentNode;var c={},d=b.getScreenCTM(),e=b.getBBox(),f=e.width,g=e.height,h=e.x,i=e.y;return w.x=h,w.y=i,c.nw=w.matrixTransform(d),w.x+=f,c.ne=w.matrixTransform(d),w.y+=g,c.se=w.matrixTransform(d),w.x-=f,c.sw=w.matrixTransform(d),w.y-=g/2,c.w=w.matrixTransform(d),w.x+=f,c.e=w.matrixTransform(d),w.x-=f/2,w.y-=g/2,c.n=w.matrixTransform(d),w.y+=g,c.s=w.matrixTransform(d),c}var r=c,s=d,t=e,u=n(),v=null,w=null,x=null;b.show=function(){var a=Array.prototype.slice.call(arguments);a[a.length-1]instanceof SVGElement&&(x=a.pop());var c,d=t.apply(this,a),e=s.apply(this,a),f=r.apply(this,a),g=p(),h=z.length,i=document.documentElement.scrollTop||document.body.scrollTop,j=document.documentElement.scrollLeft||document.body.scrollLeft;for(g.html(d).style({opacity:1,"pointer-events":"all"});h--;)g.classed(z[h],!1);return c=y.get(f).apply(this),g.classed(f,!0).style({top:c.top+e[0]+i+"px",left:c.left+e[1]+j+"px"}),b},b.hide=function(){var a=p();return a.style({opacity:0,"pointer-events":"none"}),b},b.attr=function(c,d){if(arguments.length<2&&"string"==typeof c)return p().attr(c);var e=Array.prototype.slice.call(arguments);return a.selection.prototype.attr.apply(p(),e),b},b.style=function(c,d){if(arguments.length<2&&"string"==typeof c)return p().style(c);var e=Array.prototype.slice.call(arguments);return a.selection.prototype.style.apply(p(),e),b},b.direction=function(c){return arguments.length?(r=null==c?c:a.functor(c),b):r},b.offset=function(c){return arguments.length?(s=null==c?c:a.functor(c),b):s},b.html=function(c){return arguments.length?(t=null==c?c:a.functor(c),b):t},b.destroy=function(){return u&&(p().remove(),u=null),b};var y=a.map({n:f,s:g,e:h,w:i,nw:j,ne:k,sw:l,se:m}),z=y.keys();return b}}),!function(a){"use strict";a.module("gm.datepickerMultiSelect",["ui.bootstrap"]).config(["$provide","$injector",function(b,c){var d=function(b){var c=b[0],d=c.link;return c.compile=function(){return function(b,c,e,f){if(d.apply(this,arguments),a.isDefined(e.multiSelect)){b.selectedDates=[],b.selectRange,b.$parent.$watchCollection(e.multiSelect,function(a){b.selectedDates=a||[]}),e.$observe("selectRange",function(a){b.selectRange=!!a&&"false"!==a});var g=f[1];g.$viewChangeListeners.push(function(){var a=b.$parent.$eval(e.ngModel);if(a){var c=a.getTime(),d=b.selectedDates;if(b.selectRange){if(!d.length||d.length>1||d[0]==c)return d.splice(0,d.length,c);d.push(c);var f=Math.min.apply(null,d),g=Math.max.apply(null,d);for(f=new Date(f).setHours(24);g>f;)d.push(f),f=new Date(f).setHours(24)}else d.indexOf(c)<0?d.push(c):d.splice(d.indexOf(c),1)}})}}},b};c.has("datepickerDirective")&&b.decorator("datepickerDirective",["$delegate",d]),c.has("uibDatepickerDirective")&&b.decorator("uibDatepickerDirective",["$delegate",d]);var e=function(b){var c=b[0],d=c.link;return c.compile=function(){return function(b,c,e,f){function g(){a.forEach(b.rows,function(c){a.forEach(c,function(a){a.selected=b.selectedDates.indexOf(a.date.setHours(0,0,0,0))>-1})})}if(d.apply(this,arguments),a.isDefined(b.$parent.selectedDates)){b.$parent.$watchCollection("selectedDates",g);var h=a.isArray(f)?f[0]:f;b.$watch(function(){return h.activeDate.getTime()},g)}}},b};c.has("daypickerDirective")&&b.decorator("daypickerDirective",["$delegate",e]),c.has("uibDaypickerDirective")&&b.decorator("uibDaypickerDirective",["$delegate",e])}])}(window.angular),function(){"use strict";angular.module("PortalCommon",["ngCookies"]).config(["$provide",function(a){a.decorator("$exceptionHandler",["$delegate","GoogleAnalyticsService",function(a,b){return function(c,d){a(c,d),b.sendException(c,d)}}])}]),angular.module("jwNullAuthentication",[])}(),function(){"use strict";angular.module("PortalCommon").controller("LoginController",["$scope","$location","SessionService","AuthenticationService",function(a,b,c,d){a.forgotLinkBase="/#/account/forgot",a.forgotLink=a.forgotLinkBase,a.submittingForm=!1,a.error=!1,a.errorMessage=void 0,a.email=a.getGlobal("emailLogin"),a.password=void 0;var e=function(b,c){b===!0?(a.error=!0,a.errorMessage=c):b===!1&&(a.error=!1,a.errorMessage=void 0)};a.getGlobal("emailChanged")===!1&&(e(!0,"There was a problem when updating email address."),a.clearGlobal("emailChanged")),a.$watch(function(){return a.getGlobal("emailLogin")},function(b){a.email=b}),a.$watch("email",function(b){"undefined"!=typeof b?a.forgotLink=a.forgotLinkBase+"?email="+encodeURIComponent(b):a.forgotLink=a.forgotLinkBase}),a.$watch(function(){return d.isAuthorized()},function(b,c){c!==b&&(a.email=void 0,a.password=void 0)}),a.submitForm=function(){a.submittingForm=!0,e(!1),c.createSession(a.email,a.password,function(){a.clearGlobal("emailLogin"),a.submittingForm=!1},function(b){a.submittingForm=!1,e(!0,"The email or password you entered is incorrect. Please try again.")})}}])}(),function(){"use strict";function a(a){a.addClass("has-error")}function b(a){a.removeClass("has-error")}function c(a){a.removeClass("ng-hide")}function d(a){a.addClass("ng-hide")}function e(a,b,c){var d=a.bind("blur",function(){b.checkPristine()||(b.setAttempted(!0),a.unbind("blur",d))}),e=a.bind("keyup",function(){a.scope().$apply(function(){c.submit.disabled=!1}),a.unbind("keyupHandler",e)})}function f(a,b){b.addClass("animate-error"),a(function(){b.removeClass("animate-error")},300)}angular.module("PortalCommon").factory("ValidationSet",[function(){function a(){var a=this;a.controllers=[],_.each(arguments,function(b){a.controllers.push(b)})}return a.prototype={addController:function(a){this.controllers.push(a)},invalid:function(){return _.chain(this.controllers).map(function(a){return!a.isValid()}).any().value()}},a}]),angular.module("PortalCommon").directive("jwForm",["$parse","$timeout","ValidationSet",function(a,b,c){return{require:["jwForm"],restrict:"E",controller:["$scope",function(a){function b(a,b){n.push(a),b&&(_.has(r,b)?r[b].addController(a):r[b]=new c(a)),_.has(q,a.getName())?q[a.getName()].push(a.model):q[a.getName()]=[a.model]}function d(){return _.any(n,function(a){return a.hasChanged()})}function e(){return m}function f(){return _.all(n,function(a){return a.isValid()})}function g(){return _.all(n,function(a){return a.isPristine()})}function h(a){n=_.reject(n,function(b){return b===a})}function i(){_.each(n,function(a){a.revertInitial()})}function j(a){m=a,_.each(n,function(b){b.setAttempted(a)})}function k(){_.each(n,function(a){a.updateInitial()})}var l=this,m=!1,n=[],o={},p={},q={},r={};l.addController=b,l.isTriggered=e,l.isValid=f,l.removeController=h,l.revertInitial=i,l.setTriggered=j,l.updateInitial=k,l.form=o,l.models=q,l.submit=p,l.sections=r,a.$watch(d,function(a){o.changed=a}),a.$watch(f,function(a){o.valid=a}),a.$watch(g,function(a){p.disabled=a})}],link:function(c,d,e,g){var h,i,j,k=g[0],l=a(e.submit),m=e.name||"";h=function(a){a.disabled=!0},i=j=function(a){a.disabled=!1},m&&(c[m]=k),c.$on("submitTriggered",function(a,e,g,n){if(k.setTriggered(!0),e===m&&k.isValid()){var o=l(c,{$event:g,$data:n});o&&o.then&&(h(g.srcElement),o.then(function(){i(g.srcElement),k.setTriggered(!1),k.updateInitial()},function(){j(g.srcElement)}))}else f(b,d)})}}}]),angular.module("PortalCommon").directive("jwFormSubmit",["$rootScope",function(a){return{restrict:"A",link:function(b,c,d){if(d.ngClick)throw'** ERROR **: Put submit handlers on jw-form directive (e.g. <jw-form submit="'+d.ngClick+'">) not here :: from';c.bind("click",function(b){a.$broadcast("submitTriggered",d.jwFormSubmit,b,d.jwSubmitData)})}}}]),angular.module("PortalCommon").directive("jwValidationHolder",[function(){return{require:["jwValidationHolder","^jwForm"],restrict:"A",controller:["$scope",function(a){function b(b){var c,d=function(){return b.$modelValue};c=a.$watch(d,function(a){Number.Nan!==a&&(n=angular.copy(q.$modelValue),c())})}function c(a){if(q)throw"only one form control should be registered";q=a,o.model=a,a.$setAttempted=l,b(a)}function d(){return q.$viewValue&&(s=!1),h()}function e(){return q.$name}function f(){return r.attempted=p,r.errors=_.keys(q.$error).join(","),r}function g(){return!angular.equals(q.$modelValue,n)}function h(){return s&&q.$pristine}function i(){return 0===f().errors.length}function j(){q.$setPristine(),q.$setUntouched()}function k(){q.$modelValue=angular.copy(n),j()}function l(a){p=a}function m(){n=angular.copy(q.$modelValue),j()}var n,o=this,p=!1,q=!1,r={},s=!0;o.addController=c,o.checkPristine=d,o.getName=e,o.getValidationState=f,o.hasChanged=g,o.isPristine=h,o.isValid=i,o.revertInitial=k,o.setAttempted=l,o.updateInitial=m}],link:function(c,d,e,f){var g=f[0],h=f[1];h.addController(g,e.jwFormSection),d.addClass("error-message"),c.$watchCollection(g.getValidationState,function(c){c.attempted&&c.errors.length?a(d):b(d)})}}}]),angular.module("PortalCommon").directive("jwValidatedControl",[function(){return{require:["ngModel","^jwValidationHolder","^jwForm"],restrict:"A",link:function(a,b,c,d){var f=d[0],g=d[1],h=d[2];g.addController(f),b.addClass("form-control"),e(b,g,h)}}}]),angular.module("PortalCommon").directive("showWhenAttemptedAndInvalid",["$parse",function(a){return{require:["^jwValidationHolder"],restrict:"A",link:function(b,e,f,g){var h=g[0],i=a(f.showWhenAttemptedAndInvalid)(b).split(",");e.addClass("validation"),b.$watchCollection(h.getValidationState,function(a){a.attempted&&_.any(i,function(b){return _.contains(a.errors.split(","),b)})?c(e):d(e)})}}}]),angular.module("PortalCommon").directive("validateError",function(){return{replace:!0,template:function(a){var b,c=["type","id","class","validate-type","validated-model","validate-error","validate-type-value","validate-form"],d=_.chain(a[0].attributes).filter(function(a){return!_.contains(c,a.name)}).map(function(a){return a.name+'="'+a.value+'"'}).join(" ").value();a.attr("validate-form")?b=a.attr("validate-form"):(b=a.parents()[a.parentsUntil("form").length],b&&(b=b.name));var e=a.attr("validated-model").replace(/[^\w]/g,""),f=a.attr("validate-type");if(f)var g=f.replace(/-([a-z])/g,function(a){return a[1].toUpperCase()});else var g="";a.attr("validate-type-value")&&(f+='="'+a.attr("validate-type-value")+'"');var h=b+"."+e+".$dirty",i=b+".$submitted",j=b+"."+e+".$error."+g;return'<div class="input-error-wrapper"><div class="input-error" ng-show="('+h+" || "+i+") && "+j+'">'+a.attr("validate-error")+'</div><input type="text" name="'+e+'" ng-model="'+a.attr("validated-model")+'" ng-disabled="'+a.attr("validate-input-disabled")+'" class="form-control" '+f+" ng-model-options=\"{ updateOn: 'blur' }\" "+d+"/></div>"}}});var g=/^\d+$/,h=/^\-?\d+$/;angular.module("PortalCommon").directive("jwInteger",function(){return{require:"ngModel",link:function(a,b,c,d){d.$validators.jwInteger=function(a,b){return d.$isEmpty(a)||h.test(b)}}}});var i=/^[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/;angular.module("PortalCommon").directive("jwEmail",function(){return{require:"ngModel",link:function(a,b,c,d){d.$validators.jwEmail=function(a,b){return d.$isEmpty(a)||i.test(b)}}}}),angular.module("PortalCommon").directive("jwEqual",function(){return{require:"ngModel",link:function(a,b,c,d){d.jwEqual=c.jwEqual,d.scope=a,d.$validators.jwEqual=function(a,b){var c=d.scope.$eval(d.jwEqual);return d.$isEmpty(c)||b==c}}}}),angular.module("PortalCommon").directive("jwDate",["$locale",function(a){return{require:"ngModel",link:function(b,c,d,e){e.$validators.jwDate=function(b,c){if(!c||e.$isEmpty(b))return!0;var d=c.split(" ");return 3==d.length&&-1!=a.DATETIME_FORMATS.SHORTMONTH.indexOf(d[0])&&g.test(d[1].slice(0,-1))&&","==d[1][d[1].length-1]&&4==d[2].length&&g.test(d[2])}}}}]),angular.module("PortalCommon").directive("jwTime",function(){return{require:"ngModel",link:function(a,b,c,d){d.$validators.jwTime=function(a,b){if(!b||d.$isEmpty(a))return!0;var c=b.split(":");return 3==c.length&&_.all(c,function(a){return g.test(a)&&2==a.length})&&c[0]<24&&c[1]<60&&c[2]<60}}}}),angular.module("PortalCommon").directive("jwPresent",function(){return{require:"ngModel",link:function(a,b,c,d){d.$validators.jwPresent=function(a,b){return d.$pristine||!d.$isEmpty(a)}}}})}(),function(){"use strict";angular.module("PortalCommon").factory("AlertService",["$cookies","$rootScope","MathService",function(a,b,c){var d={};b.pageAlerts=[],b.systemWideAlerts=[],d.createPageAlert=function(a,c){b.pageAlerts=[],b.pageAlerts.push({message:a,type:c,close:function(){return d.dismissPageAlert(this)}})},d.dismissPageAlert=function(a){var c=b.pageAlerts.indexOf(a);b.pageAlerts.splice(c,1)},b.$on("$routeChangeSuccess",function(){b.pageAlerts=[]}),"undefined"==typeof a.dismissedSystemWideAlertIds&&(a.dismissedSystemWideAlertIds=[]);var e=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*c.random()|0,d="x"==a?b:3&b|8;return d.toString(16)})},f=function(a,c,f){"undefined"==typeof f&&(f=e()),b.systemWideAlerts.push({message:a,type:c,id:f,close:function(){return d.dismissSystemWideAlert(this)}})};return d.createSystemWideAlert=f,d.dismissSystemWideAlert=function(c){var d=b.systemWideAlerts.indexOf(c);b.systemWideAlerts.splice(d,1),-1!=a.dismissedSystemWideAlertIds.indexOf(c.id)&&a.dismissedSystemWideAlertIds.push(c.id)},d.retreiveSystemWideAlerts=function(){var c=[];angular.forEach(b.systemWideAlerts,function(a,b){c.push(a.id)});var d=a.dismissedSystemWideAlertIds;"undefined"==typeof d&&(d=[]);var e=[];angular.forEach(e,function(a,b){var e=-1!=c.indexOf(a.id),g=-1!=d.indexOf(a.id),h=!(e||g);h&&f(a.message,a.type,a.id)})},d}])}(),function(){"use strict";angular.module("PortalCommon").factory("AnimationFrameService",["$exceptionHandler","$rootScope","$timeout","$window",function(a,b,c,d){var e,f,g,h=1e3/60;return f=d.performance&&d.performance.now?function(){return d.performance.now()}:angular.noop,d.cancelAnimationFrame&&d.requestAnimationFrame?(e=function(a){return d.cancelAnimationFrame(a)},g=function(c,e){return d.requestAnimationFrame(function(d){try{c(d)}catch(f){a(f)}e&&b.$apply()})}):(e=function(a){c.cancel(a)},g=function(a,b){return c(function(){a(f())},h,!!b)}),{cancelAnimationFrame:e,requestAnimationFrame:g}}])}(),function(){"use strict";angular.module("PortalCommon").factory("BrowserService",["$location","$window","ConfigService",function(a,b,c){function d(){return b.bowser.name}function e(){return!_.some(_.keys(i),function(a){return b.bowser[a]&&parseFloat(b.bowser.version)>=parseFloat(i[a].satisfyVersion)})}function f(){return _.some(_.keys(j),function(a){return b.bowser[a]&&parseFloat(b.bowser.version)<parseFloat(j[a].belowVersion)})}function g(){var a=_.find(_.keys(i),function(a){return b.bowser[a]});return i[a]}function h(){return b.bowser.safari}var i=c.get("supportedBrowsers"),j=c.get("unsupportedBrowsers");return{getCurrentSupportedBrowser:g,getBrowserName:d,isBrowserOutdated:e,isBrowserUnsupported:f,isSafari:h}}])}(),function(){"use strict";angular.module("PortalCommon").factory("CacheService",["$rootScope",function(a){var b={};a.$on("authorizationRevoked",function(){b={}});var c=function(){for(var a=b,c=1;c<arguments.length;c++){var d=arguments[c];"undefined"==typeof a[d]&&(a[d]={}),c===arguments.length-1?a[d]=arguments[0]:a=a[d]}},d=function(){for(var a=b,c=0;c<arguments.length;c++){var d=arguments[c];if("undefined"==typeof a[d])return;if(c===arguments.length-1)return a[d];a=a[d]}},e=function(){for(var a=b,c=0;c<arguments.length;c++){var d=arguments[c];if("undefined"==typeof a[d])return!1;if(c===arguments.length-1)return delete a[d],!0;a=a[d]}},f=function(){return"undefined"!=typeof d.apply(this,arguments)};return{get:d,has:f,put:c,remove:e}}])}(),function(){"use strict";angular.module("PortalCommon").factory("CommunicationService",["$cookies","$http","$log","$timeout","$rootScope","$q","CacheService","AuthenticationService","ConfigService",function(a,b,c,d,e,f,g,h,i){function j(a){return _.chain(a.log.entries).filter(k).groupBy(l).mapObject(m).value()}function k(a){return"OPTIONS"!==a.request.method&&a.response.content.text}function l(a){return a.request.method}function m(a){return _.map(a,n)}function n(a){return{request:new RegExp(a.request.url),response:{status:a.response.status,content:JSON.parse(a.response.content.text)}}}function o(a,b){return _.find(q&&q[a],function(a){return a.request.test(b)})}var p,q,r=/^(\/\d+)?\/testing\/mocks\/.*$/,s=!!a.mocks&&r.test(a.mocks),t=a.mocks;s&&(p=b.get(t),p.then(function(a){q=j(a.data),c.warn("MOCK COMMUNICATION DATA:",q)},function(a){s=!1}));var u=function(a,b,c,d,e,f,h){var i={success:d,error:e,resolve:f,reject:h};if(g.has("callbacks",a,b,c)){var j=g.get("callbacks",a,b,c);j.push(i)}else g.put([i],"callbacks",a,b,c)},v=function(a,b,c){return g.get("callbacks",a,b,c)},w=function(a,b,c){return g.remove("callbacks",a,b,c)},x=function(a,b,c,d){angular.forEach(v(a,b,c),function(a){a.success&&a.success(d),a.resolve&&a.resolve(d)}),w(a,b,c)},y=function(a,b,c,d){angular.forEach(v(a,b,c),function(a){var b=d.data&&d.data.code||void 0;(a.error||angular.noop)(d.status,b),a.reject&&a.reject(d)}),w(a,b,c)},z=function(a,d,e,j,k,l,m){var n=i.get("overridePerEnvironment","communication","apiRootUrl");e.method=a,e.url=n+d,e.headers={"Content-Type":"application/json"};var p=h.getSignature();"undefined"!=typeof p&&(e.headers.Authorization=p),"object"==typeof m&&angular.extend(e.headers,m);var q,r=[];for(q in e.data)r.push(q+"="+e.data[q]);for(q in e.params)r.push(q+"="+e.params[q]);r.sort();var t=r.join(" ");if(s){var w=o(a,d);if(w)return c.warn("MOCK COMMUNICATION:",w.response.status,"|",a,"|",d),j(w.response.content),f(function(a){a(w.response.content)})}if(l===!0&&g.has(a,d,t))return c.debug("COMMUNICATION CACHE: "+a+" | "+d+" | "+t),j(g.get(a,d,t)),f(function(b){b(g.get(a,d,t))});var z=f(function(f,i){"GET"==a&&u(a,d,t,j,k,f,i),"GET"==a&&v(a,d,t).length>1?c.debug("COMMUNICATION DUPE: "+a+" | "+d):(c.debug("COMMUNICATION SENT: "+a+" | "+d),e.timeout||(e.timeout=z),b(e).then(function(b){var e=b.data,h=b.status;if(c.debug("COMMUNICATION SUCCESS: "+h+" | "+a+" | "+d),null===e||"object"==typeof e&&"error"===e.status)if("GET"==a)y(a,d,t,b);else{if(k){var m=e&&e.code||void 0;k(h,m)}i(b)}else{var n="undefined"==typeof e.return_value?e:e.return_value;l===!0&&g.put(n,a,d,t),"GET"==a?x(a,d,t,n):(j&&j(n),f(n))}})["catch"](function(b){var e=b.data,f=b.status,g=b.config;if(0!==f){if(c.error("COMMUNICATION ERROR: "+f+" | "+a+" | "+d),403===f){var j=["/v2/proxy/botr/accounts/show","/v2/account/support"];_.any(j,function(a){return g.url.indexOf(a)!=g.url.length-a.length})||h.clearSignature()}if("GET"==a)y(a,d,t,b);else{if(k){var l=e&&e.code||void 0;k(f,l)}i(b)}}}))});return z};return{get:function(a,b,c,d,e,f){return z("GET",a,{params:b,data:{}},c,d,e,f)},post:function(a,b,c,d,e){return z("POST",a,{data:b},c,d,e)},put:function(a,b,c,d,e){return z("PUT",a,{data:b},c,d,e)},"delete":function(a,b,c,d){return z("DELETE",a,{},b,c,d)},botr:function(a,b,c,d,e){return z("POST","/proxy/botr"+a,{data:b},c,d,e)}}}])}(),function(){"use strict";angular.module("PortalCommon").factory("ConfigService",["_config","_localconfig",function(a,b){var c={};angular.extend(c,a),angular.extend(c,b);var d=function(a,b,c){if(c==b.length)return a;var e=b[c],f=a[e];return"undefined"!=typeof f?d(f,b,c+1):void 0},e=function(){var a=Array.prototype.slice.call(arguments,0);return d(c,a,0)};return{get:e}}])}(),function(){"use strict";angular.module("PortalCommon").factory("GoogleAnalyticsService",["$window",function(a){function b(){"create"===arguments[0]?(a.ga.apply(null,arguments),d&&d.forEach&&d.forEach(function(b){a.ga.apply(null,b)}),d=null):d&&d.push?d.push(arguments):a.ga.apply(null,arguments)}function c(a,c){b("send","exception",{exDescription:a.stack,exFatal:!1})}var d=[];return{ga:b,sendException:c}}])}(),function(){"use strict";angular.module("PortalCommon").factory("LocalStorageService",["$rootScope","$window",function(a,b){function c(){j&&j.clear()}function d(){return j?j.getItem(f(arguments)):void 0}function e(){return j?null!==j.getItem(f(arguments)):void 0}function f(a){return Array.prototype.join.call(a,".")}function g(){j&&j.setItem(f(_.rest(arguments)),_.first(arguments))}function h(){j&&j.removeItem(f(arguments))}function i(){return!!j}var j=b.localStorage;return a.$on("authorizationRevoked",c),{clear:c,get:d,has:e,put:g,remove:h,supported:i}}])}(),function(){"use strict";angular.module("PortalCommon").factory("MathService",["$window",function(a){function b(b,c,d){return a.Math.min(a.Math.max(c,b),d)}function c(a,b,c){return(1-c)*a+c*b}return angular.extend(a.Math,{bound:b,lerp:c})}])}(),function(){"use strict";angular.module("jwNullAuthentication").factory("AuthenticationService",[function(){function a(){return!0}return{applyRedirectAuth:angular.noop,clearSignature:angular.noop,getSignature:angular.noop,getUserToken:angular.noop,isAuthorized:a,setSignature:angular.noop}}])}(),function(){"use strict";angular.module("jwNullAuthentication").factory("SessionService",[function(){var a={$canViewPage:function(){return!0}};return{createSession:angular.noop,getAccountToken:angular.noop,getAccountSlug:angular.noop,getSiteToken:angular.noop,getUser:function(){return a},initialized:function(){return!0},loadErrored:angular.noop,previewMode:angular.noop,updateUser:angular.noop,determineEntitlement:angular.noop}}])}(),function(){"use strict";angular.module("PortalCommon").factory("PollingService",["$timeout","$rootScope",function(a,b){function c(a,c,e){this.interval=void 0,this.scope=e||b,this.timingFunction=d(c),this.execs=0,this.elapsedms=0,this.lastDelay=0,this.fn=a,this.scope.$on("$destroy",_.bind(this.stop,this))}function d(a){if(_.isFunction(a)){var b=a;return b}var c=a;return function(){return c}}return c.prototype={restart:function(){this.stop(),this.start()},start:function(){function b(){c.fn(),c.execs+=1,c.elapsedms+=c.lastDelay;var d=c.timingFunction(c.elapsedms,c.execs);d>0?(c.interval=a(b,d),c.lastDelay=d):c.interval=void 0}var c=this;angular.isDefined(this.interval)||(this.execs=0,this.elapsedms=0,b())},stop:function(){angular.isDefined(this.interval)&&(a.cancel(this.interval),this.interval=void 0)}},c}])}(),function(){"use strict";angular.module("PortalCommon").factory("StringService",[function(){function a(a){this.parts=a}function b(b){return new a(b.split(/\s+/))}return a.prototype.toDashes=function(){return this.parts.join("-")},{spaces:b}}])}(),function(){"use strict";angular.module("PortalCommon").factory("UrlService",["$location",function(a){function b(b,c){a.search(b,c)}function c(){return a.search()}function d(a){return"undefined"!=typeof c()[a]}function e(){var a=[],b=[],d=c();return angular.forEach(d,function(a,c){b.push(c)}),angular.forEach(b,function(b){a.push(b+"="+d[b])}),a.join("&")}function f(b){a.search(b,void 0)}function g(a,b){return b===c()[a]}return{addUrlParam:b,getUrlParams:c,hasUrlParam:d,paramString:e,removeUrlParam:f,urlParamEquals:g}}])}(),function(){"use strict";angular.module("PortalCommon").factory("UtilService",["MathService",function(a){function b(a,b){if("number"!=typeof a||0>a)return"-";var c;return a/g>1||k===b?(c=a/g,c>=100?Math.round(c)+" "+k:c.toFixed(1)+" "+k):a/h>1||l===b?(c=a/h,c>=100?Math.round(c)+" "+l:c.toFixed(1)+" "+l):a/i>1||m===b?(c=a/i,c>=100?Math.round(c)+" "+m:c.toFixed(1)+" "+m):a/j>1||n===b?(c=a/j,c>=100?Math.round(c)+" "+n:c.toFixed(1)+" "+n):a+" "+o}function c(b,c){var d="object"==typeof b&&b.hasOwnProperty("length")?b.length:parseInt(b);return a.floor(d/c)+(d%c>0)}function d(a,b,c){var d=_.sortBy(a,c);b||d.reverse(),a.length=0,_.each(d,function(b){a.push(b)})}function e(a,b,c){var d=(b-1)*c,e=d+c;return a.slice(d,e)}function f(b){for(var c="",d="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",e=b;e>0;--e)c+=d[a.round(a.random()*(d.length-1))];return c}var g=1e12,h=1e9,i=1e6,j=1e3,k="TB",l="GB",m="MB",n="KB",o="bytes";return{normalizeFileSize:b,numberPages:c,objectSort:d,paginate:e,randomString:f}}])}();var mod;mod=angular.module("infinite-scroll",[]),mod.value("THROTTLE_MILLISECONDS",null),mod.directive("infiniteScroll",["$rootScope","$window","$interval","THROTTLE_MILLISECONDS",function(a,b,c,d){return{scope:{infiniteScroll:"&",infiniteScrollContainer:"=",infiniteScrollDistance:"=",infiniteScrollDisabled:"=",infiniteScrollUseDocumentBottom:"=",infiniteScrollListenForEvent:"@"},link:function(e,f,g){var h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y;return y=angular.element(b),t=null,u=null,i=null,j=null,q=!0,x=!1,w=null,p=function(a){return a=a[0]||a,isNaN(a.offsetHeight)?a.document.documentElement.clientHeight:a.offsetHeight},r=function(a){return a[0].getBoundingClientRect&&!a.css("none")?a[0].getBoundingClientRect().top+s(a):void 0},s=function(a){return a=a[0]||a,isNaN(window.pageYOffset)?a.document.documentElement.scrollTop:a.ownerDocument.defaultView.pageYOffset},o=function(){var b,c,d,g,h;return j===y?(b=p(j)+s(j[0].document.documentElement),d=r(f)+p(f)):(b=p(j),c=0,void 0!==r(j)&&(c=r(j)),d=r(f)-c+p(f)),x&&(d=p((f[0].ownerDocument||f[0].document).documentElement)),g=d-b,h=g<=p(j)*t+1,h?(i=!0,u?e.$$phase||a.$$phase?e.infiniteScroll():e.$apply(e.infiniteScroll):void 0):i=!1},v=function(a,b){var d,e,f;return f=null,e=0,d=function(){var b;return e=(new Date).getTime(),c.cancel(f),f=null,a.call(),b=null},function(){var g,h;return g=(new Date).getTime(),h=b-(g-e),0>=h?(clearTimeout(f),c.cancel(f),f=null,e=g,a.call()):f?void 0:f=c(d,h,1)}},null!=d&&(o=v(o,d)),e.$on("$destroy",function(){return j.unbind("scroll",o),null!=w?(w(),w=null):void 0}),m=function(a){return t=parseFloat(a)||0},e.$watch("infiniteScrollDistance",m),m(e.infiniteScrollDistance),l=function(a){return u=!a,u&&i?(i=!1,o()):void 0},e.$watch("infiniteScrollDisabled",l),l(e.infiniteScrollDisabled),n=function(a){return x=a},e.$watch("infiniteScrollUseDocumentBottom",n),n(e.infiniteScrollUseDocumentBottom),h=function(a){return null!=j&&j.unbind("scroll",o),j=a,null!=a?j.bind("scroll",o):void 0},h(y),e.infiniteScrollListenForEvent&&(w=a.$on(e.infiniteScrollListenForEvent,o)),k=function(a){if(null!=a&&0!==a.length){if(a instanceof HTMLElement?a=angular.element(a):"function"==typeof a.append?a=angular.element(a[a.length-1]):"string"==typeof a&&(a=angular.element(document.querySelector(a))),null!=a)return h(a);throw new Exception("invalid infinite-scroll-container attribute.")}},e.$watch("infiniteScrollContainer",k),k(e.infiniteScrollContainer||[]),null!=g.infiniteScrollParent&&h(angular.element(f.parent())),null!=g.infiniteScrollImmediateCheck&&(q=e.$eval(g.infiniteScrollImmediateCheck)),c(function(){return q?o():void 0},0,1)}}}]),function(){function a(a,b){window.XMLHttpRequest.prototype[a]=b(window.XMLHttpRequest.prototype[a])}function b(a,b,c,d,g,h,i){function j(){return"input"===b[0].tagName.toLowerCase()&&b.attr("type")&&"file"===b.attr("type").toLowerCase()}function k(b){if(!p){p=!0;try{for(var i=b.__files_||b.target&&b.target.files,j=[],k=[],l=0;l<i.length;l++){var m=i.item(l);f(a,g,c,m,b)?j.push(m):k.push(m)}e(g,h,a,d,c,c.ngfChange||c.ngfSelect,j,k,b),0==j.length&&(b.target.value=j)}finally{p=!1}}}function l(d){c.ngfMultiple&&d.attr("multiple",g(c.ngfMultiple)(a)),g(c.ngfMultiple)(a)||d.attr("multiple",void 0),c.accept&&d.attr("accept",c.accept),c.ngfCapture&&d.attr("capture",g(c.ngfCapture)(a));for(var e=0;e<b[0].attributes.length;e++){var f=b[0].attributes[e];(j()&&"type"!==f.name||"type"!==f.name&&"class"!==f.name&&"id"!==f.name&&"style"!==f.name)&&d.attr(f.name,f.value)}}function m(c){if(!b.attr("disabled")){var d=angular.element('<input type="file">');return l(d),j()?(b.replaceWith(d),b=d,d.attr("__ngf_gen__",!0),i(b)(a)):(d.css("visibility","hidden").css("position","absolute").css("width","1").css("height","1").css("z-index","-100000").attr("tabindex","-1"),b.__ngf_ref_elem__&&b.__ngf_ref_elem__.remove(),b.__ngf_ref_elem__=d,document.body.appendChild(d[0])),d}}function n(b){e(g,h,a,d,c,c.ngfChange||c.ngfSelect,[],[],b,!0)}function o(a){function c(a){null!=a&&d[0].click(),j()&&b.bind("click touchend",o)}null!=a&&(a.preventDefault(),a.stopPropagation());var d=m(a);return d&&(d.bind("change",k),a&&n(a),navigator.userAgent.toLowerCase().match(/android/)?setTimeout(function(){c(a)},0):c(a)),!1}if(!b.attr("__ngf_gen__")){var p=!1;window.FileAPI&&window.FileAPI.ngfFixIE?window.FileAPI.ngfFixIE(b,m,l,k,n):(o(),j()||b.bind("click touchend",o))}}function c(a,b,c,g,h,i,j){function k(a,b,c){var d=!0,e=c.dataTransfer.items;if(null!=e)for(var g=0;g<e.length&&d;g++)d=d&&("file"==e[g].kind||""==e[g].kind)&&f(a,h,b,e[g],c);var i=h(b.ngfDragOverClass)(a,{$event:c});return i&&(i.delay&&(q=i.delay),i.accept&&(i=d?i.accept:i.reject)),i||b.ngfDragOverClass||"dragover"}function l(b,d,e,g){function k(d){f(a,h,c,d,b)?m.push(d):n.push(d)}function l(a,b,c){if(null!=b)if(b.isDirectory){var d=(c||"")+b.name;k({name:b.name,type:"directory",path:d});var e=b.createReader(),f=[];p++;var g=function(){e.readEntries(function(d){try{if(d.length)f=f.concat(Array.prototype.slice.call(d||[],0)),g();else{for(var e=0;e<f.length;e++)l(a,f[e],(c?c:"")+b.name+"/");p--}}catch(h){p--,console.error(h)}},function(){p--})};g()}else p++,b.file(function(a){try{p--,a.path=(c?c:"")+a.name,k(a)}catch(b){p--,console.error(b)}},function(){p--})}var m=[],n=[],o=b.dataTransfer.items,p=0;if(o&&o.length>0&&"file"!=j.protocol())for(var q=0;q<o.length;q++){if(o[q].webkitGetAsEntry&&o[q].webkitGetAsEntry()&&o[q].webkitGetAsEntry().isDirectory){var r=o[q].webkitGetAsEntry();if(r.isDirectory&&!e)continue;null!=r&&l(m,r)}else{var s=o[q].getAsFile();null!=s&&k(s)}if(!g&&m.length>0)break}else{var t=b.dataTransfer.files;if(null!=t)for(var q=0;q<t.length&&(k(t.item(q)),g||!(m.length>0));q++);}var u=0;!function v(a){i(function(){if(p)10*u++<2e4&&v(10);else{if(!g&&m.length>1){for(q=0;"directory"==m[q].type;)q++;m=[m[q]]}d(m,n)}},a||0)}()}var m=d();if(c.dropAvailable&&i(function(){a[c.dropAvailable]?a[c.dropAvailable].value=m:a[c.dropAvailable]=m}),!m)return void(1==h(c.ngfHideOnDropNotAvailable)(a)&&b.css("display","none"));var n,o=null,p=h(c.ngfStopPropagation),q=1;h(c.ngfAccept);b[0].addEventListener("dragover",function(d){if(!b.attr("disabled")){if(d.preventDefault(),p(a)&&d.stopPropagation(),navigator.userAgent.indexOf("Chrome")>-1){var e=d.dataTransfer.effectAllowed;d.dataTransfer.dropEffect="move"===e||"linkMove"===e?"move":"copy"}i.cancel(o),a.actualDragOverClass||(n=k(a,c,d)),b.addClass(n)}},!1),b[0].addEventListener("dragenter",function(c){b.attr("disabled")||(c.preventDefault(),p(a)&&c.stopPropagation())},!1),b[0].addEventListener("dragleave",function(){b.attr("disabled")||(o=i(function(){b.removeClass(n),n=null},q||1))},!1),b[0].addEventListener("drop",function(d){b.attr("disabled")||(d.preventDefault(),p(a)&&d.stopPropagation(),b.removeClass(n),n=null,l(d,function(b,f){e(h,i,a,g,c,c.ngfChange||c.ngfDrop,b,f,d)},0!=h(c.ngfAllowDir)(a),c.multiple||h(c.ngfMultiple)(a)))},!1)}function d(){var a=document.createElement("div");return"draggable"in a&&"ondrop"in a}function e(a,b,c,d,e,f,g,h,i,j){function k(){d&&(a(e.ngModel).assign(c,g),
b(function(){d&&d.$setViewValue(null!=g&&0==g.length?null:g)})),e.ngModelRejected&&a(e.ngModelRejected).assign(c,h),f&&a(f)(c,{$files:g,$rejectedFiles:h,$event:i})}j?k():b(function(){k()})}function f(a,b,c,d,e){var f=b(c.ngfAccept)(a,{$file:d,$event:e}),h=b(c.ngfMaxSize)(a,{$file:d,$event:e})||9007199254740991,i=b(c.ngfMinSize)(a,{$file:d,$event:e})||-1;if(null!=f&&angular.isString(f)){var j=new RegExp(g(f),"gi");f=null!=d.type&&j.test(d.type.toLowerCase())||null!=d.name&&j.test(d.name.toLowerCase())}return(null==f||f)&&(null==d.size||d.size<h&&d.size>i)}function g(a){if(a.length>2&&"/"===a[0]&&"/"===a[a.length-1])return a.substring(1,a.length-1);var b=a.split(","),c="";if(b.length>1)for(var d=0;d<b.length;d++)c+="("+g(b[d])+")",d<b.length-1&&(c+="|");else 0==a.indexOf(".")&&(a="*"+a),c="^"+a.replace(new RegExp("[.\\\\+*?\\[\\^\\]$(){}=!<>|:\\-]","g"),"\\$&")+"$",c=c.replace(/\\\*/g,".*").replace(/\\\?/g,".");return c}var h;window.XMLHttpRequest&&!window.XMLHttpRequest.__isFileAPIShim&&a("setRequestHeader",function(a){return function(b,c){if("__setXHR_"===b){var d=c(this);d instanceof Function&&d(this)}else a.apply(this,arguments)}});var i=angular.module("ngFileUpload",[]);i.version="4.2.4",i.service("Upload",["$http","$q","$timeout",function(a,b,c){function d(d){d.method=d.method||"POST",d.headers=d.headers||{},d.transformRequest=d.transformRequest||function(b,c){return window.ArrayBuffer&&b instanceof window.ArrayBuffer?b:a.defaults.transformRequest[0](b,c)};var e=b.defer(),f=e.promise;return d.headers.__setXHR_=function(){return function(a){a&&(d.__XHR=a,d.xhrFn&&d.xhrFn(a),a.upload.addEventListener("progress",function(a){a.config=d,e.notify?e.notify(a):f.progress_fn&&c(function(){f.progress_fn(a)})},!1),a.upload.addEventListener("load",function(a){a.lengthComputable&&(a.config=d,e.notify?e.notify(a):f.progress_fn&&c(function(){f.progress_fn(a)}))},!1))}},a(d).then(function(a){e.resolve(a)},function(a){e.reject(a)},function(a){e.notify(a)}),f.success=function(a){return f.then(function(b){a(b.data,b.status,b.headers,d)}),f},f.error=function(a){return f.then(null,function(b){a(b.data,b.status,b.headers,d)}),f},f.progress=function(a){return f.progress_fn=a,f.then(null,null,function(b){a(b)}),f},f.abort=function(){return d.__XHR&&c(function(){d.__XHR.abort()}),f},f.xhr=function(a){return d.xhrFn=function(b){return function(){b&&b.apply(f,arguments),a.apply(f,arguments)}}(d.xhrFn),f},f}this.upload=function(a){return a.headers=a.headers||{},a.headers["Content-Type"]=void 0,a.transformRequest=a.transformRequest?angular.isArray(a.transformRequest)?a.transformRequest:[a.transformRequest]:[],a.transformRequest.push(function(b){var c=new FormData,d={};for(h in a.fields)a.fields.hasOwnProperty(h)&&(d[h]=a.fields[h]);if(b&&(d.data=b),a.formDataAppender)for(h in d)d.hasOwnProperty(h)&&a.formDataAppender(c,h,d[h]);else for(h in d)if(d.hasOwnProperty(h)){var e=d[h];void 0!==e&&(angular.isDate(e)&&(e=e.toISOString()),angular.isString(e)?c.append(h,e):a.sendObjectsAsJsonBlob&&angular.isObject(e)?c.append(h,new Blob([e],{type:"application/json"})):c.append(h,JSON.stringify(e)))}if(null!=a.file){var f=a.fileFormDataName||"file";if(angular.isArray(a.file))for(var g=angular.isString(f),i=0;i<a.file.length;i++)c.append(g?f:f[i],a.file[i],a.fileName&&a.fileName[i]||a.file[i].name);else c.append(f,a.file,a.fileName||a.file.name)}return c}),d(a)},this.http=function(a){return d(a)}}]),i.directive("ngfSelect",["$parse","$timeout","$compile",function(a,c,d){return{restrict:"AEC",require:"?ngModel",link:function(e,f,g,h){b(e,f,g,h,a,c,d)}}}]),i.directive("ngfDrop",["$parse","$timeout","$location",function(a,b,d){return{restrict:"AEC",require:"?ngModel",link:function(e,f,g,h){c(e,f,g,h,a,b,d)}}}]),i.directive("ngfNoFileDrop",function(){return function(a,b){d()&&b.css("display","none")}}),i.directive("ngfDropAvailable",["$parse","$timeout",function(a,b){return function(c,e,f){if(d()){var g=a(f.ngfDropAvailable);b(function(){g(c),g.assign&&g.assign(c,!0)})}}}]),i.directive("ngfSrc",["$parse","$timeout",function(a,b){return{restrict:"AE",link:function(c,d,e,g){window.FileReader&&c.$watch(e.ngfSrc,function(g){g&&f(c,a,e,g,null)&&(!window.FileAPI||-1===navigator.userAgent.indexOf("MSIE 8")||g.size<2e4)&&(!window.FileAPI||-1===navigator.userAgent.indexOf("MSIE 9")||g.size<4e6)?b(function(){var a=window.URL||window.webkitURL;if(a&&a.createObjectURL)d.attr("src",a.createObjectURL(g));else{var c=new FileReader;c.readAsDataURL(g),c.onload=function(a){b(function(){d.attr("src",a.target.result)})}}}):d.attr("src",e.ngfDefaultSrc||"")})}}}])}(),function(){function a(a,b){window.XMLHttpRequest.prototype[a]=b(window.XMLHttpRequest.prototype[a])}function b(a,b,c){try{Object.defineProperty(a,b,{get:c})}catch(d){}}function c(a){return"input"===a[0].tagName.toLowerCase()&&a.attr("type")&&"file"===a.attr("type").toLowerCase()}var d=function(){try{var a=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");if(a)return!0}catch(b){if(void 0!=navigator.mimeTypes["application/x-shockwave-flash"])return!0}return!1};if(window.XMLHttpRequest&&!window.FormData||window.FileAPI&&FileAPI.forceLoad){var e=function(a){if(!a.__listeners){a.upload||(a.upload={}),a.__listeners=[];var b=a.upload.addEventListener;a.upload.addEventListener=function(c,d,e){a.__listeners[c]=d,b&&b.apply(this,arguments)}}};a("open",function(a){return function(b,c,d){e(this),this.__url=c;try{a.apply(this,[b,c,d])}catch(f){f.message.indexOf("Access is denied")>-1&&(this.__origError=f,a.apply(this,[b,"_fix_for_ie_crossdomain__",d]))}}}),a("getResponseHeader",function(a){return function(b){return this.__fileApiXHR&&this.__fileApiXHR.getResponseHeader?this.__fileApiXHR.getResponseHeader(b):null==a?null:a.apply(this,[b])}}),a("getAllResponseHeaders",function(a){return function(){return this.__fileApiXHR&&this.__fileApiXHR.getAllResponseHeaders?this.__fileApiXHR.getAllResponseHeaders():null==a?null:a.apply(this)}}),a("abort",function(a){return function(){return this.__fileApiXHR&&this.__fileApiXHR.abort?this.__fileApiXHR.abort():null==a?null:a.apply(this)}}),a("setRequestHeader",function(a){return function(b,c){if("__setXHR_"===b){e(this);var d=c(this);d instanceof Function&&d(this)}else this.__requestHeaders=this.__requestHeaders||{},this.__requestHeaders[b]=c,a.apply(this,arguments)}}),a("send",function(a){return function(){var c=this;if(arguments[0]&&arguments[0].__isFileAPIShim){var e=arguments[0],f={url:c.__url,jsonp:!1,cache:!0,complete:function(a,d){c.__completed=!0,!a&&c.__listeners.load&&c.__listeners.load({type:"load",loaded:c.__loaded,total:c.__total,target:c,lengthComputable:!0}),!a&&c.__listeners.loadend&&c.__listeners.loadend({type:"loadend",loaded:c.__loaded,total:c.__total,target:c,lengthComputable:!0}),"abort"===a&&c.__listeners.abort&&c.__listeners.abort({type:"abort",loaded:c.__loaded,total:c.__total,target:c,lengthComputable:!0}),void 0!==d.status&&b(c,"status",function(){return 0==d.status&&a&&"abort"!==a?500:d.status}),void 0!==d.statusText&&b(c,"statusText",function(){return d.statusText}),b(c,"readyState",function(){return 4}),void 0!==d.response&&b(c,"response",function(){return d.response});var e=d.responseText||(a&&0==d.status&&"abort"!==a?a:void 0);b(c,"responseText",function(){return e}),b(c,"response",function(){return e}),a&&b(c,"err",function(){return a}),c.__fileApiXHR=d,c.onreadystatechange&&c.onreadystatechange(),c.onload&&c.onload()},progress:function(a){if(a.target=c,c.__listeners.progress&&c.__listeners.progress(a),c.__total=a.total,c.__loaded=a.loaded,a.total===a.loaded){var b=this;setTimeout(function(){c.__completed||(c.getAllResponseHeaders=function(){},b.complete(null,{status:204,statusText:"No Content"}))},FileAPI.noContentTimeout||1e4)}},headers:c.__requestHeaders};f.data={},f.files={};for(var g=0;g<e.data.length;g++){var h=e.data[g];null!=h.val&&null!=h.val.name&&null!=h.val.size&&null!=h.val.type?f.files[h.key]=h.val:f.data[h.key]=h.val}setTimeout(function(){if(!d())throw'Adode Flash Player need to be installed. To check ahead use "FileAPI.hasFlash"';c.__fileApiXHR=FileAPI.upload(f)},1)}else{if(this.__origError)throw this.__origError;a.apply(c,arguments)}}}),window.XMLHttpRequest.__isFileAPIShim=!0,window.FormData=FormData=function(){return{append:function(a,b,c){b.__isFileAPIBlobShim&&(b=b.data[0]),this.data.push({key:a,val:b,name:c})},data:[],__isFileAPIShim:!0}},window.Blob=Blob=function(a){return{data:a,__isFileAPIBlobShim:!0}},function(){if(window.FileAPI||(window.FileAPI={}),FileAPI.forceLoad&&(FileAPI.html5=!1),!FileAPI.upload){var a,b,c,e,f,g=document.createElement("script"),h=document.getElementsByTagName("script");if(window.FileAPI.jsUrl)a=window.FileAPI.jsUrl;else if(window.FileAPI.jsPath)b=window.FileAPI.jsPath;else for(c=0;c<h.length;c++)if(f=h[c].src,e=f.search(/\/ng\-file\-upload[\-a-zA-z0-9\.]*\.js/),e>-1){b=f.substring(0,e+1);break}null==FileAPI.staticPath&&(FileAPI.staticPath=b),g.setAttribute("src",a||b+"FileAPI.min.js"),document.getElementsByTagName("head")[0].appendChild(g),FileAPI.hasFlash=d()}}(),FileAPI.ngfFixIE=function(a,b,e,f,g){if(!d())throw'Adode Flash Player need to be installed. To check ahead use "FileAPI.hasFlash"';var h=function(d){function g(a){var b,c;if(b=c=0,a.offsetParent)do b+=a.offsetLeft,c+=a.offsetTop;while(a=a.offsetParent);return{left:b,top:c}}if(a.attr("disabled"))a.__ngf_elem__.removeClass("js-fileapi-wrapper");else{var j=a.__ngf_elem__;j?e(a.__ngf_elem__):(j=a.__ngf_elem__=b(),j.addClass("js-fileapi-wrapper"),!c(a),setTimeout(function(){j.bind("mouseenter",h)},10),j.bind("change",function(a){i.apply(this,[a]),f.apply(this,[a])})),c(a)||j.css("position","absolute").css("top",g(a[0]).top+"px").css("left",g(a[0]).left+"px").css("width",a[0].offsetWidth+"px").css("height",a[0].offsetHeight+"px").css("filter","alpha(opacity=0)").css("display",a.css("display")).css("overflow","hidden").css("z-index","900000").css("visibility","visible")}};a.bind("mouseenter",h);var i=function(a){for(var b=FileAPI.getFiles(a),c=0;c<b.length;c++)void 0===b[c].size&&(b[c].size=0),void 0===b[c].name&&(b[c].name="file"),void 0===b[c].type&&(b[c].type="undefined");a.target||(a.target={}),a.target.files=b,a.target.files!=b&&(a.__files_=b),(a.__files_||a.target.files).item=function(b){return(a.__files_||a.target.files)[b]||null}}},FileAPI.disableFileInput=function(a,b){b?a.removeClass("js-fileapi-wrapper"):a.addClass("js-fileapi-wrapper")}}window.FileReader||(window.FileReader=function(){var a=this,b=!1;this.listeners={},this.addEventListener=function(b,c){a.listeners[b]=a.listeners[b]||[],a.listeners[b].push(c)},this.removeEventListener=function(b,c){a.listeners[b]&&a.listeners[b].splice(a.listeners[b].indexOf(c),1)},this.dispatchEvent=function(b){var c=a.listeners[b.type];if(c)for(var d=0;d<c.length;d++)c[d].call(a,b)},this.onabort=this.onerror=this.onload=this.onloadstart=this.onloadend=this.onprogress=null;var c=function(b,c){var d={type:b,target:a,loaded:c.loaded,total:c.total,error:c.error};return null!=c.result&&(d.target.result=c.result),d},d=function(d){if(b||(b=!0,a.onloadstart&&a.onloadstart(c("loadstart",d))),"load"===d.type){a.onloadend&&a.onloadend(c("loadend",d));var e=c("load",d);a.onload&&a.onload(e),a.dispatchEvent(e)}else if("progress"===d.type){var e=c("progress",d);a.onprogress&&a.onprogress(e),a.dispatchEvent(e)}else{var e=c("error",d);a.onerror&&a.onerror(e),a.dispatchEvent(e)}};this.readAsArrayBuffer=function(a){FileAPI.readAsBinaryString(a,d)},this.readAsBinaryString=function(a){FileAPI.readAsBinaryString(a,d)},this.readAsDataURL=function(a){FileAPI.readAsDataURL(a,d)},this.readAsText=function(a){FileAPI.readAsText(a,d)}})}(),function(a,b){"object"==typeof exports&&"undefined"!=typeof module?b(exports):"function"==typeof define&&define.amd?define(["exports"],b):b(a.topojson={})}(this,function(a){"use strict";function b(){}function c(a){if(!a)return b;var c,d,e=a.scale[0],f=a.scale[1],g=a.translate[0],h=a.translate[1];return function(a,b){b||(c=d=0),a[0]=(c+=a[0])*e+g,a[1]=(d+=a[1])*f+h}}function d(a){if(!a)return b;var c,d,e=a.scale[0],f=a.scale[1],g=a.translate[0],h=a.translate[1];return function(a,b){b||(c=d=0);var i=(a[0]-g)/e|0,j=(a[1]-h)/f|0;a[0]=i-c,a[1]=j-d,c=i,d=j}}function e(a,b){for(var c,d=a.length,e=d-b;e<--d;)c=a[e],a[e++]=a[d],a[d]=c}function f(a,b){for(var c=0,d=a.length;d>c;){var e=c+d>>>1;a[e]<b?c=e+1:d=e}return c}function g(a,b){return"GeometryCollection"===b.type?{type:"FeatureCollection",features:b.geometries.map(function(b){return h(a,b)})}:h(a,b)}function h(a,b){var c={type:"Feature",id:b.id,properties:b.properties||{},geometry:i(a,b)};return null==b.id&&delete c.id,c}function i(a,b){function d(a,b){b.length&&b.pop();for(var c,d=l[0>a?~a:a],f=0,g=d.length;g>f;++f)b.push(c=d[f].slice()),k(c,f);0>a&&e(b,g)}function f(a){return a=a.slice(),k(a,0),a}function g(a){for(var b=[],c=0,e=a.length;e>c;++c)d(a[c],b);return b.length<2&&b.push(b[0].slice()),b}function h(a){for(var b=g(a);b.length<4;)b.push(b[0].slice());return b}function i(a){return a.map(h)}function j(a){var b=a.type;return"GeometryCollection"===b?{type:b,geometries:a.geometries.map(j)}:b in m?{type:b,coordinates:m[b](a)}:null}var k=c(a.transform),l=a.arcs,m={Point:function(a){return f(a.coordinates)},MultiPoint:function(a){return a.coordinates.map(f)},LineString:function(a){return g(a.arcs)},MultiLineString:function(a){return a.arcs.map(g)},Polygon:function(a){return i(a.arcs)},MultiPolygon:function(a){return a.arcs.map(i)}};return j(b)}function j(a,b){function c(b){var c,d=a.arcs[0>b?~b:b],e=d[0];return a.transform?(c=[0,0],d.forEach(function(a){c[0]+=a[0],c[1]+=a[1]})):c=d[d.length-1],0>b?[c,e]:[e,c]}function d(a,b){for(var c in a){var d=a[c];delete b[d.start],delete d.start,delete d.end,d.forEach(function(a){e[0>a?~a:a]=1}),h.push(d)}}var e={},f={},g={},h=[],i=-1;return b.forEach(function(c,d){var e,f=a.arcs[0>c?~c:c];f.length<3&&!f[1][0]&&!f[1][1]&&(e=b[++i],b[i]=c,b[d]=e)}),b.forEach(function(a){var b,d,e=c(a),h=e[0],i=e[1];if(b=g[h])if(delete g[b.end],b.push(a),b.end=i,d=f[i]){delete f[d.start];var j=d===b?b:b.concat(d);f[j.start=b.start]=g[j.end=d.end]=j}else f[b.start]=g[b.end]=b;else if(b=f[i])if(delete f[b.start],b.unshift(a),b.start=h,d=g[h]){delete g[d.end];var k=d===b?b:d.concat(b);f[k.start=d.start]=g[k.end=b.end]=k}else f[b.start]=g[b.end]=b;else b=[a],f[b.start=h]=g[b.end=i]=b}),d(g,f),d(f,g),b.forEach(function(a){e[0>a?~a:a]||h.push([a])}),h}function k(a){return i(a,l.apply(this,arguments))}function l(a,b,c){function d(a){var b=0>a?~a:a;(k[b]||(k[b]=[])).push({i:a,g:i})}function e(a){a.forEach(d)}function f(a){a.forEach(e)}function g(a){"GeometryCollection"===a.type?a.geometries.forEach(g):a.type in l&&(i=a,l[a.type](a.arcs))}var h=[];if(arguments.length>1){var i,k=[],l={LineString:e,MultiLineString:f,Polygon:f,MultiPolygon:function(a){a.forEach(f)}};g(b),k.forEach(arguments.length<3?function(a){h.push(a[0].i)}:function(a){c(a[0].g,a[a.length-1].g)&&h.push(a[0].i)})}else for(var m=0,n=a.arcs.length;n>m;++m)h.push(m);return{type:"MultiLineString",arcs:j(a,h)}}function m(a){var b=a[0],c=a[1],d=a[2];return Math.abs((b[0]-d[0])*(c[1]-b[1])-(b[0]-c[0])*(d[1]-b[1]))}function n(a){for(var b,c=-1,d=a.length,e=a[d-1],f=0;++c<d;)b=e,e=a[c],f+=b[0]*e[1]-b[1]*e[0];return f/2}function o(a){return i(a,p.apply(this,arguments))}function p(a,b){function c(a){a.forEach(function(b){b.forEach(function(b){(e[b=0>b?~b:b]||(e[b]=[])).push(a)})}),f.push(a)}function d(b){return n(i(a,{type:"Polygon",arcs:[b]}).coordinates[0])>0}var e={},f=[],g=[];return b.forEach(function(a){"Polygon"===a.type?c(a.arcs):"MultiPolygon"===a.type&&a.arcs.forEach(c)}),f.forEach(function(a){if(!a._){var b=[],c=[a];for(a._=1,g.push(b);a=c.pop();)b.push(a),a.forEach(function(a){a.forEach(function(a){e[0>a?~a:a].forEach(function(a){a._||(a._=1,c.push(a))})})})}}),f.forEach(function(a){delete a._}),{type:"MultiPolygon",arcs:g.map(function(b){var c,f=[];if(b.forEach(function(a){a.forEach(function(a){a.forEach(function(a){e[0>a?~a:a].length<2&&f.push(a)})})}),f=j(a,f),(c=f.length)>1)for(var g,h=d(b[0][0]),i=0;c>i;++i)if(h===d(f[i])){g=f[0],f[0]=f[i],f[i]=g;break}return f})}}function q(a){function b(a,b){a.forEach(function(a){0>a&&(a=~a);var c=e[a];c?c.push(b):e[a]=[b]})}function c(a,c){a.forEach(function(a){b(a,c)})}function d(a,b){"GeometryCollection"===a.type?a.geometries.forEach(function(a){d(a,b)}):a.type in h&&h[a.type](a.arcs,b)}var e={},g=a.map(function(){return[]}),h={LineString:b,MultiLineString:c,Polygon:c,MultiPolygon:function(a,b){a.forEach(function(a){c(a,b)})}};a.forEach(d);for(var i in e)for(var j=e[i],k=j.length,l=0;k>l;++l)for(var m=l+1;k>m;++m){var n,o=j[l],p=j[m];(n=g[o])[i=f(n,p)]!==p&&n.splice(i,0,p),(n=g[p])[i=f(n,o)]!==o&&n.splice(i,0,o)}return g}function r(a,b){return a[1][2]-b[1][2]}function s(){function a(a,b){for(;b>0;){var c=(b+1>>1)-1,e=d[c];if(r(a,e)>=0)break;d[e._=b]=e,d[a._=b=c]=a}}function b(a,b){for(;;){var c=b+1<<1,f=c-1,g=b,h=d[g];if(e>f&&r(d[f],h)<0&&(h=d[g=f]),e>c&&r(d[c],h)<0&&(h=d[g=c]),g===b)break;d[h._=b]=h,d[a._=b=g]=a}}var c={},d=[],e=0;return c.push=function(b){return a(d[b._=e]=b,e++),e},c.pop=function(){if(!(0>=e)){var a,c=d[0];return--e>0&&(a=d[e],b(d[a._=0]=a,0)),c}},c.remove=function(c){var f,g=c._;if(d[g]===c)return g!==--e&&(f=d[e],(r(f,c)<0?a:b)(d[f._=g]=f,g)),g},c}function t(a,b){function e(a){h.remove(a),a[1][2]=b(a),h.push(a)}var f=c(a.transform),g=d(a.transform),h=s();return b||(b=m),a.arcs.forEach(function(a){var c,d,i,j,k=[],l=0;for(d=0,i=a.length;i>d;++d)j=a[d],f(a[d]=[j[0],j[1],1/0],d);for(d=1,i=a.length-1;i>d;++d)c=a.slice(d-1,d+2),c[1][2]=b(c),k.push(c),h.push(c);for(d=0,i=k.length;i>d;++d)c=k[d],c.previous=k[d-1],c.next=k[d+1];for(;c=h.pop();){var m=c.previous,n=c.next;c[1][2]<l?c[1][2]=l:l=c[1][2],m&&(m.next=n,m[2]=c[2],e(m)),n&&(n.previous=m,n[0]=c[0],e(n))}a.forEach(g)}),a}var u="1.6.24";a.version=u,a.mesh=k,a.meshArcs=l,a.merge=o,a.mergeArcs=p,a.feature=g,a.neighbors=q,a.presimplify=t}),function(){function a(a){function b(b,c,d,e,f,g){for(;f>=0&&g>f;f+=a){var h=e?e[f]:f;d=c(d,b[h],h,b)}return d}return function(c,d,e,f){d=t(d,f,4);var g=!A(c)&&s.keys(c),h=(g||c).length,i=a>0?0:h-1;return arguments.length<3&&(e=c[g?g[i]:i],i+=a),b(c,d,e,g,i,h)}}function b(a){return function(b,c,d){c=u(c,d);for(var e=z(b),f=a>0?0:e-1;f>=0&&e>f;f+=a)if(c(b[f],f,b))return f;return-1}}function c(a,b,c){return function(d,e,f){var g=0,h=z(d);if("number"==typeof f)a>0?g=f>=0?f:Math.max(f+h,g):h=f>=0?Math.min(f+1,h):f+h+1;else if(c&&f&&h)return f=c(d,e),d[f]===e?f:-1;if(e!==e)return f=b(k.call(d,g,h),s.isNaN),f>=0?f+g:-1;for(f=a>0?g:h-1;f>=0&&h>f;f+=a)if(d[f]===e)return f;return-1}}function d(a,b){var c=F.length,d=a.constructor,e=s.isFunction(d)&&d.prototype||h,f="constructor";for(s.has(a,f)&&!s.contains(b,f)&&b.push(f);c--;)f=F[c],f in a&&a[f]!==e[f]&&!s.contains(b,f)&&b.push(f)}var e=this,f=e._,g=Array.prototype,h=Object.prototype,i=Function.prototype,j=g.push,k=g.slice,l=h.toString,m=h.hasOwnProperty,n=Array.isArray,o=Object.keys,p=i.bind,q=Object.create,r=function(){},s=function(a){return a instanceof s?a:this instanceof s?void(this._wrapped=a):new s(a)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=s),exports._=s):e._=s,s.VERSION="1.8.3";var t=function(a,b,c){if(void 0===b)return a;switch(null==c?3:c){case 1:return function(c){return a.call(b,c)};case 2:return function(c,d){return a.call(b,c,d)};case 3:return function(c,d,e){return a.call(b,c,d,e)};case 4:return function(c,d,e,f){return a.call(b,c,d,e,f)}}return function(){return a.apply(b,arguments)}},u=function(a,b,c){return null==a?s.identity:s.isFunction(a)?t(a,b,c):s.isObject(a)?s.matcher(a):s.property(a)};s.iteratee=function(a,b){return u(a,b,1/0)};var v=function(a,b){return function(c){var d=arguments.length;if(2>d||null==c)return c;for(var e=1;d>e;e++)for(var f=arguments[e],g=a(f),h=g.length,i=0;h>i;i++){var j=g[i];b&&void 0!==c[j]||(c[j]=f[j])}return c}},w=function(a){if(!s.isObject(a))return{};if(q)return q(a);r.prototype=a;var b=new r;return r.prototype=null,b},x=function(a){return function(b){return null==b?void 0:b[a]}},y=Math.pow(2,53)-1,z=x("length"),A=function(a){var b=z(a);return"number"==typeof b&&b>=0&&y>=b};s.each=s.forEach=function(a,b,c){b=t(b,c);var d,e;if(A(a))for(d=0,e=a.length;e>d;d++)b(a[d],d,a);else{var f=s.keys(a);for(d=0,e=f.length;e>d;d++)b(a[f[d]],f[d],a)}return a},s.map=s.collect=function(a,b,c){b=u(b,c);for(var d=!A(a)&&s.keys(a),e=(d||a).length,f=Array(e),g=0;e>g;g++){var h=d?d[g]:g;f[g]=b(a[h],h,a)}return f},s.reduce=s.foldl=s.inject=a(1),s.reduceRight=s.foldr=a(-1),s.find=s.detect=function(a,b,c){var d;return d=A(a)?s.findIndex(a,b,c):s.findKey(a,b,c),void 0!==d&&-1!==d?a[d]:void 0},s.filter=s.select=function(a,b,c){var d=[];return b=u(b,c),s.each(a,function(a,c,e){b(a,c,e)&&d.push(a)}),d},s.reject=function(a,b,c){return s.filter(a,s.negate(u(b)),c)},s.every=s.all=function(a,b,c){b=u(b,c);for(var d=!A(a)&&s.keys(a),e=(d||a).length,f=0;e>f;f++){var g=d?d[f]:f;if(!b(a[g],g,a))return!1}return!0},s.some=s.any=function(a,b,c){b=u(b,c);for(var d=!A(a)&&s.keys(a),e=(d||a).length,f=0;e>f;f++){var g=d?d[f]:f;if(b(a[g],g,a))return!0}return!1},s.contains=s.includes=s.include=function(a,b,c,d){return A(a)||(a=s.values(a)),("number"!=typeof c||d)&&(c=0),s.indexOf(a,b,c)>=0},s.invoke=function(a,b){var c=k.call(arguments,2),d=s.isFunction(b);return s.map(a,function(a){var e=d?b:a[b];return null==e?e:e.apply(a,c)})},s.pluck=function(a,b){return s.map(a,s.property(b))},s.where=function(a,b){return s.filter(a,s.matcher(b))},s.findWhere=function(a,b){return s.find(a,s.matcher(b))},s.max=function(a,b,c){var d,e,f=-(1/0),g=-(1/0);if(null==b&&null!=a){a=A(a)?a:s.values(a);for(var h=0,i=a.length;i>h;h++)d=a[h],d>f&&(f=d)}else b=u(b,c),s.each(a,function(a,c,d){e=b(a,c,d),(e>g||e===-(1/0)&&f===-(1/0))&&(f=a,g=e)});return f},s.min=function(a,b,c){var d,e,f=1/0,g=1/0;if(null==b&&null!=a){a=A(a)?a:s.values(a);for(var h=0,i=a.length;i>h;h++)d=a[h],f>d&&(f=d)}else b=u(b,c),s.each(a,function(a,c,d){e=b(a,c,d),(g>e||e===1/0&&f===1/0)&&(f=a,g=e)});return f},s.shuffle=function(a){for(var b,c=A(a)?a:s.values(a),d=c.length,e=Array(d),f=0;d>f;f++)b=s.random(0,f),b!==f&&(e[f]=e[b]),e[b]=c[f];return e},s.sample=function(a,b,c){return null==b||c?(A(a)||(a=s.values(a)),a[s.random(a.length-1)]):s.shuffle(a).slice(0,Math.max(0,b))},s.sortBy=function(a,b,c){return b=u(b,c),s.pluck(s.map(a,function(a,c,d){return{value:a,index:c,criteria:b(a,c,d)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;if(c!==d){if(c>d||void 0===c)return 1;if(d>c||void 0===d)return-1}return a.index-b.index}),"value")};var B=function(a){return function(b,c,d){var e={};return c=u(c,d),s.each(b,function(d,f){var g=c(d,f,b);a(e,d,g)}),e}};s.groupBy=B(function(a,b,c){s.has(a,c)?a[c].push(b):a[c]=[b]}),s.indexBy=B(function(a,b,c){a[c]=b}),s.countBy=B(function(a,b,c){s.has(a,c)?a[c]++:a[c]=1}),s.toArray=function(a){return a?s.isArray(a)?k.call(a):A(a)?s.map(a,s.identity):s.values(a):[]},s.size=function(a){return null==a?0:A(a)?a.length:s.keys(a).length},s.partition=function(a,b,c){b=u(b,c);var d=[],e=[];return s.each(a,function(a,c,f){(b(a,c,f)?d:e).push(a)}),[d,e]},s.first=s.head=s.take=function(a,b,c){return null!=a?null==b||c?a[0]:s.initial(a,a.length-b):void 0},s.initial=function(a,b,c){return k.call(a,0,Math.max(0,a.length-(null==b||c?1:b)))},s.last=function(a,b,c){return null!=a?null==b||c?a[a.length-1]:s.rest(a,Math.max(0,a.length-b)):void 0},s.rest=s.tail=s.drop=function(a,b,c){return k.call(a,null==b||c?1:b)},s.compact=function(a){return s.filter(a,s.identity)};var C=function(a,b,c,d){for(var e=[],f=0,g=d||0,h=z(a);h>g;g++){var i=a[g];if(A(i)&&(s.isArray(i)||s.isArguments(i))){b||(i=C(i,b,c));var j=0,k=i.length;for(e.length+=k;k>j;)e[f++]=i[j++]}else c||(e[f++]=i)}return e};s.flatten=function(a,b){return C(a,b,!1)},s.without=function(a){return s.difference(a,k.call(arguments,1))},s.uniq=s.unique=function(a,b,c,d){s.isBoolean(b)||(d=c,c=b,b=!1),null!=c&&(c=u(c,d));for(var e=[],f=[],g=0,h=z(a);h>g;g++){var i=a[g],j=c?c(i,g,a):i;b?(g&&f===j||e.push(i),f=j):c?s.contains(f,j)||(f.push(j),e.push(i)):s.contains(e,i)||e.push(i)}return e},s.union=function(){return s.uniq(C(arguments,!0,!0))},s.intersection=function(a){for(var b=[],c=arguments.length,d=0,e=z(a);e>d;d++){var f=a[d];if(!s.contains(b,f)){for(var g=1;c>g&&s.contains(arguments[g],f);g++);g===c&&b.push(f)}}return b},s.difference=function(a){var b=C(arguments,!0,!0,1);return s.filter(a,function(a){return!s.contains(b,a)})},s.zip=function(){return s.unzip(arguments)},s.unzip=function(a){for(var b=a&&s.max(a,z).length||0,c=Array(b),d=0;b>d;d++)c[d]=s.pluck(a,d);return c},s.object=function(a,b){for(var c={},d=0,e=z(a);e>d;d++)b?c[a[d]]=b[d]:c[a[d][0]]=a[d][1];return c},s.findIndex=b(1),s.findLastIndex=b(-1),s.sortedIndex=function(a,b,c,d){c=u(c,d,1);for(var e=c(b),f=0,g=z(a);g>f;){var h=Math.floor((f+g)/2);c(a[h])<e?f=h+1:g=h}return f},s.indexOf=c(1,s.findIndex,s.sortedIndex),s.lastIndexOf=c(-1,s.findLastIndex),s.range=function(a,b,c){null==b&&(b=a||0,a=0),c=c||1;for(var d=Math.max(Math.ceil((b-a)/c),0),e=Array(d),f=0;d>f;f++,a+=c)e[f]=a;return e};var D=function(a,b,c,d,e){if(!(d instanceof b))return a.apply(c,e);var f=w(a.prototype),g=a.apply(f,e);return s.isObject(g)?g:f};s.bind=function(a,b){if(p&&a.bind===p)return p.apply(a,k.call(arguments,1));if(!s.isFunction(a))throw new TypeError("Bind must be called on a function");var c=k.call(arguments,2),d=function(){return D(a,d,b,this,c.concat(k.call(arguments)))};return d},s.partial=function(a){var b=k.call(arguments,1),c=function(){for(var d=0,e=b.length,f=Array(e),g=0;e>g;g++)f[g]=b[g]===s?arguments[d++]:b[g];for(;d<arguments.length;)f.push(arguments[d++]);return D(a,c,this,this,f)};return c},s.bindAll=function(a){var b,c,d=arguments.length;if(1>=d)throw new Error("bindAll must be passed function names");for(b=1;d>b;b++)c=arguments[b],a[c]=s.bind(a[c],a);return a},s.memoize=function(a,b){var c=function(d){var e=c.cache,f=""+(b?b.apply(this,arguments):d);return s.has(e,f)||(e[f]=a.apply(this,arguments)),e[f]};return c.cache={},c},s.delay=function(a,b){var c=k.call(arguments,2);return setTimeout(function(){return a.apply(null,c)},b)},s.defer=s.partial(s.delay,s,1),s.throttle=function(a,b,c){var d,e,f,g=null,h=0;c||(c={});var i=function(){h=c.leading===!1?0:s.now(),g=null,f=a.apply(d,e),g||(d=e=null)};return function(){var j=s.now();h||c.leading!==!1||(h=j);var k=b-(j-h);return d=this,e=arguments,0>=k||k>b?(g&&(clearTimeout(g),g=null),h=j,f=a.apply(d,e),g||(d=e=null)):g||c.trailing===!1||(g=setTimeout(i,k)),f}},s.debounce=function(a,b,c){var d,e,f,g,h,i=function(){var j=s.now()-g;b>j&&j>=0?d=setTimeout(i,b-j):(d=null,c||(h=a.apply(f,e),d||(f=e=null)))};return function(){f=this,e=arguments,g=s.now();var j=c&&!d;return d||(d=setTimeout(i,b)),j&&(h=a.apply(f,e),f=e=null),h}},s.wrap=function(a,b){return s.partial(b,a)},s.negate=function(a){return function(){return!a.apply(this,arguments)}},s.compose=function(){var a=arguments,b=a.length-1;return function(){for(var c=b,d=a[b].apply(this,arguments);c--;)d=a[c].call(this,d);return d}},s.after=function(a,b){return function(){return--a<1?b.apply(this,arguments):void 0}},s.before=function(a,b){var c;return function(){return--a>0&&(c=b.apply(this,arguments)),1>=a&&(b=null),c}},s.once=s.partial(s.before,2);var E=!{toString:null}.propertyIsEnumerable("toString"),F=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];s.keys=function(a){if(!s.isObject(a))return[];if(o)return o(a);var b=[];for(var c in a)s.has(a,c)&&b.push(c);return E&&d(a,b),b},s.allKeys=function(a){if(!s.isObject(a))return[];var b=[];for(var c in a)b.push(c);return E&&d(a,b),b},s.values=function(a){for(var b=s.keys(a),c=b.length,d=Array(c),e=0;c>e;e++)d[e]=a[b[e]];return d},s.mapObject=function(a,b,c){b=u(b,c);for(var d,e=s.keys(a),f=e.length,g={},h=0;f>h;h++)d=e[h],g[d]=b(a[d],d,a);return g},s.pairs=function(a){for(var b=s.keys(a),c=b.length,d=Array(c),e=0;c>e;e++)d[e]=[b[e],a[b[e]]];return d},s.invert=function(a){for(var b={},c=s.keys(a),d=0,e=c.length;e>d;d++)b[a[c[d]]]=c[d];return b},s.functions=s.methods=function(a){var b=[];for(var c in a)s.isFunction(a[c])&&b.push(c);return b.sort()},s.extend=v(s.allKeys),s.extendOwn=s.assign=v(s.keys),s.findKey=function(a,b,c){b=u(b,c);for(var d,e=s.keys(a),f=0,g=e.length;g>f;f++)if(d=e[f],b(a[d],d,a))return d},s.pick=function(a,b,c){var d,e,f={},g=a;if(null==g)return f;s.isFunction(b)?(e=s.allKeys(g),d=t(b,c)):(e=C(arguments,!1,!1,1),d=function(a,b,c){return b in c},g=Object(g));for(var h=0,i=e.length;i>h;h++){var j=e[h],k=g[j];d(k,j,g)&&(f[j]=k)}return f},s.omit=function(a,b,c){if(s.isFunction(b))b=s.negate(b);else{var d=s.map(C(arguments,!1,!1,1),String);b=function(a,b){return!s.contains(d,b)}}return s.pick(a,b,c)},s.defaults=v(s.allKeys,!0),s.create=function(a,b){var c=w(a);return b&&s.extendOwn(c,b),c},s.clone=function(a){return s.isObject(a)?s.isArray(a)?a.slice():s.extend({},a):a},s.tap=function(a,b){return b(a),a},s.isMatch=function(a,b){var c=s.keys(b),d=c.length;if(null==a)return!d;for(var e=Object(a),f=0;d>f;f++){var g=c[f];if(b[g]!==e[g]||!(g in e))return!1}return!0};var G=function(a,b,c,d){if(a===b)return 0!==a||1/a===1/b;if(null==a||null==b)return a===b;a instanceof s&&(a=a._wrapped),b instanceof s&&(b=b._wrapped);var e=l.call(a);if(e!==l.call(b))return!1;switch(e){case"[object RegExp]":case"[object String]":return""+a==""+b;case"[object Number]":return+a!==+a?+b!==+b:0===+a?1/+a===1/b:+a===+b;case"[object Date]":case"[object Boolean]":return+a===+b}var f="[object Array]"===e;if(!f){if("object"!=typeof a||"object"!=typeof b)return!1;var g=a.constructor,h=b.constructor;if(g!==h&&!(s.isFunction(g)&&g instanceof g&&s.isFunction(h)&&h instanceof h)&&"constructor"in a&&"constructor"in b)return!1}c=c||[],d=d||[];for(var i=c.length;i--;)if(c[i]===a)return d[i]===b;if(c.push(a),d.push(b),f){if(i=a.length,i!==b.length)return!1;for(;i--;)if(!G(a[i],b[i],c,d))return!1}else{var j,k=s.keys(a);if(i=k.length,s.keys(b).length!==i)return!1;for(;i--;)if(j=k[i],!s.has(b,j)||!G(a[j],b[j],c,d))return!1}return c.pop(),d.pop(),!0};s.isEqual=function(a,b){return G(a,b)},s.isEmpty=function(a){return null==a?!0:A(a)&&(s.isArray(a)||s.isString(a)||s.isArguments(a))?0===a.length:0===s.keys(a).length},s.isElement=function(a){return!(!a||1!==a.nodeType)},s.isArray=n||function(a){return"[object Array]"===l.call(a)},s.isObject=function(a){var b=typeof a;return"function"===b||"object"===b&&!!a},s.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(a){s["is"+a]=function(b){return l.call(b)==="[object "+a+"]"}}),s.isArguments(arguments)||(s.isArguments=function(a){return s.has(a,"callee")}),"function"!=typeof/./&&"object"!=typeof Int8Array&&(s.isFunction=function(a){return"function"==typeof a||!1}),s.isFinite=function(a){return isFinite(a)&&!isNaN(parseFloat(a))},s.isNaN=function(a){return s.isNumber(a)&&a!==+a},s.isBoolean=function(a){return a===!0||a===!1||"[object Boolean]"===l.call(a)},s.isNull=function(a){return null===a},s.isUndefined=function(a){return void 0===a},s.has=function(a,b){return null!=a&&m.call(a,b)},s.noConflict=function(){return e._=f,this},s.identity=function(a){return a},s.constant=function(a){return function(){return a}},s.noop=function(){},s.property=x,s.propertyOf=function(a){return null==a?function(){}:function(b){return a[b]}},s.matcher=s.matches=function(a){return a=s.extendOwn({},a),function(b){return s.isMatch(b,a)}},s.times=function(a,b,c){var d=Array(Math.max(0,a));b=t(b,c,1);for(var e=0;a>e;e++)d[e]=b(e);return d},s.random=function(a,b){return null==b&&(b=a,a=0),a+Math.floor(Math.random()*(b-a+1))},s.now=Date.now||function(){return(new Date).getTime()};var H={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},I=s.invert(H),J=function(a){var b=function(b){return a[b]},c="(?:"+s.keys(a).join("|")+")",d=RegExp(c),e=RegExp(c,"g");return function(a){return a=null==a?"":""+a,d.test(a)?a.replace(e,b):a;
}};s.escape=J(H),s.unescape=J(I),s.result=function(a,b,c){var d=null==a?void 0:a[b];return void 0===d&&(d=c),s.isFunction(d)?d.call(a):d};var K=0;s.uniqueId=function(a){var b=++K+"";return a?a+b:b},s.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var L=/(.)^/,M={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},N=/\\|'|\r|\n|\u2028|\u2029/g,O=function(a){return"\\"+M[a]};s.template=function(a,b,c){!b&&c&&(b=c),b=s.defaults({},b,s.templateSettings);var d=RegExp([(b.escape||L).source,(b.interpolate||L).source,(b.evaluate||L).source].join("|")+"|$","g"),e=0,f="__p+='";a.replace(d,function(b,c,d,g,h){return f+=a.slice(e,h).replace(N,O),e=h+b.length,c?f+="'+\n((__t=("+c+"))==null?'':_.escape(__t))+\n'":d?f+="'+\n((__t=("+d+"))==null?'':__t)+\n'":g&&(f+="';\n"+g+"\n__p+='"),b}),f+="';\n",b.variable||(f="with(obj||{}){\n"+f+"}\n"),f="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+f+"return __p;\n";try{var g=new Function(b.variable||"obj","_",f)}catch(h){throw h.source=f,h}var i=function(a){return g.call(this,a,s)},j=b.variable||"obj";return i.source="function("+j+"){\n"+f+"}",i},s.chain=function(a){var b=s(a);return b._chain=!0,b};var P=function(a,b){return a._chain?s(b).chain():b};s.mixin=function(a){s.each(s.functions(a),function(b){var c=s[b]=a[b];s.prototype[b]=function(){var a=[this._wrapped];return j.apply(a,arguments),P(this,c.apply(s,a))}})},s.mixin(s),s.each(["pop","push","reverse","shift","sort","splice","unshift"],function(a){var b=g[a];s.prototype[a]=function(){var c=this._wrapped;return b.apply(c,arguments),"shift"!==a&&"splice"!==a||0!==c.length||delete c[0],P(this,c)}}),s.each(["concat","join","slice"],function(a){var b=g[a];s.prototype[a]=function(){return P(this,b.apply(this._wrapped,arguments))}}),s.prototype.value=function(){return this._wrapped},s.prototype.valueOf=s.prototype.toJSON=s.prototype.value,s.prototype.toString=function(){return""+this._wrapped},"function"==typeof define&&define.amd&&define("underscore",[],function(){return s})}.call(this),function(a){var b=a._||require("underscore"),c=Array.prototype.concat,d=Array.prototype;d.slice;b.mixin({accessor:function(a){return function(b){return b&&b[a]}},dictionary:function(a){return function(b){return a&&b&&a[b]}},selectKeys:function(a,d){return b.pick.apply(null,c.call([a],d))},kv:function(a,c){return b.has(a,c)?[c,a[c]]:void 0},getPath:function e(a,c){if("string"==typeof c&&(c=c.split(".")),void 0!==a){if(0===c.length)return a;if(null!==a)return e(a[b.first(c)],b.rest(c))}},hasPath:function f(a,c){"string"==typeof c&&(c=c.split("."));var d=c.length;return null==a&&d>0?!1:c[0]in a?1===d?!0:f(a[b.first(c)],b.rest(c)):!1},pickWhen:function(a,c){var d={};return b.each(a,function(b,e){c(a[e])&&(d[e]=a[e])}),d},omitWhen:function(a,c){return b.pickWhen(a,function(a){return!c(a)})}})}(this),function(a){var b=a._||require("underscore"),c=/\+/g,d=/\%20/g,e=/(?:([^\[]+))|(?:\[(.*?)\])/g,f=function(a){return decodeURIComponent(a.replace(c,"%20"))},g=function(a){return encodeURIComponent(a).replace(d,"+")},h=function(a,c,d){return b.isUndefined(d)&&(d=!0),b.isArray(c)?b.map(c,function(b,c){return h(d?c:a+"[]",b,!1)}).join("&"):b.isObject(c)?b.map(c,function(b,c){return h(d?c:a+"["+c+"]",b,!1)}).join("&"):g(a)+"="+g(c)};b.mixin({explode:function(a){return a.split("")},fromQuery:function(a){var c,d,g,h,i,j=a.split("&"),k={};return b.each(j,function(a){for(a=a.split("="),c=f(a[0]),g=c,i=k,e.lastIndex=0;null!==(d=e.exec(c));)b.isUndefined(d[1])?(h=d[2],i[g]=i[g]||(h?{}:[]),i=i[g]):h=d[1],g=h||b.size(i);i[g]=f(a[1])}),k},implode:function(a){return a.join("")},camelCase:function(a){return a.replace(/-([a-z])/g,function(a){return a[1].toUpperCase()})},toDash:function(a){return a=a.replace(/([A-Z])/g,function(a){return"-"+a.toLowerCase()}),"-"==a.charAt(0)?a.substr(1):a},toQuery:function(a){return h("",a)},strContains:function(a,b){if("string"!=typeof a)throw new TypeError;return-1!=a.indexOf(b)}})}(this);var WaveSurfer={defaultParams:{height:128,waveColor:"#999",progressColor:"#555",cursorColor:"#333",cursorWidth:1,skipLength:2,minPxPerSec:20,pixelRatio:window.devicePixelRatio,fillParent:!0,scrollParent:!1,hideScrollbar:!1,normalize:!1,audioContext:null,container:null,dragSelection:!0,loopSelection:!0,audioRate:1,interact:!0,splitChannels:!1,renderer:"Canvas",backend:"WebAudio",mediaType:"audio"},init:function(a){if(this.params=WaveSurfer.util.extend({},this.defaultParams,a),this.container="string"==typeof a.container?document.querySelector(this.params.container):this.params.container,!this.container)throw new Error("Container element not found");if("undefined"==typeof this.params.mediaContainer?this.mediaContainer=this.container:"string"==typeof this.params.mediaContainer?this.mediaContainer=document.querySelector(this.params.mediaContainer):this.mediaContainer=this.params.mediaContainer,!this.mediaContainer)throw new Error("Media Container element not found");this.savedVolume=0,this.isMuted=!1,this.tmpEvents=[],this.createDrawer(),this.createBackend()},createDrawer:function(){var a=this;this.drawer=Object.create(WaveSurfer.Drawer[this.params.renderer]),this.drawer.init(this.container,this.params),this.drawer.on("redraw",function(){a.drawBuffer(),a.drawer.progress(a.backend.getPlayedPercents())}),this.drawer.on("click",function(b,c){setTimeout(function(){a.seekTo(c)},0)}),this.drawer.on("scroll",function(b){a.fireEvent("scroll",b)})},createBackend:function(){var a=this;this.backend&&this.backend.destroy(),"AudioElement"==this.params.backend&&(this.params.backend="MediaElement"),"WebAudio"!=this.params.backend||WaveSurfer.WebAudio.supportsWebAudio()||(this.params.backend="MediaElement"),this.backend=Object.create(WaveSurfer[this.params.backend]),this.backend.init(this.params),this.backend.on("finish",function(){a.fireEvent("finish")}),this.backend.on("audioprocess",function(b){a.drawer.progress(a.backend.getPlayedPercents()),a.fireEvent("audioprocess",b)})},getDuration:function(){return this.backend.getDuration()},getCurrentTime:function(){return this.backend.getCurrentTime()},play:function(a,b){this.backend.play(a,b),this.fireEvent("play")},pause:function(){this.backend.pause(),this.fireEvent("pause")},playPause:function(){this.backend.isPaused()?this.play():this.pause()},isPlaying:function(){return!this.backend.isPaused()},skipBackward:function(a){this.skip(-a||-this.params.skipLength)},skipForward:function(a){this.skip(a||this.params.skipLength)},skip:function(a){var b=this.getCurrentTime()||0,c=this.getDuration()||1;b=Math.max(0,Math.min(c,b+(a||0))),this.seekAndCenter(b/c)},seekAndCenter:function(a){this.seekTo(a),this.drawer.recenter(a)},seekTo:function(a){var b=this.backend.isPaused(),c=this.params.scrollParent;b&&(this.params.scrollParent=!1),this.backend.seekTo(a*this.getDuration()),this.drawer.progress(this.backend.getPlayedPercents()),b||(this.backend.pause(),this.backend.play()),this.params.scrollParent=c,this.fireEvent("seek",a)},stop:function(){this.pause(),this.seekTo(0),this.drawer.progress(0)},setVolume:function(a){this.backend.setVolume(a)},setPlaybackRate:function(a){this.backend.setPlaybackRate(a)},toggleMute:function(){this.isMuted?(this.backend.setVolume(this.savedVolume),this.isMuted=!1):(this.savedVolume=this.backend.getVolume(),this.backend.setVolume(0),this.isMuted=!0)},toggleScroll:function(){this.params.scrollParent=!this.params.scrollParent,this.drawBuffer()},toggleInteraction:function(){this.params.interact=!this.params.interact},drawBuffer:function(){var a=Math.round(this.getDuration()*this.params.minPxPerSec*this.params.pixelRatio),b=this.drawer.getWidth(),c=a;this.params.fillParent&&(!this.params.scrollParent||b>a)&&(c=b);var d=this.backend.getPeaks(c);this.drawer.drawPeaks(d,c),this.fireEvent("redraw",d,c)},zoom:function(a){this.params.minPxPerSec=a,this.params.scrollParent=!0,this.drawBuffer(),this.seekAndCenter(this.getCurrentTime()/this.getDuration())},loadArrayBuffer:function(a){this.decodeArrayBuffer(a,function(a){this.loadDecodedBuffer(a)}.bind(this))},loadDecodedBuffer:function(a){this.backend.load(a),this.drawBuffer(),this.fireEvent("ready")},loadBlob:function(a){var b=this,c=new FileReader;c.addEventListener("progress",function(a){b.onProgress(a)}),c.addEventListener("load",function(a){b.loadArrayBuffer(a.target.result)}),c.addEventListener("error",function(){b.fireEvent("error","Error reading file")}),c.readAsArrayBuffer(a),this.empty()},load:function(a,b){switch(this.params.backend){case"WebAudio":return this.loadBuffer(a);case"MediaElement":return this.loadMediaElement(a,b)}},loadBuffer:function(a){return this.empty(),this.getArrayBuffer(a,this.loadArrayBuffer.bind(this))},loadMediaElement:function(a,b){this.empty(),this.backend.load(a,this.mediaContainer,b),this.tmpEvents.push(this.backend.once("canplay",function(){this.drawBuffer(),this.fireEvent("ready")}.bind(this)),this.backend.once("error",function(a){this.fireEvent("error",a)}.bind(this))),!b&&this.backend.supportsWebAudio()&&this.getArrayBuffer(a,function(a){this.decodeArrayBuffer(a,function(a){this.backend.buffer=a,this.drawBuffer()}.bind(this))}.bind(this))},decodeArrayBuffer:function(a,b){this.backend.decodeArrayBuffer(a,this.fireEvent.bind(this,"decoded"),this.fireEvent.bind(this,"error","Error decoding audiobuffer")),this.tmpEvents.push(this.once("decoded",b))},getArrayBuffer:function(a,b){var c=this,d=WaveSurfer.util.ajax({url:a,responseType:"arraybuffer"});return this.tmpEvents.push(d.on("progress",function(a){c.onProgress(a)}),d.on("success",b),d.on("error",function(a){c.fireEvent("error","XHR error: "+a.target.statusText)})),d},onProgress:function(a){if(a.lengthComputable)var b=a.loaded/a.total;else b=a.loaded/(a.loaded+1e6);this.fireEvent("loading",Math.round(100*b),a.target)},exportPCM:function(a,b,c){a=a||1024,b=b||1e4,c=c||!1;var d=this.backend.getPeaks(a,b),e=[].map.call(d,function(a){return Math.round(a*b)/b}),f=JSON.stringify(e);return c||window.open("data:application/json;charset=utf-8,"+encodeURIComponent(f)),f},clearTmpEvents:function(){this.tmpEvents.forEach(function(a){a.un()})},empty:function(){this.backend.isPaused()||(this.stop(),this.backend.disconnectSource()),this.clearTmpEvents(),this.drawer.progress(0),this.drawer.setWidth(0),this.drawer.drawPeaks({length:this.drawer.getWidth()},0)},destroy:function(){this.fireEvent("destroy"),this.clearTmpEvents(),this.unAll(),this.backend.destroy(),this.drawer.destroy()}};WaveSurfer.create=function(a){var b=Object.create(WaveSurfer);return b.init(a),b},WaveSurfer.util={extend:function(a){var b=Array.prototype.slice.call(arguments,1);return b.forEach(function(b){Object.keys(b).forEach(function(c){a[c]=b[c]})}),a},getId:function(){return"wavesurfer_"+Math.random().toString(32).substring(2)},ajax:function(a){var b=Object.create(WaveSurfer.Observer),c=new XMLHttpRequest,d=!1;return c.open(a.method||"GET",a.url,!0),c.responseType=a.responseType||"json",c.addEventListener("progress",function(a){b.fireEvent("progress",a),a.lengthComputable&&a.loaded==a.total&&(d=!0)}),c.addEventListener("load",function(a){d||b.fireEvent("progress",a),b.fireEvent("load",a),200==c.status||206==c.status?b.fireEvent("success",c.response,a):b.fireEvent("error",a)}),c.addEventListener("error",function(a){b.fireEvent("error",a)}),c.send(),b.xhr=c,b}},WaveSurfer.Observer={on:function(a,b){this.handlers||(this.handlers={});var c=this.handlers[a];return c||(c=this.handlers[a]=[]),c.push(b),{name:a,callback:b,un:this.un.bind(this,a,b)}},un:function(a,b){if(this.handlers){var c=this.handlers[a];if(c)if(b)for(var d=c.length-1;d>=0;d--)c[d]==b&&c.splice(d,1);else c.length=0}},unAll:function(){this.handlers=null},once:function(a,b){var c=this,d=function(){b.apply(this,arguments),setTimeout(function(){c.un(a,d)},0)};return this.on(a,d)},fireEvent:function(a){if(this.handlers){var b=this.handlers[a],c=Array.prototype.slice.call(arguments,1);b&&b.forEach(function(a){a.apply(null,c)})}}},WaveSurfer.util.extend(WaveSurfer,WaveSurfer.Observer),WaveSurfer.WebAudio={scriptBufferSize:256,PLAYING_STATE:0,PAUSED_STATE:1,FINISHED_STATE:2,supportsWebAudio:function(){return!(!window.AudioContext&&!window.webkitAudioContext)},getAudioContext:function(){return WaveSurfer.WebAudio.audioContext||(WaveSurfer.WebAudio.audioContext=new(window.AudioContext||window.webkitAudioContext)),WaveSurfer.WebAudio.audioContext},getOfflineAudioContext:function(a){return WaveSurfer.WebAudio.offlineAudioContext||(WaveSurfer.WebAudio.offlineAudioContext=new(window.OfflineAudioContext||window.webkitOfflineAudioContext)(1,2,a)),WaveSurfer.WebAudio.offlineAudioContext},init:function(a){this.params=a,this.ac=a.audioContext||this.getAudioContext(),this.lastPlay=this.ac.currentTime,this.startPosition=0,this.scheduledPause=null,this.states=[Object.create(WaveSurfer.WebAudio.state.playing),Object.create(WaveSurfer.WebAudio.state.paused),Object.create(WaveSurfer.WebAudio.state.finished)],this.createVolumeNode(),this.createScriptNode(),this.createAnalyserNode(),this.setState(this.PAUSED_STATE),this.setPlaybackRate(this.params.audioRate)},disconnectFilters:function(){this.filters&&(this.filters.forEach(function(a){a&&a.disconnect()}),this.filters=null,this.analyser.connect(this.gainNode))},setState:function(a){this.state!==this.states[a]&&(this.state=this.states[a],this.state.init.call(this))},setFilter:function(){this.setFilters([].slice.call(arguments))},setFilters:function(a){this.disconnectFilters(),a&&a.length&&(this.filters=a,this.analyser.disconnect(),a.reduce(function(a,b){return a.connect(b),b},this.analyser).connect(this.gainNode))},createScriptNode:function(){this.ac.createScriptProcessor?this.scriptNode=this.ac.createScriptProcessor(this.scriptBufferSize):this.scriptNode=this.ac.createJavaScriptNode(this.scriptBufferSize),this.scriptNode.connect(this.ac.destination)},addOnAudioProcess:function(){var a=this;this.scriptNode.onaudioprocess=function(){var b=a.getCurrentTime();b>=a.getDuration()?a.setState(a.FINISHED_STATE):b>=a.scheduledPause?a.setState(a.PAUSED_STATE):a.state===a.states[a.PLAYING_STATE]&&a.fireEvent("audioprocess",b)}},removeOnAudioProcess:function(){this.scriptNode.onaudioprocess=null},createAnalyserNode:function(){this.analyser=this.ac.createAnalyser(),this.analyser.connect(this.gainNode)},createVolumeNode:function(){this.ac.createGain?this.gainNode=this.ac.createGain():this.gainNode=this.ac.createGainNode(),this.gainNode.connect(this.ac.destination)},setVolume:function(a){this.gainNode.gain.value=a},getVolume:function(){return this.gainNode.gain.value},decodeArrayBuffer:function(a,b,c){this.offlineAc||(this.offlineAc=this.getOfflineAudioContext(this.ac?this.ac.sampleRate:44100)),this.offlineAc.decodeAudioData(a,function(a){b(a)}.bind(this),c)},getPeaks:function(a){for(var b=this.buffer.length/a,c=~~(b/10)||1,d=this.buffer.numberOfChannels,e=[],f=[],g=0;d>g;g++)for(var h=e[g]=[],i=this.buffer.getChannelData(g),j=0;a>j;j++){for(var k=~~(j*b),l=~~(k+b),m=i[0],n=i[0],o=k;l>o;o+=c){var p=i[o];p>n&&(n=p),m>p&&(m=p)}h[2*j]=n,h[2*j+1]=m,(0==g||n>f[2*j])&&(f[2*j]=n),(0==g||m<f[2*j+1])&&(f[2*j+1]=m)}return this.params.splitChannels?e:f},getPlayedPercents:function(){return this.state.getPlayedPercents.call(this)},disconnectSource:function(){this.source&&this.source.disconnect()},destroy:function(){this.isPaused()||this.pause(),this.unAll(),this.buffer=null,this.disconnectFilters(),this.disconnectSource(),this.gainNode.disconnect(),this.scriptNode.disconnect(),this.analyser.disconnect()},load:function(a){this.startPosition=0,this.lastPlay=this.ac.currentTime,this.buffer=a,this.createSource()},createSource:function(){this.disconnectSource(),this.source=this.ac.createBufferSource(),this.source.start=this.source.start||this.source.noteGrainOn,this.source.stop=this.source.stop||this.source.noteOff,this.source.playbackRate.value=this.playbackRate,this.source.buffer=this.buffer,this.source.connect(this.analyser)},isPaused:function(){return this.state!==this.states[this.PLAYING_STATE]},getDuration:function(){return this.buffer?this.buffer.duration:0},seekTo:function(a,b){return this.scheduledPause=null,null==a&&(a=this.getCurrentTime(),a>=this.getDuration()&&(a=0)),null==b&&(b=this.getDuration()),this.startPosition=a,this.lastPlay=this.ac.currentTime,this.state===this.states[this.FINISHED_STATE]&&this.setState(this.PAUSED_STATE),{start:a,end:b}},getPlayedTime:function(){return(this.ac.currentTime-this.lastPlay)*this.playbackRate},play:function(a,b){this.createSource();var c=this.seekTo(a,b);a=c.start,b=c.end,this.scheduledPause=b,this.source.start(0,a,b-a),this.setState(this.PLAYING_STATE)},pause:function(){this.scheduledPause=null,this.startPosition+=this.getPlayedTime(),this.source&&this.source.stop(0),this.setState(this.PAUSED_STATE)},getCurrentTime:function(){return this.state.getCurrentTime.call(this)},setPlaybackRate:function(a){a=a||1,this.isPaused()?this.playbackRate=a:(this.pause(),this.playbackRate=a,this.play())}},WaveSurfer.WebAudio.state={},WaveSurfer.WebAudio.state.playing={init:function(){this.addOnAudioProcess()},getPlayedPercents:function(){var a=this.getDuration();return this.getCurrentTime()/a||0},getCurrentTime:function(){return this.startPosition+this.getPlayedTime()}},WaveSurfer.WebAudio.state.paused={init:function(){this.removeOnAudioProcess()},getPlayedPercents:function(){var a=this.getDuration();return this.getCurrentTime()/a||0},getCurrentTime:function(){return this.startPosition}},WaveSurfer.WebAudio.state.finished={init:function(){this.removeOnAudioProcess(),this.fireEvent("finish")},getPlayedPercents:function(){return 1},getCurrentTime:function(){return this.getDuration()}},WaveSurfer.util.extend(WaveSurfer.WebAudio,WaveSurfer.Observer),WaveSurfer.MediaElement=Object.create(WaveSurfer.WebAudio),WaveSurfer.util.extend(WaveSurfer.MediaElement,{init:function(a){this.params=a,this.media={currentTime:0,duration:0,paused:!0,playbackRate:1,play:function(){},pause:function(){}},this.mediaType=a.mediaType.toLowerCase(),this.elementPosition=a.elementPosition},load:function(a,b,c){var d=this,e=document.createElement(this.mediaType);e.controls=!1,e.autoplay=!1,e.preload="auto",e.src=a,e.addEventListener("error",function(){d.fireEvent("error","Error loading media element")}),e.addEventListener("canplay",function(){d.fireEvent("canplay")}),e.addEventListener("ended",function(){d.fireEvent("finish")}),e.addEventListener("timeupdate",function(){d.fireEvent("audioprocess",d.getCurrentTime())});var f=b.querySelector(this.mediaType);f&&b.removeChild(f),b.appendChild(e),this.media=e,this.peaks=c,this.onPlayEnd=null,this.buffer=null,this.setPlaybackRate(this.playbackRate)},isPaused:function(){return!this.media||this.media.paused},getDuration:function(){var a=this.media.duration;return a>=1/0&&(a=this.media.seekable.end()),a},getCurrentTime:function(){return this.media&&this.media.currentTime},getPlayedPercents:function(){return this.getCurrentTime()/this.getDuration()||0},setPlaybackRate:function(a){this.playbackRate=a||1,this.media.playbackRate=this.playbackRate},seekTo:function(a){null!=a&&(this.media.currentTime=a),this.clearPlayEnd()},play:function(a,b){this.seekTo(a),this.media.play(),b&&this.setPlayEnd(b)},pause:function(){this.media&&this.media.pause(),this.clearPlayEnd()},setPlayEnd:function(a){var b=this;this.onPlayEnd=function(c){c>=a&&(b.pause(),b.seekTo(a))},this.on("audioprocess",this.onPlayEnd)},clearPlayEnd:function(){this.onPlayEnd&&(this.un("audioprocess",this.onPlayEnd),this.onPlayEnd=null)},getPeaks:function(a){return this.buffer?WaveSurfer.WebAudio.getPeaks.call(this,a):this.peaks||[]},getVolume:function(){return this.media.volume},setVolume:function(a){this.media.volume=a},destroy:function(){this.pause(),this.unAll(),this.media&&this.media.parentNode&&this.media.parentNode.removeChild(this.media),this.media=null}}),WaveSurfer.AudioElement=WaveSurfer.MediaElement,WaveSurfer.Drawer={init:function(a,b){this.container=a,this.params=b,this.width=0,this.height=b.height*this.params.pixelRatio,this.lastPos=0,this.createWrapper(),this.createElements()},createWrapper:function(){this.wrapper=this.container.appendChild(document.createElement("wave")),this.style(this.wrapper,{display:"block",position:"relative",userSelect:"none",webkitUserSelect:"none",height:this.params.height+"px"}),(this.params.fillParent||this.params.scrollParent)&&this.style(this.wrapper,{width:"100%",overflowX:this.params.hideScrollbar?"hidden":"auto",overflowY:"hidden"}),this.setupWrapperEvents()},handleEvent:function(a){a.preventDefault();var b=this.wrapper.getBoundingClientRect();return(a.clientX-b.left+this.wrapper.scrollLeft)/this.wrapper.scrollWidth||0},setupWrapperEvents:function(){var a=this;this.wrapper.addEventListener("click",function(b){var c=a.wrapper.offsetHeight-a.wrapper.clientHeight;if(0!=c){var d=a.wrapper.getBoundingClientRect();if(b.clientY>=d.bottom-c)return}a.params.interact&&a.fireEvent("click",b,a.handleEvent(b))}),this.wrapper.addEventListener("scroll",function(b){a.fireEvent("scroll",b)})},drawPeaks:function(a,b){this.resetScroll(),this.setWidth(b),this.params.barWidth?this.drawBars(a):this.drawWave(a)},style:function(a,b){return Object.keys(b).forEach(function(c){a.style[c]!==b[c]&&(a.style[c]=b[c])}),a},resetScroll:function(){null!==this.wrapper&&(this.wrapper.scrollLeft=0)},recenter:function(a){var b=this.wrapper.scrollWidth*a;this.recenterOnPosition(b,!0)},recenterOnPosition:function(a,b){var c=this.wrapper.scrollLeft,d=~~(this.wrapper.clientWidth/2),e=a-d,f=e-c,g=this.wrapper.scrollWidth-this.wrapper.clientWidth;if(0!=g){if(!b&&f>=-d&&d>f){var h=5;f=Math.max(-h,Math.min(h,f)),e=c+f}e=Math.max(0,Math.min(g,e)),e!=c&&(this.wrapper.scrollLeft=e)}},getWidth:function(){return Math.round(this.container.clientWidth*this.params.pixelRatio)},setWidth:function(a){a!=this.width&&(this.width=a,this.params.fillParent||this.params.scrollParent?this.style(this.wrapper,{width:""}):this.style(this.wrapper,{width:~~(this.width/this.params.pixelRatio)+"px"}),this.updateSize())},setHeight:function(a){a!=this.height&&(this.height=a,this.style(this.wrapper,{height:~~(this.height/this.params.pixelRatio)+"px"}),this.updateSize())},progress:function(a){var b=1/this.params.pixelRatio,c=Math.round(a*this.width)*b;if(c<this.lastPos||c-this.lastPos>=b){if(this.lastPos=c,this.params.scrollParent){var d=~~(this.wrapper.scrollWidth*a);this.recenterOnPosition(d)}this.updateProgress(a)}},destroy:function(){this.unAll(),this.wrapper&&(this.container.removeChild(this.wrapper),this.wrapper=null)},createElements:function(){},updateSize:function(){},drawWave:function(a,b){},clearWave:function(){},updateProgress:function(a){}},WaveSurfer.util.extend(WaveSurfer.Drawer,WaveSurfer.Observer),WaveSurfer.Drawer.Canvas=Object.create(WaveSurfer.Drawer),WaveSurfer.util.extend(WaveSurfer.Drawer.Canvas,{createElements:function(){var a=this.wrapper.appendChild(this.style(document.createElement("canvas"),{position:"absolute",zIndex:1,left:0,top:0,bottom:0}));if(this.waveCc=a.getContext("2d"),this.progressWave=this.wrapper.appendChild(this.style(document.createElement("wave"),{position:"absolute",zIndex:2,left:0,top:0,bottom:0,overflow:"hidden",width:"0",display:"none",boxSizing:"border-box",borderRightStyle:"solid",borderRightWidth:this.params.cursorWidth+"px",borderRightColor:this.params.cursorColor})),this.params.waveColor!=this.params.progressColor){var b=this.progressWave.appendChild(document.createElement("canvas"));this.progressCc=b.getContext("2d")}},updateSize:function(){var a=Math.round(this.width/this.params.pixelRatio);this.waveCc.canvas.width=this.width,this.waveCc.canvas.height=this.height,this.style(this.waveCc.canvas,{width:a+"px"}),this.style(this.progressWave,{display:"block"}),this.progressCc&&(this.progressCc.canvas.width=this.width,this.progressCc.canvas.height=this.height,this.style(this.progressCc.canvas,{width:a+"px"})),this.clearWave()},clearWave:function(){this.waveCc.clearRect(0,0,this.width,this.height),this.progressCc&&this.progressCc.clearRect(0,0,this.width,this.height)},drawBars:function(a,b){if(a[0]instanceof Array){var c=a;if(this.params.splitChannels)return this.setHeight(c.length*this.params.height*this.params.pixelRatio),void c.forEach(this.drawBars,this);a=c[0]}var d=.5/this.params.pixelRatio,e=this.width,f=this.params.height*this.params.pixelRatio,g=f*b||0,h=f/2,i=~~(a.length/2),j=this.params.barWidth*this.params.pixelRatio,k=Math.max(this.params.pixelRatio,~~(j/2)),l=j+k,m=1;if(this.params.normalize){var n,o;o=Math.max.apply(Math,a),n=Math.min.apply(Math,a),m=o,-n>m&&(m=-n)}var p=i/e;this.waveCc.fillStyle=this.params.waveColor,this.progressCc&&(this.progressCc.fillStyle=this.params.progressColor),[this.waveCc,this.progressCc].forEach(function(b){if(b)if(this.params.reflection)for(var c=0;e>c;c+=l){var f=Math.round(a[2*c*p]/m*h);b.fillRect(c+d,h-f+g,j+d,2*f)}else{for(var c=0;e>c;c+=l){var f=Math.round(a[2*c*p]/m*h);b.fillRect(c+d,h-f+g,j+d,f)}for(var c=0;e>c;c+=l){var f=Math.round(a[2*c*p+1]/m*h);b.fillRect(c+d,h-f+g,j+d,f)}}},this)},drawWave:function(a,b){if(a[0]instanceof Array){var c=a;if(this.params.splitChannels)return this.setHeight(c.length*this.params.height*this.params.pixelRatio),void c.forEach(this.drawWave,this);a=c[0]}var d=.5/this.params.pixelRatio,e=this.params.height*this.params.pixelRatio,f=e*b||0,g=e/2,h=~~(a.length/2),i=1;this.params.fillParent&&this.width!=h&&(i=this.width/h);var j=1;if(this.params.normalize){var k,l;l=Math.max.apply(Math,a),k=Math.min.apply(Math,a),j=l,-k>j&&(j=-k)}this.waveCc.fillStyle=this.params.waveColor,this.progressCc&&(this.progressCc.fillStyle=this.params.progressColor),[this.waveCc,this.progressCc].forEach(function(b){if(b){b.beginPath(),b.moveTo(d,g+f);for(var c=0;h>c;c++){var e=Math.round(a[2*c]/j*g);b.lineTo(c*i+d,g-e+f)}for(var c=h-1;c>=0;c--){var e=Math.round(a[2*c+1]/j*g);b.lineTo(c*i+d,g-e+f)}b.closePath(),b.fill(),b.fillRect(0,g+f-d,this.width,d)}},this)},updateProgress:function(a){var b=Math.round(this.width*a)/this.params.pixelRatio;this.style(this.progressWave,{width:b+"px"})}}),WaveSurfer.Regions={init:function(a){this.wavesurfer=a,this.wrapper=this.wavesurfer.drawer.wrapper,this.list={}},add:function(a){var b=Object.create(WaveSurfer.Region);return b.init(a,this.wavesurfer),this.list[b.id]=b,b.on("remove",function(){delete this.list[b.id]}.bind(this)),b},clear:function(){Object.keys(this.list).forEach(function(a){this.list[a].remove()},this)},enableDragSelection:function(a){var b,c,d,e=this;this.wrapper.addEventListener("mousedown",function(a){b=!0,c=e.wavesurfer.drawer.handleEvent(a),d=null}),this.wrapper.addEventListener("mouseup",function(a){b=!1,d&&(d.fireEvent("update-end",a),e.wavesurfer.fireEvent("region-update-end",d,a)),d=null}),this.wrapper.addEventListener("mousemove",function(f){if(b){d||(d=e.add(a||{}));var g=e.wavesurfer.getDuration(),h=e.wavesurfer.drawer.handleEvent(f);d.update({start:Math.min(h*g,c*g),end:Math.max(h*g,c*g)})}})}},WaveSurfer.Region={style:WaveSurfer.Drawer.style,init:function(a,b){this.wavesurfer=b,this.wrapper=b.drawer.wrapper,this.id=null==a.id?WaveSurfer.util.getId():a.id,this.start=Number(a.start)||0,this.end=null==a.end?this.start+4/this.wrapper.scrollWidth*this.wavesurfer.getDuration():Number(a.end),this.resize=void 0===a.resize?!0:Boolean(a.resize),this.drag=void 0===a.drag?!0:Boolean(a.drag),this.loop=Boolean(a.loop),this.color=a.color||"rgba(0, 0, 0, 0.1)",this.data=a.data||{},this.maxLength=a.maxLength,this.minLength=a.minLength,this.bindInOut(),this.render(),this.wavesurfer.fireEvent("region-created",this)},update:function(a){null!=a.start&&(this.start=Number(a.start)),null!=a.end&&(this.end=Number(a.end)),null!=a.loop&&(this.loop=Boolean(a.loop)),null!=a.color&&(this.color=a.color),null!=a.data&&(this.data=a.data),null!=a.resize&&(this.resize=Boolean(a.resize)),null!=a.drag&&(this.drag=Boolean(a.drag)),null!=a.maxLength&&(this.maxLength=Number(a.maxLength)),null!=a.minLength&&(this.minLength=Number(a.minLength)),this.updateRender(),this.fireEvent("update"),this.wavesurfer.fireEvent("region-updated",this)},remove:function(a){this.element&&(this.wrapper.removeChild(this.element),this.element=null,this.fireEvent("remove"),this.wavesurfer.fireEvent("region-removed",this))},play:function(){this.wavesurfer.play(this.start,this.end),this.fireEvent("play"),this.wavesurfer.fireEvent("region-play",this)},playLoop:function(){this.play(),this.once("out",this.playLoop.bind(this))},render:function(){var a=document.createElement("region");a.className="wavesurfer-region",a.title=this.formatTime(this.start,this.end),a.setAttribute("data-id",this.id);this.wrapper.scrollWidth;if(this.style(a,{position:"absolute",zIndex:2,height:"100%",top:"0px"}),this.resize){var b=a.appendChild(document.createElement("handle")),c=a.appendChild(document.createElement("handle"));b.className="wavesurfer-handle wavesurfer-handle-start",c.className="wavesurfer-handle wavesurfer-handle-end";var d={cursor:"col-resize",position:"absolute",left:"0px",top:"0px",width:"1%",maxWidth:"4px",height:"100%"};this.style(b,d),this.style(c,d),this.style(c,{left:"100%"})}this.element=this.wrapper.appendChild(a),this.updateRender(),this.bindEvents(a)},formatTime:function(a,b){return(a==b?[a]:[a,b]).map(function(a){return[Math.floor(a%3600/60),("00"+Math.floor(a%60)).slice(-2)].join(":")}).join("–")},updateRender:function(){var a=this.wavesurfer.getDuration(),b=this.wrapper.scrollWidth;this.start<0&&(this.start=0,this.end=this.end-this.start),this.end>a&&(this.end=a,this.start=a-(this.end-this.start)),null!=this.minLength&&(this.end=Math.max(this.start+this.minLength,this.end)),null!=this.maxLength&&(this.end=Math.min(this.start+this.maxLength,this.end)),this.style(this.element,{left:~~(this.start/a*b)+"px",width:~~((this.end-this.start)/a*b)+"px",backgroundColor:this.color,cursor:this.drag?"move":"default"}),this.element.title=this.formatTime(this.start,this.end)},bindInOut:function(){var a=this,b=function(){a.firedIn=!1,a.firedOut=!1},c=function(b){!a.firedIn&&a.start<=b&&a.end>b&&(a.firedIn=!0,a.fireEvent("in"),a.wavesurfer.fireEvent("region-in",a)),!a.firedOut&&a.firedIn&&a.end<=b&&(a.firedOut=!0,a.fireEvent("out"),a.wavesurfer.fireEvent("region-out",a))};this.wavesurfer.on("play",b),this.wavesurfer.backend.on("audioprocess",c),this.on("remove",function(){a.wavesurfer.un("play",b),a.wavesurfer.backend.un("audioprocess",c)}),this.on("out",function(){a.loop&&a.wavesurfer.play(a.start)})},bindEvents:function(){var a=this;this.element.addEventListener("mouseenter",function(b){a.fireEvent("mouseenter",b),a.wavesurfer.fireEvent("region-mouseenter",a,b)}),this.element.addEventListener("mouseleave",function(b){a.fireEvent("mouseleave",b),a.wavesurfer.fireEvent("region-mouseleave",a,b)}),this.element.addEventListener("click",function(b){b.preventDefault(),a.fireEvent("click",b),a.wavesurfer.fireEvent("region-click",a,b)}),this.element.addEventListener("dblclick",function(b){b.stopPropagation(),b.preventDefault(),a.fireEvent("dblclick",b),a.wavesurfer.fireEvent("region-dblclick",a,b)}),(this.drag||this.resize)&&function(){var b,c,d,e=a.wavesurfer.getDuration(),f=function(f){f.stopPropagation(),d=a.wavesurfer.drawer.handleEvent(f)*e,"handle"==f.target.tagName.toLowerCase()?c=f.target.classList.contains("wavesurfer-handle-start")?"start":"end":b=!0},g=function(d){(b||c)&&(b=!1,c=!1,d.stopPropagation(),d.preventDefault(),a.fireEvent("update-end",d),a.wavesurfer.fireEvent("region-update-end",a,d))},h=function(f){if(b||c){var g=a.wavesurfer.drawer.handleEvent(f)*e,h=g-d;d=g,a.drag&&b&&a.onDrag(h),a.resize&&c&&a.onResize(h,c)}};a.element.addEventListener("mousedown",f),a.wrapper.addEventListener("mousemove",h),document.body.addEventListener("mouseup",g),a.on("remove",function(){document.body.removeEventListener("mouseup",g),a.wrapper.removeEventListener("mousemove",h)}),a.wavesurfer.on("destroy",function(){document.body.removeEventListener("mouseup",g)})}()},onDrag:function(a){this.update({
start:this.start+a,end:this.end+a})},onResize:function(a,b){"start"==b?this.update({start:Math.min(this.start+a,this.end),end:Math.max(this.start+a,this.end)}):this.update({start:Math.min(this.end+a,this.start),end:Math.max(this.end+a,this.start)})}},WaveSurfer.util.extend(WaveSurfer.Region,WaveSurfer.Observer),WaveSurfer.initRegions=function(){this.regions||(this.regions=Object.create(WaveSurfer.Regions),this.regions.init(this))},WaveSurfer.addRegion=function(a){return this.initRegions(),this.regions.add(a)},WaveSurfer.clearRegions=function(){this.regions&&this.regions.clear()},WaveSurfer.enableDragSelection=function(a){this.initRegions(),this.regions.enableDragSelection(a)},function(){"use strict";angular.module("wavesurfer.angular",[]).filter("hms",function(){return function(a){var b=parseInt(a,10),c=Math.floor(b/3600),d=Math.floor((b-3600*c)/60),e=b-3600*c-60*d;10>c&&(c="0"+c),10>d&&(d="0"+d),10>e&&(e="0"+e);var f=d+":"+e;return f}}).directive("wavesurferAngular",function(a,b){var c=1;return{restrict:"AE",scope:{url:"=",options:"="},template:'<div class="row"><div class="col-xs-12 wave-control-wrap"><button class="bw-btn" ng-click="bw()"></button><button ng-class="{\'play-btn\': !playing, \'pause-btn\': playing}" ng-click="playpause()"></button><button class="ff-btn" ng-click="ff()"></button><span class="sound-duration pull-left"><span>{{moment | hms}}</span> / <span>{{length | hms}}</span></span><div class="waveform" id="{{::uniqueId}}"></div><span ng-class="{\'volume-100\' : volume_level > 50, \'volume-50\' : volume_level > 0 && volume_level <= 50, \'volume-0\' : volume_level === 0}" id="player"><span class="audio-volume" id="volume" style="width: 75%"></span></span></div></div>',link:function(d,e){var f=c++;d.uniqueId="waveform_"+f,d.wavesurfer=Object.create(WaveSurfer),d.playing=!1,d.volume_level=b.sessionStorage.audioLevel||50,d.updateSlider=function(){$("#volume").slider({min:0,max:100,value:d.volume_level,range:"min",animate:!0,slide:function(a,c){d.volume_level=b.sessionStorage.audioLevel=c.value,d.wavesurfer.setVolume(d.volume_level/100)}})};var g=e.children()[0].children[0].children[4];d.options=_.extend({container:g},d.options),d.wavesurfer.init(d.options),d.updateSlider(),d.wavesurfer.load(d.url),d.moment="0",d.wavesurfer.on("ready",function(){d.length=Math.floor(d.wavesurfer.getDuration()).toString(),a(function(){d.moment=Math.floor(d.wavesurfer.getCurrentTime()).toString()},1e3*parseFloat(d.playrate))}),d.wavesurfer.on("finish",function(){d.playing=!1}),d.playpause=function(){d.wavesurfer.playPause(),d.playing=!d.playing},d.ff=function(){d.wavesurfer.skipForward()},d.bw=function(){d.wavesurfer.skipBackward()}}}})}(),function(a,b){"use strict";var c,d,e,f=a,g=f.document,h=f.navigator,i=f.setTimeout,j=f.clearTimeout,k=f.setInterval,l=f.clearInterval,m=f.getComputedStyle,n=f.encodeURIComponent,o=f.ActiveXObject,p=f.Error,q=f.Number.parseInt||f.parseInt,r=f.Number.parseFloat||f.parseFloat,s=f.Number.isNaN||f.isNaN,t=f.Date.now,u=f.Object.keys,v=f.Object.defineProperty,w=f.Object.prototype.hasOwnProperty,x=f.Array.prototype.slice,y=function(){var a=function(a){return a};if("function"==typeof f.wrap&&"function"==typeof f.unwrap)try{var b=g.createElement("div"),c=f.unwrap(b);1===b.nodeType&&c&&1===c.nodeType&&(a=f.unwrap)}catch(d){}return a}(),z=function(a){return x.call(a,0)},A=function(){var a,c,d,e,f,g,h=z(arguments),i=h[0]||{};for(a=1,c=h.length;c>a;a++)if(null!=(d=h[a]))for(e in d)w.call(d,e)&&(f=i[e],g=d[e],i!==g&&g!==b&&(i[e]=g));return i},B=function(a){var b,c,d,e;if("object"!=typeof a||null==a||"number"==typeof a.nodeType)b=a;else if("number"==typeof a.length)for(b=[],c=0,d=a.length;d>c;c++)w.call(a,c)&&(b[c]=B(a[c]));else{b={};for(e in a)w.call(a,e)&&(b[e]=B(a[e]))}return b},C=function(a,b){for(var c={},d=0,e=b.length;e>d;d++)b[d]in a&&(c[b[d]]=a[b[d]]);return c},D=function(a,b){var c={};for(var d in a)-1===b.indexOf(d)&&(c[d]=a[d]);return c},E=function(a){if(a)for(var b in a)w.call(a,b)&&delete a[b];return a},F=function(a,b){if(a&&1===a.nodeType&&a.ownerDocument&&b&&(1===b.nodeType&&b.ownerDocument&&b.ownerDocument===a.ownerDocument||9===b.nodeType&&!b.ownerDocument&&b===a.ownerDocument))do{if(a===b)return!0;a=a.parentNode}while(a);return!1},G=function(a){var b;return"string"==typeof a&&a&&(b=a.split("#")[0].split("?")[0],b=a.slice(0,a.lastIndexOf("/")+1)),b},H=function(a){var b,c;return"string"==typeof a&&a&&(c=a.match(/^(?:|[^:@]*@|.+\)@(?=http[s]?|file)|.+?\s+(?: at |@)(?:[^:\(]+ )*[\(]?)((?:http[s]?|file):\/\/[\/]?.+?\/[^:\)]*?)(?::\d+)(?::\d+)?/),c&&c[1]?b=c[1]:(c=a.match(/\)@((?:http[s]?|file):\/\/[\/]?.+?\/[^:\)]*?)(?::\d+)(?::\d+)?/),c&&c[1]&&(b=c[1]))),b},I=function(){var a,b;try{throw new p}catch(c){b=c}return b&&(a=b.sourceURL||b.fileName||H(b.stack)),a},J=function(){var a,c,d;if(g.currentScript&&(a=g.currentScript.src))return a;if(c=g.getElementsByTagName("script"),1===c.length)return c[0].src||b;if("readyState"in c[0])for(d=c.length;d--;)if("interactive"===c[d].readyState&&(a=c[d].src))return a;return"loading"===g.readyState&&(a=c[c.length-1].src)?a:(a=I())?a:b},K=function(){var a,c,d,e=g.getElementsByTagName("script");for(a=e.length;a--;){if(!(d=e[a].src)){c=null;break}if(d=G(d),null==c)c=d;else if(c!==d){c=null;break}}return c||b},L=function(){var a=G(J())||K()||"";return a+"ZeroClipboard.swf"},M=function(){return null==a.opener&&(!!a.top&&a!=a.top||!!a.parent&&a!=a.parent)}(),N={bridge:null,version:"0.0.0",pluginType:"unknown",disabled:null,outdated:null,sandboxed:null,unavailable:null,degraded:null,deactivated:null,overdue:null,ready:null},O="11.0.0",P={},Q={},R=null,S=0,T=0,U={ready:"Flash communication is established",error:{"flash-disabled":"Flash is disabled or not installed. May also be attempting to run Flash in a sandboxed iframe, which is impossible.","flash-outdated":"Flash is too outdated to support ZeroClipboard","flash-sandboxed":"Attempting to run Flash in a sandboxed iframe, which is impossible","flash-unavailable":"Flash is unable to communicate bidirectionally with JavaScript","flash-degraded":"Flash is unable to preserve data fidelity when communicating with JavaScript","flash-deactivated":"Flash is too outdated for your browser and/or is configured as click-to-activate.\nThis may also mean that the ZeroClipboard SWF object could not be loaded, so please check your `swfPath` configuration and/or network connectivity.\nMay also be attempting to run Flash in a sandboxed iframe, which is impossible.","flash-overdue":"Flash communication was established but NOT within the acceptable time limit","version-mismatch":"ZeroClipboard JS version number does not match ZeroClipboard SWF version number","clipboard-error":"At least one error was thrown while ZeroClipboard was attempting to inject your data into the clipboard","config-mismatch":"ZeroClipboard configuration does not match Flash's reality","swf-not-found":"The ZeroClipboard SWF object could not be loaded, so please check your `swfPath` configuration and/or network connectivity"}},V=["flash-unavailable","flash-degraded","flash-overdue","version-mismatch","config-mismatch","clipboard-error"],W=["flash-disabled","flash-outdated","flash-sandboxed","flash-unavailable","flash-degraded","flash-deactivated","flash-overdue"],X=new RegExp("^flash-("+W.map(function(a){return a.replace(/^flash-/,"")}).join("|")+")$"),Y=new RegExp("^flash-("+W.slice(1).map(function(a){return a.replace(/^flash-/,"")}).join("|")+")$"),Z={swfPath:L(),trustedDomains:a.location.host?[a.location.host]:[],cacheBust:!0,forceEnhancedClipboard:!1,flashLoadTimeout:3e4,autoActivate:!0,bubbleEvents:!0,containerId:"global-zeroclipboard-html-bridge",containerClass:"global-zeroclipboard-container",swfObjectId:"global-zeroclipboard-flash-bridge",hoverClass:"zeroclipboard-is-hover",activeClass:"zeroclipboard-is-active",forceHandCursor:!1,title:null,zIndex:999999999},$=function(a){if("object"==typeof a&&null!==a)for(var b in a)if(w.call(a,b))if(/^(?:forceHandCursor|title|zIndex|bubbleEvents)$/.test(b))Z[b]=a[b];else if(null==N.bridge)if("containerId"===b||"swfObjectId"===b){if(!na(a[b]))throw new Error("The specified `"+b+"` value is not valid as an HTML4 Element ID");Z[b]=a[b]}else Z[b]=a[b];{if("string"!=typeof a||!a)return B(Z);if(w.call(Z,a))return Z[a]}},_=function(){return Ta(),{browser:C(h,["userAgent","platform","appName"]),flash:D(N,["bridge"]),zeroclipboard:{version:Va.version,config:Va.config()}}},aa=function(){return!!(N.disabled||N.outdated||N.sandboxed||N.unavailable||N.degraded||N.deactivated)},ba=function(a,d){var e,f,g,h={};if("string"==typeof a&&a)g=a.toLowerCase().split(/\s+/);else if("object"==typeof a&&a&&"undefined"==typeof d)for(e in a)w.call(a,e)&&"string"==typeof e&&e&&"function"==typeof a[e]&&Va.on(e,a[e]);if(g&&g.length){for(e=0,f=g.length;f>e;e++)a=g[e].replace(/^on/,""),h[a]=!0,P[a]||(P[a]=[]),P[a].push(d);if(h.ready&&N.ready&&Va.emit({type:"ready"}),h.error){for(e=0,f=W.length;f>e;e++)if(N[W[e].replace(/^flash-/,"")]===!0){Va.emit({type:"error",name:W[e]});break}c!==b&&Va.version!==c&&Va.emit({type:"error",name:"version-mismatch",jsVersion:Va.version,swfVersion:c})}}return Va},ca=function(a,b){var c,d,e,f,g;if(0===arguments.length)f=u(P);else if("string"==typeof a&&a)f=a.split(/\s+/);else if("object"==typeof a&&a&&"undefined"==typeof b)for(c in a)w.call(a,c)&&"string"==typeof c&&c&&"function"==typeof a[c]&&Va.off(c,a[c]);if(f&&f.length)for(c=0,d=f.length;d>c;c++)if(a=f[c].toLowerCase().replace(/^on/,""),g=P[a],g&&g.length)if(b)for(e=g.indexOf(b);-1!==e;)g.splice(e,1),e=g.indexOf(b,e);else g.length=0;return Va},da=function(a){var b;return b="string"==typeof a&&a?B(P[a])||null:B(P)},ea=function(a){var b,c,d;return a=oa(a),a&&!va(a)?"ready"===a.type&&N.overdue===!0?Va.emit({type:"error",name:"flash-overdue"}):(b=A({},a),ta.call(this,b),"copy"===a.type&&(d=Da(Q),c=d.data,R=d.formatMap),c):void 0},fa=function(){var a=N.sandboxed;if(Ta(),"boolean"!=typeof N.ready&&(N.ready=!1),N.sandboxed!==a&&N.sandboxed===!0)N.ready=!1,Va.emit({type:"error",name:"flash-sandboxed"});else if(!Va.isFlashUnusable()&&null===N.bridge){var b=Z.flashLoadTimeout;"number"==typeof b&&b>=0&&(S=i(function(){"boolean"!=typeof N.deactivated&&(N.deactivated=!0),N.deactivated===!0&&Va.emit({type:"error",name:"flash-deactivated"})},b)),N.overdue=!1,Ba()}},ga=function(){Va.clearData(),Va.blur(),Va.emit("destroy"),Ca(),Va.off()},ha=function(a,b){var c;if("object"==typeof a&&a&&"undefined"==typeof b)c=a,Va.clearData();else{if("string"!=typeof a||!a)return;c={},c[a]=b}for(var d in c)"string"==typeof d&&d&&w.call(c,d)&&"string"==typeof c[d]&&c[d]&&(Q[d]=c[d])},ia=function(a){"undefined"==typeof a?(E(Q),R=null):"string"==typeof a&&w.call(Q,a)&&delete Q[a]},ja=function(a){return"undefined"==typeof a?B(Q):"string"==typeof a&&w.call(Q,a)?Q[a]:void 0},ka=function(a){if(a&&1===a.nodeType){d&&(La(d,Z.activeClass),d!==a&&La(d,Z.hoverClass)),d=a,Ka(a,Z.hoverClass);var b=a.getAttribute("title")||Z.title;if("string"==typeof b&&b){var c=Aa(N.bridge);c&&c.setAttribute("title",b)}var e=Z.forceHandCursor===!0||"pointer"===Ma(a,"cursor");Ra(e),Qa()}},la=function(){var a=Aa(N.bridge);a&&(a.removeAttribute("title"),a.style.left="0px",a.style.top="-9999px",a.style.width="1px",a.style.height="1px"),d&&(La(d,Z.hoverClass),La(d,Z.activeClass),d=null)},ma=function(){return d||null},na=function(a){return"string"==typeof a&&a&&/^[A-Za-z][A-Za-z0-9_:\-\.]*$/.test(a)},oa=function(a){var b;if("string"==typeof a&&a?(b=a,a={}):"object"==typeof a&&a&&"string"==typeof a.type&&a.type&&(b=a.type),b){b=b.toLowerCase(),!a.target&&(/^(copy|aftercopy|_click)$/.test(b)||"error"===b&&"clipboard-error"===a.name)&&(a.target=e),A(a,{type:b,target:a.target||d||null,relatedTarget:a.relatedTarget||null,currentTarget:N&&N.bridge||null,timeStamp:a.timeStamp||t()||null});var c=U[a.type];return"error"===a.type&&a.name&&c&&(c=c[a.name]),c&&(a.message=c),"ready"===a.type&&A(a,{target:null,version:N.version}),"error"===a.type&&(X.test(a.name)&&A(a,{target:null,minimumVersion:O}),Y.test(a.name)&&A(a,{version:N.version})),"copy"===a.type&&(a.clipboardData={setData:Va.setData,clearData:Va.clearData}),"aftercopy"===a.type&&(a=Ea(a,R)),a.target&&!a.relatedTarget&&(a.relatedTarget=pa(a.target)),qa(a)}},pa=function(a){var b=a&&a.getAttribute&&a.getAttribute("data-clipboard-target");return b?g.getElementById(b):null},qa=function(a){if(a&&/^_(?:click|mouse(?:over|out|down|up|move))$/.test(a.type)){var c=a.target,d="_mouseover"===a.type&&a.relatedTarget?a.relatedTarget:b,e="_mouseout"===a.type&&a.relatedTarget?a.relatedTarget:b,h=Na(c),i=f.screenLeft||f.screenX||0,j=f.screenTop||f.screenY||0,k=g.body.scrollLeft+g.documentElement.scrollLeft,l=g.body.scrollTop+g.documentElement.scrollTop,m=h.left+("number"==typeof a._stageX?a._stageX:0),n=h.top+("number"==typeof a._stageY?a._stageY:0),o=m-k,p=n-l,q=i+o,r=j+p,s="number"==typeof a.movementX?a.movementX:0,t="number"==typeof a.movementY?a.movementY:0;delete a._stageX,delete a._stageY,A(a,{srcElement:c,fromElement:d,toElement:e,screenX:q,screenY:r,pageX:m,pageY:n,clientX:o,clientY:p,x:o,y:p,movementX:s,movementY:t,offsetX:0,offsetY:0,layerX:0,layerY:0})}return a},ra=function(a){var b=a&&"string"==typeof a.type&&a.type||"";return!/^(?:(?:before)?copy|destroy)$/.test(b)},sa=function(a,b,c,d){d?i(function(){a.apply(b,c)},0):a.apply(b,c)},ta=function(a){if("object"==typeof a&&a&&a.type){var b=ra(a),c=P["*"]||[],d=P[a.type]||[],e=c.concat(d);if(e&&e.length){var g,h,i,j,k,l=this;for(g=0,h=e.length;h>g;g++)i=e[g],j=l,"string"==typeof i&&"function"==typeof f[i]&&(i=f[i]),"object"==typeof i&&i&&"function"==typeof i.handleEvent&&(j=i,i=i.handleEvent),"function"==typeof i&&(k=A({},a),sa(i,j,[k],b))}return this}},ua=function(a){var b=null;return(M===!1||a&&"error"===a.type&&a.name&&-1!==V.indexOf(a.name))&&(b=!1),b},va=function(a){var b=a.target||d||null,f="swf"===a._source;switch(delete a._source,a.type){case"error":var g="flash-sandboxed"===a.name||ua(a);"boolean"==typeof g&&(N.sandboxed=g),-1!==W.indexOf(a.name)?A(N,{disabled:"flash-disabled"===a.name,outdated:"flash-outdated"===a.name,unavailable:"flash-unavailable"===a.name,degraded:"flash-degraded"===a.name,deactivated:"flash-deactivated"===a.name,overdue:"flash-overdue"===a.name,ready:!1}):"version-mismatch"===a.name&&(c=a.swfVersion,A(N,{disabled:!1,outdated:!1,unavailable:!1,degraded:!1,deactivated:!1,overdue:!1,ready:!1})),Pa();break;case"ready":c=a.swfVersion;var h=N.deactivated===!0;A(N,{disabled:!1,outdated:!1,sandboxed:!1,unavailable:!1,degraded:!1,deactivated:!1,overdue:h,ready:!h}),Pa();break;case"beforecopy":e=b;break;case"copy":var i,j,k=a.relatedTarget;!Q["text/html"]&&!Q["text/plain"]&&k&&(j=k.value||k.outerHTML||k.innerHTML)&&(i=k.value||k.textContent||k.innerText)?(a.clipboardData.clearData(),a.clipboardData.setData("text/plain",i),j!==i&&a.clipboardData.setData("text/html",j)):!Q["text/plain"]&&a.target&&(i=a.target.getAttribute("data-clipboard-text"))&&(a.clipboardData.clearData(),a.clipboardData.setData("text/plain",i));break;case"aftercopy":wa(a),Va.clearData(),b&&b!==Ja()&&b.focus&&b.focus();break;case"_mouseover":Va.focus(b),Z.bubbleEvents===!0&&f&&(b&&b!==a.relatedTarget&&!F(a.relatedTarget,b)&&xa(A({},a,{type:"mouseenter",bubbles:!1,cancelable:!1})),xa(A({},a,{type:"mouseover"})));break;case"_mouseout":Va.blur(),Z.bubbleEvents===!0&&f&&(b&&b!==a.relatedTarget&&!F(a.relatedTarget,b)&&xa(A({},a,{type:"mouseleave",bubbles:!1,cancelable:!1})),xa(A({},a,{type:"mouseout"})));break;case"_mousedown":Ka(b,Z.activeClass),Z.bubbleEvents===!0&&f&&xa(A({},a,{type:a.type.slice(1)}));break;case"_mouseup":La(b,Z.activeClass),Z.bubbleEvents===!0&&f&&xa(A({},a,{type:a.type.slice(1)}));break;case"_click":e=null,Z.bubbleEvents===!0&&f&&xa(A({},a,{type:a.type.slice(1)}));break;case"_mousemove":Z.bubbleEvents===!0&&f&&xa(A({},a,{type:a.type.slice(1)}))}return/^_(?:click|mouse(?:over|out|down|up|move))$/.test(a.type)?!0:void 0},wa=function(a){if(a.errors&&a.errors.length>0){var b=B(a);A(b,{type:"error",name:"clipboard-error"}),delete b.success,i(function(){Va.emit(b)},0)}},xa=function(a){if(a&&"string"==typeof a.type&&a){var b,c=a.target||null,d=c&&c.ownerDocument||g,e={view:d.defaultView||f,canBubble:!0,cancelable:!0,detail:"click"===a.type?1:0,button:"number"==typeof a.which?a.which-1:"number"==typeof a.button?a.button:d.createEvent?0:1},h=A(e,a);c&&d.createEvent&&c.dispatchEvent&&(h=[h.type,h.canBubble,h.cancelable,h.view,h.detail,h.screenX,h.screenY,h.clientX,h.clientY,h.ctrlKey,h.altKey,h.shiftKey,h.metaKey,h.button,h.relatedTarget],b=d.createEvent("MouseEvents"),b.initMouseEvent&&(b.initMouseEvent.apply(b,h),b._source="js",c.dispatchEvent(b)))}},ya=function(){var a=Z.flashLoadTimeout;if("number"==typeof a&&a>=0){var b=Math.min(1e3,a/10),c=Z.swfObjectId+"_fallbackContent";T=k(function(){var a=g.getElementById(c);Oa(a)&&(Pa(),N.deactivated=null,Va.emit({type:"error",name:"swf-not-found"}))},b)}},za=function(){var a=g.createElement("div");return a.id=Z.containerId,a.className=Z.containerClass,a.style.position="absolute",a.style.left="0px",a.style.top="-9999px",a.style.width="1px",a.style.height="1px",a.style.zIndex=""+Sa(Z.zIndex),a},Aa=function(a){for(var b=a&&a.parentNode;b&&"OBJECT"===b.nodeName&&b.parentNode;)b=b.parentNode;return b||null},Ba=function(){var a,b=N.bridge,c=Aa(b);if(!b){var d=Ia(f.location.host,Z),e="never"===d?"none":"all",h=Ga(A({jsVersion:Va.version},Z)),i=Z.swfPath+Fa(Z.swfPath,Z);c=za();var j=g.createElement("div");c.appendChild(j),g.body.appendChild(c);var k=g.createElement("div"),l="activex"===N.pluginType;k.innerHTML='<object id="'+Z.swfObjectId+'" name="'+Z.swfObjectId+'" width="100%" height="100%" '+(l?'classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000"':'type="application/x-shockwave-flash" data="'+i+'"')+">"+(l?'<param name="movie" value="'+i+'"/>':"")+'<param name="allowScriptAccess" value="'+d+'"/><param name="allowNetworking" value="'+e+'"/><param name="menu" value="false"/><param name="wmode" value="transparent"/><param name="flashvars" value="'+h+'"/><div id="'+Z.swfObjectId+'_fallbackContent">&nbsp;</div></object>',b=k.firstChild,k=null,y(b).ZeroClipboard=Va,c.replaceChild(b,j),ya()}return b||(b=g[Z.swfObjectId],b&&(a=b.length)&&(b=b[a-1]),!b&&c&&(b=c.firstChild)),N.bridge=b||null,b},Ca=function(){var a=N.bridge;if(a){var d=Aa(a);d&&("activex"===N.pluginType&&"readyState"in a?(a.style.display="none",function e(){if(4===a.readyState){for(var b in a)"function"==typeof a[b]&&(a[b]=null);a.parentNode&&a.parentNode.removeChild(a),d.parentNode&&d.parentNode.removeChild(d)}else i(e,10)}()):(a.parentNode&&a.parentNode.removeChild(a),d.parentNode&&d.parentNode.removeChild(d))),Pa(),N.ready=null,N.bridge=null,N.deactivated=null,c=b}},Da=function(a){var b={},c={};if("object"==typeof a&&a){for(var d in a)if(d&&w.call(a,d)&&"string"==typeof a[d]&&a[d])switch(d.toLowerCase()){case"text/plain":case"text":case"air:text":case"flash:text":b.text=a[d],c.text=d;break;case"text/html":case"html":case"air:html":case"flash:html":b.html=a[d],c.html=d;break;case"application/rtf":case"text/rtf":case"rtf":case"richtext":case"air:rtf":case"flash:rtf":b.rtf=a[d],c.rtf=d}return{data:b,formatMap:c}}},Ea=function(a,b){if("object"!=typeof a||!a||"object"!=typeof b||!b)return a;var c={};for(var d in a)if(w.call(a,d))if("errors"===d){c[d]=a[d]?a[d].slice():[];for(var e=0,f=c[d].length;f>e;e++)c[d][e].format=b[c[d][e].format]}else if("success"!==d&&"data"!==d)c[d]=a[d];else{c[d]={};var g=a[d];for(var h in g)h&&w.call(g,h)&&w.call(b,h)&&(c[d][b[h]]=g[h])}return c},Fa=function(a,b){var c=null==b||b&&b.cacheBust===!0;return c?(-1===a.indexOf("?")?"?":"&")+"noCache="+t():""},Ga=function(a){var b,c,d,e,g="",h=[];if(a.trustedDomains&&("string"==typeof a.trustedDomains?e=[a.trustedDomains]:"object"==typeof a.trustedDomains&&"length"in a.trustedDomains&&(e=a.trustedDomains)),e&&e.length)for(b=0,c=e.length;c>b;b++)if(w.call(e,b)&&e[b]&&"string"==typeof e[b]){if(d=Ha(e[b]),!d)continue;if("*"===d){h.length=0,h.push(d);break}h.push.apply(h,[d,"//"+d,f.location.protocol+"//"+d])}return h.length&&(g+="trustedOrigins="+n(h.join(","))),a.forceEnhancedClipboard===!0&&(g+=(g?"&":"")+"forceEnhancedClipboard=true"),"string"==typeof a.swfObjectId&&a.swfObjectId&&(g+=(g?"&":"")+"swfObjectId="+n(a.swfObjectId)),"string"==typeof a.jsVersion&&a.jsVersion&&(g+=(g?"&":"")+"jsVersion="+n(a.jsVersion)),g},Ha=function(a){if(null==a||""===a)return null;if(a=a.replace(/^\s+|\s+$/g,""),""===a)return null;var b=a.indexOf("//");a=-1===b?a:a.slice(b+2);var c=a.indexOf("/");return a=-1===c?a:-1===b||0===c?null:a.slice(0,c),a&&".swf"===a.slice(-4).toLowerCase()?null:a||null},Ia=function(){var a=function(a){var b,c,d,e=[];if("string"==typeof a&&(a=[a]),"object"!=typeof a||!a||"number"!=typeof a.length)return e;for(b=0,c=a.length;c>b;b++)if(w.call(a,b)&&(d=Ha(a[b]))){if("*"===d){e.length=0,e.push("*");break}-1===e.indexOf(d)&&e.push(d)}return e};return function(b,c){var d=Ha(c.swfPath);null===d&&(d=b);var e=a(c.trustedDomains),f=e.length;if(f>0){if(1===f&&"*"===e[0])return"always";if(-1!==e.indexOf(b))return 1===f&&b===d?"sameDomain":"always"}return"never"}}(),Ja=function(){try{return g.activeElement}catch(a){return null}},Ka=function(a,b){var c,d,e,f=[];if("string"==typeof b&&b&&(f=b.split(/\s+/)),a&&1===a.nodeType&&f.length>0)if(a.classList)for(c=0,d=f.length;d>c;c++)a.classList.add(f[c]);else if(a.hasOwnProperty("className")){for(e=" "+a.className+" ",c=0,d=f.length;d>c;c++)-1===e.indexOf(" "+f[c]+" ")&&(e+=f[c]+" ");a.className=e.replace(/^\s+|\s+$/g,"")}return a},La=function(a,b){var c,d,e,f=[];if("string"==typeof b&&b&&(f=b.split(/\s+/)),a&&1===a.nodeType&&f.length>0)if(a.classList&&a.classList.length>0)for(c=0,d=f.length;d>c;c++)a.classList.remove(f[c]);else if(a.className){for(e=(" "+a.className+" ").replace(/[\r\n\t]/g," "),c=0,d=f.length;d>c;c++)e=e.replace(" "+f[c]+" "," ");a.className=e.replace(/^\s+|\s+$/g,"")}return a},Ma=function(a,b){var c=m(a,null).getPropertyValue(b);return"cursor"!==b||c&&"auto"!==c||"A"!==a.nodeName?c:"pointer"},Na=function(a){var b={left:0,top:0,width:0,height:0};if(a.getBoundingClientRect){var c=a.getBoundingClientRect(),d=f.pageXOffset,e=f.pageYOffset,h=g.documentElement.clientLeft||0,i=g.documentElement.clientTop||0,j=0,k=0;if("relative"===Ma(g.body,"position")){var l=g.body.getBoundingClientRect(),m=g.documentElement.getBoundingClientRect();j=l.left-m.left||0,k=l.top-m.top||0}b.left=c.left+d-h-j,b.top=c.top+e-i-k,b.width="width"in c?c.width:c.right-c.left,b.height="height"in c?c.height:c.bottom-c.top}return b},Oa=function(a){if(!a)return!1;var b=m(a,null),c=r(b.height)>0,d=r(b.width)>0,e=r(b.top)>=0,f=r(b.left)>=0,g=c&&d&&e&&f,h=g?null:Na(a),i="none"!==b.display&&"collapse"!==b.visibility&&(g||!!h&&(c||h.height>0)&&(d||h.width>0)&&(e||h.top>=0)&&(f||h.left>=0));return i},Pa=function(){j(S),S=0,l(T),T=0},Qa=function(){var a;if(d&&(a=Aa(N.bridge))){var b=Na(d);A(a.style,{width:b.width+"px",height:b.height+"px",top:b.top+"px",left:b.left+"px",zIndex:""+Sa(Z.zIndex)})}},Ra=function(a){N.ready===!0&&(N.bridge&&"function"==typeof N.bridge.setHandCursor?N.bridge.setHandCursor(a):N.ready=!1)},Sa=function(a){if(/^(?:auto|inherit)$/.test(a))return a;var b;return"number"!=typeof a||s(a)?"string"==typeof a&&(b=Sa(q(a,10))):b=a,"number"==typeof b?b:"auto"},Ta=function(b){var c,d,e,f=N.sandboxed,g=null;if(b=b===!0,M===!1)g=!1;else{try{d=a.frameElement||null}catch(h){e={name:h.name,message:h.message}}if(d&&1===d.nodeType&&"IFRAME"===d.nodeName)try{g=d.hasAttribute("sandbox")}catch(h){g=null}else{try{c=document.domain||null}catch(h){c=null}(null===c||e&&"SecurityError"===e.name&&/(^|[\s\(\[@])sandbox(es|ed|ing|[\s\.,!\)\]@]|$)/.test(e.message.toLowerCase()))&&(g=!0)}}return N.sandboxed=g,f===g||b||Ua(o),g},Ua=function(a){function b(a){var b=a.match(/[\d]+/g);return b.length=3,b.join(".")}function c(a){return!!a&&(a=a.toLowerCase())&&(/^(pepflashplayer\.dll|libpepflashplayer\.so|pepperflashplayer\.plugin)$/.test(a)||"chrome.plugin"===a.slice(-13))}function d(a){a&&(i=!0,a.version&&(l=b(a.version)),!l&&a.description&&(l=b(a.description)),a.filename&&(k=c(a.filename)))}var e,f,g,i=!1,j=!1,k=!1,l="";if(h.plugins&&h.plugins.length)e=h.plugins["Shockwave Flash"],d(e),h.plugins["Shockwave Flash 2.0"]&&(i=!0,l="2.0.0.11");else if(h.mimeTypes&&h.mimeTypes.length)g=h.mimeTypes["application/x-shockwave-flash"],e=g&&g.enabledPlugin,d(e);else if("undefined"!=typeof a){j=!0;try{f=new a("ShockwaveFlash.ShockwaveFlash.7"),i=!0,l=b(f.GetVariable("$version"))}catch(m){try{f=new a("ShockwaveFlash.ShockwaveFlash.6"),i=!0,l="6.0.21"}catch(n){try{f=new a("ShockwaveFlash.ShockwaveFlash"),i=!0,l=b(f.GetVariable("$version"))}catch(o){j=!1}}}}N.disabled=i!==!0,N.outdated=l&&r(l)<r(O),N.version=l||"0.0.0",N.pluginType=k?"pepper":j?"activex":i?"netscape":"unknown"};Ua(o),Ta(!0);var Va=function(){return this instanceof Va?void("function"==typeof Va._createClient&&Va._createClient.apply(this,z(arguments))):new Va};v(Va,"version",{value:"2.2.0",writable:!1,configurable:!0,enumerable:!0}),Va.config=function(){return $.apply(this,z(arguments))},Va.state=function(){return _.apply(this,z(arguments))},Va.isFlashUnusable=function(){return aa.apply(this,z(arguments))},Va.on=function(){return ba.apply(this,z(arguments))},Va.off=function(){return ca.apply(this,z(arguments))},Va.handlers=function(){return da.apply(this,z(arguments))},Va.emit=function(){return ea.apply(this,z(arguments))},Va.create=function(){return fa.apply(this,z(arguments))},Va.destroy=function(){return ga.apply(this,z(arguments))},Va.setData=function(){return ha.apply(this,z(arguments))},Va.clearData=function(){return ia.apply(this,z(arguments))},Va.getData=function(){return ja.apply(this,z(arguments))},Va.focus=Va.activate=function(){return ka.apply(this,z(arguments))},Va.blur=Va.deactivate=function(){return la.apply(this,z(arguments))},Va.activeElement=function(){return ma.apply(this,z(arguments))};var Wa=0,Xa={},Ya=0,Za={},$a={};A(Z,{autoActivate:!0});var _a=function(a){var b=this;b.id=""+Wa++,Xa[b.id]={instance:b,elements:[],handlers:{}},a&&b.clip(a),Va.on("*",function(a){return b.emit(a)}),Va.on("destroy",function(){b.destroy()}),Va.create()},ab=function(a,d){var e,f,g,h={},i=Xa[this.id],j=i&&i.handlers;if(!i)throw new Error("Attempted to add new listener(s) to a destroyed ZeroClipboard client instance");if("string"==typeof a&&a)g=a.toLowerCase().split(/\s+/);else if("object"==typeof a&&a&&"undefined"==typeof d)for(e in a)w.call(a,e)&&"string"==typeof e&&e&&"function"==typeof a[e]&&this.on(e,a[e]);if(g&&g.length){for(e=0,f=g.length;f>e;e++)a=g[e].replace(/^on/,""),h[a]=!0,j[a]||(j[a]=[]),j[a].push(d);if(h.ready&&N.ready&&this.emit({type:"ready",client:this}),h.error){for(e=0,f=W.length;f>e;e++)if(N[W[e].replace(/^flash-/,"")]){this.emit({type:"error",name:W[e],client:this});break}c!==b&&Va.version!==c&&this.emit({type:"error",name:"version-mismatch",jsVersion:Va.version,swfVersion:c})}}return this},bb=function(a,b){var c,d,e,f,g,h=Xa[this.id],i=h&&h.handlers;if(!i)return this;if(0===arguments.length)f=u(i);else if("string"==typeof a&&a)f=a.split(/\s+/);else if("object"==typeof a&&a&&"undefined"==typeof b)for(c in a)w.call(a,c)&&"string"==typeof c&&c&&"function"==typeof a[c]&&this.off(c,a[c]);if(f&&f.length)for(c=0,d=f.length;d>c;c++)if(a=f[c].toLowerCase().replace(/^on/,""),g=i[a],g&&g.length)if(b)for(e=g.indexOf(b);-1!==e;)g.splice(e,1),e=g.indexOf(b,e);else g.length=0;return this},cb=function(a){var b=null,c=Xa[this.id]&&Xa[this.id].handlers;return c&&(b="string"==typeof a&&a?c[a]?c[a].slice(0):[]:B(c)),b},db=function(a){if(ib.call(this,a)){"object"==typeof a&&a&&"string"==typeof a.type&&a.type&&(a=A({},a));var b=A({},oa(a),{client:this});jb.call(this,b)}return this},eb=function(a){if(!Xa[this.id])throw new Error("Attempted to clip element(s) to a destroyed ZeroClipboard client instance");a=kb(a);for(var b=0;b<a.length;b++)if(w.call(a,b)&&a[b]&&1===a[b].nodeType){a[b].zcClippingId?-1===Za[a[b].zcClippingId].indexOf(this.id)&&Za[a[b].zcClippingId].push(this.id):(a[b].zcClippingId="zcClippingId_"+Ya++,Za[a[b].zcClippingId]=[this.id],Z.autoActivate===!0&&lb(a[b]));var c=Xa[this.id]&&Xa[this.id].elements;-1===c.indexOf(a[b])&&c.push(a[b])}return this},fb=function(a){var b=Xa[this.id];if(!b)return this;var c,d=b.elements;a="undefined"==typeof a?d.slice(0):kb(a);for(var e=a.length;e--;)if(w.call(a,e)&&a[e]&&1===a[e].nodeType){for(c=0;-1!==(c=d.indexOf(a[e],c));)d.splice(c,1);var f=Za[a[e].zcClippingId];if(f){for(c=0;-1!==(c=f.indexOf(this.id,c));)f.splice(c,1);0===f.length&&(Z.autoActivate===!0&&mb(a[e]),delete a[e].zcClippingId)}}return this},gb=function(){var a=Xa[this.id];return a&&a.elements?a.elements.slice(0):[]},hb=function(){Xa[this.id]&&(this.unclip(),this.off(),delete Xa[this.id])},ib=function(a){if(!a||!a.type)return!1;if(a.client&&a.client!==this)return!1;var b=Xa[this.id],c=b&&b.elements,d=!!c&&c.length>0,e=!a.target||d&&-1!==c.indexOf(a.target),f=a.relatedTarget&&d&&-1!==c.indexOf(a.relatedTarget),g=a.client&&a.client===this;return!(!b||!(e||f||g))},jb=function(a){var b=Xa[this.id];if("object"==typeof a&&a&&a.type&&b){var c=ra(a),d=b&&b.handlers["*"]||[],e=b&&b.handlers[a.type]||[],g=d.concat(e);if(g&&g.length){var h,i,j,k,l,m=this;for(h=0,i=g.length;i>h;h++)j=g[h],k=m,"string"==typeof j&&"function"==typeof f[j]&&(j=f[j]),"object"==typeof j&&j&&"function"==typeof j.handleEvent&&(k=j,j=j.handleEvent),"function"==typeof j&&(l=A({},a),sa(j,k,[l],c))}}},kb=function(a){return"string"==typeof a&&(a=[]),"number"!=typeof a.length?[a]:a},lb=function(a){if(a&&1===a.nodeType){var b=function(a){(a||(a=f.event))&&("js"!==a._source&&(a.stopImmediatePropagation(),a.preventDefault()),delete a._source)},c=function(c){(c||(c=f.event))&&(b(c),Va.focus(a))};a.addEventListener("mouseover",c,!1),a.addEventListener("mouseout",b,!1),a.addEventListener("mouseenter",b,!1),a.addEventListener("mouseleave",b,!1),a.addEventListener("mousemove",b,!1),$a[a.zcClippingId]={mouseover:c,mouseout:b,mouseenter:b,mouseleave:b,mousemove:b}}},mb=function(a){if(a&&1===a.nodeType){var b=$a[a.zcClippingId];if("object"==typeof b&&b){for(var c,d,e=["move","leave","enter","out","over"],f=0,g=e.length;g>f;f++)c="mouse"+e[f],d=b[c],"function"==typeof d&&a.removeEventListener(c,d,!1);delete $a[a.zcClippingId]}}};Va._createClient=function(){_a.apply(this,z(arguments))},Va.prototype.on=function(){return ab.apply(this,z(arguments))},Va.prototype.off=function(){return bb.apply(this,z(arguments))},Va.prototype.handlers=function(){return cb.apply(this,z(arguments))},Va.prototype.emit=function(){return db.apply(this,z(arguments))},Va.prototype.clip=function(){return eb.apply(this,z(arguments))},Va.prototype.unclip=function(){return fb.apply(this,z(arguments))},Va.prototype.elements=function(){return gb.apply(this,z(arguments))},Va.prototype.destroy=function(){return hb.apply(this,z(arguments))},Va.prototype.setText=function(a){if(!Xa[this.id])throw new Error("Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance");return Va.setData("text/plain",a),this},Va.prototype.setHtml=function(a){if(!Xa[this.id])throw new Error("Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance");return Va.setData("text/html",a),this},Va.prototype.setRichText=function(a){if(!Xa[this.id])throw new Error("Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance");return Va.setData("application/rtf",a),this},Va.prototype.setData=function(){if(!Xa[this.id])throw new Error("Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance");return Va.setData.apply(this,z(arguments)),this},Va.prototype.clearData=function(){if(!Xa[this.id])throw new Error("Attempted to clear pending clipboard data from a destroyed ZeroClipboard client instance");return Va.clearData.apply(this,z(arguments)),this},Va.prototype.getData=function(){if(!Xa[this.id])throw new Error("Attempted to get pending clipboard data from a destroyed ZeroClipboard client instance");
return Va.getData.apply(this,z(arguments))},"function"==typeof define&&define.amd?define(function(){return Va}):"object"==typeof module&&module&&"object"==typeof module.exports&&module.exports?module.exports=Va:a.ZeroClipboard=Va}(function(){return this||window}()),function(a){"use strict";var b=angular.module("DashboardApp",["PortalCommon","dndLists","colorpicker.module","infinite-scroll","ngCookies","ngFileUpload","ngRoute","ngSanitize","ui.bootstrap","ui.bootstrap.override","ui.keypress","gm.datepickerMultiSelect"]);a.app=b,angular.module("DashboardApp").config(["$routeProvider","$logProvider","_config","_localconfig",function(a,b,c,d){angular.extend(c,d),ZeroClipboard.config({swfPath:c.overridePerEnvironment.baseDirectory+"bower_components/zeroclipboard/dist/ZeroClipboard.swf"}),b.debugEnabled(!0),a.when("/welcome",{templateUrl:c.overridePerEnvironment.baseDirectory+"templates/welcome.html",publishWidget:!0,wide:!0,ga_name:"Welcome Page",requirements:["property"]}).when("/style-guide",{templateUrl:c.overridePerEnvironment.baseDirectory+"templates/docs/index.html",controller:"DefaultController",wide:!0,noAuth:!0}).when("/style-guide/elements.html",{templateUrl:c.overridePerEnvironment.baseDirectory+"templates/docs/elements.html",controller:"DefaultController",wide:!0,noAuth:!0}).when("/style-guide/molecules.html",{templateUrl:c.overridePerEnvironment.baseDirectory+"templates/docs/molecules.html",controller:"DefaultController",wide:!0,noAuth:!0}).when("/players",{redirectTo:"/players/list"}).when("/players/list",{templateUrl:c.overridePerEnvironment.baseDirectory+"templates/players/list.html",controller:"PlayersListController",publishWidget:!0,permissions:{site:{players:["view"]}},ga_name:"Player List",requirements:["pageLength","property"]}).when("/players/basic_setup",{templateUrl:c.overridePerEnvironment.baseDirectory+"templates/players/builder.html",controller:"PlayerBuilderController",permissions:{site:{players:["view"]}},ga_name:"Player Builder",requirements:["property"],detailList:"/players/list"}).when("/players/design",{templateUrl:c.overridePerEnvironment.baseDirectory+"templates/players/design.html",controller:"PlayersDesignController",permissions:{site:{players:["view"]}}}).when("/players/assets",{redirectTo:"/players/assets/images",preview:!0,permissions:{site:{players:["view"]}}}).when("/players/assets/images",{templateUrl:c.overridePerEnvironment.baseDirectory+"templates/players/assets/list.html",controller:"AssetsListController",preview:!0,permissions:{site:{players:["view"]}},ga_name:"Asset Manager",requirements:["pageLength","property"]}).when("/players/downloads",{templateUrl:c.overridePerEnvironment.baseDirectory+"templates/players/downloads.html",controller:"PlayersDownloadsController",ga_name:"Downloads",requirements:["property"]}).when("/account",{redirectTo:"/account/profile"}).when("/account/settings",{redirectTo:"/account/profile"}).when("/account/profile",{templateUrl:c.overridePerEnvironment.baseDirectory+"templates/account/settings.html",controller:"AccountSettingsController",ga_name:"Account Profile",nav_name:"Profile",name:"Profile"}).when("/account/properties",{templateUrl:c.overridePerEnvironment.baseDirectory+"templates/account/properties.html",controller:"AccountPropertiesController",permissions:{account:{properties:["edit"]}},ga_name:"Account Properties"}).when("/account/users",{templateUrl:c.overridePerEnvironment.baseDirectory+"templates/account/users.html",controller:"AccountUsersController",permissions:{account:{users:["view"]}},ga_name:"Account Users",requirements:["pageLength"]}).when("/account/create",{templateUrl:c.overridePerEnvironment.baseDirectory+"templates/account/create.html",controller:"AccountCreateController",noAuth:!0}).when("/account/signup",{templateUrl:c.overridePerEnvironment.baseDirectory+"templates/account/signup.html",controller:"AccountSignupController",noAuth:!0,preview:!0}).when("/account/forgot",{templateUrl:c.overridePerEnvironment.baseDirectory+"templates/account/forgot.html",controller:"AccountForgotController",noAuth:!0}).when("/account/reset",{templateUrl:c.overridePerEnvironment.baseDirectory+"templates/account/reset.html",controller:"AccountResetController",noAuth:!0}).when("/account/select",{templateUrl:c.overridePerEnvironment.baseDirectory+"templates/account/select.html",controller:"AccountSelectController",noAuth:!0}).when("/account/email",{templateUrl:c.overridePerEnvironment.baseDirectory+"templates/account/email.html",controller:"AccountEmailController",noAuth:!0}).when("/property/detail",{redirectTo:"/account/property/detail"}).when("/account/property/detail",{templateUrl:c.overridePerEnvironment.baseDirectory+"templates/account/property_detail.html",controller:"PropertyDetailController",ga_name:"Property Detail"}).when("/account/usage",{templateUrl:c.overridePerEnvironment.baseDirectory+"templates/account/usage.html",controller:"AccountUsageController",permissions:{site:{usage:["view"]}},ga_name:"Account Usage"}).when("/account/billing",{templateUrl:c.overridePerEnvironment.baseDirectory+"templates/account/billing.html",controller:"AccountBillingController",permissions:{account:{billing:["view"]}},ga_name:"Account Billing"}).when("/account/invoice/:id",{redirectTo:function(a){return"/account/invoice/past/"+a.id}}).when("/account/invoice/past/:id",{templateUrl:c.overridePerEnvironment.baseDirectory+"templates/account/invoice/past.html",controller:"AccountInvoicePastController",permissions:{account:{billing:["view"]}},hidden:!0}).when("/account/invoice/future/:autoBillId/:invoiceId",{templateUrl:c.overridePerEnvironment.baseDirectory+"templates/account/invoice/future.html",controller:"AccountInvoiceFutureController",permissions:{account:{billing:["view"]}},hidden:!0}).when("/content",{redirectTo:"/content/list"}).when("/content/list",{templateUrl:c.overridePerEnvironment.baseDirectory+"templates/content/list.html",controller:"ContentListController",publishWidget:!0,permissions:{site:{lists:["view"]}},ga_name:"Content List",nav_name:"Library",requirements:["pageLength","property"]}).when("/content/detail",{templateUrl:c.overridePerEnvironment.baseDirectory+"templates/content/detail.html",controller:"ContentDetailController",publishWidget:!0,permissions:{site:{content:["view"]}},reloadOnSearch:!1,ga_name:"Content Detail",hidden:!0,requirements:["property"],detailList:"/content/list"}).when("/content/tags",{templateUrl:c.overridePerEnvironment.baseDirectory+"templates/content/tags/list.html",controller:"ContentTagsListController",permissions:{site:{content:["view"]}},ga_name:"Tags List",hidden:!0,requirements:["pageLength","property"]}).when("/content/edit_track",{templateUrl:c.overridePerEnvironment.baseDirectory+"templates/content/edit-track.html",controller:"ContentEditTrackController",publishWidget:!0,permissions:{site:{content:["view"]}},ga_name:"Edit Track",hidden:!0,detailList:"/content/list"}).when("/content/playlists",{templateUrl:c.overridePerEnvironment.baseDirectory+"templates/content/playlists.html",controller:"ContentPlaylistsController",publishWidget:!0,permissions:{site:{lists:["view"]}},ga_name:"Playlist List",requirements:["pageLength","property"]}).when("/content/playlists/dynamic_detail",{templateUrl:c.overridePerEnvironment.baseDirectory+"templates/content/playlist-dynamic-detail.html",controller:"ContentPlaylistDynamicDetailController",publishWidget:!0,permissions:{site:{lists:["view"]}},hidden:!0,requirements:["property"],detailList:"/content/playlists"}).when("/content/playlists/manual_detail",{templateUrl:c.overridePerEnvironment.baseDirectory+"templates/content/playlist-manual-detail.html",controller:"ContentPlaylistManualDetailController",publishWidget:!0,permissions:{site:{lists:["view"]}},hidden:!0,requirements:["property"],detailList:"/content/playlists"}).when("/content/playlists/trending_detail",{templateUrl:c.overridePerEnvironment.baseDirectory+"templates/content/playlist-dynamic-detail.html",controller:"ContentPlaylistDynamicDetailController",publishWidget:!0,permissions:{site:{lists:["view"]}},hidden:!0,requirements:["property"],detailList:"/content/playlists"}).when("/feeds",{templateUrl:c.overridePerEnvironment.baseDirectory+"templates/lists/feeds/list.html",controller:"FeedsListController",permissions:{site:{lists:["view"]}},ga_name:"Feeds List",nav_name:"Feeds",requirements:["pageLength","property"]}).when("/feeds/similar_detail",{templateUrl:c.overridePerEnvironment.baseDirectory+"templates/lists/feeds/feeds-detail.html",controller:"FeedDetailController",permissions:{site:{lists:["view"]}},entitlement:"feeds_beta",ga_name:"Feed Detail",hidden:!0,requirements:["property"],detailList:"/feeds"}).when("/ads",{redirectTo:"/ads/list"}).when("/ads/tags",{templateUrl:c.overridePerEnvironment.baseDirectory+"templates/ads/tags_list.html",controller:"AdTagsListController",permissions:{site:{ads:["view"]}},entitlement:"ads",ga_name:"Ad Tags List",requirements:["pageLength","property"]}).when("/ads/list",{templateUrl:c.overridePerEnvironment.baseDirectory+"templates/ads/schedules_list.html",controller:"AdSchedulesListController",permissions:{site:{ads:["view"]}},entitlement:"ads",ga_name:"Ad Schedules List",requirements:["pageLength","property"]}).when("/ads/detail",{templateUrl:c.overridePerEnvironment.baseDirectory+"templates/ads/schedule_detail.html",controller:"AdScheduleDetailController",permissions:{site:{ads:["view"]}},entitlement:"ads",ga_name:"Ad Schedule Detail",requirements:["property"],detailList:"/ads/list"}).when("/analytics",{redirectTo:"/analytics/overview",permissions:{site:{analytics:["view"]}}}).when("/analytics/overview",{templateUrl:c.overridePerEnvironment.baseDirectory+"templates/analytics/overview.html",controller:"AnalyticsOverviewController",ga_name:"Analytics Overview",nav_name:"Overview",requirements:["property"],shareParams:"Analytics"}).when("/analytics/content",{templateUrl:c.overridePerEnvironment.baseDirectory+"templates/analytics/content.html",controller:"AnalyticsContentController",ga_name:"Analytics Content",nav_name:"Content",requirements:["pageLength","property"],shareParams:"Analytics"}).when("/analytics/content/detail",{templateUrl:c.overridePerEnvironment.baseDirectory+"templates/analytics/content-detail.html",controller:"AnalyticsContentDetailController",hidden:!0,ga_name:"Analytics Content Detail",nav_name:"Content Detail",requirements:["property"],detailList:"/analytics/content",shareParams:"Analytics"}).when("/analytics/domains",{templateUrl:c.overridePerEnvironment.baseDirectory+"templates/analytics/domains.html",controller:"AnalyticsDomainsController",ga_name:"Analytics Domains",nav_name:"Domains",requirements:["pageLength","property"],shareParams:"Analytics"}).when("/analytics/rightnow",{templateUrl:c.overridePerEnvironment.baseDirectory+"templates/analytics/rightnow.html",controller:"AnalyticsRightnowController",ga_name:"Analytics Right Now",nav_name:"Right Now (Beta)",entitlement:"right_now",fullPage:!0,requirements:["property"]}).when("/analytics/legacy/platform",{templateUrl:c.overridePerEnvironment.baseDirectory+"templates/analytics/legacy/platform.html",permissions:{site:{analytics:["view"]}},ga_name:"Legacy Platform Analytics",hidden:!0,requirements:["property"]}).when("/admin",{templateUrl:c.overridePerEnvironment.baseDirectory+"templates/admin.html",controller:"AdminController",noAuth:!0}).when("/logout",{templateUrl:c.overridePerEnvironment.baseDirectory+"templates/welcome.html",controller:"LogoutController"}).otherwise({redirectTo:"/welcome"})}])}(window),function(){"use strict";angular.module("DashboardApp").constant("_config",{overridePerEnvironment:{autoPlayer:"http://content-portal.jwplatform.com/libraries/",baseDirectory:"",communication:{apiRootUrl:"http://local.api.jwplayer.com/v2",delegateLogoutUrl:"https://local.account.jwplayer.com/logout/delegate",delegateLoginUrl:"https://local.account.jwplayer.com/sign-in"},contentLocation:"content-portal.jwplatform.com",recurlyKey:"sjc-DzseKnjbUi0K68injjNLtI",hostedPlayer:"http://local.api.jwplayer.com/library/",ga:{id:"UA-42148455-4"},useDelegateLogin:!1,CORSService:{SDKMobileManifest:"https://ssl.p.jwpcdn.com/sdks/mobile_version_manifest.json",standaloneManifest:"https://ssl.p.jwpcdn.com/player/channel/production/package.json",productionManifest:"https://ssl.p.jwpcdn.com/player/channel/production/package.json",stagingManifest:"https://ssl.p.jwpcdn.com/player/channel/staging/package.json",previousManifest:"https://ssl.p.jwpcdn.com/player/channel/previous/package.json",betaManifest:"https://ssl.p.jwpcdn.com/player/channel/beta/package.json"},realtimeAPI:"analytics-api-nrt.dev.longtailvideo.com"},s3Turbo:!0,chromecastReceiverUrl:"https://chromecast.jwpsrv.com/receiver/",supportedBrowsers:{chrome:{iconUrl:"http://www.chromium.org/_/rsrc/1365117468642/chromium-projects/chrome-64.png?height=32&width=32",name:"Chrome",icon:"chrome",updateUrl:"http://www.google.com/chrome/",satisfyVersion:"38.0"},firefox:{iconUrl:"https://mozorg.cdn.mozilla.net/media/img/styleguide/identity/firefox/usage-logo.png?2013-06",name:"Firefox",icon:"firefox",updateUrl:"http://www.mozilla.com/firefox/",satisfyVersion:"33.0"},msie:{iconUrl:"http://ie.microsoft.com/testdrive/Browser/F12Adventure/ie-logo.png",name:"IE 10+",icon:"ie",updateUrl:"http://windows.microsoft.com/en-us/internet-explorer/download-ie",satisfyVersion:"10.0"},safari:{iconUrl:"https://www.apple.com/v/safari/c/images/overview/safari_icon_large.png",name:"Safari",icon:"safari",updateUrl:"https://itunes.apple.com//app/os-x-yosemite/id915041082?mt=12",satisfyVersion:"6.0"}},unsupportedBrowsers:{msie:{belowVersion:"10.0"}},feedbackEmailUrl:"mailto:dashboard-feedback@jwplayer.com",feedbackSurveyUrl:"https://www.surveymonkey.com/r/QRJRLKS",supportEmailUrl:"https://support.jwplayer.com/customer/portal/emails/new",upgradesEmailUrl:"mailto:upgrades@jwplayer.com",twitterFeed:"http://twitter.com/jwplatform","segment.io":{writeKey:"swxp71epjj"},imageDirectory:"images",embedTypes:{script:'<script src="{{src}}"></script>',iframe:'<iframe src="{{src}}" width="{{width}}" height="{{height}}" frameborder="0" scrolling="auto" allowfullscreen></iframe>'},audioPosterLocation:"http://content.jwplatform.com/thumbs/RF97o66v.jpg",unknownPosterImage:"images/in-progress-preview-img.png",content:{tag:{autocompleteLimit:10,suggestedLimit:10}},player:{publishURL:"http://content-portal.jwplatform.com/players/",key:"LJu3LqXr6x1yi4MI",related:"//content.jwplatform.com/feeds/EtO8vdvV.rss",video:"http://content.jwplatform.com/videos/nPripu9l-twSo9iFz.mp4",playlist:"//content.jwplatform.com/jw6/IkW1vxxc.xml",vastURL:"https://playertest.longtailvideo.com/unified/preroll_unified.xml",vmapURL:"https://playertest.longtailvideo.com/unified/unifiedvmap.xml",googimaURL:"https://ad.doubleclick.net/pfadx/N270.130667.DOUBLECLICKADVERTISI/B6436143;dcadv=2215309;dcove=o;sz=0..."},analyticsExportMax:500,publish:{player:{defaultVersion:"7",cdnHostedVersions:{6:"p.jwpcdn.com/player/v/6.12.4960",7:"p.jwpcdn.com/player/v/7.0.1"},skins:{6:[{key:"__1",name:"default",thumbnail:"skin-six.png"},{key:"__2",name:"bekle",thumbnail:"skin-bekle.png"},{key:"__3",name:"glow",thumbnail:"skin-glow.png"},{key:"__4",name:"five",thumbnail:"skin-five.png"},{key:"__5",name:"beelden",thumbnail:"skin-beelden.png"},{key:"__6",name:"stormtrooper",thumbnail:"skin-stormtrooper.png"},{key:"__7",name:"vapor",thumbnail:"skin-vapor.png"},{key:"__8",name:"roundster",thumbnail:"skin-roundster.png"},{key:"custom",name:"custom",thumbnail:"skin-custom.png"}],7:[{key:"__1",name:"default",thumbnail:"skin-seven.png"},{key:"__2",name:"six",thumbnail:"skin-six.png"},{key:"__3",name:"bekle",thumbnail:"skin-bekle.png"},{key:"__4",name:"glow",thumbnail:"skin-glow.png"},{key:"__5",name:"five",thumbnail:"skin-five.png"},{key:"__6",name:"beelden",thumbnail:"skin-beelden.png"},{key:"__7",name:"stormtrooper",thumbnail:"skin-stormtrooper.png"},{key:"__8",name:"vapor",thumbnail:"skin-vapor.png"},{key:"__9",name:"roundster",thumbnail:"skin-roundster.png"},{key:"custom",name:"custom",thumbnail:"skin-custom.png"}]}},videoUrl:"http://content.jwplatform.com/videos/HkauGhRi-1280.mp4",imageUrl:"http://demo.jwplayer.com/homepage/homepage_preroll.jpg",availablePosterSizes:[40,120,320,480,720,1280]},customMetadataBlacklist:["file","tracks","sources","feedid","tags","image","title","description","mediaid"],productPricingUrl:"https://www.jwplayer.com/upgrade/",contactUrl:"https://www.jwplayer.com/contact-us/",UPLaunchTimestamp:1406918062,maxSmallAssetCacheSize:5242880,uploadDialogDelay:500,processingAssetsRefreshDelay:5e3,processingContentRefreshDelay:5e3,processingTrackRefreshDelay:5e3,shiftLerpRate:.1,aspectRatios:["16:9","16:10","4:3","3:2","1:1","2.4:1"],AnalyticsSharedParams:["dateRange","dateRangeStart","dateRangeEnd"],SharedParamsGroups:["Analytics"],countries:[{name:"Afghanistan",code:"AF"},{name:"Åland Islands",code:"AX"},{name:"Albania",code:"AL"},{name:"Algeria",code:"DZ"},{name:"American Samoa",code:"AS"},{name:"Andorra",code:"AD"},{name:"Angola",code:"AO"},{name:"Anguilla",code:"AI"},{name:"Antarctica",code:"AQ"},{name:"Antigua and Barbuda",code:"AG"},{name:"Argentina",code:"AR"},{name:"Armenia",code:"AM"},{name:"Aruba",code:"AW"},{name:"Australia",code:"AU"},{name:"Austria",code:"AT"},{name:"Azerbaijan",code:"AZ"},{name:"Bahamas",code:"BS"},{name:"Bahrain",code:"BH"},{name:"Bangladesh",code:"BD"},{name:"Barbados",code:"BB"},{name:"Belarus",code:"BY"},{name:"Belgium",code:"BE"},{name:"Belize",code:"BZ"},{name:"Benin",code:"BJ"},{name:"Bermuda",code:"BM"},{name:"Bhutan",code:"BT"},{name:"Bolivia",code:"BO"},{name:"Bonaire, Sint Eustatius and Saba",code:"BQ"},{name:"Bosnia and Herzegovina",code:"BA"},{name:"Botswana",code:"BW"},{name:"Bouvet Island",code:"BV"},{name:"Brazil",code:"BR"},{name:"British Indian Ocean Territory",code:"IO"},{name:"Brunei Darussalam",code:"BN"},{name:"Bulgaria",code:"BG"},{name:"Burkina Faso",code:"BF"},{name:"Burundi",code:"BI"},{name:"Cambodia",code:"KH"},{name:"Cameroon",code:"CM"},{name:"Canada",code:"CA"},{name:"Cabo Verde",code:"CV"},{name:"Cayman Islands",code:"KY"},{name:"Central African Republic",code:"CF"},{name:"Chad",code:"TD"},{name:"Chile",code:"CL"},{name:"China",code:"CN"},{name:"Christmas Island",code:"CX"},{name:"Cocos (Keeling) Islands",code:"CC"},{name:"Colombia",code:"CO"},{name:"Comoros",code:"KM"},{name:"Congo",code:"CG"},{name:"Congo, The Democratic Republic of the",code:"CD"},{name:"Cook Islands",code:"CK"},{name:"Costa Rica",code:"CR"},{name:'Cote D"Ivoire',code:"CI"},{name:"Croatia",code:"HR"},{name:"Cuba",code:"CU"},{name:"Curaçao",code:"CW"},{name:"Cyprus",code:"CY"},{name:"Czech Republic",code:"CZ"},{name:"Denmark",code:"DK"},{name:"Djibouti",code:"DJ"},{name:"Dominica",code:"DM"},{name:"Dominican Republic",code:"DO"},{name:"Ecuador",code:"EC"},{name:"Egypt",code:"EG"},{name:"El Salvador",code:"SV"},{name:"Equatorial Guinea",code:"GQ"},{name:"Eritrea",code:"ER"},{name:"Estonia",code:"EE"},{name:"Ethiopia",code:"ET"},{name:"Falkland Islands (Malvinas)",code:"FK"},{name:"Faroe Islands",code:"FO"},{name:"Fiji",code:"FJ"},{name:"Finland",code:"FI"},{name:"France",code:"FR"},{name:"French Guiana",code:"GF"},{name:"French Polynesia",code:"PF"},{name:"French Southern Territories",code:"TF"},{name:"Gabon",code:"GA"},{name:"Gambia",code:"GM"},{name:"Georgia",code:"GE"},{name:"Germany",code:"DE"},{name:"Ghana",code:"GH"},{name:"Gibraltar",code:"GI"},{name:"Greece",code:"GR"},{name:"Greenland",code:"GL"},{name:"Grenada",code:"GD"},{name:"Guadeloupe",code:"GP"},{name:"Guam",code:"GU"},{name:"Guatemala",code:"GT"},{name:"Guernsey",code:"GG"},{name:"Guinea",code:"GN"},{name:"Guinea-Bissau",code:"GW"},{name:"Guyana",code:"GY"},{name:"Haiti",code:"HT"},{name:"Heard Island and Mcdonald Islands",code:"HM"},{name:"Holy See (Vatican City State)",code:"VA"},{name:"Honduras",code:"HN"},{name:"Hong Kong",code:"HK"},{name:"Hungary",code:"HU"},{name:"Iceland",code:"IS"},{name:"India",code:"IN"},{name:"Indonesia",code:"ID"},{name:"Iran, Islamic Republic Of",code:"IR"},{name:"Iraq",code:"IQ"},{name:"Ireland",code:"IE"},{name:"Isle of Man",code:"IM"},{name:"Israel",code:"IL"},{name:"Italy",code:"IT"},{name:"Jamaica",code:"JM"},{name:"Japan",code:"JP"},{name:"Jersey",code:"JE"},{name:"Jordan",code:"JO"},{name:"Kazakhstan",code:"KZ"},{name:"Kenya",code:"KE"},{name:"Kiribati",code:"KI"},{name:"Korea, Democratic People's Republic of",code:"KP"},{name:"Korea, Republic of",code:"KR"},{name:"Kuwait",code:"KW"},{name:"Kyrgyzstan",code:"KG"},{name:"Lao People's Democratic Republic",code:"LA"},{name:"Latvia",code:"LV"},{name:"Lebanon",code:"LB"},{name:"Lesotho",code:"LS"},{name:"Liberia",code:"LR"},{name:"Libya",code:"LY"},{name:"Liechtenstein",code:"LI"},{name:"Lithuania",code:"LT"},{name:"Luxembourg",code:"LU"},{name:"Macao",code:"MO"},{name:"Macedonia, The Former Yugoslav Republic of",code:"MK"},{name:"Madagascar",code:"MG"},{name:"Malawi",code:"MW"},{name:"Malaysia",code:"MY"},{name:"Maldives",code:"MV"},{name:"Mali",code:"ML"},{name:"Malta",code:"MT"},{name:"Marshall Islands",code:"MH"},{name:"Martinique",code:"MQ"},{name:"Mauritania",code:"MR"},{name:"Mauritius",code:"MU"},{name:"Mayotte",code:"YT"},{name:"Mexico",code:"MX"},{name:"Micronesia, Federated States of",code:"FM"},{name:"Moldova, Republic of",code:"MD"},{name:"Monaco",code:"MC"},{name:"Mongolia",code:"MN"},{name:"Montenegro",code:"ME"},{name:"Montserrat",code:"MS"},{name:"Morocco",code:"MA"},{name:"Mozambique",code:"MZ"},{name:"Myanmar",code:"MM"},{name:"Namibia",code:"NA"},{name:"Nauru",code:"NR"},{name:"Nepal",code:"NP"},{name:"Netherlands",code:"NL"},{name:"New Caledonia",code:"NC"},{name:"New Zealand",code:"NZ"},{name:"Nicaragua",code:"NI"},{name:"Niger",code:"NE"},{name:"Nigeria",code:"NG"},{name:"Niue",code:"NU"},{name:"Norfolk Island",code:"NF"},{name:"Northern Mariana Islands",code:"MP"},{name:"Norway",code:"NO"},{name:"Oman",code:"OM"},{name:"Pakistan",code:"PK"},{name:"Palau",code:"PW"},{name:"Palestine, State of",code:"PS"},{name:"Panama",code:"PA"},{name:"Papua New Guinea",code:"PG"},{name:"Paraguay",code:"PY"},{name:"Peru",code:"PE"},{name:"Philippines",code:"PH"},{name:"Pitcairn",code:"PN"},{name:"Poland",code:"PL"},{name:"Portugal",code:"PT"},{name:"Puerto Rico",code:"PR"},{name:"Qatar",code:"QA"},{name:"Réunion",code:"RE"},{name:"Romania",code:"RO"},{name:"Russian Federation",code:"RU"},{name:"Rwanda",code:"RW"},{name:"Saint Barthélemy ",code:"BL"},{name:"Saint Helena, Ascension and Tristan da Cunha",code:"SH"},{name:"Saint Kitts and Nevis",code:"KN"},{name:"Saint Lucia",code:"LC"},{name:"Saint Martin (French part)",code:"MF"},{name:"Saint Pierre and Miquelon",code:"PM"},{name:"Saint Vincent and the Grenadines",code:"VC"},{name:"Samoa",code:"WS"},{name:"San Marino",code:"SM"},{name:"Sao Tome and Principe",code:"ST"},{name:"Saudi Arabia",code:"SA"},{name:"Senegal",code:"SN"},{name:"Serbia",code:"RS"},{name:"Seychelles",code:"SC"},{name:"Sierra Leone",code:"SL"},{name:"Singapore",code:"SG"},{name:"Sint Maarten (Dutch part)",code:"SX"},{name:"Slovakia",code:"SK"},{name:"Slovenia",code:"SI"},{name:"Solomon Islands",code:"SB"},{name:"Somalia",code:"SO"},{name:"South Africa",code:"ZA"},{name:"South Georgia and the South Sandwich Islands",code:"GS"},{name:"Spain",code:"ES"},{name:"Sri Lanka",code:"LK"},{name:"Sudan",code:"SD"},{name:"Suriname",code:"SR"},{name:"Svalbard and Jan Mayen",code:"SJ"},{name:"Swaziland",code:"SZ"},{name:"Sweden",code:"SE"},{name:"Switzerland",code:"CH"},{name:"Syrian Arab Republic",code:"SY"},{name:"Taiwan, Province of China",code:"TW"},{name:"Tajikistan",code:"TJ"},{name:"Tanzania, United Republic of",code:"TZ"},{name:"Thailand",code:"TH"},{name:"Timor-Leste",code:"TL"},{name:"Togo",code:"TG"},{name:"Tokelau",code:"TK"},{name:"Tonga",code:"TO"},{name:"Trinidad and Tobago",code:"TT"},{name:"Tunisia",code:"TN"},{name:"Turkey",code:"TR"},{name:"Turkmenistan",code:"TM"},{name:"Turks and Caicos Islands",code:"TC"},{name:"Tuvalu",code:"TV"},{name:"Uganda",code:"UG"},{name:"Ukraine",code:"UA"},{name:"United Arab Emirates",code:"AE"},{name:"United Kingdom",code:"GB"},{name:"United States of America",code:"US"},{name:"United States Minor Outlying Islands",code:"UM"},{name:"Uruguay",code:"UY"},{name:"Uzbekistan",code:"UZ"},{name:"Vanuatu",code:"VU"},{name:"Venezuela",code:"VE"},{name:"Viet Nam",code:"VN"},{name:"Virgin Islands, British",code:"VG"},{name:"Virgin Islands, U.S.",code:"VI"},{name:"Wallis and Futuna",code:"WF"},{name:"Western Sahara",code:"EH"},{name:"Yemen",code:"YE"},{name:"Zambia",code:"ZM"},{name:"Zimbabwe",code:"ZW"}],countriesRequiringVAT:["NL","GB","AT","BE","BG","CY","CZ","DK","EE","ES","FI","FR","DE","GR","HR","IE","IT","LV","LT","LU","MT","PL","PT","RO","SE","SI","SK"],countriesRequiringPostalCode:["AD","AM","AR","AS","AT","AU","AX","AZ","BA","BB","BD","BE","BG","BH","BM","BN","BR","BY","CA","CC","CH","CK","CL","CN","CR","CS","CV","CX","CY","CZ","DE","DK","DO","DZ","EC","EE","EG","ES","ET","FI","FK","FM","FO","FR","GB","GE","GF","GG","GL","GN","GP","GR","GS","GT","GU","GW","HM","HN","HR","HT","HU","ID","IL","IM","IN","IO","IQ","IS","IT","JE","JO","JP","KE","KG","KH","KR","KW","KZ","LA","LB","LI","LK","LR","LS","LT","LU","LV","MA","MC","MD","ME","MG","MH","MK","MN","MP","MQ","MT","MU","MV","MX","MY","NC","NE","NF","NG","NI","NL","NO","NP","NZ","OM","PF","PG","PH","PK","PL","PM","PN","PR","PT","PW","PY","RE","RO","RS","RU","SA","SE","SG","SH","SI","SJ","SK","SM","SN","SO","SZ","TC","TH","TJ","TM","TN","TR","TW","UA","US","UY","UZ","VA","VE","VI","WF","XK","YT","YU","ZA","ZM"],states:[{name:"Alabama",code:"AL"},{name:"Alaska",code:"AK"},{name:"Arizona",code:"AZ"},{name:"Arkansas",code:"AR"},{name:"California",code:"CA"},{name:"Colorado",code:"CO"},{name:"Connecticut",code:"CT"},{name:"Delaware",code:"DE"},{name:"District of Columbia",code:"DC"},{name:"Florida",code:"FL"},{name:"Georgia",code:"GA"},{name:"Hawaii",code:"HI"},{name:"Idaho",code:"ID"},{name:"Illinois",code:"IL"},{name:"Indiana",code:"IN"},{name:"Iowa",code:"IA"},{name:"Kansa",code:"KS"},{name:"Kentucky",code:"KY"},{name:"Lousiana",code:"LA"},{name:"Maine",code:"ME"},{name:"Maryland",code:"MD"},{name:"Massachusetts",code:"MA"},{name:"Michigan",code:"MI"},{name:"Minnesota",code:"MN"},{name:"Mississippi",code:"MS"},{name:"Missouri",code:"MO"},{name:"Montana",code:"MT"},{name:"Nebraska",code:"NE"},{name:"Nevada",code:"NV"},{name:"New Hampshire",code:"NH"},{name:"New Jersey",code:"NJ"},{name:"New Mexico",code:"NM"},{name:"New York",code:"NY"},{name:"North Carolina",code:"NC"},{name:"North Dakota",code:"ND"},{name:"Ohio",code:"OH"},{name:"Oklahoma",code:"OK"},{name:"Oregon",code:"OR"},{name:"Pennsylvania",code:"PA"},{name:"Rhode Island",code:"RI"},{name:"South Carolina",code:"SC"},{name:"South Dakota",code:"SD"},{name:"Tennessee",code:"TN"},{name:"Texas",code:"TX"},{name:"Utah",code:"UT"},{name:"Vermont",code:"VT"},{name:"Virginia",code:"VA"},{name:"Washington",code:"WA"},{name:"West Virginia",code:"WV"},{name:"Wisconsin",code:"WI"},{name:"Wyoming",code:"WY"}]})}(),function(){"use strict";angular.module("DashboardApp").controller("AccountBillingController",["$filter","$location","$sce","$scope","$window","$route","AccountService","BrowserService","UrlService","BotrAccountService","DownloadService","UtilService","CacheService","ConfigService","ModalService","PaymentService","SessionService","Templates","TrackingService",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){function t(){d.BotrAccount.addCallback("AccountBillingController",function(a){"free"!==a.jwplayer_edition&&p.getFuture(q.getAccountToken()).then(function(a){d.futureLoaded=!0,d.invoices=a.invoices,d.hasFuture=d.invoices&&d.invoices.length>0})["catch"](function(){d.futureLoadFailed=!0,d.noFutureFailure="Failed to load future invoices"})}),p.getHistory(q.getAccountToken()).then(function(a){var b=1,c=x,e="periodStart",f=!1,g=a.transactions,h=["amount","periodStart","periodEnd","type"];h.indexOf(e)>-1?l.objectSort(g,f,e):"products"===e?l.objectSort(g,f,function(a){return a.products.join(" ")}):"periodLength"===e&&l.objectSort(g,f,function(a){return a.periodEnd-a.periodStart});var i=a.nextTransaction,j=l.numberPages(g,c);g=l.paginate(g,b,c),d.nextTransaction=i,d.numHistoryPages=j,d.transactions=g,d.historyLoaded=!0,0===d.numHistoryPages&&(d.hasHistory=!1)})["catch"](function(){d.historyLoadFailed=!0,d.noHistoryFailure="Failed to load transaction history"})}function u(){d.futureTable.rows=_.map(d.invoices,function(a){return{periodStart:a.periodStart,link:"#/account/invoice/future/"+a.autoBillID+"/"+a.id,products:d.convertProductNames(a.items),amount:a.amount}})}function v(){d.historyTable.rows=_.map(d.transactions,function(a){return{periodStart:a.periodStart,periodEnd:a.periodEnd,link:"#/account/invoice/past/"+a.id,products:d.convertProductNames(a.items),amount:a.amount}})}function w(){if(d.accountLoaded===!0&&d.historyLoaded===!0&&d.futureLoaded===!0){for(var b=0;b<d.paymentAccount.products.length;b++)d.productNameMap[d.paymentAccount.products[b].name]=d.paymentAccount.products[b].description;u(),v(),d.hasSubscription&&null!==d.nextTransaction?(d.nextTransactionLabel="Next billing date: "+a("longDate")(d.nextTransaction),d.subscriptionEnd=1e3*d.nextTransaction):d.hasSubscription&&(d.subscriptionEnd=1e3*d.transactions[0].periodEnd)}}var x=12;d.$emit("viewLoaded"),d.hasSubscription=!0,d.hasPaymentMethod=!0,d.hasHistory=!0,d.hasFuture=!1,d.emailFormSubmitting=!1,d.subscriptionTable={columns:[{display:"products",key:"description"},{display:"rate",key:"price"},{key:"cycle"},{display:"included",key:"units"},{display:"overage rate",key:"overageRate"}],rows:[]},d.futureTable={columns:[{display:"statement date",key:"periodStart"},{display:"product",key:"products"},{key:"amount"}],rows:[]},d.historyTable={columns:[{display:"statement date",key:"periodStart"},{display:"product",key:"products"},{display:"billing cycle",key:"periodLength"},{key:"amount"}],rows:[]},d.sites=Object.keys(q.getAccount().sites),d.paymentAccount=void 0,d.webSession=void 0,d.accountLoaded=!1,d.accountLoadFailed=!1,d.historyLoaded=!1,d.historyLoadFailed=!1,d.noHistoryMessage=void 0,d.noHistoryFailure=void 0,d.billingDisabled=!1,d.futureLoaded=!1,d.futureLoadFailed=!1,d.noFutureMessage=void 0,d.noFutureFailure=void 0,d.billingLoading=!0,d.numHistoryPages=0,d.transactions=[],d.invoices=[],d.cardUpdateErrorMessage=void 0,d.cardUpdateSuccessMessage={success:void 0},d.emailUpdateErrorMessage=void 0,d.emailUpdateSuccessMessage={success:void 0},d.paymentName=void 0,d.paymentCard=void 0,d.paymentCode=void 0,d.paymentExpireDate=void 0,d.paymentAddress1=void 0,d.paymentAddress2=void 0,d.paymentAddressCity=void 0,d.paymentAddressDistrict=void 0,d.paymentAddressPostalCode=void 0,d.paymentAddressCountry=void 0,d.productNameMap={},d.expirationYear=void 0,d.expirationMonth=void 0,d.recurly=!1,d.vindicia=!1,d.recurlyLoading=!0,d.recurlyLink="",d.showCancel=q.hasFeature("cancel"),d.getGlobal("webSessionFinalized")===!0?d.handleNotification("Your credit card has been changed successfully","success"):d.getGlobal("webSessionFinalized")===!1&&d.handleNotification("There was an error updating your credit card","failed"),d.clearGlobal("webSessionFinalized"),"string"==typeof b.search().session_id?"1"===b.search().code?p.finalizeUpdateWebSession(q.getAccountToken(),b.search().session_id).then(function(a){a?(d.setGlobal("webSessionFinalized",!0),b.url(b.path())):(d.setGlobal("webSessionFinalized",!1),b.url(b.path()))})["catch"](function(){d.setGlobal("webSessionFinalized",!1),b.url(b.path())}):(d.setGlobal("webSessionFinalized",!1),b.url(b.path())):p.getAccount(q.getAccountToken()).then(function(e){d.billingLoading=!1;var f=e.account;if(f.primaryPaymentMethod=_.find(f.paymentMethods,function(a){return a.active}),f.primaryPaymentPayPal=void 0!==f.primaryPaymentMethod&&"paypal"===f.primaryPaymentMethod.type.toLowerCase(),f.primaryPaymentCreditCard=void 0!==f.primaryPaymentMethod&&"creditcard"===f.primaryPaymentMethod.type.toLowerCase(),f.billingDisabled&&(d.billingDisabled=!0),
"Vindicia"===f.paymentProviderNameToken||d.isFree&&"Recurly"!=f.paymentProviderNameToken){d.vindicia=!0,d.recurly=!1;var g=f;if(d.paymentAccount=angular.copy(g),g.products&&g.products.length>0){d.hasSubscription=!0,d.subscriptionTable.rows=d.paymentAccount.products,d.nextBillPrice=0;for(var i in g.products)d.nextBillPrice+=g.products[i].price}else d.hasSubscription=!1,d.subscriptionTable={columns:[{display:"products",key:"description"},{display:"rate",key:"price"},{display:"included",key:"units"},{}],rows:[{name:"JW_FREE",description:"JW Player Free Edition",price:"Free",units:"Free Player Edition"}]};d.paymentAccount.paymentMethods&&d.paymentAccount.paymentMethods.length>0?(d.paymentName=d.paymentAccount.primaryPaymentMethod.ownerName,d.paymentAccount.primaryPaymentMethod&&"CreditCard"===d.paymentAccount.primaryPaymentMethod.type&&(d.expirationMonth=g.primaryPaymentMethod.creditCard.expirationDate.substr(4,6),d.expirationYear=g.primaryPaymentMethod.creditCard.expirationDate.substr(0,4)),d.paymentAddress1=g.primaryPaymentMethod.address.addr1,d.paymentAddress2=g.primaryPaymentMethod.address.addr2,d.paymentAddressCity=g.primaryPaymentMethod.address.city,d.paymentAddressPostalCode=g.primaryPaymentMethod.address.postalCode,d.paymentAddressCountry=g.primaryPaymentMethod.address.country,d.paymentAddressDistrict=g.primaryPaymentMethod.address.district,d.hasPaymentMethod=!0,t()):(d.hasPaymentMethod=!1,d.hasHistory=!1),d.accountLoaded=!0}else if("Recurly"===f.paymentProviderNameToken){j.get().then(function(a){d.hasStorageLimit=a.storage.limit>-1,d.hasStreamingLimit=a.traffic.limit>-1}),d.isNotUnlimited=function(){return d.hasStorageLimit&&d.hasStreamingLimit&&"Unlimited"!=d.entitlement},d.isUnlimited=function(){return"Unlimited"==d.entitlement||!d.hasStorageLimit&&!d.hasStreamingLimit},d.recurly=!0,d.recurlyLink=c.trustAsResourceUrl(d.base.protocol+f.subdomain+".recurly.com/account/"+f.hostedLoginToken),d.hostedLogin=f.hostedLoginToken,f.subscriptions.forEach(function(b){b.costInPrice=(b.cost/100).toFixed(2),d.subscriptionEnd=1e3*b.currentPeriodEnds,b.endsAt=a("date")(1e3*b.currentPeriodEnds,"MMM d, y"),b.start=a("date")(1e3*b.startDate,"MMM d, y")}),f.invoices.forEach(function(b){b.billedDate=a("date")(1e3*b.billedOn,"MMM d, y"),b.billedAmount=(b.total/100).toFixed(2)});var k=b.search();d.page=k.page?parseInt(k.page):1,d.pageLength=k.pageLength?parseInt(k.pageLength):10,d.numPages=Math.ceil(f.invoices.length/d.pageLength);var l=(d.page-1)*d.pageLength;f.displayInvoices=f.invoices.slice(l,l+d.pageLength),d.recurlyTable={columns:[{display:"Number",key:"id"},{display:"Billed On",key:"billedDate"},{display:"Due On",key:"billedDate"},{display:"Status",key:"status"},{display:"Total",key:"billedAmount"},{key:"View PDF"}],rows:f.displayInvoices},d.recurlyDetails=f,h.isSafari()&&(d.recurly=!1,d.recurlySafari=!0)}})["catch"](function(){d.accountLoadFailed=!0,d.accountLoaded=!0}),d.convertProductNames=function(a){for(var b=[],c=0;c<a.length;c++){var e=d.getProductDescription(a[c]);e&&b.push(e)}return 0===b.length&&(b=["(see invoice)"]),b},d.downloadInvoicePDF=function(a){p.getAccountInvoice(q.getAccountToken(),void 0,a).then(function(b){k.startDownload(b.invoice,"invoice"+a+".pdf","application/pdf")})["catch"](function(){d.handleNotification("There was an error fetching your invoice. Please contact us.","failed")})},d.openModal=function(a){o.open({templateUrl:r.path("modals/update-"+a),controller:"UpdateBilling",resolve:{details:function(){return d.recurlyDetails}}}).result.then(function(){},function(a){"success"==a&&e.location.reload()})},d.reactivateSubscription=function(){o.open({templateUrl:r.path("modals/reactivate-recurly"),controller:"ReactivateRecurly",scope:d,resolve:{subscriptionId:function(){return d.recurlyDetails.subscriptions[0].id},recurlyAccountCode:function(){return d.recurlyDetails.id}}}).result.then(function(){},function(a){"success"==a&&e.location.reload()})},d.getProductDescription=function(a){return(d.productNameMap[a.sku]||"").trim()},d.accountLoading=function(){return!d.accountLoaded},d.historyLoading=function(){return!(d.historyLoaded||d.historyLoadFailed)},d.futureLoading=function(){return!(d.futureLoaded||d.futureLoadFailed)},d.$watch("accountLoaded",w),d.$watch("historyLoaded",w),d.$watch("futureLoaded",w),d.accountEmailFormSubmitting=function(){return d.emailFormSubmitting},d.submitEmail=function(a){d.emailFormSubmitting=!0,p.updateAccount(q.getAccountToken(),d.paymentAccount.email).then(function(){d.emailFormSubmitting=!1,a.$setPristine(),d.handleNotification("Your email address has been changed successfully","success")})["catch"](function(){d.emailFormSubmitting=!1,d.handleNotification("There was an error updating your Billing Email.  Please contact us.","success")})},d.openEditModal=function(){o.open({templateUrl:r.path("modals/edit-credit-card"),controller:"EditCreditCardCtrl",size:"",backdrop:"static",resolve:{paymentMethodVid:function(){return d.paymentAccount.primaryPaymentMethod.providerVid}}})},d.cancelSubscription=function(){s.ga("send","event","Account Settings","Click Cancel Subscription"),o.open({templateUrl:r.path("modals/subscription-cancel"),controller:"SubscriptionCancelController",scope:d})},d.confirmCancel=function(){g.cancelSubscription(q.getAccountToken()).then(function(){o.open({templateUrl:r.path("modals/subscription-cancel-feedback"),controller:"SubscriptionCancelFeedbackController",scope:d}).result.then(function(a){f.reload()},function(a){f.reload()})})}}]),angular.module("DashboardApp").controller("EditCreditCardCtrl",["$document","$modalInstance","$scope","ConfigService","paymentMethodVid","PaymentService","SessionService",function(a,b,c,d,e,f,g){var h=(new Date).getFullYear();c.states=d.get("states"),c.countriesRequiringPostalCode=d.get("countriesRequiringPostalCode"),c.countries=d.get("countries"),c.expirationMonthOptions=["01","02","03","04","05","06","07","08","09","10","11","12"],c.expirationYearOptions=[];for(var i=0;51>i;i++)c.expirationYearOptions.push((h+i).toString());c.exp={},c.exp.month=c.expirationMonthOptions[0],c.exp.year=h,c.address={},c.address.country="US",c.address.postalCode=void 0,c.address.postalCodeUnvalidated=void 0,c.message=void 0,c.creditCardUpdateSubmitting=!1,c.creditCardUpdateServerError=!1;var j=/^\d{5}([ -]?\d{4})?$/,k=/^[\w -]*$/;c.pattern={},c.pattern.postalCodePattern=j,c.$watch("address.country",function(){c.pattern.postalCodePattern="US"===c.address.country?j:k}),c.countryRequiresPostalCode=function(a){return c.countriesRequiringPostalCode.indexOf(a)>-1},c.isPostalCodeMissingWhenRequired=function(){return c.countryRequiresPostalCode(c.address.country)&&(!c.address.postalCodeUnvalidated||0===c.address.postalCodeUnvalidated.length)},c.submit=function(){c.creditCardUpdateSubmitting=!0,c.creditCardUpdateServerError=!1,f.getUpdateSession(g.getAccountToken(),e).then(function(b){c.creditCardUpdateSubmitting=!1,c.webSession=b.session,c.expDate=c.exp.year+c.exp.month,c.$apply();var d=a[0].getElementById("creditCardUpdateForm");d.action=b.formTarget,d.submit()})["catch"](function(){c.creditCardUpdateSubmitting=!1,c.creditCardUpdateServerError=!0})}}])}(),function(){"use strict";angular.module("DashboardApp").controller("AccountCreateController",["$location","$scope","$window","CacheService","InviteService","SessionService","UserService",function(a,b,c,d,e,f,g){b.message=void 0,d.remove("user");var h=a.search().inviteToken;"undefined"!=typeof h&&h.indexOf(".")>-1&&(b.inviteToken=a.search().inviteToken.split(".")[0],b.signature=a.search().inviteToken),b.password=void 0,b.confirmPassword=void 0,b.submitting=!1,e.getInvite(b.inviteToken).then(function(a){var d=a.invite;3===d.inviteStateID||4===d.inviteStateID?b.message="This invite is no longer valid. If you still need access, please contact the account owner.":1!==d.inviteStateID&&2!==d.inviteStateID||1!==d.isInvalidated||(b.setGlobal("emailLogin",d.inviteeEmail),c.location.href="#/welcome"),b.$emit("viewLoaded")})["catch"](function(){b.message="Invalid invite.",b.$emit("viewLoaded")}),b.submit=function(){b.submitting=!0,b.message=void 0,g.createUser(b.signature,b.password).then(function(a){f.createSession(a.userEmail,b.password,function(){b.submitting=!1,c.location.href="#/welcome"},function(a){b.message="Unable to login",b.submitting=!1})})["catch"](function(){b.message="Unable to create new user",b.submitting=!1})},b.checkPasswordsMatch=function(a){a.password.$dirty&&a.conf_pass.$dirty&&(b.passwordsMatch=a.password.$modelValue===a.conf_pass.$modelValue,b.passwordsMatch?b.message=void 0:b.message="Your password and password confirmation do not match.",a.password.$setValidity("mismatch",b.passwordsMatch),a.conf_pass.$setValidity("mismatch",b.passwordsMatch))},b.passwordsMatch=!0}])}(),function(){"use strict";angular.module("DashboardApp").controller("AccountEmailController",["$location","$rootScope","$scope","AuthenticationService","SessionService","UserService",function(a,b,c,d,e,f){var g=a.search().requestToken;f.updateUserEmail(g.split(".")[0],g).then(function(f){var g=e.getUser(),h=function(){a.search("requestToken",void 0),c.setGlobal("emailChanged",!0),c.setGlobal("emailLogin",f.userEmail),a.path("/account/profile")};"undefined"!=typeof g?g.userToken!==f.userToken?(d.clearSignature(),b.$on("globalsCleared",function(){h()})):(e.updateUser({userEmail:f.userEmail}),h()):h()})["catch"](function(){a.search("requestToken",void 0),c.setGlobal("emailChanged",!1),a.path("/account/profile")})}])}(),function(){"use strict";angular.module("DashboardApp").controller("AccountForgotController",["$location","$scope","RequestService",function(a,b,c){b.submitting=!1,b.message="Enter your email address below, and a password reset link will be sent to you.",b.email=a.search().email,b.submit=function(){b.submitting=!0,b.message="Submitting...",c.createRequest(b.email).then(function(){b.message="Check your email for a password reset link.",b.submitting=!1})["catch"](function(){b.message="Something went wrong!",b.submitting=!1})},b.$emit("viewLoaded")}])}(),function(){"use strict";angular.module("DashboardApp").controller("AccountInvoiceFutureController",["$document","$routeParams","$scope","PaymentService","SessionService","TitleService",function(a,b,c,d,e,f){c.invoice=void 0,c.invoiceError=!1;var g=e.getAccountToken(),h=b.autoBillId||"",i=b.invoiceId||"";f.setTitle(c,"JW Player - Invoice "+i),d.getAccount(g).then(function(a){c.company=a.account.company})["catch"](function(){c.invoiceError=!0}),d.getAccountInvoice(g,h,i).then(function(a){c.invoice=a.invoice,c.$emit("viewLoaded")})["catch"](function(){c.invoiceError=!0,c.$emit("viewLoaded")})}])}(),function(){"use strict";angular.module("DashboardApp").controller("AccountInvoicePastController",["$document","$routeParams","$scope","PaymentService","SessionService","TitleService",function(a,b,c,d,e,f){c.transaction=void 0,c.transactionError=!1;var g=e.getAccountToken(),h=b.id||"";f.setTitle(c,"JW Player - Invoice "+h),d.getAccount(g).then(function(a){c.company=a.account.company})["catch"](function(){c.transactionError=!0}),d.getAccountTransaction(g,h).then(function(a){c.transaction=a.transaction,c.$emit("viewLoaded")})["catch"](function(a){c.transactionError=!0,c.$emit("viewLoaded")})}])}(),function(){"use strict";angular.module("DashboardApp").controller("SubscriptionCancelController",[function(){}]),angular.module("DashboardApp").controller("SubscriptionCancelFeedbackController",["$scope","AccountService","SessionService",function(a,b,c){a.sendFeedback=function(){a.feedback&&b.sendCancelFeedback(c.getAccountToken(),a.feedback)}}])}(),function(){"use strict";angular.module("DashboardApp").controller("DeletePropertyConfirm",["$modalInstance","$scope","SessionService","SiteService","site",function(a,b,c,d,e){b.site=e,b["delete"]=function(){b.error=!1,b.deleting=!0,d["delete"](c.getAccountToken(),e.siteToken).then(function(){c.getSiteToken()==e.siteToken&&c.setSiteToken(c.getAccount().defaultSite),c.refreshSession(),b.deleting=!1,a.close(e)})["catch"](function(){b.deleting=!1,b.error=!0})},b.close=function(){a.dismiss("closed")}}])}(),function(){"use strict";angular.module("DashboardApp").controller("DeleteAccountConfirm",["$modalInstance","$scope","SessionService","AccountService",function(a,b,c,d){b.userPassword="",b["delete"]=function(){var a=c.getUser().userEmail;b.deleting=!0,d.deleteAccount(c.getAccountToken(),{userEmail:a,userPassword:b.userPassword}).then(function(a){b.deleted=!0,b.deleting=!1})["catch"](function(a){b.errored=!0,b.deleting=!1})},b.close=function(){b.deleted?c.refreshSession():a.dismiss("closed")}}])}(),function(){"use strict";angular.module("DashboardApp").controller("ReactivateRecurly",["$modalInstance","$scope","$timeout","SessionService","RecurlyService","subscriptionId","recurlyAccountCode",function(a,b,c,d,e,f,g){b.failedReactivate=!1,b.invalidCoupon=!1,b.reactivateSubscription=function(){b.failedReactivate=!1,b.invalidCoupon=!1;var c={subscriptionId:f};b.promoCode&&(c.recurlyPromoCode=b.promoCode),e.reactivateSubscription(d.getAccountToken(),g,c).then(function(b){a.dismiss("success")})["catch"](function(a){"InvalidCouponCode"==a.data.code?b.invalidCoupon=!0:b.failedReactivate=!0})},b.close=function(){a.dismiss("closed")}}])}(),function(){"use strict";angular.module("DashboardApp").controller("UpdateBilling",["$modalInstance","$scope","$timeout","SessionService","RecurlyService","ConfigService","details",function(a,b,c,d,e,f,g){b.details=angular.copy(g),b.countries=f.get("countries"),b.countriesRequiringPostalCode=f.get("countriesRequiringPostalCode"),b.countriesRequiringVAT=f.get("countriesRequiringVAT"),b.states=f.get("states"),b.currentCountry=b.countries.find(function(a){return a.code==b.details.country}).name,c(function(){recurly.configure({publicKey:f.get("overridePerEnvironment","recurlyKey"),required:["cvv"],style:{all:{height:"30px",border:"1px solid #000",fontSize:"13px"},number:{placeholder:"number"},month:{placeholder:"mm"},year:{placeholder:"yy"},cvv:{placeholder:"cvv"}}})},1e3),b.setCountry=function(a){b.details.country=a.code,b.currentCountry=a.name};var h=function(){var a=!!(b.details.address1&&b.details.billingFirstName&&b.details.billingLastName&&b.details.city&&b.details.country&&b.details.zip);return"US"!=b.details.country||b.details.state||(a=!1),b.required=!a,!a};b.updateAccount=function(c){if(!h()){b.working=!0;var f=c.target;recurly.token(f,function(c,f,g){c?(b.recurlyError=!0,b.working=!1,b.$apply()):e.updateRecurlyCC(d.getAccountToken(),b.details.id,{token:f.id}).then(function(b){a.dismiss("success")})["catch"](function(a){b.recurlyError=!0,b.working=!1})})}},b.updatePaypal=function(){if(!h()){b.working=!0;var c={description:"Update Paypal information"};recurly.paypal(c,function(c,f){if(c)b.recurlyError=!0,b.working=!1;else{var h={paypalToken:f.id,address1:b.details.address1,billingFirstName:b.details.billingFirstName,billingLastName:b.details.billingLastName,city:b.details.city,country:b.details.country,state:b.details.state,zip:b.details.zip};g.address2&&(h.address2=b.details.address2),e.updateRecurlyPaypal(d.getAccountToken(),b.details.id,h).then(function(b){a.dismiss("success")})["catch"](function(a){b.recurlyError=!0,b.working=!1})}})}},b.updateRecurlyEmail=function(){b.invalidEmail=!1,b.working=!0,e.updateRecurlyEmail(d.getAccountToken(),b.details.id,{newEmail:b.recurlyEmail}).then(function(c){b.working=!1,a.dismiss("success")})["catch"](function(a){b.invalidEmail=!0,b.working=!1})},b.close=function(){a.dismiss("closed")}}])}(),function(){"use strict";angular.module("DashboardApp").controller("AccountPropertiesController",["$location","$modal","$route","$scope","AccountService","BotrAccountService","ConfigService","ModalService","PollingBotrAccountService","Tables","SessionService","SiteService","Templates","TrackingService","UtilService",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){d.table={columns:[{display:"Property Name",sortable:!0,key:"siteName",tooltip:"A Property is a distinct grouping of content & players. There must be at least one Property per account."},{display:"#Videos",key:"total"},{key:"Users"},{key:"Streaming",tooltip:"GB streamed this month."},{key:"Settings"}]},j.setTableSortVariables(d.table,"siteName"),d.$emit("viewLoaded"),n.ga("send","event","Account Settings","Account Properties"),d.properties=k.hasFeature("multiple_sites"),d.nameMissing=!1;var p=a.search();d.orderBy=p.sort||"siteName",d.asc=p.reverse?0:1,d.page=p.page||1,d.pageLength=p.pageLength||10,d.sitesLoading=!0,d.newSiteName="",e.getAccountSites(k.getAccountToken(),{includeBotr:1,includeUsers:1,limit:d.pageLength,offset:(d.page-1)*d.pageLength,ascending:d.asc}).then(function(a){d.sites=a.sites,d.sites.forEach(function(a){var b=o.normalizeFileSize(a.botr.traffic.used,"GB");a.streaming=b.slice(0,-2),d.table.columns.forEach(function(a){"Streaming"==a.key&&(a.tooltip=b.slice(-2)+a.tooltip.slice(2))})}),d.table.properties=d.sites,d.numPages=j.getNumberOfPages(a.total),d.sitesLoading=!1})["catch"](function(a,b){d.$emit("viewError")}),i.addCallback("AccountPropertiesController",function(a){d.can_stream=a.can_stream,d.can_store=a.can_store,d.usage_type=a.usage_type,"unlimited"==d.usage_type&&(d.table.columns=[{display:"Property Name",sortable:!0,key:"siteName",tooltip:"A Property is a distinct grouping of content & players. There must be at least one Property per account."},{display:"#Videos",key:"total"},{key:"Users"},{key:"Settings"}])}),d.fireUpgradeGA=function(){n.ga("send","event","Account Settings","Click Properties Upgrade")},d.nameChange=function(a){d.newSiteName=a},d.openModal=function(a){var c=b.open({templateUrl:m.path("modals/delete-property"),controller:"DeletePropertyConfirm",scope:d,resolve:{site:function(){return a}}});c.result.then(d.deleteSite)},d.creatingSite=!1,d.createSite=function(){d.createErrorMessage=void 0,d.creatingSite=!0,d.sitesLoading=!0,l.create(k.getAccountToken(),d.newSiteName).then(function(){d.creatingSite=!1,k.refreshSession(),c.reload(),d.handleNotification("The site was successfully created","success")})["catch"](function(){d.creatingSite=!1,d.sitesLoading=!1,d.handleNotification("There was an error creating the property","failed")})},d.deleteSite=function(a){d.handleNotification("The property was successfully deleted","success"),d.sites=_.reject(d.sites,function(b){return b==a}),d.table.properties=d.sites}}])}(),function(){"use strict";angular.module("DashboardApp").controller("PropertyDetailController",["$location","$modal","$route","$scope","$q","$timeout","$document","AccountService","BotrAccountService","ConfigService","ModalService","PollingBotrAccountService","SessionService","SiteService","SubSystemService","Templates","TrackingService","UtilService","GeoBlockingService",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){q.ga("send","event","Account Settings","Property Detail Page");var t=a.search();d.unsavedChanges=!1,d.saving=!1;var u=[];u.push(n.show(t.siteToken).then(function(a){d.property=a.site,d.newName=d.property.siteName})),u.push(h.getAccountSites(m.getAccountToken()).then(function(a){d.sites=a.sites})),u.push(s.getRule(t.siteToken).then(function(a){d.geoRuleType=a.geo_rule_type;var b=[],c=j.get("countries");"object"==typeof a.geo_country_list&&a.geo_country_list.forEach&&a.geo_country_list.forEach(function(a){for(var d in c){var e=c[d];if(e.code==a){b.push(e);break}}}),d.geoRegions=b})["catch"](function(){d.geoRuleType="none",d.geoRegions=[]}));var v=e(function(a,b){o.getSubSystems(t.siteToken).then(function(c){var e=c[0];d.credentials={api_key:e.subSystemToken,api_secret:e.subSystemSecret},i.get(!1,{siteToken:t.siteToken}).then(function(b){d.total=b.videos.total,d.usageType=b.usage_type,"unlimited"!=b.usage_type&&(d.streaming=r.normalizeFileSize(b.traffic.used,"GB").slice(0,-2),d.streamingUnit=r.normalizeFileSize(b.traffic.used,"GB").slice(-2)),d.cname=b.dns_masks.content,d.originalRestrictDownloads=d.restrictDownloads=!b.restrictions.downloads.allow,d.originalRestrictEmbeds=d.restrictEmbeds=!b.restrictions.embeds.allow,a()})["catch"](b)})["catch"](function(){b(),d.errorLoadingCredentials=!0})});u.push(v),u.push(h.getAccountUsersAndInvites(m.getAccountToken(),{siteToken:t.siteToken,limit:1e3}).then(function(a){d.usersTotal=a.usersTotal})),e.all(u).then(function(){d.$emit("viewLoaded")},function(){d.$emit("viewError")}),d.updateSite=function(){m.hasFeature("unlimited_hosting_streaming")&&d.restrictDownloads&&!d.originalRestrictDownloads&&alert("Please note if you enable URL signing, recommended videos will no longer appear in the Related overlay. These two features are currently incompatible."),d.originalRestrictDownloads=d.restrictDownloads,d.originalRestrictEmbeds=d.restrictEmbeds,d.saving=!0;var a=n.update(m.getAccountToken(),d.property.siteToken,d.newName),b=i.update({site_token:d.property.siteToken,content_dns_mask:"string"==typeof d.cname&&d.cname.replace(/^([a-z]+\:\/\/)?(.+)/,"$2").replace(/(.+)\/$/,"$1")||"",allow_downloads:!d.restrictDownloads,allow_embeds:!d.restrictEmbeds}),c=[a,b];d.hasGeoBlocking&&c.push(s.updateRule(d.property.siteToken,{geo_rule_type:d.geoRuleType,geo_country_list:_.pluck(d.geoRegions,"code").join(",")})),e.all(c).then(function(){m.refreshSession(),l.resetInterval(),d.unsavedChanges=!1,d.handleNotification("Property successfully updated","success"),d.saving=!1},function(){d.handleNotification("There was an error in updating this property","failed")})},d.fireGA=function(a){q.ga("send","event","Account Settings","Copy API "+a)},d.close=function(){a.url("/account/properties")},d.openModal=function(){var a=b.open({templateUrl:p.path("modals/delete-property"),controller:"DeletePropertyConfirm",scope:d,resolve:{site:function(){return d.property}}});a.result.then(d.close)},d.hasGeoBlocking=m.hasFeature("geoblocking"),d.newChanges=function(){d.unsavedChanges=!0},d.searchRegions=function(){d.regionResults=s.searchRegions(d.newRegion,5,d.geoRegions)},d.selectRegion=function(a){d.newRegion="",d.regionResults=null,d.geoRegions.push(a),d.newChanges(),g[0].getElementById("newRegion").focus()},d.removeRegion=function(a){d.geoRegions.splice(d.geoRegions.indexOf(a),1),d.newChanges()},d.selectFirstRegion=function(){d.regionResults&&d.regionResults.length&&d.selectRegion(d.regionResults[0])},d.$watch("geoRuleType",function(a){"none"===a&&(d.geoRegions=[],d.regionResults=null,d.newRegion="")}),d.$watch("unsavedChanges",function(a){d.blockExit(a)})}])}(),function(){"use strict";angular.module("DashboardApp").controller("AccountResetController",["$location","$scope","RequestService","SessionService",function(a,b,c,d){b.requestToken=void 0,b.signature=void 0,b.message=void 0;var e=a.search().requestToken;"undefined"!=typeof e&&e.indexOf(".")>-1&&(b.requestToken=a.search().requestToken.split(".")[0],b.signature=a.search().requestToken),b.password=void 0,b.confirmPassword=void 0,b.submitting=!1,b.passwordsMatch=!0,b.checkPasswordsMatch=function(a){a.password.$dirty&&a.confirm_password.$dirty&&(b.passwordsMatch=a.password.$modelValue===a.confirm_password.$modelValue,a.password.$setValidity("mismatch",b.passwordsMatch),a.confirm_password.$setValidity("mismatch",b.passwordsMatch),b.message=b.passwordsMatch===!0?void 0:"Passwords do not match!")},c.getRequest(b.requestToken).then(function(){b.$emit("viewLoaded")})["catch"](function(){b.message="Your reset password link has expired. Please visit the Forgot Password page to request a new link.",b.$emit("viewLoaded")}),b.submit=function(){b.submitting=!0,c.useRequest(b.requestToken,b.signature,b.password).then(function(c){d.createSession(c.userEmail,b.password,function(){b.submitting=!1,a.path("/welcome")},function(a){b.message="Unable to login",b.submitting=!1},!0)})["catch"](function(){b.message="Something went wrong!",b.submitting=!1})}}])}(),function(){"use strict";angular.module("DashboardApp").controller("AccountSelectController",["$scope",function(a){a.$emit("viewLoaded")}])}(),function(){"use strict";angular.module("DashboardApp").controller("AccountSettingsController",["$location","$scope","$filter","ConfigService","ModalService","SessionService","Templates","UserService","TrackingService",function(a,b,c,d,e,f,g,h,i){b.profileSectionError=void 0,b.profileSectionSuccess={success:void 0},b.profileSectionWarning=void 0,b.submitting=!1,b.getGlobal("emailChanged")===!0?(b.handleNotification("Email address was changed successfully","success"),b.clearGlobal("emailChanged")):b.getGlobal("emailChanged")===!1&&(b.handleNotification("There was a problem when updating email address","failed"),b.clearGlobal("emailChanged")),b.sites=Object.keys(f.getAccount().sites),b.userRoles=c("lowercase")(f.getAccount().userRoles.join(", ")),b.formSubmitting=function(){return b.submitting},b.openPasswordModal=function(){var a=e.open({templateUrl:g.path("modals/change-password"),controller:"ChangePasswordFormCtrl",backdrop:"static",size:"sm"});a.result.then(function(){b.handleNotification("Your password has been successfully changed","success")},function(){})},b.openDeleteModal=function(){i.ga("send","event","Account Settings","Click Delete Account");var a=e.open({templateUrl:g.path("modals/delete-account"),controller:"DeleteAccountConfirm",scope:b});a.result.then(function(a){})["catch"](function(a){f.refreshSession()})},b.user=function(){return f.getUser()},b.submitForm=function(a){a&&b.saveForm()},b.saveForm=function(){var a={userName:b.formUser.userName||"",userPhoneNumber:b.formUser.userPhoneNumber||"",userCompanyName:b.formUser.userCompanyName||""};b.submitting=!0,h.updateUser(f.getUser().userToken,a).then(function(c){b.handleNotification("Your information has been updated successfully","success"),f.updateUser(a),b.userSettingsForm.$setPristine(),b.submitting=!1})["catch"](function(a){b.handleNotification(a.data.code,"failed"),b.submitting=!1})},b.resetForm=function(){b.formUser=angular.copy(f.getUser()),b.userSettingsForm&&b.userSettingsForm.$setPristine()},b.userFormLoading=function(){return"undefined"==typeof f.getUser()},b.$watch("userSettingsForm.$dirty",function(a,c){b.blockExit(a)}),b.$watch(f.getUser,b.resetForm),b.resetForm(),b.$emit("viewLoaded")}]),angular.module("DashboardApp").controller("ChangePasswordFormCtrl",["$modalInstance","$scope","SessionService","UserService",function(a,b,c,d){var e=c.getUser();b.newPassword=void 0,b.newPasswordConfirm=void 0,b.forgotLink="/#/account/forgot?email="+encodeURIComponent(e.userEmail),b.passwordsMatch=!0,b.passwordUpdatePasswordError=!1,b.passwordUpdateServerError=!1,b.passwordUpdateSubmitting=!1,b.passwordUpdateSuccess=!1,b.submitChangePasswordForm=function(c){b.passwordUpdateSubmitting=!0,b.passwordUpdatePasswordError=!1,b.passwordUpdateServerError=!1,d.updateUserPassword(e.userToken,c.currentPassword.$modelValue,c.newPassword.$modelValue).then(function(){b.passwordUpdateSubmitting=!1,b.passwordUpdateSuccess=!0,a.close()})["catch"](function(a){b.passwordUpdateSubmitting=!1,"PasswordInvalid"===a.data.code?b.passwordUpdatePasswordError=!0:b.passwordUpdateServerError=!0})},b.checkPasswordsMatch=function(a){a.newPassword.$dirty&&a.newPasswordConfirm.$dirty&&(b.passwordsMatch=a.newPassword.$modelValue===a.newPasswordConfirm.$modelValue,a.newPassword.$setValidity("mismatch",b.passwordsMatch),a.newPasswordConfirm.$setValidity("mismatch",b.passwordsMatch))}}]),angular.module("DashboardApp").controller("ChangeEmailFormCtrl",["$modalInstance","$scope","SessionService","UserService",function(a,b,c,d){var e=c.getUser();b.newEmail=void 0,b.newEmailConfirm=void 0,b.emailsMatch=!0,b.emailUpdatePasswordError=!1,b.emailUpdateServerError=!1,b.emailUpdateSubmitting=!1,b.emailUpdateSuccess=!1,b.submitChangeEmailForm=function(c){b.emailUpdateSubmitting=!0,b.emailUpdatePasswordError=!1,b.emailUpdateServerError=!1,c.newEmail.$modelValue===e.userEmail?(b.emailUpdateSubmitting=!1,b.emailUpdateUnchanged=!0,b.close()):d.requestEmailChange(e.userToken,c.currentPassword.$modelValue,c.newEmail.$modelValue).then(function(){b.emailUpdateSubmitting=!1,b.emailUpdateSuccess=!0,a.close(c.newEmail.$modelValue)})["catch"](function(a){b.emailUpdateSubmitting=!1,"PasswordInvalid"===a.data.code?b.emailUpdatePasswordError=!0:b.emailUpdateServerError=!0})},b.checkEmailsMatch=function(a){a.newEmail.$dirty&&a.newEmailConfirm.$dirty&&(b.emailsMatch=a.newEmail.$modelValue===a.newEmailConfirm.$modelValue,a.newEmail.$setValidity("mismatch",b.emailsMatch),a.newEmailConfirm.$setValidity("mismatch",b.emailsMatch))}}])}(),function(){"use strict";angular.module("DashboardApp").controller("AccountSignupController",["$scope","InviteService",function(a,b){a.submittingForm=!1,a.error=!1,a.success=!1,a.email=void 0,a.submitForm=function(c){c.$valid&&(a.submittingForm=!0,a.error=!1,a.success=!1,b.createFreeInvite(a.email).then(function(){a.success=!0,a.submittingForm=!1}).cach(function(){a.error=!0,a.submittingForm=!1}))},a.$emit("viewLoaded")}])}(),function(){"use strict";angular.module("DashboardApp").controller("AccountUsageController",["$document","$filter","$location","$q","$route","$scope","$window","AccountService","AccountUsageService","AnalyticsService","BotrAccountService","ConfigService","DownloadService","SessionService","UrlService","UtilService",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){function q(a,b,c,d){f.playsUnit=a,f.adsUnit=b,f.storageUnit=c,f.streamingUnit=d,f.table={columns:[{key:"date",display:"Summary Date"},{key:"storage",display:"Max Stored ("+c+")"},{key:"streaming",display:"Total Delivered ("+d+")"},{key:"plays",display:a?"Total Plays ("+a+")":"Total Plays"},{key:"downloadCsv",display:"Download CSV"}],loading:!0,rows:[],minimumRows:1},"ADS"===f.accountType&&f.table.columns.splice(4,0,{key:"totalAdImpressions",display:b?"Total Ad Impressions ("+b+")":"Total Ad Impressions"})}f.$emit("viewLoaded");var r={January:1,February:2,March:3,April:4,May:5,June:6,July:7,August:8,September:9,October:10,November:11,December:12};f.upgradesEmailUrl=l.get("upgradesEmailUrl");var s=d.defer(),t=d.defer(),u=d.defer(),v=d.all({table:s.promise,usage:t.promise,account:u.promise});f.unlimited=!1;var w=this,x=!1,y=c.search();f.playsLimit=n.getAccount().playsLimit,f.adsLimit=n.getAccount().adsLimit,q(null,null,"GB","GB"),f.selectedSite=y.site?y.site:null,f.monthToDateLoading=!0,v.then(function(a){var b=Object.keys(a.table),c=0,d=0,e=0,g=0,h="GB";b.forEach(function(b){a.table[b].plays>d&&(d=a.table[b].plays),a.table[b].ad_impressions>c&&(c=a.table[b].ad_impressions)}),a.usage.forEach(function(a){a.storage>e&&(e=a.storage),a.streaming>g&&(g=a.streaming)});var i=T(d).label,j=T(c).label,k=S(e,h).slice(-2),l=S(g,h).slice(-2);q(i,j,k,l),a.usage.forEach(function(b){if(a.table[b.date])angular.extend(b,a.table[b.date]);else{var c=new Date(b.date),d=c.getFullYear(),e=c.getMonth();angular.extend(b,{plays:0,ad_impressions:0,year:d,month:e+1})}}),"unlimited"!=a.account.usageType&&(a.usage[0].streaming=a.account.traffic.used,a.usage[0].storage=a.account.storage.used),a.usage.forEach(function(a,b){A(a,b,i,j,k,l)}),f.table.loading=!1,f.monthToDateLoading=!1});var z=function(a){var b={};return f.selectedSite&&"ALL"!=f.selectedSite.token?f.sites.forEach(function(c){f.selectedSite.token==c.token&&(c["promise"+a]=d.defer(),b[c.token]=c["promise"+a].promise,f.selectedSite=c)}):f.sites.forEach(function(c){"ALL"!=c.token&&(c["promise"+a]=d.defer(),b[c.token]=c["promise"+a].promise)}),d.all(b)},A=function(a,c,e,g,h,j){var k=f.sites,l=f.selectedSite;0===c&&(["storage","streaming"].forEach(function(b){var c=S(a[b],"KB");f[b+"Used"]="0.00 KB"==c?"0":c.slice(0,-2),f[b+"Unit"]=c.slice(-2)}),[{scope:"plays",response:"plays"},{scope:"ad",response:"ad_impressions"}].forEach(function(b){var c=T(a[b.response]);f[b.scope+"Count"]=c.number,f[b.scope+"Unit"]=c.label}));var n={date:0===c?"Month-to-Date":a.date,storage:S(a.storage,h).slice(0,-2),streaming:S(a.streaming,j).slice(0,-2),plays:T(a.plays,e).number,ad_impressions:"ADS"===f.accountType||x?T(a.ad_impressions,g).number:void 0,download:function(c){var e=d.defer(),g=r[a.date.slice(0,-5)],h=a.date.slice(-4,a.date.length),j=new Date(h,g-1,1),n=new Date(h,g,0),o=b("date")(j,"yyyy-MM-dd"),p=b("date")(n,"yyyy-MM-dd");
f.downloadPromise=z("csv"),f.downloadPromise.then(function(a){f.analyticsUsage={};var b="ALL"==l.token?k:[l];b.forEach(function(b){if("ALL"!=b.token){var c=a[b.token];c.forEach(function(a){f.analyticsUsage[a.date]?(f.analyticsUsage[a.date].plays+=a.plays,f.analyticsUsage[a.date].ad_impressions+=a.ad_impressions):f.analyticsUsage[a.date]=a})}}),e.resolve(f.analyticsUsage)}),e.promise.then(function(b){var c=i.serializeMonthUsage(a.date,w.usageHistory,b,x||"ADS"==f.accountType);if("ALL"==l.token)m.startDownload(c,"JWP_usage_"+o+"_"+p+"_all_properties.csv","text/csv");else{var d=l.name.replace(/ /g,"_");m.startDownload(c,"JWP_usage_"+o+"_"+p+"_"+d+".csv","text/csv")}}),V(o,p,"daily","csv")}};f.table.rows.push(n)},B=new Date,C=B.getFullYear(),D=B.getMonth(),E=new Date(C,D,1),F=new Date(C,D+1,0),G=b("date")(E,"yyyy-MM-dd"),H=b("date")(F,"yyyy-MM-dd"),I=b("date")(F,"yyyy-MM"),J=1e12,K=1e9,L=1e6,M=1e3,N="TB",O="GB",P="MB",Q="KB",R="bytes";h.getAccountSites(n.getAccountToken(),{includeBotr:1}).then(function(a){f.sites=[{name:"All Properties",token:"ALL"}],"ALL"!=f.selectedSite&&f.selectedSite||(f.selectedSite=f.sites[0]),a.sites.forEach(function(a){f.sites.push({name:a.siteName,token:a.siteToken,botr:a.botr}),f.selectedSite==a.siteToken&&(f.selectedSite={name:a.siteName,token:a.siteToken,botr:a.botr})}),f.sitesPromises=z("table"),U(G,H),f.sitesPromises.then(function(a){f.extendUsageMetrics={};var c="ALL"==f.selectedSite.token?f.sites:[f.selectedSite];c.forEach(function(c){if("ALL"!=c.token){var d=a[c.token],e=0;d.forEach(function(a){var c=new Date(a.year,a.month-1,1);a.label=b("date")(c,"MMMM yyyy"),f.extendUsageMetrics[a.label]?(f.extendUsageMetrics[a.label].plays+=a.plays,f.extendUsageMetrics[a.label].ad_impressions+=a.ad_impressions,e+=a.ad_impressions):(f.extendUsageMetrics[a.label]=a,e+=a.ad_impressions)}),e>0&&(x=!0)}}),s.resolve(f.extendUsageMetrics)}),f.botrAccountPromises=z("botrAccount"),f.botrAccountPromises.then(function(a){var c,d="ALL"==f.selectedSite.token?f.sites:[f.selectedSite],e={},g=[];d.forEach(function(b){"ALL"!=b.token&&(0===g.length?(e=a[b.token],g.push(b)):(c=a[b.token],e.storage.used+=c.storage.used,e.traffic.used+=c.traffic.used,e.registered=c.registered<e.registered?c.registered:e.registered,g.push(b)))}),W(e),u.resolve(e),V(b("date")(f.registered,"yyyy-MM"),I,"monthly","table")}),X(),f.sites.length>2?f.usageHeading="Showing usage for":f.usageHeading=""})["catch"](function(){f.$emit("viewError")}),f.changeSite=function(a){f.selectedSite=a,o.addUrlParam("site",f.selectedSite.token)},j.getUserAlert().then(function(a){f.alert=a});var S=function(a,b){if("number"!=typeof a||0>a)return"-";var c;return a/J>1||N===b?(c=a/J,c.toFixed(2)+" "+N):a/K>1||O===b?(c=a/K,c.toFixed(2)+" "+O):a/L>1||P===b?(c=a/L,c.toFixed(2)+" "+P):a/M>1||Q===b?(c=a/M,c.toFixed(2)+" "+Q):a+" "+R},T=function(a,b){b||(b="");var c=[{unit:1e6,label:"M"},{unit:1e3,label:"K"},{unit:1,label:""}],d=2;for(var e in c){var f=c[e];if(a>=f.unit||f.label==b||1===f.unit)return{number:Math.floor(a*Math.pow(10,d)/f.unit)/Math.pow(10,d),label:f.label}}},U=function(a,b){var c="ALL"==f.selectedSite.token?f.sites:[f.selectedSite],d=0,e=0;c.forEach(function(c){"ALL"!=c.token&&j.getUsageMetrics({startDate:a,endDate:b,accountToken:n.getAccount().sites[c.token].slug},{},function(a){return a.metrics.length?(a=a.metrics[0],d+=a.plays,void(e+=a.ad_impressions)):(d+=0,void(e+=0))},function(a){f.$emit("viewError")})}),f.$watch(function(){return d},function(a){var b=T(a);f.playsCount=b.number,f.playsUnit=b.label,f.playsPercent=(100*Math.min(1,f.playsCount/f.playsLimit)).toFixed(2)+"%"}),d=0,f.$watch(function(){return e},function(a){var b=T(a);f.adCount=b.number,f.adUnit=b.label,f.adsLimit>0?f.adsPercent=(100*Math.min(1,f.adCount/f.adsLimit)).toFixed(2)+"%":f.adsPercent="0%"}),e=0},V=function(a,b,c,d){var e="ALL"==f.selectedSite.token?f.sites:[f.selectedSite];e.forEach(function(e){"ALL"!=e.token&&j.getUsageMetrics({startDate:a,endDate:b,accountToken:n.getAccount().sites[e.token].slug},{sum:c},function(a){a.metrics||e["promise"+d].resolve([]);var b=a.metrics;e["promise"+d].resolve(b)},function(a){f.$emit("viewError")})})},W=function(a){f.accountType=f.entitlement.toUpperCase(),f.registered=new Date(1e3*a.registered),f.hasStorageLimit=a.storage.limit>-1&&!n.hasFeature("unlimited_hosting_streaming"),f.storageLimit=S(a.storage.limit);var b=(S(a.storage.used,"MB"),Math.min(1,a.storage.used/a.storage.limit));f.storagePercent=(100*b).toFixed(2)+"%",f.hasStreamingLimit=a.traffic.limit>-1,f.streamingLimit=S(a.traffic.limit);var c=(S(a.traffic.used,"MB"),Math.min(1,a.traffic.used/a.traffic.limit));f.streamingPercent=(100*c).toFixed(2)+"%",f.hasStreamingLimit||f.hasStorageLimit||(f.unlimited=!0,f.storagePercent="100%",f.streamingPercent="100%"),f.storageLimitReached=f.hasStorageLimit&&a.storage.used>=a.storage.limit,f.streamingLimitReached=f.hasStreamingLimit&&a.traffic.used>=a.traffic.limit},X=function(){f.botrPromises=z("usage"),f.botrPromises.then(function(a){var b="ALL"==f.selectedSite.token?f.sites:[f.selectedSite],c=[];b.forEach(function(b){if("ALL"!=b.token)for(var d=a[b.token],e=0;e<d.length;e++)c.length>e?(c[e].storage.used+=d[e].storage.used,c[e].traffic+=d[e].traffic,c[e].content+=d[e].content):c.push(d[e])}),w.usageHistory=c;var d=i.aggregateUsage(w.usageHistory);t.resolve(d)}),Y("usage")},Y=function(a){var b="ALL"==f.selectedSite.token?f.sites:[f.selectedSite];b.forEach(function(b){if("ALL"!=b.token){b.promisebotrAccount.resolve(b.botr);try{k.getUsage({siteToken:b.token,accountKey:b.botr.key}).then(function(c){b["promise"+a].resolve(c.account.days)})["catch"](function(){b["promise"+a].reject()})}catch(c){f.$emit("viewError")}}})}}])}(),function(){"use strict";angular.module("DashboardApp").factory("RoleFactory",[function(){return{getSelectedSites:function(a){return _.filter(a,function(a){return a.checked}).map(function(a){return a.token}).join(",")},getSelectedSiteRoles:function(a){return _.filter(a,function(a){return a.checked}).map(function(a){return a.name}).join(",")}}}]),angular.module("DashboardApp").controller("EditSitePermissions",["$document","$modalInstance","$scope","InviteService","AccountService","RoleFactory","SessionService","type","user",function(a,b,c,d,e,f,g,h,i){c.type=h;var j=i.email;c.email=j,c.invalidSites=!1,c.checkInvalid=function(a){return c.invalidSites=!_.any(a,function(a){return a.checked})},c.$watch("permissionSites",function(b,d){var e=_.pluck(b,"checked");c.allChecked=b&&b.length&&_.every(e),a[0].getElementById("site-permissions-check-all").indeterminate=_.some(e)&&!c.allChecked},!0),c.checkAll=function(){_.each(c.permissionSites,function(a){a.checked=c.allChecked}),c.checkInvalid(c.permissionSites)},c.save=function(){c.checkInvalid(c.permissionSites)||("create"==h||"resend"==h?"resend"==h||c.verifyEmail(c.email)?d.createAccountInvite({inviteeEmail:j,inviterEmail:g.getUser().userEmail,accountRole:"Manager",accountToken:g.getAccountToken(),siteTokens:f.getSelectedSites(c.permissionSites),siteRoles:f.getSelectedSiteRoles(c.siteRoles),sendEmail:"create"==h}).then(function(a){b.close(a)})["catch"](b.dismiss):c.close():"update"==h&&e.swapAccountRoles(g.getAccountToken(),i.token,"MANAGER",f.getSelectedSites(c.permissionSites),f.getSelectedSiteRoles(c.siteRoles)).then(function(a){b.close(a)})["catch"](b.dismiss))},c.close=function(){b.dismiss("closed")}}]),angular.module("DashboardApp").controller("AccountUsersController",["$location","$modal","$q","$route","$scope","$timeout","$window","AccountService","CacheService","Tables","ConfigService","InviteService","RoleFactory","SessionService","Templates","UrlService",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){e.roleValues={MANAGER:"Manager",ADMIN:"Admin"},e.newInvite={inviteRole:"Select permissions",email:""};var q={},r=a.search();e.page=r.page?parseInt(r.page):1,e.currentEmail=n.getUser().userEmail,e.selectedSite=r.property?r.property:null,i.has("create")&&e.handleNotification("User invite sent successfully","success"),i.remove("create"),e.siteRoles=[{name:"Analytics",checked:!0},{name:"Players",checked:!0},{name:"Content",checked:!0}],e.table={columns:[{key:"email",display:"Email Address",sortable:!0},{key:"role",display:"Permissions",sortable:!0},{key:"type",display:"Status",sortable:!0},{key:""},{key:""}],users:[]},j.setScopePageVariables(e),j.setTableSortVariables(e.table,"email"),e.userList=void 0,e.inviteList=void 0,e.error_message="",e.success_message={success:""},e.siteNames=[],e.siteRoles=[{name:"Analytics",checked:!0},{name:"Players",checked:!0},{name:"Content",checked:!0}],e.sitesLoading=!0,e.usersLoading=!0,e.$emit("viewLoaded"),i.has("update")?(e.handleNotification("User role successfully changed","success"),i.remove("update")):i.has("delete")&&(e.handleNotification("User "+i.get("delete")+" successfully deleted","success"),i.remove("delete"));var s=function(){r=a.search();var b={sortBy:r.sort,asc:r.reverse?1:0,currentEmail:e.currentEmail,offset:(e.page-1)*j.getPageLength(),limit:j.getPageLength()};e.selectedSite&&"ALL"!=e.selectedSite.token&&"ALL"!=e.selectedSite&&(e.selectedSite.token?b.siteToken=e.selectedSite.token:b.siteToken=e.selectedSite),h.getAccountUsersAndInvites(n.getAccountToken(),b).then(function(a){e.table.users=a.users,e.numPages=j.getNumberOfPages(a.usersTotal),C(),e.usersLoading=!1})["catch"](function(){e.$emit("viewError")})};s(),h.getAccountSites(n.getAccountToken()).then(function(a){if(e.sitesLoading=!1,e.sites=a.sites.map(function(a){return{name:a.siteName,token:a.siteToken,checked:!0}}),e.newSites=angular.copy(e.sites),e.sites=[{name:"All Properties",token:"ALL"}].concat(e.sites),e.selectedSite?e.sites.forEach(function(a){e.selectedSite==a.token&&(e.selectedSite=a)}):e.selectedSite=e.sites[0],e.sites.length>2){e.userHeading="Showing users for";var b=[{key:"email",display:"Email Address",sortable:!0},{key:"role",display:"Permissions",sortable:!0},{key:"Edit"},{key:"type",display:"Status",sortable:!0},{key:""}];e.table.columns.forEach(function(a){b.forEach(function(b){a.key===b.key&&angular.extend(b,a)})}),e.table.columns=b}else e.userHeading=""})["catch"](function(){e.$emit("viewError")}),e.changeSite=function(a){e.selectedSite=a,e.usersLoading=!0,e.page=1,p.addUrlParam("property",e.selectedSite.token),p.removeUrlParam("sort"),p.removeUrlParam("page"),p.removeUrlParam("reverse"),d.reload()},e.setNewInvite=function(a){e.newInvite.inviteRole=a};var t=function(a){u(a);var c=b.open({templateUrl:o.path("modals/site-permissions"),controller:"EditSitePermissions",scope:e,resolve:{type:function(){return"user"==a.type?"update":"resend"},user:function(){return a}}});c.result.then(function(b){"user"==a.type?A(b,a):y(b,a)},function(b){"user"==a.type?B(b,a):z(b,a)})};e.openModal=function(a){var c=b.open({templateUrl:o.path("modals/site-permissions"),controller:"EditSitePermissions",scope:e,resolve:{type:function(){return"create"},user:function(){return a}}});c.result.then(w,x)};var u=function(a){var b=q[a.email],c=[],d=[];b.siteRoles&&(c=b.siteRoles.map(function(a){return a.toUpperCase()})),b.siteTokens&&(d=b.siteTokens.map(function(a){return a.toUpperCase()})),e.permissionSites.forEach(function(b){b.checked=_.contains(d,b.token.toUpperCase())||a.downgrade})},v=function(a,b){i.put(b,a),d.reload()},w=function(a){a=a.invite,e.newInvite.email="",e.newInvite.inviteRole="Select permissions",v("create",!0)},x=function(a,b){"DuplicateEmailError"===b?e.handleNotification("Cannot add user - this email address is already in use.","failed"):"closed"!=a&&"backdrop click"!=a&&"escape key press"!=a?e.handleNotification("Unable to send invitation","failed"):e.newInvite.inviteRole="Select permissions"},y=function(a){var b=a.invite.inviteeEmail;v("update",b)},z=function(a,b){"closed"!=a&&"backdrop click"!=a&&"escape key press"!=a&&e.handleNotification("Unable to resend invitation","failed"),b.working=!1},A=function(a){var b=a.email;a.working=!1,q[b]=_.extend({isUser:!0},a.roles),e.allManagers=!_.any(Object.keys(q),function(a){return"ADMIN"==q[a].accountRole}),e.handleNotification("Role changed for "+a.userEmail,"success"),v("update",a.userEmail)},B=function(a,b){"closed"!=a&&"backdrop click"!=a&&"escape key press"!=a&&e.handleNotification("Unable to update user","failed"),b.working=!1};e.verifyEmail=function(a){if(_.find(e.inviteList,function(b){return b.inviteeEmail==a}))return e.handleNotification("Pending invite exists for "+a+'. Click "Resend invite" if you wish to send another invite.',"failed"),!1;if(_.find(e.userList,function(b){return b.userEmail==a}))return e.handleNotification("User already exists with email "+a,"failed"),!1;var b=/[a-zA-Z0-9!#$%&'*+/=?^_`{|}~.-]+@[A-Za-z0-9-]+(\.[A-Za-z0-9-]+)*/;return b.test(a)?!0:(e.handleNotification("Invalid email","failed"),!1)},e.navigateProfile=function(){g.location.href="#/account/profile"},e.createInvite=function(){if(e.verifyEmail(e.newInvite.email)){var a=c.defer(),b=m.getSelectedSites(e.permissionSites),d=m.getSelectedSiteRoles(e.siteRoles);return l.createAccountInvite({inviteeEmail:e.newInvite.email,inviterEmail:n.getUser().userEmail,accountRole:e.newInvite.inviteRole,accountToken:n.getAccountToken(),siteTokens:b,siteRoles:d}).then(function(b){w(b),a.resolve()})["catch"](function(b){x(b.status,b.data.code),a.reject()}),a.promise}},e.$watch("newInvite.inviteRole",function(a){"Manager"==a&&(e.permissionSites=angular.copy(e.newSites),e.permissionSites.forEach(function(a){a.checked=!0}),e.sites.length>2&&e.openModal({email:e.newInvite.email}))});var C=function(){e.table.users.forEach(function(a){q[a.email]=a.roles,"OWNER"==a.roles.accountRole&&(a.roles.accountRole="ADMIN"),e.currentEmail==a.email&&(a.current=!0)})};e.deleteUser=function(a){g.confirm("Are you sure you want to delete this "+a.type+"?")&&("invite"==a.type?l.deleteInvite(a.token).then(function(){e.errored=!1,v("delete",a.email)})["catch"](function(){e.handleNotification("Unable to delete user "+a.email,"failed")}):"user"==a.type&&h.deleteAccountUser(n.getAccountToken(),a.token).then(function(){e.errored=!1,v("delete",a.email)})["catch"](function(){e.handleNotification("Unable to delete user "+a.email,"failed")}))},e.resendInvite=function(a){l.createAccountInvite({inviteeEmail:a.email,inviterEmail:n.getUser().userEmail,accountRole:a.roles.accountRole,accountToken:n.getAccountToken(),siteTokens:a.roles.siteTokens.join(","),siteRoles:a.roles.siteRoles.join(","),sendEmail:!0}).then(function(){e.handleNotification("User invite resent","success")})["catch"](function(){z()})},e.updateInvite=function(a){var b={inviteeEmail:a.email,inviterEmail:n.getUser().userEmail,accountRole:a.roles.accountRole,accountToken:n.getAccountToken(),siteRoles:a.roles.siteRoles.join(","),sendEmail:!1};"ADMIN"!=a.roles.accountRole&&(b.siteTokens=a.roles.siteTokens.join(",")),l.createAccountInvite(b).then(function(){v("update",a.email),a.working=!1})["catch"](function(b){z(b,a)})},e.updateUser=function(a){h.swapAccountRoles(n.getAccountToken(),a.token,a.roles.accountRole,m.getSelectedSites(e.newSites),m.getSelectedSiteRoles(e.siteRoles)).then(A)["catch"](function(b){B(b,a)})},e.changePermissions=function(a,b,c){a.roles.accountRole=c,a.working=!0,"MANAGER"==a.roles.accountRole&&e.sites.length>2?(e.permissionSites=angular.copy(e.newSites),a.downgrade=b,t(a)):"invite"==a.type?e.updateInvite(a):e.updateUser(a)}}])}(),function(){"use strict";angular.module("DashboardApp").controller("AdminController",["$location","$rootScope","$route","$routeParams","$cookies","AuthenticationService","SessionService",function(a,b,c,d,e,f,g){g.initialized()&&f.isAuthorized()?(f.clearSignature(),location.reload()):f.applyRedirectAuth()&&f.isAuthorized()&&g.createSession(void 0,void 0,function(){d[f.getAuthRedirect()]&&(e.isAdmin=g.getUser().userEmail,a.path("/"))},function(){})}])}(),function(){"use strict";angular.module("DashboardApp").controller("AnalyticsContentDetailController",["$document","$filter","$location","$q","$rootScope","$routeParams","$sce","$scope","$timeout","AnalyticsService","ConfigService","ChartService","ChartLoaderService","CountryService","SigningService","TimeService","TrackingService","VirtualPlayerService","VirtualVideoService",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){function t(a){m.finished(),w.reject(a)}function u(a,b){var c,d=a/b;c=a==b?chart.clientWidth:d*chart.clientWidth,G&&(G.style.width=c+"px"),F&&(c=Math.round(c-F.clientWidth/2),F.style.left=c+"px"),h.$apply(function(){h.timeWatched=new Date(new Date(0,0,0).setSeconds(a));for(var b=0;b<D.length-1&&!(D[b].independentVariable<=d&&D[b+1].independentVariable>d);b++);h.remainingViewers=Math.round(100*D[b].dependentVariable/(D[0].dependentVariable||1))})}if(f.dateRange){h.sendTooltipGaEvent=function(a){q.ga("send","event","Analytics Section","Chart Hover",a)},h.reportType="contentDetail",m.init(h),h.dataError={},h.noData={};var v=c.search();h.media=v.mediaID;var w=d.defer(),x=d.defer(),y=d3.time.format("%Y-%m-%d").parse,z=a[0].getElementById("engagementPlayer"),A=!1;h.timeWatched=new Date(0,0,0).setSeconds(0),h.remainingViewers=100;var B=0;h.isPlaying=!1,h.togglePlay=function(){if(z){var a=z.currentTime>0&&!z.paused&&!z.ended&&z.readyState>2;z[a?"pause":"play"]()}},m.started(),s.show(v.mediaID,function(a){h.video=a,a.sourceurl?h.viLink=a.sourceurl:h.viLink=s.createContentURL(h.video,h.base.protocol),o.bulkSignContentUrls([h.viLink]).then(function(a){m.finished(),A||(z.src=a[0],z.load(),z.play(),z.addEventListener("timeupdate",function(){B=z.duration,u(z.currentTime,z.duration),h.$apply(function(){h.isPlaying=!0})}),z.addEventListener("ended",function(){F&&u(B,B),h.$apply(function(){h.isPlaying=!1})}),z.addEventListener("pause",function(){h.$apply(function(){h.isPlaying=!1})}),z.addEventListener("mouseover",function(){h.showControl=!0}),z.addEventListener("mouseout",function(){h.showControl=!1}))}),h.vidDuration=p.parseTimeToString(parseFloat(h.video.duration))},function(){m.finished()});var C=function(a){m.finished();var c=["completes","embeds","plays","timewatched","uniques"],d={},f={},g={};if(c.forEach(function(a){d[a]=0,f[a]=0}),a.metrics.length){var i={};a.metrics.forEach(function(a){i[a.date]=a}),i=l.padDateData(i,{embeds:0,plays:0,completes:0,uniques:0,timewatched:0},!0),a.metrics=[],Object.keys(i).forEach(function(b){a.metrics.push(i[b])})}for(var j=1;j<e.dateRangeDays&&j<a.metrics.length;j++)c.forEach(function(b){f[b]+=a.metrics[j][b]});for(var k=[],n=[],j=e.dateRangeDays;j<a.metrics.length;j++){var o={};angular.extend(o,a.metrics[j]),c.forEach(function(a){d[a]+=o[a]}),n.push({xdata:y(o.date),ydata:o.plays,date:o.date,tipData:o.plays}),k.push(o)}var q=k.length?d.uniques/k.length:0;q=b("number")(Math.round(q));var r={};c.forEach(function(a){g[a]=d[a]>=f[a],"timewatched"!=a&&(r[a]=b("number")(d[a]))}),r.timewatched=p.parseTimeToString(d.timewatched);var s=l.groupDataIntoSeries("date",k,["embeds","plays","completes","timewatched","uniques"]),t=[{dependentVariable:"timewatched",label:"Total Time Watched",dependentVariableValue:r.timewatched,trending:g.timewatched,previous:p.parseTimeToString(f.timewatched),show:!0,percentChange:(100*(d.timewatched>f.timewatched?f.timewatched/d.timewatched:d.timewatched/f.timewatched||0)).toFixed(1)||0},{dependentVariable:"embeds",label:"Total Embeds",dependentVariableValue:r.embeds,trending:g.embeds,previous:b("number")(f.embeds),percentChange:(100*(d.embeds>f.embeds?f.embeds/d.embeds:d.embeds/f.embeds||0)).toFixed(1)||0},{dependentVariable:"plays",label:"Total Plays",dependentVariableValue:r.plays,trending:g.plays,previous:b("number")(f.plays),percentChange:(100*(d.plays>f.plays?f.plays/d.plays:d.plays/f.plays||0)).toFixed(1)||0},{dependentVariable:"uniques",label:"Avg Daily Uniques",dependentVariableValue:q,trending:g.uniques,previous:b("number")(Math.round(k.length?f.uniques/k.length:0)),percentChange:(100*(d.uniques>f.uniques?f.uniques/d.uniques:d.uniques/f.uniques||0)).toFixed(1)||0},{dependentVariable:"completes",label:"Total Completes",dependentVariableValue:r.completes,trending:g.completes,previous:b("number")(f.completes),percentChange:(100*(d.completes>f.completes?f.completes/d.completes:d.completes/f.completes||0)).toFixed(1)||0}];s.forEach(function(a){a.fullData=s,t.some(function(b){return b.dependentVariable==a.dependentVariable?(a.legend=b,!0):void 0})});var u=!!a.last_updation_timestamp;m.callback(x.resolve,{dateRange:e.dateRangeDays,data:[s],legends:t,totals:{"Total Plays":r.plays,"Total Embeds":r.embeds,"Avg Daily Uniques":q,"Total Completes":r.completes,"Total Time Watched":r.timewatched},toggleLabel:"",recency:u,type:"line"}),m.callback(w.resolve,{data:n,recency:u,type:"spark-line"});var v;v=d.plays>f.plays?f.plays/d.plays:d.plays/f.plays,h.plays={trending:g.plays,total:r.plays,previousTotal:f.plays,change:(100*v).toFixed(1)},isNaN(h.plays.change)&&(h.plays.change=100),h.uniques={trending:g.uniques,playsPer:b("currency")(d.plays/d.uniques,"",2)},e.setDataLastUpdated(a.last_updation_timestamp)};m.started(),e.$watch("trendingStart",function(a){a&&j.getMetricsByMediaIdByDateRange({mediaId:v.mediaID,startDate:a,endDate:f.dateRangeEnd},{per_page:1e3},C,t)}),h.deviceLoading=!0,j.getMetricsByMediaIdByDeviceByDateRange({mediaId:v.mediaID,startDate:f.dateRangeStart,endDate:f.dateRangeEnd},{per_page:4},function(a){m.finished();for(var b=[],c=a.device_metrics,d=0;d<c.length;d++){var e={};angular.copy(c[d],e),e.plays=a.total_plays?Math.floor(1e3*c[d].plays/a.total_plays)/10:0,e.style={width:e.plays+"%"},e["class"]="bg-stacked-bar-"+d,b.push(e)}var f=["Desktop","Other","Phone","Tablet"];f.forEach(function(a){_.findWhere(b,{device:a})||b.push({device:a,plays:0,style:{width:"0"},"class":"bg-stacked-bar-"+b.length})}),h.devices=b,h.deviceTotal=a.total_plays,h.deviceLoading=!1},t);var D=[{dependentVariable:1,independentVariable:0}],E=.03125;h.engagementData=function(a,b){m.started(),j.getMetricsByMediaIdByEngagementByDateRange({mediaId:v.mediaID,startDate:f.dateRangeStart,endDate:f.dateRangeEnd},{},function(b){m.finished();var c={label:"",values:[]},d=[];b.engagement.forEach(function(a){d.push(0)});for(var e=0;1>=e;e+=E){for(var f=0,g=0;g<d.length;g++){var h=d[g],i=b.engagement[g].chart_data;h<i.length-1&&parseFloat(i[h+1][0])==e&&d[g]++,f+=parseInt(i[d[g]][1])}c.values.push({dependentVariable:f,independentVariable:e})}D=c.values,m.callback(a,{data:[c],type:"stacked-area"})},function(a){z.src="",A=!0,m.finished(),b(a)})};var F,G;h.setUpEngagement=function(){var b=a[0].getElementById("chart");G=d3.select(b).append("div").attr("id","positionMarkerFill"),F=d3.select(b).append("svg").attr("id","positionMarker"),F.append("line").attr("x1",0).attr("y1",0).attr("x2","100%").attr("y2",0),F.append("line").attr("x1",0).attr("y1","100%").attr("x2","100%").attr("y2","100%"),F.append("line").attr("x1","50%").attr("y1",0).attr("x2","50%").attr("y2","100%").classed("center",!0),F=F.node(),G=G.node();b&&b.addEventListener("click",function(a){if(z&&z.duration){var c=a.x-b.getBoundingClientRect().left+F.clientWidth/2;z.currentTime=Math.round(c*z.duration/b.clientWidth),z.play()}})},h.countriesLoading=!0,j.getMetricsByMediaIdByCountryByDateRange({mediaId:v.mediaID,startDate:f.dateRangeStart,endDate:f.dateRangeEnd},{per_page:1e3},function(a){var b,c=a.country_metrics,d=[];c.forEach(function(e){e.plays>0&&(d.length<4||5==c.length?(b=n.getCountrybyCountryCode(e.country_code)||"Unknown",d.push({label:b,plays:Math.floor(1e3*e.plays/a.total_plays)/10})):4===d.length?d.push({label:"Other",plays:e.plays}):d[4].plays+=e.plays)}),5==d.length&&5!=c.length&&(d[4].plays=Math.floor(1e3*d[4].plays/a.total_plays)/10),h.countries=d,h.countryTotal=a.total_plays,h.countriesLoading=!1},function(a){h.countryError=!0}),h.playsDataFunc=function(a,b){w.promise.then(a,b)},h.getLineData=function(a,b){x.promise.then(a,b)},h.isFinite=Number.isFinite,m.started(),j.getMetricsByMediaIdByDomainsByDateRange({mediaId:v.mediaID,startDate:f.dateRangeStart,endDate:f.dateRangeEnd},{sort:"-embeds",per_page:4},function(a){m.finished(),h.domains={columns:[{key:"domain"},{key:"embeds"},{key:"plays"},{key:"completes"},{display:"complete rate",key:"completeRate"}],minimumRows:4,loading:!0},a.domain_metrics.length?h.domains.rows=_.map(a.domain_metrics,function(a){return _.extend(a,{completeRate:a.plays?Math.round(100*a.completes/a.plays):0})}):h.noData.domains=!0,h.domains.loading=!1},function(a){m.finished(),h.dataError.domains=!0}),h.$emit("viewLoaded")}}])}(),function(){"use strict";angular.module("DashboardApp").controller("AnalyticsContentController",["$filter","$location","$q","$route","$routeParams","$scope","$timeout","AnalyticsService","Tables","TimeService","VirtualVideoService","VirtualTagService","ConfigService","UrlService","TrackingService","SessionService",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){function q(){return(f.table.sort.reverse?"":"-")+f.table.sort.by}if(e.dateRange){f.$emit("viewLoaded"),f.selectedTags=b.search().tags?b.search().tags.split(","):[],f.isFinite=Number.isFinite,f.numPages=1,f.previousQuery="",f.searchTerms=f.searchQuery=b.search().search?b.search().search:"",f.property=p.getSiteToken();var r=m.get("content","tag","autocompleteLimit"),s=(m.get("content","tag","suggestedLimit"),"date");f.table={loading:!0,columns:[{key:"title"},{key:"embeds",sortable:!0},{key:"plays",sortable:!0},{key:"completes",sortable:!0},{display:"complete rate",key:"completeRate"},{display:"time watched",key:"timewatched",sortable:!0}],minimumRows:i.DEFAULT_PAGE_LENGTH},i.setScopePageVariables(f),i.setTableSortVariables(f.table,"plays");var t=c.defer(),u=c.defer(),v=c.all({videos:t.promise,analytics:u.promise});if(f.searchTerms||f.selectedTags.length){var w={};k.list({offset:0,limit:1e3,sort:s,searchQuery:f.searchQuery,tags:f.selectedTags},function(a,b){for(var d,g=a,j=0,l=[];b>1e3;)d={},j+=1e3,b-=1e3,d.offset=j,d.idx=l.length,w["videosPromises"+d.idx]=c.defer(),d.promise=w["videosPromises"+d.idx],l.push(d),k.list({offset:d.offset,limit:1e3,sort:s,searchQuery:f.searchQuery,tags:f.selectedTags},function(a){d.promise.resolve(a)});var m=c.all(w);m.then(function(a){Object.keys(a).forEach(function(b){g=g.concat(a[b])}),t.resolve(g),g.length?h.getMetricsByMultipleMediaIdsByDateRange({startDate:e.dateRangeStart,endDate:e.dateRangeEnd,mediaIds:_.pluck(g,"key").join()},{page:f.page,per_page:i.getPageLength()},function(a){f.numPages=i.getNumberOfPages(a.multiple_videos_metrics),u.resolve(a.multiple_videos_metrics)}):u.resolve([])})},function(a,b){t.reject({status:a,message:b,analytics:response.top_videos_metrics})})}else h.getMetricsByTopVideosByDateRange({startDate:e.dateRangeStart,endDate:e.dateRangeEnd},{page:f.page,per_page:i.getPageLength(),sort:q()},function(a){f.numPages=i.getNumberOfPages(a.top_videos_count),f.reportType="content",a.top_videos_count>m.get("analyticsExportMax")&&(f.reportEmail=!0),u.resolve(a.top_videos_metrics),k.list({offset:0,limit:a.top_videos_metrics.length,sort:s,sortReverse:!0,videoKeys:_.pluck(a.top_videos_metrics,"mediaid").join()},function(a){t.resolve(a)},function(b,c){t.reject({status:b,message:c,analytics:a.top_videos_metrics})})},function(a,b){u.reject({status:a,message:b})});var x=function(a,b){return _.extend(a,{title:b&&b.title||null,titleError:!(b&&b.title),completeRate:a.completes/a.plays,timeWatchedFormatted:j.parseTimeToString(parseFloat(a.timewatched))})};v.then(function(a){f.table.rows=_.map(a.analytics,function(b){var c=_.findWhere(a.videos,{key:b.mediaid});return x(b,c)}),f.table.rows.length||(f.table.noData=!0,f.table.columns.forEach(function(a){a.sortable=!1})),f.table.loading=!1},function(a){a.analytics?f.table.rows=_.map(a.analytics,x):f.table.error=!0,f.table.loading=!1}),f.getMatched=function(a){var b=c.defer(),d=a.split(", "),e=d[d.length-1];return f.previousQuery=1==d.length?"":d[0],l.list({search:e,limit:r,offset:0},function(a){var c=_.chain(a).sortBy(function(a){return-a.videos}).pluck("name").reject(function(a){return _.contains(f.selectedTags,a)}).value();b.resolve(c)},function(a){b.reject(a)}),b.promise},f.addTag=function(a){f.searchQuery=f.previousQuery,f.selectedTags.push(a),f.dispatchSearch()},f.toggleDropdown=function(){f.showTagsDropdown=!f.showTagsDropdown},f.removeTag=function(a){f.selectedTags.splice(f.selectedTags.indexOf(a),1),f.selectedTags.length<4&&(f.showTagsDropdown=!1),f.dispatchSearch()},f.clearSearchResults=function(){n.removeUrlParam("page"),n.removeUrlParam("search",""),n.removeUrlParam("tags")},f.searchTermsChanged=function(){return f.searchQuery!==f.searchTerms},f.dispatchSearch=function(){f.selectedTags.length>0&&o.ga("send","event","Analytics Section","Search","Tag",f.selectedTags.length),n.addUrlParam("tags",f.selectedTags.join(",")),n.addUrlParam("page",1),f.searchQuery.trim().length>0?n.addUrlParam("search",f.searchQuery):n.removeUrlParam("search")};var y=function(){l.list({order_by:"videos:desc",limit:5,offset:0},function(a){f.popularTags=a})};y(),f.showPopularTags=function(){f.showPop=!0},f.hidePopularTags=function(){g(function(){f.showPop=!1},100)}}}])}(),function(){"use strict";angular.module("DashboardApp").controller("AnalyticsDomainsController",["$filter","$location","$route","$routeParams","$scope","AnalyticsService","Tables","ConfigService",function(a,b,c,d,e,f,g,h){function i(){return(e.table.sort.reverse?"":"-")+e.table.sort.by}d.dateRange&&(e.$emit("viewLoaded"),e.isFinite=Number.isFinite,e.numPages=1,e.table={loading:!0,columns:[{key:"domain"},{key:"embeds",sortable:!0},{key:"plays",sortable:!0},{key:"completes",sortable:!0},{display:"complete rate",key:"completeRate"}],minimumRows:g.DEFAULT_PAGE_LENGTH},g.setScopePageVariables(e),g.setTableSortVariables(e.table,"plays"),f.getMetricsByDomainsByDateRange({startDate:d.dateRangeStart,endDate:d.dateRangeEnd},{page:e.page,per_page:g.getPageLength(),sort:i()},function(a){e.numPages=g.getNumberOfPages(a.top_domains_count),e.reportType="domain",a.top_domains_count>h.get("analyticsExportMax")&&(e.reportEmail=!0),e.table.rows=_.map(a.domain_metrics,function(a){return _.extend(a,{completeRate:a.completes/a.plays})}),e.table.rows.length||(e.table.noData=!0,e.table.columns.forEach(function(a){a.sortable=!1})),e.table.loading=!1},function(a){e.table.loading=!1,e.table.error=!0}))}])}(),function(){"use strict";angular.module("DashboardApp").controller("AnalyticsExportController",["$rootScope","$scope","AnalyticsReportService","SessionService",function(a,b,c,d){b.user=function(){return d.getUser()},!b.media||b.video&&b.video.title||(b.video={title:"Content Unavailable"}),b.forminput={emailReportTo:d.getUser().userEmail,invalidEmailReportTo:!1},b.checkEmailReportTo=function(){""===b.forminput.emailReportTo?b.forminput.emailReportTo=b.user().userEmail:"undefined"==typeof b.forminput.emailReportTo&&(b.forminput.invalidEmailReportTo=!0)},b.resetEmailReportTo=function(){b.forminput.invalidEmailReportTo&&(b.forminput.emailReportTo="",b.forminput.invalidEmailReportTo=!1)},b.exportEmail=function(){var e={type:b.reportType,siteToken:d.getSiteToken(),rangeStart:Math.round(a.dateRangeStart/1e3),rangeEnd:Math.round(a.dateRangeEnd/1e3),emailTo:b.forminput.emailReportTo};"contentDetail"==b.reportType&&(e.objectId=b.media),c.createReport(e).then(function(a){b.emailSuccess=!0})}}])}(),function(){"use strict";angular.module("DashboardApp").controller("AnalyticsHeaderController",["$document","$filter","$location","$modal","$rootScope","$routeParams","$scope","$timeout","AnalyticsService","ConfigService","SessionService","TrackingService","AnalyticsReportService","DownloadService",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){var o=864e5,p="yyyy-MM-dd";e.hasRealtimeBeta=k.getAccount().realtimeBeta,e.hasRightNow=k.hasFeature("right_now"),e.setDataLastUpdated=function(a){var c=Date.parse(a);c&&(!e.dataLastUpdated||c.getTime()<e.dataLastUpdated)&&(e.dataLastUpdated=c.getTime(),e.dataLastUpdatedToday=b("date")(c,p)==b("date")(Date.now(),p))},g.userMigrated=k.getMigrated(),g.updateDateRange=function(a,d,f){this.dateRange=a,"custom"==a?(l.ga("send","event","Analytics Section","Change Date Range","Custom"),"object"==typeof d&&d.getTime&&(d=d.getTime(),
f=f.getTime()),e.dateRangeStart=d,e.dateRangeEnd=f,e.dateRangeDays=Math.round(Math.abs(e.dateRangeEnd-e.dateRangeStart)/o)+1):(l.ga("send","event","Analytics Section","Change Date Range",this.dateRange),e.dateRangeDisplay=parseInt(this.dateRange.slice(0,-1)),e.dateRangeDays=e.dateRangeDisplay+1,e.dateRangeEnd=(new Date).getTime(),e.dateRangeStart=e.dateRangeEnd-e.dateRangeDisplay*o),g.dateRangeEnd=e.dateRangeEnd,g.dateRangeStart=e.dateRangeStart;var h=e.dateRangeStart-o;e.trendingStartTime=h-e.dateRangeEnd+e.dateRangeStart,e.trendingStart=b("date")(e.trendingStartTime,p),e.trendingEnd=b("date")(h,p),c.search("dateRange",this.dateRange),c.search("dateRangeEnd",b("date")(e.dateRangeEnd,p)),c.search("dateRangeStart",b("date")(e.dateRangeStart,p)),e.dateRange=this.dateRange},g.isRightNow="/analytics/rightnow"===c.path(),g.isRangePage=!g.isRightNow,e.dateRange&&f.dateRange||!g.isRangePage||(e.dateRange=f.dateRange||"7d",g.updateDateRange(e.dateRange,Date.parse(f.dateRangeStart),Date.parse(f.dateRangeEnd))),e.sendDataLabelKeyGaEvent=function(){l.ga("send","event","Analytics Section","View Data Label Key")},g.exportData=function(){if(l.ga("send","event","Analytics Section","Click Export"),g.reportType&&!g.reportEmail){var a={type:g.reportType,siteToken:k.getSiteToken(),rangeStart:Math.round(e.dateRangeStart/1e3),rangeEnd:Math.round(e.dateRangeEnd/1e3)};"contentDetail"==g.reportType&&(a.objectId=g.media),m.downloadReport(a).then(function(a){n.startDownload(a.report.data,a.report.file,"text/csv")})}else d.open({templateUrl:j.get("overridePerEnvironment","baseDirectory")+"templates/modals/analytics-export.html",controller:"AnalyticsExportController",scope:g})},g.pickingRange=!1,g.startPickingRange=function(a){g.pickingRange=!0,a.stopPropagation()},g.finishPickingRange=function(a,b){g.pickingRange=!1,a&&g.updateDateRange("custom",a,b)},g.clickRange=function(a){a.stopPropagation()},g.analyticsStartDate=new Date(2015,7,1),g.analyticsEndDate=new Date,g.pickRangeEnd=new Date(e.dateRangeEnd),g.pickRangeStart=new Date(e.dateRangeStart),g.pickRangeEnd=g.pickRangeEnd.setHours(0,0,0,0,0),g.pickRangeStart=g.pickRangeStart.setHours(0,0,0,0,0),g.selectedDates=[g.pickRangeStart,g.pickRangeEnd],f.dateRange&&f.dateRangeStart&&f.dateRangeEnd&&i.getUserAlert().then(function(a){g.alert=a}),a[0].getElementsByTagName("html")[0].addEventListener("click",function(){g.finishPickingRange()})}])}(),function(){"use strict";angular.module("DashboardApp").controller("AnalyticsOverviewController",["$filter","$modal","$q","$rootScope","$routeParams","$scope","$timeout","AnalyticsService","ConfigService","ChartService","CountryService","ModalService","SessionService","Templates","TrackingService","VirtualVideoService",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){function q(a,b){A.success?a(A.result):A.error?b():(A.successCallbacks.push(a),A.errorCallbacks.push(b),A.queried||(A.queried=!0,z.loadStarted(),d.$watch("dateRangeDays",function(a){if(a){var b=B();h.getMetricsByDateRange({startDate:b,endDate:e.dateRangeEnd},{per_page:2*d.dateRangeDays},function(a){z.loadFinished(),A.result=C(a),A.success=!0;for(var b in A.successCallbacks)y(A.successCallbacks[b],a)},function(){z.loadFinished(),f.dataError.uniques=!0,A.error=!0;for(var a in A.errorCallbacks)A.errorCallbacks[a]()})}})))}if(e.dateRange){f.isOverview=!0,f.dataError={},f.noData={},f.emptyVideos=[1,2,3,4,5],f.reportType="overview";var r=c.defer(),s=c.defer(),t=c.defer(),u=c.defer(),v=c.defer();c.all(_.pluck([r,s,t,u,v],"promise")).then(function(a){_.any(a)||l.open({templateUrl:n.path("modals/zero-data"),controller:"ZeroDataModal"})}),f.sendTooltipGaEvent=function(a){o.ga("send","event","Analytics Section","Chart Hover",a)};var w=!1,x=[],y=function(a,b){w?a(b):x.push([a,b])},z={loading:0,loadStarted:function(){this.loading++},loadFinished:function(){this.loading--,0===this.loading&&g(function(){if(!w){w=!0;for(var a in x)x[a][0](x[a][1])}})}};f.getDeviceData=function(a,b){z.loadStarted(),h.getMetricsByDeviceByDateRange({startDate:e.dateRangeStart,endDate:e.dateRangeEnd},{per_page:4}).then(function(b){z.loadFinished();var c=["Desktop","Other","Phone","Tablet"],d=b.device_metrics;d.length>0?r.resolve(!0):r.resolve(!1),c.forEach(function(a){_.findWhere(d,{device:a})||d.push({device:a,plays:0})}),y(a,{labelKey:"device",valueKey:"plays",data:d,type:"stacked-bar"})})["catch"](function(a){z.loadFinished(),b(a)})},f.getGeoData=function(a,b){z.loadStarted(),h.getMetricsByCountryByDateRange({startDate:e.dateRangeStart,endDate:e.dateRangeEnd},{per_page:1e3}).then(function(b){z.loadFinished();var c=b.country_metrics,d=[];c.forEach(function(a){if(a.plays>0)if(d.length<4||5==c.length){var b=k.getCountrybyCountryCode(a.country_code)||"Unknown";d.push({label:b,value:a.plays})}else 4===d.length?d.push({label:"Other",value:a.plays}):d[4].value+=a.plays}),c.length>0?s.resolve(!0):s.resolve(!1),y(a,{labelKey:"label",valueKey:"value",data:d,type:"stacked-bar"})})["catch"](function(a){z.loadFinished(),b(a)})};var A={successCallbacks:[],errorCallbacks:[],queried:!1,success:!1,error:!1,result:null},B=function(){var b=f.dateRangeStart,c=f.dateRangeEnd,d=b-(c-b);return a("date")(d,"yyyy-MM-dd")},C=function(a){var b,c,d=0,f=0,g=0,h=0,i=[];a.metrics.forEach(function(a){b=new Date(a.date),c=new Date(e.dateRangeStart),b.getTime()<c.getTime()?(d+=a.completes,f+=a.embeds,g+=a.plays,h+=a.uniques):i.push(a)});var j={metrics:i,completesTrend:parseInt(d),embedsTrend:parseInt(f),playsTrend:parseInt(g),uniquesTrend:parseInt(h),completeRateTrend:0!==parseInt(g)?parseInt(d)/parseInt(g):0};return j},D=c.defer();f.completesLoading=!0,f.completeRateDataFunc=function(a,b){D.promise.then(a,b)},f.getLineData=function(b,c){q(function(c){var g={},h={},i=0,k=0,l=0,m=0,n=c.last_updation_timestamp,o=!!n;c=C(c);for(var p in c.metrics)if(c.metrics[p].date>=e.dateRangeStart){var q={};angular.extend(q,c.metrics[p]),i+=q.uniques,k+=q.embeds,l+=q.plays,m+=q.completes,g[q.date]=q,h[q.date]={completeRate:q.plays>0?q.completes/q.plays:0,date:q.date}}0==i&&0==k&&0==l&&0==m?v.resolve(!1):v.resolve(!0),f.completeAverage=0!==l?(m/l*100).toFixed(2):0;var r={embeds:0,plays:0,completes:0,uniques:0},s={completeRate:0};c.metrics.length&&(g=j.padDateData(g,r),h=j.padDateData(h,s));var t=j.groupDataIntoSeries("date",g,["embeds","plays","completes","uniques"]),u=j.groupDataIntoSeries("date",h);i?f.playsPerUnique=l/i:f.playsPerUnique=0,f.playsTrendingDown=l>c.playsTrend,f.completesTrendingDown=m>c.completesTrend,f.uniquesTrendingDown=i>c.uniquesTrend,f.embedsTrendingDown=k>c.embedsTrend,f.completeRateTrendingDown=f.completeAverage<(100*c.completeRateTrend).toFixed(2),f.trendingCompleteRate=(100*c.completeRateTrend).toFixed(2)||0;var w={embeds:k,plays:l,completes:m,uniques:i},x=g.length?i/g.length:0;x=a("number")(Math.round(x));var z,A=a("number")(parseInt(k)),B=a("number")(l),E=a("number")(m),F=a("number")(c.embedsTrend),G=a("number")(c.playsTrend),H=a("number")(c.completesTrend),I=a("number")(Math.round(g.length?c.uniquesTrend/g.length:0)),J=[{dependentVariable:"embeds",label:"Total Embeds",dependentVariableValue:A,trending:f.embedsTrendingDown,previous:F},{dependentVariable:"plays",label:"Total Plays",dependentVariableValue:B,trending:f.playsTrendingDown,show:!0,previous:G},{dependentVariable:"uniques",label:"Avg Daily Uniques",dependentVariableValue:x,trending:f.uniquesTrendingDown,previous:I},{dependentVariable:"completes",label:"Total Completes",dependentVariableValue:E,trending:f.completesTrendingDown,previous:H}];["embeds","plays","uniques","completes"].forEach(function(a,b){z=w[a]>c[a+"Trend"]?c[a+"Trend"]/w[a]:w[a]/c[a+"Trend"],z||(z=0),J[b].percentChange=(100*(1-z)).toFixed(1)}),t.forEach(function(a){a.fullData=t,J.some(function(b){return b.dependentVariable==a.dependentVariable?(a.legend=b,!0):void 0})}),u[0]?(u[0].values.forEach(function(a){a.xdata=Date.parse(a.independentVariableValue),a.ydata=a.dependentVariableValue,a.date=a.independentVariableValue,a.tipData=(100*a.dependentVariableValue).toFixed(2)+"%"}),D.resolve({data:["Complete Rate"].concat(u[0].values),recency:o,type:"spark-line"})):D.resolve({data:u,recency:o,type:"spark-line"}),f.completesLoading=!1,y(b,{dateRange:d.dateRangeDays,data:[t],legends:J,totals:{"Total Plays":B,"Total Embeds":A,"Avg Daily Uniques":x,"Total Completes":E},toggleLabel:"Show Complete Rates",recency:o,type:"line"}),d.setDataLastUpdated(n)},function(a){z.loadFinished(),c(a)})},z.loadStarted(),f.topVideosLoading=!0,h.getMetricsByTopVideosByDateRange({startDate:e.dateRangeStart,endDate:e.dateRangeEnd},{per_page:5,sort:"-plays"},function(a){z.loadFinished(),f.topVideos={},a.top_videos_metrics.length?(a.top_videos_metrics.forEach(function(a){f.topVideos[a.mediaid]=a,p.show(a.mediaid,function(a){f.topVideos[a.key].title=a.title},function(b,c){a.error=!0})}),t.resolve(!0),f.topVideosLoading=!1):(f.noData.topContent=!0,t.resolve(!1),f.topVideosLoading=!1),f.videoMediaBase=f.base.protocol+i.get("overridePerEnvironment","contentLocation")},function(){z.loadFinished(),f.dataError.topContent=!0}),z.loadStarted(),f.domains={columns:[{key:"URL"},{key:"Embeds"},{key:"Plays"},{key:"Completes"},{key:"Complete Rate"}],minimumRows:3,loading:!0},h.getMetricsByDomainsByDateRange({startDate:e.dateRangeStart,endDate:e.dateRangeEnd},{per_page:3}).then(function(a){if(z.loadFinished(),f.domains={columns:[{key:"URL"},{key:"Embeds"},{key:"Plays"},{key:"Completes"},{key:"Complete Rate"}],minimumRows:3},a.domain_metrics.length){for(var b in a.domain_metrics){var c=a.domain_metrics[b];c.completeRate=c.plays?Math.round(100*c.completes/c.plays):0,c.position=parseInt(b)+1+"."}f.domains.rows=a.domain_metrics,u.resolve(!0)}else f.domains.noData=!0,u.resolve(!1)})["catch"](function(){z.loadFinished(),f.dataError.domains=!0}),f.$emit("viewLoaded")}}])}(),function(){"use strict";angular.module("DashboardApp").controller("AnalyticsRightnowController",["$scope","$location","$interval","$timeout","$q","SessionService","AnalyticsRealtimeService","ConfigService","VirtualVideoService","CountryService","TrackingService","d3","AnalyticsService",function(a,b,c,d,e,f,g,h,i,j,k,l,m){function n(){function a(a){a.errorCallback&&("undefined"==typeof a.consecutiveErrors||a.consecutiveErrors>=s-1)&&a.errorCallback(),"undefined"==typeof a.consecutiveErrors?a.consecutiveErrors=1:a.consecutiveErrors++}C.forEach(function(a){var b=g[a.serviceMethod]({},a.serviceParams);a.activePromise=b}),e.all(_.pluck(C,"activePromise")).then(function(b){C.forEach(function(c,e){var f=b[e];if(f&&f.metrics){c.consecutiveErrors=0;var g=c.dataCallback(f.metrics);c.chartCallback&&c.timeout?d(function(){c.chartCallback(g)},c.timeout):c.chartCallback&&c.chartCallback(g)}else"undefined"!=typeof f&&a(c)})},function(){C.forEach(function(b){a(b)})})}f.hasFeature("right_now")||b.url("/analytics/overview");var o,p=5e3,q=14,r=18e5,s=5;a.animateNewValue=angular.noop;var t={},u=5,v=10,w=!1;a.videoMediaBase=a.base.protocol+h.get("overridePerEnvironment","contentLocation");var x=["Desktop","Phone","Tablet","Other"],y=4;a.devices={loading:!0,columns:[{key:"name"},{key:"percentage"},{key:"uniques"}],minimumRows:y};var z=5;a.topCountries={loading:!0,columns:[{key:"Top 5 Countries"},{key:""}],minimumRows:z};var A,B=[];l.json("/static/world-topo.json",function(a,b){if(B=topojson.feature(b,b.objects.countries).features,A){var c=C[_.findIndex(C,function(a){return"getGlobalMetrics"==a.serviceMethod})];c.chartCallback(c.dataCallback(A))}}),a.domains={loading:!0,columns:[{display:"URL",key:"domain"},{key:"uniques"}]},m.getUserAlert().then(function(b){a.alert=b});var C=[{serviceMethod:"getMetrics",chartMethod:"getUniqueMetrics",serviceParams:{intervals:q},dataCallback:function(b){return b=b.slice(1),b.forEach(function(a){a.ydata=a.uniques,a.xdata=b.indexOf(a)}),a.currentUniques=b[0].uniques,o&&a.animateNewValue(b[0].ydata,b[0].datetime==o),o=b[0].datetime,{data:["Current Viewers"].concat(b)}},timeout:1e3},{serviceMethod:"getMediaMetrics",serviceParams:{num:v},dataCallback:function(b){function c(){d.forEach(function(a){t[a.mediaid]=w}),b=b.slice(0,u),b.forEach(function(a){a.title=t[a.mediaid]||w,a.error=a.title===w}),a.topContent=b,a.topContentError=!1}var d=_.filter(b,function(a){return"undefined"==typeof t[a.mediaid]});d.length?i.list({offset:0,limit:v,sort:"date",videoKeys:_.pluck(d,"mediaid").join()},function(a){a.forEach(function(a){t[a.key]=a.title,d.splice(_.findIndex(d,function(b){return b.mediaid==a.key}),1)}),c()},c):c()},errorCallback:function(){a.topContentError=!0}},{serviceMethod:"getDeviceMetrics",chartMethod:"getDeviceMetrics",dataCallback:function(b){var c=x.slice(0),d=0;b.forEach(function(a){c.splice(_.findIndex(c,function(b){return b===a.name}),1),d+=a.uniques}),a.devices.noData=!b.length,c.forEach(function(a){b.length<y&&b.push({name:a,uniques:0})});for(var e=0;e<b.length;e++){var f=b[e];f.style={width:(d&&Math.round(100*f.uniques/d)||0)+"%"},f["class"]="bg-stacked-bar-"+e}a.devices.rows=b,a.devices.loading=!1,a.devices.error=!1},errorCallback:function(){a.devices.error=!0}},{serviceMethod:"getDomainMetrics",chartMethod:"getDomainMetrics",dataCallback:function(b){a.domains.rows=b,a.domains.noData=!a.domains.rows.length,a.domains.loading=!1,a.domains.error=!1},errorCallback:function(){a.domains.error=!0}},{serviceMethod:"getGlobalMetrics",chartMethod:"getGlobalMetrics",dataCallback:function(b){return A=b,B.forEach(function(a){a.uniques=0}),b.sort(function(a,b){return a.uniques<b.uniques?1:a.uniques==b.uniques?0:-1}),b.forEach(function(a){a.country=j.getCountrybyCountryCode(a.code),"United States of America"==a.country&&(a.country="United States")}),a.topCountries.rows=b.slice(0,5),{data:[".viewers-legend svg"].concat(b),countries:B}}}];C.forEach(function(b){b.chartMethod&&(a[b.chartMethod]=function(a,c){b.chartCallback=a,b.errorCallback=c}),b.consecutiveErrors=0}),a.sendTooltipGaEvent=function(a){k.ga("send","event","Analytics Section","Chart Hover",a)},n();var D=c(n,p);a.$on("$destroy",function(){c.cancel(D)}),a.refreshTimer=d(function(){window.location.reload(!0)},r),a.$on("$routeChangeStart",function(){d.cancel(a.refreshTimer)}),a.$emit("viewLoaded")}])}(),function(){"use strict";angular.module("DashboardApp").controller("AnalyticsLegacyMigrationNoticeController",["$scope","AccountService","SessionService",function(a,b,c){a.userMigrated=c.getMigrated()}])}(),function(){"use strict";angular.module("DashboardApp").controller("AnalyticsLegacyNoticeController",["$scope","$location",function(a,b){a.isOnLegacyAnalyticsPage=function(){return"/analytics/legacy"===b.path()},a.isOnPlatformPage=function(){return"/analytics/legacy/platform"===b.path()}}])}(),function(){"use strict";angular.module("DashboardApp").controller("AnalyticsLegacyPlatformController",["$filter","$scope","DownloadService","SessionService","TrackingService","VideoService",function(a,b,c,d,e,f){var g=new Date;b.months={columns:[{key:"Summary Date"},{key:"Analytics by Day (CSV)"},{key:"Analytics by Video (CSV)"}],rows:_.map(_.range(0,13),function(a){var b=g.getTimezoneOffset()/60,c=new Date(new Date(g).setMonth(g.getMonth()-a));if(c=new Date(new Date(new Date(c.setDate(2)).setHours(b)).setMinutes(0)).setSeconds(0),0===a)var d=g.getTime();else var d=new Date(c).setMonth(new Date(c).getMonth()+1)-864e5;return{startDate:Math.floor(c/1e3),endDate:Math.floor(d/1e3),currentMonth:0===a}})},b.downloadDayMetrics=function(b){e.ga("send","event","Analytics Section","Click Export","Platform by Day"),f.viewsList({list_by:"day",start_date:b.startDate,end_date:b.endDate,include_empty_days:"True"},function(b){var d,e;b.days.forEach(function(b){b.date=a("date")(1e3*b.date.timestamp,"yyyy-MM-dd"),d||(d=b.date),e=b.date}),c.exportCSV(b.days,"Views_by_day_"+d+"_"+e+"_all_videos",[{label:"Date",key:"date"},{label:"Views",key:"views"},{label:"Pageviews",key:"pageviews"},{label:"Seconds viewed",key:"viewed"},{label:"Downloads",key:"downloads"},{label:"Streams",key:"streams"}])})},b.downloadVideoMetrics=function(b){e.ga("send","event","Analytics Section","Click Export","Platform by Video"),f.viewsList({list_by:"video",start_date:b.startDate,end_date:b.endDate,include_empty_days:"True",order_by:"views:desc",result_limit:0},function(d){var e=a("date")(1e3*(b.startDate-86400),"yyyy-MM-dd"),f=a("date")(1e3*(b.endDate-86400),"yyyy-MM-dd");d.videos.forEach(function(a){a.title='"'+a.title+'"'}),c.exportCSV(d.videos,"Views_by_video_"+e+"_"+f+"_all_videos",[{label:'"Video Title"',key:"title"},{label:"Key",key:"key"},{label:"Views",key:"views"},{label:"Pageviews",key:"pageviews"},{label:"Seconds viewed",key:"viewed"},{label:"Downloads",key:"downloads"},{label:"Streams",key:"streams"},{label:"Status",key:"status"}])})},b.$emit("viewLoaded")}])}(),function(){"use strict";angular.module("DashboardApp").controller("ZeroDataModal",["$modalInstance","$scope","SessionService","TrackingService",function(a,b,c,d){d.ga("send","event","Analytics Section","Viewed Zero Data"),b.currentProperty=c.getSiteToken(),b.close=function(){a.dismiss("closed")}}])}(),function(){"use strict";angular.module("DashboardApp").controller("AdTagsListController",["$interval","$location","$scope","$window","$route","ChannelService","PollingService","Tables","AdTagsService","UrlService","TrackingService",function(a,b,c,d,e,f,g,h,i,j,k){c.$emit("viewLoaded"),k.ga("send","event","Ads Section","Ad Tags List");var l=b.search();c.reverse=l.reverse,c.page=parseInt(l.page)||1,c.newError=!1,c.table={columns:[{key:"name",sortable:!0},{key:"URL"}],loading:!0,rows:[],minimumRows:function(){return h.DEFAULT_PAGE_LENGTH-!c.table.rows.length}},h.setScopePageVariables(c),h.setTableSortVariables(c.table,"name");var m=function(){i.list({order_by:"name:"+(c.reverse?"desc":"asc"),result_limit:h.getPageLength(),result_offset:(c.page-1)*h.getPageLength()}).then(function(a){c.table.rows=a.adtags||[],c.totalAdtags=a.total,c.numPages=h.getNumberOfPages(c.totalAdtags),c.table.loading=!1})};m(),c.selectionCount=function(){return _.countBy(c.table.rows,"selected")["true"]||0},c.addNewAdTag=function(a){k.ga("send","event","Ads Section","Create New Ad Tag"),c.disableAdd=!0,c.newTag={},c.table.rows.length>9&&(c.storeTag=c.table.rows.pop()),c.totalAdtags+=1,c.numPages=h.getNumberOfPages(c.totalAdtags)},c.toggleEdit=function(a){a.edit=!a.edit,a.updateName=a.name,a.updateUrl=a.url},c.updateTag=function(a){a.updateError=!1,i.update({adtag_key:a.key,name:a.updateName,url:a.updateUrl}).then(function(b){a.name=a.updateName,a.url=a.updateUrl,c.toggleEdit(a),c.handleNotification("Ad tag successfully saved","success")},function(a){c.handleNotification("There was an error in saving this ad tag","failed")})},c.saveNewTag=function(){c.newError=!1,i.create({name:c.newTag.name,url:c.newTag.url}).then(function(a){c.disableAdd=!1,a.adtag.name=c.newTag.name,a.adtag.url=c.newTag.url,c.table.rows=[a.adtag].concat(c.table.rows),c.handleNotification("Ad tag successfully saved","success")},function(a){c.handleNotification("There was an error in saving this ad tag","failed")})},c.cancelNewTag=function(){c.disableAdd=!1,c.table.rows.length>9&&c.table.rows.push(c.storeTag),c.totalAdtags-=1,c.numPages=h.getNumberOfPages(c.totalAdtags)},c.deleteSelectedItems=function(){d.confirm("Are you sure you want to delete these Ad Tags? Once deleted, an ad tag will no longer appear in any schedules nor play in any previously embedded players with that tag.")&&c.table.rows.forEach(function(a){a.selected&&i["delete"]({adtag_key:a.key}).then(function(a){e.reload(),c.handleNotification("These ad tags has been successfully deleting","success")},function(){c.handleNotification("There was an error in deleting these ad tags","failed")})})}}])}(),function(){"use strict";angular.module("DashboardApp").controller("AdSchedulesListController",["$interval","$location","$scope","$window","$route","ChannelService","PollingService","Tables","AdSchedulesService","UrlService","TrackingService","SessionService",function(a,b,c,d,e,f,g,h,i,j,k,l){c.$emit("viewLoaded"),c.property=l.getSiteToken(),k.ga("send","event","Ads Section","Ad Schedules List");var m=b.search();c.reverse=m.reverse,c.sort="type"==m.sort?"client":"name",h.setScopePageVariables(c),c.clientDisplay={vast:"VAST",googima:"GoogleIMA"},c.table={columns:[{key:"title",sortable:!0},{key:"type",sortable:!0}],loading:!0,rows:[],minimumRows:function(){return h.DEFAULT_PAGE_LENGTH-!c.table.rows.length}},h.setTableSortVariables(c.table,"name");var n=function(){i.list({order_by:c.sort+":"+(c.reverse?"desc":"asc"),result_limit:h.getPageLength(),result_offset:(c.page-1)*h.getPageLength()}).then(function(a){c.table.rows=a.schedules,c.totalAdSchedules=a.total,c.numPages=h.getNumberOfPages(c.totalAdSchedules),c.table.loading=!1})};n(),c.selectionCount=function(){return _.countBy(c.table.rows,"selected")["true"]||0},c.addNewAdSchedule=function(a){k.ga("send","event","Ads Section","Create New Schedule"),i.create({name:"Untitled Ad Schedule"}).then(function(a){b.url("/ads/detail?key="+a.schedule.key)})},c.deleteSelectedItems=function(){d.confirm("Are you sure you want to delete these Ad Schedules?")&&c.table.rows.forEach(function(a){a.selected&&i["delete"]({schedule_key:a.key}).then(function(a){e.reload(),c.handleNotification("These ad schedules have been successfully deleted","success")},function(){c.handleNotification("There was an error in deleting these ad schedules","failed")})})}}])}(),function(){"use strict";angular.module("DashboardApp").controller("AdScheduleDetailController",["$interval","$location","$scope","$window","$document","$timeout","ChannelService","PollingService","Tables","AdSchedulesService","UtilService","UrlService","TrackingService","AdBreaksService","AdTagsService",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){m.ga("send","event","Ads Section","Ad Schedule Detail");var p=b.search();c.unsavedChanges=!1,c.scheduleChange=!1,c.breakChange=!1,c.KEY_CODE_ENTER=13,j.show({schedule_key:p.key}).then(function(a){c.schedule=a.schedule,c.scheduleName=c.schedule.name,e[0].getElementById("label").select(),c.pre=_.find(c.schedule.adbreaks,function(a){return"pre"==a.offset}),c.post=_.find(c.schedule.adbreaks,function(a){return"post"==a.offset}),c.midrolls=_.reject(c.schedule.adbreaks,function(a){return"pre"==a.offset||"post"==a.offset}),q(),c.$emit("viewLoaded")}),o.list({}).then(function(a){c.adtags=a.adtags}),c.clientDisplay={vast:"VAST",googima:"GoogleIMA"};var q=function(){var a=_.filter(c.midrolls,function(a){return"%"==(a.offset+"").slice(-1)}),b=_.filter(c.midrolls,function(a){return(a.offset+"").split(":").length>1}),d=_.filter(c.midrolls,function(a){return(a.offset+"").split(":").length<2&&"%"!=(a.offset+"").slice(-1)});b.forEach(function(a){a.seconds=t(a.offset)}),a.forEach(function(a){a.offset=a.offset.slice(0,-1),a.percent=!0,a.label="%"}),d.forEach(function(a){a.label="sec"}),a=r(a,"offset"),d=r(d,"offset"),b=r(b,"seconds"),c.midrolls=a.concat(s(d,b))},r=function(a,b){return a.sort(function(a,c){return parseFloat(a[b])<parseFloat(c[b])?-1:parseFloat(a[b])>parseFloat(c[b])?1:0}),a},s=function(a,b){for(var c=[];a.length&&b.length;)a[0].offset<b[0].seconds?(c.push(a[0]),a=a.slice(1)):(c.push(b[0]),b=b.slice(1));return c.concat(a).concat(b)},t=function(a){var b=a.split(":"),c=0;return b.length<3?(c+=60*parseInt(b[0]),c+=parseFloat(b[1])):3===b.length&&(c+=3600*parseInt(b[0]),c+=60*parseInt(b[1]),c+=parseFloat(b[2])),c};c.changeClient=function(a){m.ga("send","event","Ads Section","Change Ad Manager"),c.schedule.client=a,c.unsavedChanges=!0,c.scheduleChange=!0},c.$watch("unsavedChanges",function(a){c.blockExit(a)}),c.titleChange=function(){c.scheduleName!=c.schedule.name&&(c.unsavedChanges=!0,c.scheduleChange=!0)},c.updateSchedule=function(){if(c.active&&c.active.open&&c.active.key&&c.saveBreak(),"googima"==c.schedule.client){var a=c.midrolls;c.pre&&(a=a.concat(c.pre)),c.post&&(a=a.concat(c.post)),a.forEach(function(a){a.key&&n.show({adbreak_key:a.key}).then(function(b){a.tags=b.adbreak.adtags,a.tags=[a.tags[0]],"pre"==a.offset||"post"==a.offset?(c.type=a.offset,c.active=a,c.check=a,c.saveBreak()):(c.type="mid","%"==(a.offset+"").slice(-1)?(c.breakTiming="percent",a.offset=(a.offset+"").slice(0,-1),a.percent=!0):(a.offset+"").split(":").length>1?c.breakTiming="timecode":c.breakTiming="seconds",c.active=a,c.check=a,c.saveBreak())})})}j.update({schedule_key:c.schedule.key,name:c.scheduleName,client:c.schedule.client}).then(function(a){c.scheduleChange=!1,c.unsavedChanges=!1,c.handleNotification("Ad schedule successfully saved","success")},function(){c.handleNotification("There was an error in updating this ad schedule","failed")})},c.timings={seconds:"Seconds into video",timecode:"Timecode (hh:mm:ss)",percent:"% of video"},c.breakTiming="seconds",c.setBreakTiming=function(a){c.breakTiming=a,"percent"==a?c.editingBreak.label="%":(c.active.percent=!1,"seconds"==a?(c.editingBreak.label="sec",c.active.label="sec"):(c.editingBreak.label="",c.active.label="")),c.unsavedChanges=!0,c.breakChange=!0},c.deleteSchedule=function(){d.confirm("Are you sure you want to delete this Ad Schedule?")&&j["delete"]({schedule_key:c.schedule.key}).then(function(a){b.url("/ads/list")},function(){c.handleNotification("There was an error in deleting this ad schedule","failed")})},c.addNewTag=function(a){a.tags.push({});var b=c.type.charAt(0).toUpperCase()+c.type.slice(1);m.ga("send","event","Ads Section","Click Add Waterfall",b+"roll"),c.unsavedChanges=!0,c.breakChange=!0};var u=function(a,b){if(a.length!=b.length)return!1;for(var c=!0,d=0;d<a.length;d++)a[d].name!=b[d].name&&a[d].url!=b[d].url&&(c=!1);return c},v=function(){var a=!1;return Object.keys(c.active).forEach(function(b){"tags"==b?a=!u(c.active[b],c.check[b]):_.isEqual(c.active[b],c.check[b])||(a=!0)}),a};c.closeBreak=function(){return c.check&&v()||!c.check||c.breakChange?d.confirm("You have unsaved work on this break. Abandon changes?")?(c.active.open=!1,"mid"!=c.type||c.midrolls[c.midrollIndex].key?c[c.type]&&!c[c.type].key&&(c[c.type]=!1):c.midrolls.splice(c.midrollIndex,1),!0):!1:(c.active.open=!1,!0)},c.deleteBreak=function(){n["delete"]({adbreak_key:c.active.key}).then(function(a){c.active.open=!1,"pre"==c.type||"post"==c.type?c[c.type]=!1:c.midrolls.splice(c.midrollIndex,1),c.scheduleChange||(c.unsavedChanges=!1),c.schedule.adbreaks=_.reject(c.schedule.adbreaks,function(a){return a.key==c.active.key})},function(){c.handleNotification("There was an error in deleting this Ad Break","failed")})};var w=function(){var a=!1;return c.midrolls.forEach(function(b){b.key!=c.active.key&&b.offset==c.active.offset&&b.percent==c.active.percent&&(a=!0)}),a};c.saveBreak=function(){var a={name:c.active.name};if(a.adtag_keys=x(),c.active.skip?a.skipoffset=c.active.skipoffset:(a.skipoffset=0,c.active.skipoffset=null),c.check){if("pre"!=c.type&&"post"!=c.type)if(a.adbreak_type=c.active.nonLinear?"nonlinear":"linear",c.active.offset!=c.check.offset||"percent"==c.breakTiming){if(a.offset=c.active.offset,"percent"==c.breakTiming&&(a.offset+="%",c.active.percent=!0,c.active.label="%"),w())return void(c.duplicateBreaktiming=!0);c.duplicateBreaktiming=!1}else if(c.check.percent!=c.active.percent){if(a.offset=c.active.offset,w())return void(c.duplicateBreaktiming=!0);c.duplicateBreaktiming=!1}a.adbreak_key=c.active.key,n.update(a).then(function(a){c.active.open=!1,c.duplicateBreaktiming=!1,"pre"==c.type||"post"==c.type?c[c.type]=c.active:c.midrolls[c.midrollIndex]=c.active,c.handleNotification("Ad break successfully saved ","success")})["catch"](function(){c.handleNotification("There was an error in saving this ad break","failed")})}else{if("pre"==c.type||"post"==c.type)a.offset=c.type;else{if(a.offset=c.active.offset,a.adbreak_type=c.active.nonLinear?"nonlinear":"linear","percent"==c.breakTiming&&(a.offset+="%",c.active.percent=!0,c.active.label="%"),w())return void(c.duplicateBreaktiming=!0);c.duplicateBreaktiming=!1}a.schedule_key=c.schedule.key,n.create(a).then(function(a){c.active.open=!1,"pre"==c.type||"post"==c.type?(c[c.type]=c.active,c[c.type].key=a.adbreak.key,c[c.type].offset=c.type):(c.midrolls[c.midrollIndex]=c.active,c.midrolls[c.midrollIndex].key=a.adbreak.key),c.schedule.adbreaks.push(c.active),c.handleNotification("Ad break successfully saved ","success")},function(a){c.handleNotification("There was an error in saving this ad break","failed")})}c.scheduleChange||(c.unsavedChanges=!1)};var x=function(){var a=[];return c.active.tags.forEach(function(b){b.key?a.push(b.key):o.create({name:b.name,url:b.url}).then(function(b){a.push(b.adtag.key)})}),a.join(",")};c.deleteTag=function(a){c.unsavedChanges=!0,c.breakChange=!0,1==c.active.tags.length&&(c.active.tags[0]={}),c.active.tags=_.reject(c.active.tags,function(b){return a==b})},c.saveNewTag=function(a){return a.name&&a.name.length&&a.url&&a.url.length?(a.error=!1,a.tagSaving=!0,void o.create({name:a.name,url:a.url}).then(function(b){a.key=b.adtag.key,a["new"]=!1,a.tagSaving=!1,a.tagSaved=!0,c.unsavedChanges=!0,c.breakChange=!0,f(function(){a.tagSaved=!1},3e3),c.handleNotification("Ad tag successfully saved","success"),c.adtags.push(a)},function(b){a.error=!0,c.handleNotification("There was an error in saving this ad tag","failed")})):void(a.error=!0)},c.validBreak=function(){return c.invalidBreakTiming="mid"==c.type&&"seconds"==c.breakTiming&&!/^\d+(\.\d+)?$/.test(c.active.offset)||"percent"==c.breakTiming&&!/^\d(\d)?$/.test(c.active.offset)&&"100"!=c.active.offset||"timecode"==c.breakTiming&&!/^\d+:\d+\:\d+(\.\d+)?$/.test(c.active.offset),!c.invalidBreakTiming&&c.active.name.length},c.validTags=function(){return _.all(c.active.tags,function(a){return a.key&&!a.error&&a.name&&a.url})},c.setActive=function(a,b){var d=c.active.tags.indexOf(a);c.active.tags[d]=b,c.unsavedChanges=!0,c.breakChange=!0},c.toggleSkip=function(){c.unsavedChanges=!0,c.breakChange=!0},c.moveTags=function(){c.unsavedChanges=!0,c.breakChange=!0},c.validateInt=function(){c.invalidSkip=isNaN(""+c.active.skipoffset),c.active.skipoffset||(c.invalidSkip=!0),c.active.skipoffset>99&&(c.invalidSkip=!0)},c.openPrePostroll=function(a){c.active&&c.active.open&&!c.closeBreak()||(c.scheduleChange||(c.unsavedChanges=!1),c.invalidBreakTiming=!1,c.duplicateBreaktiming=!1,c.invalidSkip=!1,c.breakChange=!1,c.type=a,!c[c.type]||_.isEqual(c[c.type],{})?(m.ga("send","event","Ads Section","Click Add "+("pre"==a?"Preroll":"Postroll")),c.active={name:"Untitled "+a+"roll",tags:[{}],skipoffset:5,skip:!1,open:!0},c.check=!1,c[c.type]={}):n.show({adbreak_key:c[c.type].key}).then(function(a){c[c.type].tags=a.adbreak.adtags,c[c.type].open=!0,c[c.type].skipoffset?c[c.type].skip=!0:c[c.type].skipoffset=5,c.active=angular.copy(c[c.type]),c.check=angular.copy(c[c.type])},function(){c.handleNotification("There was an error in loading this ad break","failed")}))},c.addMidroll=function(){c.active&&c.active.open&&!c.closeBreak()||(c.scheduleChange||(c.unsavedChanges=!1),m.ga("send","event","Ads Section","Click Add Midroll"),c.breakChange=!1,c.breakTiming="seconds",c.midrollIndex=c.midrolls.length,c.type="mid",c.editingBreak={label:"sec"},c.midrolls.push(c.editingBreak),c.active={name:"Midroll #"+(c.midrollIndex+1),tags:[{}],skipoffset:5,skip:!1,open:!0,offset:20,label:"sec"},c.check=!1)},c.breakNameChange=function(){c.breakChange=!0,c.unsavedChanges=!0},c.openMidroll=function(a){c.active&&c.active.open&&!c.closeBreak()||(c.scheduleChange||(c.unsavedChanges=!1),c.invalidBreakTiming=!1,c.duplicateBreaktiming=!1,c.invalidSkip=!1,c.breakChange=!1,"%"==(a.offset+"").slice(-1)||a.percent?(c.breakTiming="percent",a.label="%",a.percent||(a.offset=(a.offset+"").slice(0,-1),a.percent=!0)):(a.offset+"").split(":").length>1?c.breakTiming="timecode":(c.breakTiming="seconds",a.label="sec"),c.type="mid",c.midrollIndex=c.midrolls.indexOf(a),n.show({adbreak_key:a.key}).then(function(b){a.nonLinear="nonlinear"==b.adbreak.adbreak_type,a.tags=b.adbreak.adtags,a.open=!0,a.skipoffset?a.skip=!0:a.skipoffset=5,c.active=angular.copy(a),c.check=angular.copy(a),c.editingBreak=a})["catch"](function(){c.handleNotification("There was an error in loading this Ad Break","failed");
}))},c.submitHandler=function(){return!1},c.close=function(){b.url("/ads/list")}}])}(),function(){"use strict";angular.module("DashboardApp").controller("ContentDetailController",["$document","$location","$modal","$q","$scope","$timeout","$window","$filter","ConfigService","Templates","ThumbnailService","VirtualTagService","VirtualVideoService",function(a,b,c,d,e,f,g,h,i,j,k,l,m){function n(a){e.apiError=!1,g.confirm("Are you sure you want to delete this content?")&&(e.removePublishModeContent(a),m["delete"](a,function(){b.url("/content/list")})["catch"](o))}function o(a,b,c,d){var f="The API returned an error while saving your changes: ";f+=a&&a.message?a.message:"Undefined Error.",a&&"parameterinvalid"!=a.code.toLowerCase()&&(f+=" Please try again and contact us if the problem persists."),e.handleNotification(f,"failed")}function p(){e.poster={url:D,status:"ready",style:{}}}function q(){b.url("/content/list")}function r(){var a=b.search();return a.key&&8==a.key.length?(e.poster={url:v(w(a.key)),status:"ready",style:{}},void("key"in b.search()&&m.show(a.key,function(a){e.video=a,e.updateVideoDetails(a);var b=new Date(1e3*e.video.date);e.localTime=b.toLocaleTimeString(),e.localDate=h("date")(b,"mediumDate"),e.videoDate=h("date")(1e3*e.video.date,"mediumDate","UTC"),e.videoTime=h("date")(1e3*e.video.date,"HH:mm:ss","UTC"),e.video.expires_date&&(e.enableEndDate=!0,e.endDate=h("date")(1e3*e.video.expires_date,"mediumDate","UTC"),e.endTime=h("date")(1e3*e.video.expires_date,"HH:mm:ss","UTC")),s(),e.$emit("viewLoaded")},function(){e.$emit("viewError")}))):e.$emit("viewError")}function s(){G.test(e.videoProperties.title)&&f(function(){a[0].getElementById("video-title").select()})}function t(){e.apiError=!1,J(),e.unsavedChanges.tags&&l.resetCache(),m.update(e.video,e.videoProperties,function(){K(),e.updateVideoDetails(e.videoProperties),e.hasUnsavedChanges=!1,e.unsavedChanges={tags:!1,metadata:!1,sources:!1},e.handleNotification("Video successfully saved","success"),m.show(e.video.key,function(a){e.updatePublishModeContent(a)},angular.noop)},function(a){e.handleNotification("One or more errors in the content configuration.","failed")})}function u(){e.apiError=!1,c.open({templateUrl:j.path("modals/upload-poster"),controller:"UploadPosterController",scope:e}).result.then(function(a){e.handleNotification("Successfully uploaded poster","success"),I=a,A()})["catch"](function(a){e.handleNotification("Poster upload failed","failed")})}function v(a){return a+"?"+(new Date).getTime()}function w(a){return e.contentUrl+"/thumbs/"+a+"-320.jpg"}function x(){"audio"==e.video.mediatype?(e.poster.url=i.get("audioPosterLocation"),e.poster.style={}):(e.poster.url=D,e.poster.style={}),e.posterWrapperStyle={}}function y(){e.poster.url=v(w(e.video.key)),e.poster.style={},e.posterWrapperStyle={},I={}}function z(a){if("ready"==a)y();else if("creating"==a)e.poster.url=I.thumbnailImgFile||D,e.poster.style=I.thumbnailClipping||{},e.posterWrapperStyle=I.wrapperStyle||{},f(A,C);else{if("failed"!=a&&"not-build"!=a)throw"unknown poster status!";x()}}function A(){k.show({video_key:e.video.key}).then(function(a){z(a.status),e.poster.status=a.status,e.poster.strip_status=a.strip_status},function(a){e.handleNotification("Failed to retrieve poster","failed")})}function B(){e.tabs=angular.copy(F),"url"===e.video.sourcetype?e.tabs.push({title:"sources",src:"url.html"}):(e.tabs.push({title:"tracks",src:"tracks.html"}),e.tabs.push({title:"sources",src:"sources.html"})),_.each(e.tabs,function(a){a.active=b.search().tab===a.title})}var C=15e3,D=i.get("overridePerEnvironment","baseDirectory")+i.get("unknownPosterImage"),E=3,F=[{title:"tags",src:"tags.html"},{title:"metadata",src:"metadata.html"}],G=/^.*\.\w{3,4}$/;e.tabs=angular.copy(F),e.videoProperties=null;var H={description:null,link:null,custom:{},tags:null,title:null,date:null,expires_date:""};e.unsavedChanges={tags:!1,metadata:!1,sources:!1};var I={};e.video=void 0,e.tracks=void 0,e.conversions=void 0,e.contentUrl=e.base.protocol+i.get("overridePerEnvironment","contentLocation"),e.posterThumbnailIndex=-1,e.hasUnsavedChanges=!1,e.apiError=!1,e.$watch("videoProperties",function(a,b){a!=b&&null!==b&&(e.hasUnsavedChanges=!angular.equals(a,H),e.unsavedChanges.metadata=a.description!=H.description||a.date!=H.date||a.link!=H.link||!angular.equals(a.custom,H.custom)||a.expires_date!=H.expires_date,e.unsavedChanges.tags=!angular.equals(a.tags,H.tags),"url"==e.video.sourcetype&&(e.unsavedChanges.sources=a.sourceurl!=H.sourceurl||a.sourceformat!=H.sourceformat))},!0),e.$watch("hasUnsavedChanges",function(a){e.blockExit(a)}),e.updateVideoDetails=function(a){"url"==e.video.sourcetype&&(H.sourceurl=a.sourceurl||e.video.sourceurl,H.sourceformat=a.sourceformat||e.video.sourceformat),H.date=e.video.date=a.date||Date.now()/1e3,H.expires_date=e.video.expires_date=a.expires_date||"",H.description=e.video.description=a.description||"",H.link=e.video.link=a.link||"",H.custom=e.video.custom=a.custom,e.video.tags=a.tags?_.map(a.tags.split(","),function(a){return a.trim()}):[],H.tags=_.sortBy(e.video.tags).join(","),H.title=a.title,e.videoProperties=angular.copy(H),e.publishMode.videoUrl=e.contentUrl+"/videos/"+e.video.key+".mp4",e.publishMode.imageUrl=v(e.contentUrl+"/thumbs/"+e.video.key+".jpg"),e.publishMode.keepImageUrlOnce=!0,A(),e.tabs.length<E&&B()};var J=function(){for(var a in e.videoProperties.custom)e.videoProperties["custom."+a]=e.videoProperties.custom[a];var b=_.difference(Object.keys(H.custom),Object.keys(e.videoProperties.custom));b.forEach(function(a){e.videoProperties["custom.-"+a]=""})},K=function(){e.videoProperties.custom={};for(var a in e.videoProperties)if(0===a.indexOf("custom.")){var b=e.videoProperties[a];delete e.videoProperties[a],-1==a.indexOf("custom.-")&&(e.videoProperties.custom[a.substring(7)]=b)}};e.setTabUrlParameter=function(a){b.search("tab",a.title)},e.gotoSources=function(){for(var a=0;a<e.tabs.length;a++)"sources"==e.tabs[a].title&&(e.tabs[a].active=!0)},e.close=q,e.deleteVideo=n,e.failedImgLoad=p,e.saveChanges=t,e.uploadPoster=u,r()}])}(),function(){"use strict";angular.module("DashboardApp").controller("ContentEditTrackController",["$document","$filter","$http","$interval","$location","$rootScope","$sce","$scope","$timeout","$window","BrowserService","ChunkedUploader","CommunicationService","ConfigService","ParserService","SessionService","SigningService","ThumbnailService","TrackService","TrackingService","UtilService","VirtualVideoService",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){function w(a){h.$emit("viewError")}function x(){var a={"Content-Type":"text/plain"};c({url:h.trackLink,data:"",headers:a}).then(function(a){h.captions=o.parseCaption(a.data),B(),z()})["catch"](function(a){h.$emit("viewError")})}function y(){U.clearRegions();var a;h.captions.forEach(function(b){b.InvalidTime||(a=U.addRegion({start:b.begin,end:b.end,color:"rgba(255, 255, 255, .75)",drag:!1,resize:!1}),a.end=b.end,a.cue=b,b.region=a)})}function z(){h.currentCue=0,N(0),h.videoTooLong||(U.load(h.videoLink),U.on("ready",y),U.on("ready",function(){h.videoLoading=!1}),U.on("seek",H),U.on("region-click",I),U.setVolume(0)),A()}function A(){h.invalidPresent=!1;for(var a=0;a<h.captions.length;a++)h.captions[a].CueIndex=a,h.captions[a].beginDisplay=E(h.captions[a].begin),h.captions[a].endDisplay=E(h.captions[a].end),"invalid"!==h.captions[a].beginDisplay&&"invalid"!==h.captions[a].endDisplay||(h.captions[a].InvalidTime=!0,h.invalidPresent=!0),h.captions[a].begin>Math.round(10*h.video.duration)/10&&(h.captions[a].beginDisplay="invalid",h.captions[a].InvalidTime=!0,h.invalidPresent=!0),h.captions[a].end>Math.round(10*h.video.duration)/10&&(h.captions[a].endDisplay="invalid",h.captions[a].InvalidTime=!0,h.invalidPresent=!0),h.captions[a].begin>h.captions[a].end&&(h.captions[a].InvalidTime=!0,h.invalidPresent=!0),h.captions[a].beginEdit=h.captions[a].beginDisplay,h.captions[a].endEdit=h.captions[a].endDisplay,h.captions[a].text=X(h.captions[a].text),h.captions[a].textEdit=h.captions[a].text}function B(){h.captions.sort(function(a,b){return a.begin<b.begin?-1:a.begin>b.begin?1:0})}function C(a){return Number(a)===a&&a%1===0}function D(a){return a===Number(a)&&a%1!==0}function E(a){if(!C(a)&&!D(a))return"invalid";var c=Math.floor(a/60);a%=60;var d=Math.floor(c/60);return c=Math.floor(c%60),10>a?(a=b("currency")(a,"",1),a.length>3&&(a=a.slice(1,a.length)),a="0"+a):(a=b("currency")(a,"",1),a.length>4&&(a=a.slice(1,a.length))),d>0?(10>c&&(c="0"+c),d+":"+c+":"+a):c+":"+a}function F(a,b){function c(){h.unsavedChanges=!1,e.url("/content/detail?key="+h.video.key+"&tab=tracks")}var d={video_key:h.query.video_key,label:a,kind:"captions"};s.create.and.upload(d,b).then(c,function(){h.handleNotification("There was an error with saving your new caption file","failed")})}function G(a,b){function c(){h.unsavedChanges=!1,e.url("/content/detail?key="+h.video.key+"&tab=tracks")}var d={track_key:h.track.key,label:a,update_file:!0};s.update.and.upload(d,b).then(c,function(){h.handleNotification("There was an error with saving your caption file","failed")})}function H(a){h.seeking||(h.vid.currentTime=h.vid.duration*a,P(a),O(),h.seeking=!0,h.videoTooLong||U.seekAndCenter(a),h.seekbarTime=h.vid.currentTime/h.vid.duration,i(function(){h.seeking=!1},100))}function I(a){i(function(){h.toggleEdit(a.cue),U.seekAndCenter(a.start/h.vid.duration)},100)}function J(a){h.currentRegion&&h.currentRegion.update({color:"rgba(255, 255, 255, .75)"}),a.update({color:"rgba(11, 126, 244, .75)"}),h.currentRegion=a}function K(a){a.element&&a.update({color:"rgba(255, 255, 255, .75)"}),h.currentRegion=null}function L(){var a=h.vid.currentTime/h.vid.duration;h.videoTooLong||U.seekAndCenter(a),h.seekbarTime=100*a,seekbar.style.background="-ms-linear-gradient(left, #000 0%, #000 "+100*a+"%, #d9dde6 "+100*a+"%, #d9dde6 100%)",seekbar.style.background="-moz-linear-gradient(left, #000 0%, #000 "+100*a+"%, #d9dde6 "+100*a+"%, #d9dde6 100%)",seekbar.style.background="-o-linear-gradient(left, #000 0%, #000 "+100*a+"%, #d9dde6 "+100*a+"%, #d9dde6 100%)",seekbar.style.background="-webkit-linear-gradient(left, #000 0%, #000 "+100*a+"%, #d9dde6 "+100*a+"%, #d9dde6 100%)"}function M(){var a=h.vid.currentTime*(100/h.vid.duration);P(h.vid.currentTime),O(),N(h.vid.currentTime),h.seekbarTime=a,seekbar.style.background="-ms-linear-gradient(left, #000 0%, #000 "+a+"%, #d9dde6 "+a+"%, #d9dde6 100%)",seekbar.style.background="-moz-linear-gradient(left, #000 0%, #000 "+a+"%, #d9dde6 "+a+"%, #d9dde6 100%)",seekbar.style.background="-o-linear-gradient(left, #000 0%, #000 "+a+"%, #d9dde6 "+a+"%, #d9dde6 100%)",seekbar.style.background="-webkit-linear-gradient(left, #000 0%, #000 "+a+"%, #d9dde6 "+a+"%, #d9dde6 100%)"}function N(a){var b=a-30,c=a+30;h.waveCurrent=E(a),60>c&&(c=60),c>parseFloat(h.video.duration)&&(c=parseFloat(h.video.duration),b=parseFloat(h.video.duration)-60),0>b&&(b=0),h.waveLeft=E(b),h.waveRight=E(c)}function O(){var a=86*h.currentCue;-1===h.currentCue&&(a=86*(h.captions.length-1)),Z.scrollTop=a}function P(a){var b=h.captions.length-1;if(h.captions[b]&&!h.captions[b].InvalidTime&&h.captions[b].end<a)return h.currentCaptionText=null,h.currentCue=-1,void(h.currentRegion&&(K(h.currentRegion),h.currentRegion=null));if(h.captions[0]&&h.captions[0].begin>a)return h.currentCaptionText=null,h.currentCue=-2,void(h.currentRegion&&(K(h.currentRegion),h.currentRegion=null));for(var c=h.captions.length-1;h.captions[c]&&(h.captions[c].InvalidTime||h.captions[c].end>a);){if(h.captions[c].begin<=a&&h.captions[c].end>a&&!h.captions[c].InvalidTime)return h.currentCaptionText=$(h.captions[c].text),h.currentCue=c,void(h.videoTooLong||h.captions[c].InvalidTime||J(h.captions[c].region));c--}h.currentCaptionText=null,h.currentCue=c,h.currentRegion&&(K(h.currentRegion),i(function(){h.currentRegion&&K(h.currentRegion)},10),h.currentRegion=null)}h.vid=a[0].getElementById("video-player"),t.ga("send","event","Content Section","Edit Track Page"),h.ENTER_KEYCODE=13,h.query=e.search(),h.seekbarTime=0;var Q=function(){v.show(h.query.video_key,function(b){h.video=b,h.contentUrl=h.base.protocol+n.get("overridePerEnvironment","contentLocation"),h.viLink=h.contentUrl+"/videos/"+h.video.key+".mp4",h.vidDuration=E(parseFloat(h.video.duration)),q.bulkSignContentUrls([h.viLink]).then(function(b){h.videoLink=g.trustAsResourceUrl(b[0]),h.$emit("viewLoaded"),h.video.duration>3e3&&(h.videoTooLong=!0,h.vid.addEventListener("loadedmetadata",function(){h.videoLoading=!1,h.seekbarTime=h.vid.currentTime},!1)),h.query.key?x():(i(function(){a[0].getElementById("track-label").select()}),S())})},function(){h.$emit("viewError")})},R=function(){h.videoLoading=!0,h.unsavedChanges=!1;var a=function(a){h.track=a,h.newLabel=h.track.label;var b=a.link;h.trackLink=h.base.protocol+b.address+b.path,Q()};h.query.key&&8==h.query.key.length?s.show({track_key:h.query.key}).then(a,w):(h.track={label:""},h.newLabel="Untitled Captions Track",h.unsavedChanges=!1,Q())};"Internet Explorer"===k.getBrowserName()?(h.IE=!0,h.linkBack="#/content/detail?key="+h.query.video_key+"&tab=tracks",h.$emit("viewLoaded")):R();var S=function(){h.captions=[],z()};h.$watch("vid.currentTime",function(a){h.videoLoading||(h.seeking=!0,M(a),i(function(){h.seeking=!1},100))}),h.$watch("seekbarTime",function(a){h.videoLoading||h.seeking||(h.seeking=!0,h.vid.currentTime=h.vid.duration*(a/100),L(),i(function(){h.seeking=!1},100))});var T={container:a[0].querySelector("#waveform"),waveColor:"black",progressColor:"black",cursorColor:"#FF0046",cursorWidth:3,scrollParent:!0,hideScrollbar:!0,height:60,pixelRatio:1,minPxPerSec:575/60,normalize:!0};h.isPlaying=!1;var U=Object.create(WaveSurfer);if(U.init(T),"Internet Explorer"!=k.getBrowserName()){var V=U.backend.ac.createPanner();U.backend.setFilter(V)}var W=a[0].querySelector("#panner-input");W.addEventListener("input",function(a){var b=parseInt(a.target.value),c=Math.sin(b*(Math.PI/180));U.panner.setPosition(c,0,0)});var X=function(a){return a.replace(/<br\/?>/g,"\n")};d(function(){},10),h.addNewCue=function(){if(h.newCaption.length>255)return void alert("A cue can only be 255 characters long at max.");t.ga("send","event","Content Section","Add Caption");var a=h.newCaption,b=Math.floor(10*h.vid.currentTime)/10,c=(E(b),b+3);c>h.vid.duration&&(c=h.vid.duration);var d={begin:b,end:c,text:a};if(0===h.captions.length||h.captions[h.captions.length-1].begin<b)h.captions.push(d);else if(h.captions[0].begin>b)h.captions=[d].concat(h.captions);else{var e=h.captions.slice(0,h.currentCue+1),f=h.captions.slice(h.currentCue+1,h.captions.length);e.push(d);var g=e.concat(f);h.captions=g}B(),h.newCaption="",A(),h.videoTooLong||(d.region=U.addRegion({start:d.begin,end:d.end,color:"rgba(255, 255, 255, .75)",drag:!1,resize:!1}),d.region.cue=d),h.unsavedChanges=!0},h.cancelEdit=function(){h.editCaption.beginEdit=h.editCaption.beginDisplay,h.editCaption.endEdit=h.editCaption.endDisplay,h.editCaption.textEdit=X(h.editCaption.text),h.editCaption.NextEditing=!1,h.editing=!1,h.editCaption=null},h.toggleEdit=function(a){return h.isPlaying?(h.playPause(),void i(function(){h.toggleEdit(a)},100)):(h.editing=!0,h.editCaption=a,a.NextEditing=!0,h.vid.currentTime=a.begin,void U.seekAndCenter(a.begin/h.vid.duration))},h.updateNextCue=function(a){var b=Y(a.beginEdit),c=Y(a.endEdit);if(!b&&0!==b||!c)return void alert("You must enter a valid time (X:XX:XX.X) for the time values");if(b>c)return void alert("The end time must be after the beginning");if(Math.round(10*h.vid.duration)/10<c)return void alert("The end time of the caption cannot be beyond the end time of the video");if(a.textEdit.length>255)return void alert("A cue can only be 255 characters long at max.");if(t.ga("send","event","Content Section","Save Caption"),h.editing=!1,h.editCaption=null,a.NextEditing=!1,a.begin=b,a.end=c,a.text=a.textEdit,!h.videoTooLong)if(a.InvalidTime){var d=U.addRegion({start:a.begin,end:a.end,color:"rgba(255, 255, 255, .75)",drag:!1,resize:!1});d.end=a.end,d.cue=a,a.region=d}else a.region.update({start:a.begin,end:a.end});B(),a.InvalidTime=!1,A(),P(h.vid.currentTime),h.unsavedChanges=!0};h.deleteCue=function(a){var b=h.captions.slice(0,a.CueIndex),c=h.captions.slice(a.CueIndex+1,h.captions.length);h.captions=b.concat(c),h.videoTooLong||a.InvalidTime||a.region.remove(),A(),P(h.vid.currentTime),O(),h.unsavedChanges=!0},h.handleKeyDown=function(a,b){a.keyCode==h.ENTER_KEYCODE&&(a.metaKey||a.ctrlKey)&&(b?h.updateNextCue(b):h.addNewCue())},h.labelTest=function(){0===h.newLabel.length?h.missingTitle=!0:h.newLabel!=h.track.label&&(h.unsavedChanges=!0,h.missingTitle=!1)},h.mute=function(){h.isMute?(h.vid.volume=1,h.isMute=!1):(h.vid.volume=0,h.isMute=!0)},h.playPause=function(){h.isPlaying?(h.videoTooLong||U.pause(),h.vid.pause(),h.isPlaying=!1):(h.videoTooLong||U.play(),h.vid.play(),h.isPlaying=!0)};var Y=function(a){var b=a.split(":"),c=0;return b.length<3?(c+=60*parseInt(b[0]),c+=parseFloat(b[1])):3===b.length&&(c+=3600*parseInt(b[0]),c+=60*parseInt(b[1]),c+=parseFloat(b[2])),c};h.saveAndClose=function(){var a,b=["WEBVTT\n\n"];h.captions.forEach(function(c){c.InvalidTime||(a=E(c.begin)+" --> "+E(c.end)+"\n"+c.text+"\n\n",b.push(a))}),b.push("NOTE end of file");var c=new FileReader,d=new Blob(b,{type:"text/vtt"});d.name="newCaption.vtt",c.addEventListener("loadend",function(){h.query.key?G(h.newLabel,d):F(h.newLabel,d)}),c.readAsText(d)},h.cancel=function(){e.url("/content/detail?key="+h.video.key+"&tab=tracks")},h.$watch("unsavedChanges",function(a){h.blockExit(a)});var Z=a[0].getElementById("nextCue-box"),$=function(a){return a.split("\n")}}])}(),function(){"use strict";angular.module("DashboardApp").controller("FeedDetailController",["$document","$filter","$interpolate","$interval","$location","$q","$scope","$timeout","$window","$modal","Templates","ChannelService","ConfigService","DnsMaskingService","BotrAccountService","PollingService","SigningService","TrackingService","VirtualTagService","VirtualVideoService",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){function u(){g.$emit("viewError")}var v=m.get("content","tag","autocompleteLimit"),w="{{baseURL}}/feed.{{extension}}",x=c(w);g.unsaved=!1,g.newTag="",g.newName="",g.newValue="",g.source="rss";var y=g.query=e.search(),z=function(b){g.feed=b,n.bulkDnsMaskUrls(_.map(["rss","json"],function(a){return x({baseURL:g.baseURL,extension:a,feed:g.feed})})).then(q.bulkSignContentUrls).then(function(a){g.rssFeedUrl=a[0],g.rssFeedUrl+=-1===g.rssFeedUrl.indexOf("?")?"?":"&",g.rssFeedUrl+="feed_id="+g.feed.key+"&related_video=",g.jsonFeedUrl=a[1],g.jsonFeedUrl+=-1===g.jsonFeedUrl.indexOf("?")?"?":"&",g.jsonFeedUrl+="feed_id="+g.feed.key+"&related_video="}),g.feed.tags?(g.tagArray=g.feed.tags.split(","),g.allContent=!1):(g.tagArray=[],g.allContent=!0),g.customNames=Object.keys(b.custom),g.feed.description="None"===g.feed.description?null:g.feed.description,g.feed.link="None"===g.feed.link?null:g.feed.link,g.channel=g.feed,g.newLink=g.feed.link,g.newTitle=g.feed.title,g.tagMode=g.feed.tags_mode,g.limit=g.feed.videos.max,t.list({offset:0,limit:1e3,sort:"date",sortReverse:!1,tags:g.tagArray,tagMode:g.tagMode,statuses_filter:"ready"},function(b,c){g.videoTotal=c,g.$emit("viewLoaded"),h(function(){g.query["new"]&&a[0].getElementById("label").select()})},u)};g.getMatched=function(a){var b=f.defer();return s.list({search:a,limit:v,offset:0},function(a){var c=_.chain(a).sortBy(function(a){return-a.videos}).pluck("name").reject(function(a){return _.contains(g.tagArray,a)}).value();b.resolve(c)},function(a){b.reject(a)}),b.promise},o.get().then(function(a){g.botrPropertyId=a.key})["catch"](u),g.baseURL=g.base.protocol+m.get("overridePerEnvironment","contentLocation");var A=function(){return y.key&&8==y.key.length?void l.show({channel_key:y.key}).then(z,u):g.$emit("viewError")};A(),g.checkRadio=function(a){"allContent"==a?(g.allContent=!0,g.tagArray=[]):(g.tagMode=a,g.allContent=!1),g.unsavedChanges()},g.save=function(){if(0==g.tagArray.length&&0==g.allContent){if(!i.confirm("No tags were added, so the feed will be saved with ALL content included. Save and include all content in this feed?"))return;g.allContent=!0,g.tags=!1}var a={channel_key:g.feed.key,title:g.newTitle,tags:g.tagArray.join(","),tags_mode:g.tagMode,videos_max:g.limit};g.deleteList.forEach(function(b){a["custom."+b]="delete"}),g.customNames.forEach(function(b){a["custom."+b]=g.feed.custom[b]}),C(g.channel.description)?a.description=g.channel.description:null!=g.feed.description&&(a.description=null),C(g.channel.link)?a.link=g.channel.link:null!=g.feed.link&&(a.link=""),l.update(a).then(function(){B(),g.handleNotification("Feed successfully saved","success")},function(){g.handleNotification("There was an error in updating this feed","failed")})},g.deleteFeed=function(){i.confirm("Are you sure you want to delete this feed?")&&l["delete"]({channel_key:g.feed.key}).then(function(){e.url("/feeds")},function(){g.handleNotification("There was an error in deleting this feed","failed")})};var B=function(){g.unsaved=!1;var a;a=C(g.tagArray)?g.tagArray.join(","):null,g.feed.title=g.newTitle,g.feed.tags=a,g.feed.tags_mode=g.tagMode,g.feed.videos.max=g.limit,g.feed.description=C(g.channel.description)},C=function(a){return a&&0===a.length?null:a};g.close=function(){var a;a=C(g.tagArray)?g.tagArray.join(","):null,g.unsaved?i.confirm("You have unsaved work on this page. Abandon changes?")&&e.url("/feeds"):e.url("/feeds")},g.setLimit=function(){g.invalidLimit=!1;var a=g.limit;return isNaN(parseInt(a))||parseInt(a)<1||parseInt(a)>99?(g.invalidLimit=!0,void(g.limit=g.feed.videos.max)):(g.limit=a,void g.unsavedChanges())},g.removeTag=function(a){var b=[];g.tagArray.forEach(function(c){a!=c&&b.push(c)}),g.tagArray=b,g.unsavedChanges()},g.addTag=function(){var a=g.tagSearchQuery;""!==a&&(g.tagArray.push(a),g.tagSearchQuery="",g.unsavedChanges())},g.titleChange=function(){C(g.newTitle)?g.missingTitle=!1:g.missingTitle=!0,g.unsavedChanges()},g.unsavedChanges=function(){g.unsaved=!0},g.previewFeed=function(){r.ga("send","event","Lists Section","Preview Feed"),q.bulkSignContentUrls(_.map(["rss"],function(a){return g.baseURL+"/feed.rss"})).then(function(a){j.open({templateUrl:k.path("modals/preview-feed"),controller:"PreviewFeed",scope:g,resolve:{rssUrl:function(){return D(a[0])},mediaID:function(){return g.previewMediaID}}})})};var D=function(a){var b=a;return b+=-1===b.indexOf("?")?"?":"&",b+="related_video="+g.previewMediaID+"&preview=true&property_id="+g.botrPropertyId,g.tagArray.length&&(b+="&tags="+g.tagArray.join(",")),b+="&tags_mode="+g.tagMode,b+="&max_items="+g.limit};g.deleteList=[]}])}(),function(){"use strict";angular.module("DashboardApp").controller("ContentListController",["$document","$filter","$interval","$location","$modal","$rootScope","$route","$scope","$timeout","$window","$q","BrowserService","ChunkedUploader","ConfigService","DelayService","LocalStorageService","PollingService","SessionService","Tables","Templates","TrackingService","TurboService","UrlService","UtilService","VirtualTagService","VirtualVideoService",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z){function A(){return{searchQuery:h.searchQuery,offset:(h.page-1)*s.getPageLength(),limit:s.getPageLength(),sort:h.table.sort.by,sortReverse:"date"===h.table.sort.by?!h.table.sort.reverse:h.table.sort.reverse,tags:h.selectedTags}}function B(a){return _.every(a,function(a){return _.contains(["failed","ready"],a.status)})}function C(a){var b={};_.each(a,function(a){b[a.key]=a}),_.each(h.table.rows,function(a){var c=b[a.key];c&&(a.processing=!_.contains(["failed","ready"],c.status),a.failed="failed"===c.status,"ready"!==a.status&&"ready"===c.status&&(a.posterUrl=F+"/thumbs/"+a.key+"-120.jpg",a.mediaType=N(c),a.duration=c.duration),a.status=c.status)})}var D="content manager",E="video",F=h.base.protocol+n.get("overridePerEnvironment","contentLocation");h.ENTER_KEYCODE=13,h.$emit("viewLoaded"),h.totalVideos=void 0,h.numPage=void 0,h.selectedTags=d.search().tags?d.search().tags.split(","):[],h.unselectedTags=[],h.isSuccess=h.isError=!1,h.successMessage=h.errorMessage="",h.mimetypes="Safari"==l.getBrowserName()?"":"audio/*,video/*",h.storageLimitReached=h.BotrAccount.can_store,h.previousQuery="",h.property=r.getSiteToken(),h.sites=Object.keys(r.getAccount().sites),h.table={columns:[{key:"title",sortable:!0},{key:"type"},{key:"duration",sortable:!0},{key:"date",display:"publish date",sortable:!0},{key:"content-analytics",display:"analytics"},{key:"embed"}],loading:!0,rows:[],minimumRows:function(){return s.DEFAULT_PAGE_LENGTH-!h.table.rows.length}},s.setScopePageVariables(h),s.setScopeSearchVariables(h),s.setTableSortVariables(h.table,"date");var G=n.get("content","tag","autocompleteLimit");n.get("content","tag","suggestedLimit");h.getMatched=function(a){var b=k.defer(),c=a.split(", "),d=c[c.length-1];return h.previousQuery=1==c.length?"":c[0],y.list({search:d,limit:G,offset:0},function(a){var c=_.chain(a).sortBy(function(a){return-a.videos}).pluck("name").reject(function(a){return _.contains(h.selectedTags,a)}).value();b.resolve(c)},function(a){b.reject(a)}),b.promise},h.addTag=function(a){h.searchQuery=h.previousQuery,h.selectedTags.push(a),h.dispatchSearch()},h.toggleDropdown=function(){h.showTagsDropdown=!h.showTagsDropdown},h.uploadUrl=function(){u.ga("send","event","Content Section","Add External URL"),e.open({templateUrl:t.path("modals/upload-url"),controller:"UploadUrlController",scope:h}).result.then(function(a){g.reload()})["catch"](function(a){})},h.fireAnalyticsGA=function(){u.ga("send","event","Content Section","Click View Analytics")},h.removeTag=function(a){h.selectedTags.splice(h.selectedTags.indexOf(a),1),h.selectedTags.length<4&&(h.showTagsDropdown=!1),h.dispatchSearch()},h.clearSearchResults=function(){w.removeUrlParam("page"),w.removeUrlParam("search",""),w.removeUrlParam("tags")};var H=function(a){return"url"==a.sourcetype?"External URL":"audio"==a.mediatype?"Hosted Audio":"unknown"==a.mediatype?"processing"==a.status?"Processing":"Unknown":"Hosted Video"},I=function(){return _.pluck(_.filter(h.table.rows,"selected"),"key")},J=function(){return _.filter(h.table.rows,"selected")};h.deleteVideo=function(){var a=function(){h.BotrAccount.resetInterval(),o.cancelDelayIndicator(),g.reload()},b=function(){o.cancelDelayIndicator(),h.handleNotification("There was an error in deleting these videos","failed")};if(j.confirm("Are you sure you want to delete this content?")){o.showDelayIndicator(D,E,o.DELETING);var c=J();_.each(c,function(a){h.removePublishModeContent(a)}),z.bulkDelete(c,a,b)}},h.tagVideo=function(){h.selectedKeys=I();var a=e.open({templateUrl:t.path("modals/add-tags"),controller:"AddTagsController",scope:h});a.result.then(function(a){"success"==a&&(h.handleNotification("The videos were successfully tagged","success"),y.resetCache(),z.resetCache(),g.reload())},function(a){"escape key press"!=a&&"backdrop click"!=a&&h.handleNotification("There was an error in tagging the videos","failed")})},h.searchTermsChanged=function(){return h.searchQuery!==h.searchTerms},h.dispatchSearch=function(){h.selectedTags.length>0&&u.ga("send","event","Content Section","Search","Tag",h.selectedTags.length),w.addUrlParam("tags",h.selectedTags.join(",")),w.addUrlParam("page",1),h.searchQuery.trim().length>0?w.addUrlParam("search",h.searchQuery):w.removeUrlParam("search")},h.selectFile=function(){u.ga("send","event","Content Section","Upload New Video"),a[0].getElementById("content-upload").value=null,a[0].getElementById("content-upload").click()},h.initiateUpload=function(){for(var b=function(a){a&&z.create({title:a.name,resumable:!0},function(b){h.handleNotification("The video has begun uploading","success");var c=new m(a,b.uploadUrl,b.session_id,b.link.query.key);h.blockRefresh(!0,"You have one or more uploads in progress. Refreshing will cancel them."),c.start(),h.currentUploads.push(c)},function(){h.handleNotification("There was an error in uploading this video","failed")})},c=0;c<a[0].getElementById("content-upload").files.length;++c)n.get("s3Turbo")&&a[0].getElementById("content-upload").files[c].size<5e9?K(a[0].getElementById("content-upload").files[c]):b(a[0].getElementById("content-upload").files[c])};var K=function(a){if(a){if(a.type||".flv"!==a.name.slice(-4))var b=a.type;else var b="video/x-flv";z.createTurbo(r.getAccountToken(),r.getSiteToken(),{videoType:b,title:a.name}).then(function(b){h.isError=!1,b.uploadUrl+="&AWSAccessKeyId="+b.results.link.query.AWSAccessKeyId,b.uploadUrl+="&Expires="+b.results.link.query.Expires,b.uploadUrl+="&Signature="+encodeURIComponent(b.results.link.query.Signature);var c={file:a,turbo:!0,id:b.results.media.key};v.sendVideo(b.uploadUrl,a,c,function(a){h.$apply(function(){a.progress=a.progress})}),h.blockRefresh(!0,"You have one or more uploads in progress. Refreshing will cancel them."),h.currentUploads.push(c)})["catch"](function(){h.$emit("viewError")})}},L=function(){var a=A();z.list(a,function(a,b){!a.length&&h.page>1?(h.page--,L()):(h.totalVideos=b,h.numPages=s.getNumberOfPages(b),h.table.loading=!1,h.table.rows=a,_.each(h.table.rows,function(a){a.numtags=a.tags?a.tags.split(",").length:0,a.failed="failed"===a.status,a.processing="updating"===a.status||"processing"===a.status,a.style={padding:"updating"===a.status||"processing"===a.status?"0 15px":"0px",position:"updating"===a.status||"processing"===a.status?"relative":"static",top:"updating"===a.status||"processing"===a.status?"10px":"0px"},a.posterUrl="ready"===a.status?F+"/thumbs/"+a.key+"-120.jpg":null,a.posterUrlAlt="url"===a.sourcetype?n.get("overridePerEnvironment","baseDirectory")+"images/sourceformat-url-thumb.jpg":null,a.mediaType=N(a),a.tooltip=H(a)}))},function(a){h.$emit("viewError")})},M=function(){y.list({order_by:"videos:desc",limit:5,offset:0},function(a){h.popularTags=a})},N=function(a){return"url"===a.sourcetype?"link":"unknown"===a.mediatype?"in-progress":a.mediatype},O=f.$on("upload:complete",function(a,b){h.blockRefresh(!1),g.reload()});h.selectionCount=function(){return _.countBy(h.table.rows,"selected")["true"]||0},h.isSearch=function(){return d.search().search},h.showPopularTags=function(){return h.showPop=!0,!0},h.copyToProperty=function(){h.selectedKeys=I();e.open({templateUrl:t.path("modals/copy-to-property"),controller:"CopyToProperty",scope:h,resolve:{videos:function(){return h.selectedKeys}}})},h.hidePopularTags=function(){i(function(){h.showPop=!1},100)},new q(function(){h.table&&!B(h.table.rows)&&z.list(A(),C,function(){h.$emit("viewError")})},n.get("processingContentRefreshDelay"),h).start(),h.$on("$destroy",function(){O()}),L(),M()}])}(),function(){"use strict";angular.module("DashboardApp").controller("ContentDetailMetadataController",["$scope","$filter","VirtualVideoService","ConfigService",function(a,b,c,d){function e(b){a.isKeywordOk(a.newName)?(a.videoProperties.custom[a.newName]=a.newValue,a.custom.orderedProperties.push(a.newName),a.newName="",a.newValue="",q(b),k(a.custom.orderedProperties.length-1)):a.newName?(b.newNameField.$setValidity("unique",!a.isKeywordDupe(a.newName)),b.newNameField.$setValidity("legal",a.isKeywordLegal(a.newName)),b.newNameField.$setValidity("blacklisted",!a.isKeywordBlacklisted(a.newName))):q(b)}function f(b,c){if(a.video){if("name"==c)return _.isUndefined(a.video.custom[a.custom.orderedProperties[b]]);if("value"==c)return _.isUndefined(a.video.custom[a.custom.orderedProperties[b]])||a.video.custom[a.custom.orderedProperties[b]]!=a.videoProperties.custom[a.custom.orderedProperties[b]];throw"Type error"}return!1}function g(b){return _.has(a.videoProperties.custom,b)}function h(a){var b=/^[a-zA-Z][a-zA-Z0-9\.\-\_]*$/;return a.search(b)>-1}function i(a){return r.indexOf(b("lowercase")(a))>-1}function j(a){return a&&!g(a)&&h(a)&&!i(a)}function k(a){s=a}function l(a,b,c){_.isArray(a)||(a=[a]),_.contains(a,b.which)&&k(c)}function m(b){a.custom.orderedProperties=_.reject(a.custom.orderedProperties,function(a){return a===b;
}),delete a.videoProperties.custom[b]}function n(a,b){_.isArray(a)||(a=[a]),_.contains(a,b.which)&&b.preventDefault()}function o(a){return s===a}function p(b){b?a.custom.orderedProperties=_.keys(a.videoProperties.custom):a.custom.orderedProperties=[]}function q(a){a.$setPristine(),a.newNameField.$setValidity("unique",!0),a.newNameField.$setValidity("legal",!0),a.newNameField.$setValidity("blacklisted",!0)}a.newName="",a.newValue="",a.custom={};var r=d.get("customMetadataBlacklist");a.$watchGroup(["videoDate","videoTime"],function(c,d){if(c[0]&&c[1]){var e=new Date(c[0]+" "+c[1]+" +0000");isNaN(e.getTime())||(a.videoProperties.date=e.getTime()/1e3,a.localTime=e.toLocaleTimeString(),a.localDate=b("date")(e,"mediumDate"))}}),a.$watchGroup(["endDate","endTime"],function(c){var d=new Date(c[0]+" "+c[1]+" +0000");c[0]&&c[1]&&!isNaN(d.getTime())?(a.videoProperties.expires_date=d.getTime()/1e3,a.localEndTime=d.toLocaleTimeString(),a.localEndDate=b("date")(d,"mediumDate")):(a.videoProperties&&(a.videoProperties.expires_date=""),a.localEndDate=null,a.localEndTime=null)}),a.$watch("enableEndDate",function(b){b||(a.endTime=null,a.endDate=null)}),a.$watch("video.custom",p);var s;a.addProperty=e,a.hasChanged=f,a.isKeywordDupe=g,a.isKeywordLegal=h,a.isKeywordBlacklisted=i,a.isKeywordOk=j,a.moveCursorTo=k,a.moveCursorIf=l,a.rmProperty=m,a.tabPositionIs=o,a.suppressDefault=n}])}(),function(){"use strict";angular.module("DashboardApp").controller("AddTagsController",["$modalInstance","$q","$scope","ConfigService","SessionService","VirtualTagService","VirtualVideoService",function(a,b,c,d,e,f,g){function h(){c.tags.added&&c.tags.added.length?f.list({related:c.tags.added.join(","),limit:j,offset:0},function(a){c.tags.related=_.reject(a,function(a){return _.contains(c.tags.added,a)})}):f.list({limit:j,offset:0},function(a){c.tags.related=_.chain(a).sortBy(function(a){return-a.videos}).pluck("name").reject(function(a){return _.contains(c.tags.added,a)}).value()})}var i=d.get("content","tag","autocompleteLimit"),j=d.get("content","tag","suggestedLimit");c.tagSearchQuery="",c.tags={added:[],matched:[],related:[]},h(),c.addTag=function(a){a&&!_.contains(c.tags.added,a)&&c.tags.added.push(a),c.tags.related=_.reject(c.tags.related,function(b){return b===a}),c.tagSearchQuery=void 0,h()},c.removeTag=function(a){c.tags.added.splice(c.tags.added.indexOf(a),1),h()},c.saveChanges=function(){function b(a){return a.trim()}var d=_.chain(c.table.rows).filter(function(a){return _.contains(c.selectedKeys,a.key)}).pluck("tags").map(function(a){return a?a.split(",").map(b):[]}).map(function(a){return _.union(a,c.tags.added).join(",")}).value();return g.bulkTagVideos(e.getSiteToken(),c.selectedKeys,d).then(function(){a.close("success")},a.dismiss)},c.getMatched=function(a){var d=b.defer();return f.list({search:a,limit:i,offset:0},function(a){var b=_.chain(a).sortBy(function(a){return-a.videos}).pluck("name").reject(function(a){return _.contains(c.tags.added,a)}).value();d.resolve(b)},function(a){d.reject(a)}),d.promise}}])}(),function(){"use strict";angular.module("DashboardApp").controller("PreviewFeed",["$modalInstance","$scope","$location","SessionService","TrackingService","ChannelService","RSSService","TimeService","rssUrl","mediaID",function(a,b,c,d,e,f,g,h,i,j){b.canTrend=d.hasFeature("feeds_beta"),b.working=!1,b.rssUrl=i,b.mediaID=j,g.get(b.rssUrl,!0).then(function(a){var c=[];a.forEach(function(a){var b={title:a.getElementsByTagName("title")[0].innerHTML},d=a.getElementsByTagName("group")[0]||a.getElementsByTagName("media:group")[0],e=d.getElementsByTagName("content")[0]||d.getElementsByTagName("media:content")[0],f=e.getAttribute("duration")||0;f=h.parseTimeToString(Math.round(parseFloat(f))),b.duration=f;var g=d.getElementsByTagName("thumbnail")[0]||d.getElementsByTagName("media:thumbnail")[0];g&&(b.source=g.getAttribute("url")),c.push(b)}),b.feedItems=c},function(){b.error=!0}),b.close=function(){a.dismiss("closed")}}])}(),function(){"use strict";angular.module("DashboardApp").controller("CopyToProperty",["$modalInstance","$scope","$location","SessionService","SiteService","TrackingService","AccountService","ConfigService","videos",function(a,b,c,d,e,f,g,h,i){b.working=!1,b.error=!1,b.videos=i,b.contentUrl="http://"+h.get("overridePerEnvironment","contentLocation"),b.table={columns:[{key:"Select All"}],rows:[]},g.getAccountSites(d.getAccountToken()).then(function(a){b.table.rows=_.reject(a.sites,function(a){return a.siteToken==d.getSiteToken()})}),b.copy=function(){var a=_.filter(b.table.rows,"selected");a.forEach(function(a){b.videos.forEach(function(c){e.copyVideo(d.getAccountToken(),d.getSiteToken(),{sourceSiteToken:d.getSiteToken(),copySiteToken:a.siteToken,videoKey:c,contentLocation:b.contentUrl})["catch"](function(a){b.error=!0})})}),b.error||b.close()},b.close=function(){a.dismiss("closed")}}])}(),function(){"use strict";angular.module("DashboardApp").controller("CreateNewPlaylist",["$modalInstance","$scope","$location","SessionService","TrackingService","ChannelService",function(a,b,c,d,e,f){b.canTrend=d.hasFeature("feeds_beta"),b.working=!1,b.$watch("type",function(){b.error=!1}),b.type="dynamic",b.create=function(){b.working=!0,e.ga("send","event","Content Section","Create "+b.type+" Playlist"),f.create({type:b.type}).then(function(c){a.dismiss("closed"),b.navigatePlaylistDetail(c,b.type,!0)},function(){b.working=!1,b.error=!0})},b.close=function(){a.dismiss("closed")},b.navigatePlaylistDetail=function(a,b){var d="/content/playlists/"+b+"_detail?key="+a.key+"&new=true";c.url(d)}}])}(),function(){"use strict";angular.module("DashboardApp").controller("UploadPosterController",["$document","$http","$location","$scope","$timeout","ConfigService","ThumbnailService",function(a,b,c,d,e,f,g){function h(){a[0].getElementById("upload").value=null,a[0].getElementById("upload").click()}function i(){return"ready"===s.strip_status}function j(){i()?b.get(x).then(function(a){d.clippings=o(a.data),d.clippings.dirty=!1,d.clippings.index=d.posterThumbnailIndex>=0?d.posterThumbnailIndex:0})["catch"](function(a){d.clippings=void 0,s.strip_status="upload-poster.js:unknown"}):d.update.mode="upload",d.thumbstripImgFile=w}function k(b){g.update({video_key:r.key,thumbnail_index:1+parseInt(b)}).then(function(b){var c=a[0].getElementById("posterImage"),e=c.parentElement,f=a[0].getElementById("posterWrapper"),g=d.clippings[d.clippings.index],h=f.clientWidth,i=h*e.clientHeight/e.clientWidth,j=h/e.clientWidth,k=i/e.clientHeight;g.position="absolute",g.width=c.clientWidth*j+"px",g.height=c.clientHeight*k+"px",g.left=parseInt(g.left.slice(0,-2))*j+"px",g.top=parseInt(g.top.slice(0,-2))*k+"px",d.$close({thumbnailImgFile:w,thumbnailClipping:g,wrapperStyle:{height:i+"px"}})},function(a){})}function l(){d.busy=!0,n()||d.flash()}function m(){var b=a[0].getElementById("upload").files[0];b&&p(b)}function n(){var b=a[0].getElementById("upload").files[0];return b&&g.create(b,r.key).then(function(a){d.busy=!1,d.$close({thumbnailImgFile:d.posterDataUri,thumbnailClipping:{}})},function(a){d.busy=!1}),!!b}function o(a){return _.chain(a.split("\n")).filter(function(a){return t.test(a)}).map(function(a){var b=t.exec(a);return d.posterSize={width:b[3]+"px",height:b[4]+"px"},{left:-1*b[1]+"px",top:-1*b[2]+"px"}}).value()}function p(a){var b=new FileReader;d.$apply(function(){d.busy=!0}),b.onloadend=function(){d.$apply(function(){d.posterDataUri=b.result,d.busy=!1})},b.readAsDataURL(a)}function q(a){return(y.width-y.pad)*parseInt(a)/d.clippings.length}d.$on("$routeChangeStart",d.$dismiss),d.busy=!1,d.update={mode:"select"};var r=d.video,s=d.poster,t=/#xywh=(\d+),(\d+),(\d+),(\d+)/,u=d.base.protocol+f.get("overridePerEnvironment","contentLocation")+"/strips/"+r.key,v="320",w=u+"-"+v+".jpg?cachebuster="+(new Date).getTime(),x=u+"-"+v+".vtt?cachebuster="+(new Date).getTime();d.rail={pad:16,width:480,height:74,tie:{width:8,height:32},marker:{width:8,height:40},triangle:{width:12,height:8,spacing:4},text:{width:52,height:14}};var y=d.rail;y.marker.y=y.height-y.text.height-y.marker.height,y.tie.y=y.marker.y+.5*(y.marker.height-y.tie.height),d.getTieX=function(a){return y.pad+q(a)-.5*y.tie.width},d.getMarkerX=function(a){return y.pad+q(a)-.5*y.marker.width},d.getMarkerTextX=function(a){if(a>d.clippings.length/2){var b=document.getElementById("thumbnailTime").offsetWidth;return d.getMarkerX(a)-(1.5*y.triangle.spacing+b)}return d.getMarkerX(a)+y.marker.width+1.5*y.triangle.spacing},d.getMarkerTriangle=function(a){var b=y.pad+q(a),c=y.marker.y-y.triangle.spacing,d="";return d+=b+","+c+" ",b+=y.triangle.width/2,c-=y.triangle.height,d+=b+","+c+" ",b-=y.triangle.width,d+=b+","+c+" "},d.browsePoster=m,d.hasThumbstripReady=i(),d.initiateUpload=h,d.saveThumbnailIndex=k,d.saveUploadImage=l,d.uploadPoster=n,j()}])}(),function(){"use strict";angular.module("DashboardApp").controller("UploadsProgressModal",["$document","$modalInstance","$rootScope","$scope","TrackingService",function(a,b,c,d,e){d.hasError=!1,d.togglePause=function(a){a.paused?a.start():(e.ga("send","event","Content Section","Pause Upload"),a.pause()),d.buttonText=f()?"Resume All":"Pause All"},d.cancel=function(a){a.pause();for(var b=0;b<d.currentUploads.length;++b)if(d.currentUploads[b].id==a.id){d.currentUploads.splice(b,1);break}d.buttonText=f()?"Resume All":"Pause All",d.blockRefresh(!1),c.$broadcast("upload:cancel",a.id)};var f=function(){return _.all(d.currentUploads,function(a){return a.paused||a.isCompleted})},g=function(a,b){d.buttonText=f()?"Resume All":"Pause All",_.all(d.currentUploads,function(a){return a.errored})&&(d.buttonText="Clear All"),_.some(d.currentUploads,function(a){return a.errored})?d.hasError=!0:d.hasError=!1};c.$on("upload:complete",g),c.$on("upload:error",g),d.buttonText=_.all(d.currentUploads,function(a){return a.errored})?"Clear All":_.all(d.currentUploads,function(a){return a.paused})?"Resume All":"Pause All",d.toggleAll=function(){var a;"Clear All"==d.buttonText?(d.currentUploads.splice(0,d.currentUploads.length),d.uploadErrors.anyErrors=!1,d.uploadErrors.numErrors=0,d.allCompleted=!1):"Pause All"==d.buttonText?(e.ga("send","event","Content Section","Pause Upload"),a="pause",d.buttonText="Resume All"):"Resume All"==d.buttonText&&(a="start",d.buttonText="Pause All");for(var b=0;b<d.currentUploads.length;++b)a&&d.currentUploads[b][a]()},d.$watch("currentUploads.length",function(a,c){0===a&&a!=c&&b.close("success")})}])}(),function(){"use strict";function a(a,b,c){a&&a.$dirty&&(a.$setValidity("protocol",c.isSupportedProtocol()),b&&b.$setAttempted(!0))}var b=[{status:"required",message:"Your URL is required"},{status:"pattern",message:"Your input is not recognized as a URL"},{status:"protocol",message:"Protocol is not supported"}],c="aac",d="flv",e="m3u8",f="mp3",g="mp4",h="rtmp",i="smil",j="vorbis",k="webm",l="mpd",m="",n="http",o="https",p="rtmpe",q="rtmps",r="rtmpt",s="rtmpte",t=/^(([0-9]+|\w+|\.|\+|\-)+:)?\/?\/?(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/;angular.module("DashboardApp").factory("UrlVideoObject",["$rootScope","VirtualVideoService",function(a,u){function v(b,c,d,e){var f=this,g=a.$new();f.sourceurl=b||"",f.sourceformat=c||"",f.title=d||"",f.key=e,g.$watch(function(){return f.sourceurl},function(a){c?(f.sourceformat=c,c=void 0):f.sourceformat=a?w(a):"",d?(f.title=d,d=void 0):f.title=a?x(a):"Untitled"})}function w(a){var b=a.split("?"),c=b[0].split("."),d=c[0].substring(0,c[0].indexOf(":")),e=c[c.length-1].toLowerCase(),f=_.filter(v.supportedFiletypes,function(a){return _.contains(a.extensions,e)||_.contains(a.extensions,d)});return f=f.length>1?_.find(f,function(a){return _.contains(a.extensions,d)}):f[0],f?f.value:"mp4"}function x(a){var b=a.split("?"),c=b[0].split("/"),d=c[c.length-1];return d}return v.prototype={isSupportedProtocol:function(){return _.contains(v.supportedProtocols,this.protocol())},protocol:function(){return this.sourceurl?0===this.sourceurl.indexOf("//")?m:this.sourceurl.split(":")[0]:null},save:function(){var a=this;return this.key?u.updateExternal(this.key,this.sourceurl,this.sourceformat,this.title):u.createExternal(this.sourceurl,this.sourceformat,this.title).then(function(b){return a.key=b.key,b})},upload:function(){var a=this;return u.create({title:this.title,download_url:this.sourceurl}).then(function(b){return a.key=b.key,b})}},v.supportedFiletypes=[{value:c,label:"AAC",extensions:["aac","m4a","f4a"]},{value:d,label:"FLV",extensions:["flv"]},{value:e,label:"M3U8",extensions:["m3u","m3u8"]},{value:f,label:"MP3",extensions:["mp3"]},{value:g,label:"MP4",extensions:["mp4","m4v","f4v","mov"]},{value:h,label:"RTMP",extensions:["rtmp","rtmpt","rtmpe","rtmpte"]},{value:i,label:"SMIL",extensions:["smil"]},{value:j,label:"Vorbis",extensions:["ogg","oga"]},{value:k,label:"WebM",extensions:["webm"]},{value:l,label:"MPD",extensions:["mpd"]}],v.supportedProtocols=[m,n,o,h,p,q,r,s],v.urlHelpMessages=b,v.prototype.URL_REGEXP=t,v}]),angular.module("DashboardApp").controller("UploadUrlController",["$q","$scope","TrackingService","UrlVideoObject",function(c,d,e,f){function g(){d.supportedFiletypes=f.supportedFiletypes,d.urlHelpMessages=b,d.urlVideoObjects=[new f],d.messageError="",d.messageSuccess="",d.newUrlVideoObject=h,d.submitUploadUrlForm=i,d.updateState=a}function h(){d.urlVideoObjects.push(new f)}function i(){return e.ga("send","event","Content Section","Add External URL"),d.urlVideoObjects.length>1&&""===d.urlVideoObjects[d.urlVideoObjects.length-1].sourceurl&&d.urlVideoObjects.splice(d.urlVideoObjects.length-1,1),c.all(_.map(d.urlVideoObjects,function(a){return a.save()})).then(function(){d.messageSuccess="URLs saved",d.$close()},function(){d.messageError="At least one URL failed to save"})}d.$on("$routeChangeStart",d.$dismiss),g()}]),angular.module("DashboardApp").controller("EditUrlController",["$scope","UrlVideoObject",function(c,d){function e(){c.supportedFiletypes=d.supportedFiletypes,c.urlHelpMessages=b,c.urlVideoObject=new d(c.videoProperties.sourceurl,c.video.sourceformat,c.video.title,c.video.key),c.$watch("urlVideoObject.sourceurl",function(a){c.videoProperties.sourceurl=a}),c.$watch("urlVideoObject.sourceformat",function(a){c.videoProperties.sourceformat=a}),c.messageError="",c.messageSuccess="",c.submitEditUrlForm=f,c.updateState=a}function f(){return c.urlVideoObject.save().then(function(){c.messageSuccess="URL saved"},function(){c.messageError="URL failed to save"})}e()}])}(),function(){"use strict";angular.module("DashboardApp").controller("ContentPlaylistsController",["$interval","$location","$scope","$window","$modal","ChannelService","PollingService","Tables","TrackingService","UrlService","SessionService","Templates",function(a,b,c,d,e,f,g,h,i,j,k,l){function m(){c.$emit("viewError")}c.$emit("viewLoaded");var n=b.search();c.searchQuery=n.search?n.search:null,c.searchTerms=b.search().search||"",c.orderedBy=n.order?n.order:null,c.property=k.getSiteToken(),c.table={columns:[{key:"title",sortable:!0},{key:"type",sortable:!0},{key:"embed"}],loading:!0,rows:[],minimumRows:function(){return h.DEFAULT_PAGE_LENGTH-!c.table.rows.length}},h.setScopePageVariables(c),h.setTableSortVariables(c.table,"title");var o=function(a){c.totalPlaylists=a.total,c.numPages=h.getNumberOfPages(c.totalPlaylists),c.table.rows=a.channels,c.table.rows.forEach(function(a){a.items=a.videos.total}),c.table.loading=!1},p=function(){var a={result_offset:(c.page-1)*h.getPageLength(),result_limit:h.getPageLength(),types_filter:"dynamic,manual,trending"};c.searchQuery&&(a.search=c.searchQuery),a.order_by=c.table.sort.by+(c.table.sort.reverse?":desc":":asc"),f.list(a).then(o,m),c.table.loading=!0};p(),c.selectionCount=function(){return _.countBy(c.table.rows,"selected")["true"]||0},c.isSearch=function(){return b.search().search},c.openPlaylistModal=function(){e.open({templateUrl:l.path("modals/create-playlist"),controller:"CreateNewPlaylist",scope:c})},c.searchPlaylist=function(){j.addUrlParam("page",1),c.searchQuery.trim().length>0?j.addUrlParam("search",c.searchQuery):j.removeUrlParam("search")},c.navigatePlaylistDetail=function(a,d,e){var f="/content/playlists/"+d+"_detail?property="+c.property+"&key="+a.key;e&&(f+="&new=true"),b.url(f)},c.enterPublishMode=function(a){c.setPublishModeContent(a,"Playlist List"),i.ga("send","event","Publish Mode","Expand Publish Mode")},c.deleteSelectedItems=function(){var a="Playlist successfully deleted";d.confirm("Are you sure you want to delete these playlists?")&&(_.filter(c.table.rows,"selected").length>1&&(a="Playlists successfully deleted"),_.each(_.filter(c.table.rows,"selected"),function(b){f["delete"]({channel_key:b.key}).then(function(){c.handleNotification(a,"success"),p()},function(){c.handleNotification("There was an error deleting the playlists","failed")})}))}}])}(),function(){"use strict";angular.module("DashboardApp").controller("PlaylistMetadataController",["$scope","$filter","VirtualVideoService","ConfigService",function(a,b,c,d){var e=d.get("customMetadataBlacklist");a.isKeywordDupe=function(b){return a.playlist?_.has(a.playlist.custom,b):_.has(a.feed.custom,b)},a.isKeywordLegal=function(a){var b=/^[a-zA-Z][a-zA-Z0-9\.\-\_]*$/;return a.search(b)>-1},a.isKeywordBlacklisted=function(a){return e.indexOf(b("lowercase")(a))>-1},a.checkValidLink=function(b){b.target.classList.contains("ng-invalid")||a.unsavedChanges()},a.isKeywordOk=function(b){return b&&!a.isKeywordDupe(b)&&a.isKeywordLegal(b)&&!a.isKeywordBlacklisted(b)};var f;a.moveCursorTo=function(a){f=a},a.moveCursorIf=function(b,c,d){_.isArray(b)||(b=[b]),_.contains(b,c.which)&&a.moveCursorTo(d)},a.rmProperty=function(b){a.customNames=_.reject(a.customNames,function(a){return a===b}),a.deleteList.push("-"+b),a.playlist?delete a.playlist.custom[b]:delete a.feed.custom[b],a.unsavedChanges()},a.suppressDefault=function(a,b){_.isArray(a)||(a=[a]),_.contains(a,b.which)&&b.preventDefault()},a.tabPositionIs=function(a){return f===a},a.addProperty=function(){a.isKeywordOk(a.newName)?(a.playlist?a.playlist.custom[a.newName]=a.newValue:a.feed&&(a.feed.custom[a.newName]=a.newValue),a.customNames.push(a.newName),a.newName="",a.newValue="",a.moveCursorTo(a.customNames.length-1),a.metadataValid=!1,a.metadataUnique=!1,a.metadataBlacklisted=!1,a.unsavedChanges()):a.newName&&(a.metadataUnique=a.isKeywordDupe(a.newName),a.metadataValid=!a.isKeywordLegal(a.newName),a.metadataBlacklisted=a.isKeywordBlacklisted(a.newName))}}])}(),function(){"use strict";angular.module("DashboardApp").controller("ContentPlaylistDynamicDetailController",["$document","$filter","$interpolate","$interval","$location","$q","$scope","$timeout","$window","ChannelService","ConfigService","DnsMaskingService","TimeService","RSSService","BotrAccountService","PollingService","SigningService","TrackingService","VirtualTagService","VirtualVideoService",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){function u(){g.$emit("viewError")}function v(a){return a%1===0}var w=k.get("content","tag","autocompleteLimit"),x="{{baseURL}}/feeds/{{playlist.key}}.{{extension}}",y=c(x),z=g.query=e.search();g.unsaved=!1,g.firstPreview=!0,g.source="rss",g.sortDirections={title:{asc:"Title A-Z",desc:"Title Z-A"},date:{asc:"Older First",desc:"Most Recently Published"},views:{asc:"Least Played First",desc:"Most Played First"}};var A=function(a){r.ga("send","event","Content Section","Dynamic Playlist Detail"),g.playlist=a,"trending"==a.type&&(x="{{baseURL}}/feed.{{extension}}",y=c(x)),l.bulkDnsMaskUrls(_.map(["rss","json"],function(a){return y({baseURL:g.baseURL,extension:a,playlist:g.playlist})})).then(q.bulkSignContentUrls).then(function(b){g.rssFeedUrl=b[0],g.jsonFeedUrl=b[1],"trending"==a.type&&(g.rssFeedUrl+=-1===g.rssFeedUrl.indexOf("?")?"?":"&",g.rssFeedUrl+="feed_id="+g.playlist.key,g.jsonFeedUrl+=-1===g.jsonFeedUrl.indexOf("?")?"?":"&",g.jsonFeedUrl+="feed_id="+g.playlist.key)}),g.playlist.tags?(g.tagArray=g.playlist.tags.split(","),g.allContent=!1):(g.tagArray=[],g.allContent=!0);var b=[];if(g.tagArray.forEach(function(a){" "==a[0]&&(a=a.slice(1)),b.push(a)}),g.tagArray=b,g.customNames=Object.keys(a.custom),g.playlist.description="None"===g.playlist.description?null:g.playlist.description,g.playlist.link="None"===g.playlist.link?null:g.playlist.link,g.newLink=g.playlist.link,g.newTitle=g.playlist.title,g.channel=g.playlist,"trending"!=g.playlist.type){var d=a.sort_order.split("-");"date"!==d[0]&&"title"!==d[0]&&"views"!==d[0]&&"undefined"==typeof g.invalidSort&&(d[0]="date",g.invalidSort=!0),g.sort=d[0],g.reverse="desc"===d[1],g.direction=d[1],g.sortDirection=g.sortDirections[d[0]][d[1]]}g.tagMode=g.playlist.tags_mode,g.limit=g.playlist.videos.max;var e={offset:0,limit:1e3,sort:g.sort,sortReverse:g.reverse,tags:g.tagArray,tagMode:g.tagMode,statuses_filter:"ready"};"trending"==g.playlist.type?(e.sort="date",g.limit=g.playlist.videos.max,e.sortReverse=!0,G()):(g.firstPreview=!1,j.listVideo({channel_key:z.key,result_limit:99}).then(C,u)),t.list(e,function(a,b){g.videoTotal=b},u)};g.getMatched=function(a){var b=f.defer();return s.list({search:a,limit:w,offset:0},function(a){var c=_.chain(a).sortBy(function(a){return-a.videos}).pluck("name").reject(function(a){return _.contains(g.tagArray,a)}).value();b.resolve(c)},function(a){b.reject(a)}),b.promise};var B=f.defer();o.get().then(function(a){B.resolve(a.key)},function(){B.reject()}),g.baseURL=g.base.protocol+k.get("overridePerEnvironment","contentLocation");var C=function(a){g.playlistVideos=a,g.totalLength=0,g.playlistVideos.forEach(function(a){g.totalLength+=parseFloat(a.duration),"trending"!=g.playlist.type&&(a.timeString=m.parseTimeToString(parseFloat(a.duration)),a.ThumbUrl=g.baseURL+"/thumbs/"+a.key+"-120.jpg")}),g.totalLength=m.parseTimeToString(g.totalLength),g.$emit("viewLoaded"),g.invalidSort&&h(function(){i.alert("This playlist is using a sort option that is being phased out. Please change it to a valid sort option from the dropdown"),g.invalidSort=!1,g.unsaved=!0}),h(function(){g.query["new"]&&label.select()})},D=function(){return z.key&&8==z.key.length?void j.show({channel_key:z.key}).then(A,u):g.$emit("viewError")};D(),g.checkRadio=function(a){"allContent"==a?(g.allContent=!0,g.tagArray=[]):(g.tagMode=a,g.allContent=!1),G()},g.save=function(){if(0==g.tagArray.length&&0==g.allContent){if(!i.confirm("No tags were added, so the playlist will be saved with ALL content included. Save and include all content in this playlist?"))return;g.allContent=!0}var a={channel_key:g.playlist.key,title:g.newTitle,tags:g.tagArray.join(","),tags_mode:g.tagMode,videos_max:g.limit};"trending"!=g.playlist.type&&(a.sort_order=g.sort+"-"+g.direction),g.deleteList.forEach(function(b){a["custom."+b]="delete"}),g.customNames.forEach(function(b){a["custom."+b]=g.playlist.custom[b]}),g.channel.description&&g.channel.description.length?a.description=g.channel.description:null!=g.playlist.description&&(a.description=null),g.channel.link&&g.channel.link.length?a.link=g.channel.link:null!=g.playlist.link&&(a.link=""),j.update(a).then(function(){g.handleNotification("Playlist successfully saved","success"),E()},function(){g.handleNotification("Changes have failed to save","failed")})},g.deletePlaylist=function(){i.confirm("Are you sure you want to delete this playlist?")&&j["delete"]({channel_key:g.playlist.key}).then(function(){e.url("/content/playlists")})["catch"](function(){g.handleNotification("There was an error in deleting this playlist","failed")})};var E=function(){g.unsaved=!1;var a;a=F(g.tagArray)?g.tagArray.join(","):null,g.playlist.title=g.newTitle,g.playlist.tags=a,g.playlist.tags_mode=g.tagMode,"trending"!=g.playlist.type&&(g.playlist.sort_order=g.sort+"-"+g.direction),g.playlist.videos.max=g.limit,g.playlist.description=F(g.channel.description),g.playlist.link=F(g.channel.link)},F=function(a){return a&&a.length?a:null};g.close=function(){var a;a=F(g.tagArray)?g.tagArray.join(","):null,g.unsaved?i.confirm("You have unsaved work on this page. Abandon changes?")&&e.url("/content/playlists"):e.url("/content/playlists")},g.setLimit=function(){return g.invalidLimit=!1,!v(g.limit)||parseInt(g.limit)<1||parseInt(g.limit)>99?(g.invalidLimit=!0,void(g.limit=g.playlist.videos.max)):void G()},g.removeTag=function(a){var b=[];g.tagArray.forEach(function(c){a!=c&&b.push(c)}),g.tagArray=b,G()},g.setSort=function(a,b){g.sort=a,g.reverse="desc"===b,g.direction=b,g.sortDirection=g.sortDirections[a][b],G()},g.addTag=function(){""!==g.tagSearchQuery&&(g.tagArray.push(g.tagSearchQuery),g.tagSearchQuery="",G())},g.titleChange=function(){F(g.newTitle)?g.missingTitle=!1:g.missingTitle=!0,g.unsavedChanges()},g.unsavedChanges=function(){g.unsaved=!0};var G=function(){if(g.firstPreview||g.unsavedChanges(),"trending"!=g.playlist.type){var a={offset:0,limit:g.limit,sort:g.sort,sortReverse:g.reverse,tags:g.tagArray,tagMode:g.tagMode,statuses_filter:"ready"};t.list(a,function(a){C(a)},u),a.limit=1e3,t.list(a,function(a,b){g.videoTotal=b},u)}else{f.all([q.bulkSignContentUrls(_.map(["rss"],function(a){return g.baseURL+"/feed.rss"})),B.promise]).then(function(a){var b=a[0],c=a[1];n.get(H(b[0],c),!0).then(function(a){g.totalLength=0;var b=[];a.forEach(function(a){var c={title:a.getElementsByTagName("title")[0].innerHTML},d=a.getElementsByTagName("group")[0]||a.getElementsByTagName("media:group")[0],e=d.getElementsByTagName("content")[0]||d.getElementsByTagName("media:content")[0],f=e.getAttribute("duration")||0;g.totalLength+=parseFloat(f),f=m.parseTimeToString(Math.round(parseFloat(f))),c.timeString=f;var h=d.getElementsByTagName("thumbnail")[0]||d.getElementsByTagName("media:thumbnail")[0];h&&(c.ThumbUrl=h.getAttribute("url")),b.push(c)}),g.totalLength=m.parseTimeToString(Math.round(g.totalLength)),g.playlistVideos=b},u)});var a={offset:0,limit:1e3,sort:"date",sortReverse:!0,tags:g.tagArray,tagMode:g.tagMode,statuses_filter:"ready"};t.list(a,function(a,b){g.videoTotal=b,g.$emit("viewLoaded"),h(function(){g.query["new"]&&label.select()})},u)}g.firstPreview=!1},H=function(a,b){var c=a;return c+=-1===a.indexOf("?")?"?":"&",c+="sort_order=TRENDING&preview=true&property_id="+b,g.tagArray.length&&(c+="&tags="+g.tagArray.join(",")),c+="&tags_mode="+g.tagMode,c+="&max_items="+g.limit};g.fireGA=function(a){r.ga("send","event","Content Section","Copy Playlist "+a)},g.deleteList=[]}])}(),function(){"use strict";angular.module("DashboardApp").controller("ContentPlaylistManualDetailController",["$document","$filter","$interpolate","$interval","$location","$scope","$timeout","$window","ChannelService","ConfigService","TimeService","DnsMaskingService","PollingService","SigningService","TrackingService","VirtualVideoService",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){function q(){f.$emit("viewError")}function r(a){_.each(a,function(a,b){a.__oldIndex__=b})}var s="{{baseURL}}/feeds/{{playlist.key}}.{{extension}}",t=c(s);f.unsaved=!1,f.firstSearch=!1,f.updated=!1,f.searchQuery="",f.source="rss";var u=(f.query=e.search(),function(a){o.ga("send","event","Content Section","Manual Playlist Detail"),f.playlist=a,l.bulkDnsMaskUrls(_.map(["rss","json"],function(a){return t({baseURL:f.baseURL,extension:a,playlist:f.playlist})})).then(n.bulkSignContentUrls).then(function(a){f.rssFeedUrl=a[0],f.jsonFeedUrl=a[1]}),f.customNames=Object.keys(a.custom),f.playlist.description="None"===f.playlist.description?null:f.playlist.description,f.playlist.link="None"===f.playlist.link?null:f.playlist.link,f.channel=f.playlist,f.newTitle=f.playlist.title,f.newLink=f.playlist.link,p.list({offset:0,limit:5,sort:"date",sortReverse:!0,statuses_filter:"ready"},function(a,b){var c=[];a.forEach(function(a){a.timeString=k.parseTimeToString(parseFloat(a.duration)),a.ThumbUrl=f.baseURL+"/thumbs/"+a.key+"-120.jpg",x(a)&&(a["new"]=!0,c.push(a))}),f.latestContent=c,f.searchVideos=c,f.$emit("viewLoaded"),g(function(){f.query["new"]&&label.select()})},q)});f.baseURL=f.base.protocol+j.get("overridePerEnvironment","contentLocation");var v=function(a){f.playlistVideos=a,r(f.playlistVideos),f.totalLength=0,f.playlistVideos.forEach(function(a){f.totalLength+=parseFloat(a.duration),a.timeString=k.parseTimeToString(parseFloat(a.duration)),a.ThumbUrl=f.baseURL+"/thumbs/"+a.key+"-120.jpg"}),f.totalLength=k.parseTimeToString(f.totalLength)},w=function(){var a=f.query=e.search();return a.key&&8==a.key.length?(i.show({channel_key:a.key}).then(u,q),void i.listVideo({channel_key:a.key}).then(v,q)):f.$emit("viewError")};w(),f.deletePlaylist=function(){h.confirm("Are you sure you want to delete this playlist?")&&i["delete"]({channel_key:f.playlist.key}).then(function(){e.url("/content/playlists")},function(){f.handleNotification("There was an error in deleting this playlist","failed")})},f.searchFocused=function(){f.focusedSearch=!0},f.clearSearchResults=function(){f.searchQuery="",f.searchVideos=f.latestContent,f.firstSearch=!1},f.fireSearch=function(a){return a.target.blur(),f.focusedSearch=!1,f.firstSearch=!0,f.searching=!0,0===f.searchQuery.length?(f.searching=!1,f.firstSearch=!1,void(f.searchVideos=f.latestContent)):void p.list({offset:0,limit:1e3,sort:"date",sortReverse:!1,searchQuery:f.searchQuery},function(a,b){f.searching=!1;var c=[];a.forEach(function(a){a.timeString=k.parseTimeToString(parseFloat(a.duration)),a.ThumbUrl=f.baseURL+"/thumbs/"+a.key+"-120.jpg",x(a)&&(a["new"]=!0,c.push(a))}),f.searchVideos=c},function(){f.handleNotification("There was an error in fetching these videos","failed")})};var x=function(a){return"ready"==a.status};f.dragStart=function(){return f.dragging=!0,!0},f.dragEnd=function(){return f.dragging=!1,!0},f.dropComplete=function(a){f.dragging=!1;var b=a.__oldIndex__,c=_.findIndex(f.playlistVideos,function(b){return a.__oldIndex__===b.__oldIndex__});angular.isUndefined(b)?i.createVideo({channel_key:f.playlist.key,video_key:a.key,position:c}).then(function(){y(),C()},function(){f.handleNotification("There was an error in updating this playlist","failed")}):c!==b&&A(a,b,c),r(f.playlistVideos)};var y=function(){f.totalLength=0,f.playlistVideos.forEach(function(a){f.totalLength+=parseFloat(a.duration)}),f.totalLength=k.parseTimeToString(f.totalLength)};f.titleChange=function(){B(f.newTitle)?f.missingTitle=!1:f.missingTitle=!0,f.unsavedChanges()},f.unsavedChanges=function(){f.unsaved=!0};var z=function(a,b){if(1===b.length)b=[];else if(0===a)b=b.slice(1,b.length);else if(a===b.length-1)b=b.slice(0,b.length-1);else{var c=b.slice(0,a),d=b.slice(a+1,b.length);b=c.concat(d)}return b},A=function(a,b,c){i.updateVideo({channel_key:f.playlist.key,position_from:b,position_to:c}).then(function(){r(f.playlistVideos),C()},function(){f.handleNotification("There was an error in updating this playlist video","failed")})},B=function(a){return a&&a.length?a:null};f.updateChannel=function(){var a={channel_key:f.playlist.key,title:f.newTitle};f.deleteList.forEach(function(b){a["custom."+b]="delete"}),f.customNames.forEach(function(b){a["custom."+b]=f.playlist.custom[b]}),B(f.channel.description)?a.description=f.channel.description:null!=f.playlist.description&&(a.description=null),B(f.channel.link)?a.link=f.channel.link:null!=f.playlist.link&&(a.link=""),i.update(a).then(function(){f.handleNotification("Playlist successfully saved","success"),f.unsaved=!1},function(){f.handleNotification("Playlist changes failed to save","failed")})},f.deleteVideo=function(a){var b=f.playlistVideos.indexOf(a);i.deleteVideo({channel_key:f.playlist.key,position:b}).then(function(){C(),f.playlistVideos=z(b,f.playlistVideos),y(),r(f.playlistVideos)},function(){f.handleNotification("Failed to delete playlist video","failed")})};var C=function(){f.handleNotification("Playlist videos successfully saved","success")};f.close=function(){f.unsaved?h.confirm("You have unsaved work on this page. Abandon changes?")&&e.url("/content/playlists"):e.url("/content/playlists")},f.fireGA=function(a){o.ga("send","event","Content Section","Copy Playlist "+a)},f.deleteList=[]}])}(),function(){"use strict";angular.module("DashboardApp").controller("ContentDetailSourcesController",["$document","$interval","$location","$rootScope","$scope","$timeout","BrowserService","ChunkedUploader","ConfigService","DnsMaskingService","SessionService","SigningService","ThumbnailService","UtilService","VirtualVideoService",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){
e.availablePosterSizes=i.get("publish","availablePosterSizes");var p=function(){o.getConversions(k.getSiteToken(),e.video.key,function(a,b){for(var c=[],d=[],f={},h=0,i=0;i<a.length;++i){var k=a[i];if(k.dimensions=void 0===k.width||-1==k.width?"-":k.width+"x"+k.height,k.readableFileSize=n.normalizeFileSize(k.filesize),"Ready"==k.status){k.showLinks=!1;var m=k.link;f[k.key]=h,h+=1,c.push(m.protocol+"://"+m.address+m.path),d.push(m.protocol+"://"+m.address+"/thumbs/"+e.video.key+"-"+k.width+".jpg"),k.dimensions=-1==k.width?"-":k.width+"x"+k.height}}j.bulkDnsMaskUrls(c).then(l.bulkSignContentUrls).then(function(b){_.each(a,function(a){var c=f[a.key];"undefined"!=typeof c&&(a.directLink=b[c])})}),j.bulkDnsMaskUrls(d).then(function(b){_.each(a,function(a){var c=f[a.key];"undefined"!=typeof c&&(a.imageLink=b[c])})});var o=_.partition(a,function(a){return"Original"==a.template.name});e.original=o[0][0],"Safari"==g.getBrowserName()?e.mimetype="":"failed"==e.video.status?e.mimetype="audio/*,video/*":e.original&&(e.mimetype="-"==e.original.dimensions?"audio/*":"video/*"),e.sources="processing"==e.video.status||"updating"==e.video.status?[]:o[1]})},q=b(function(){if(e.video&&e.original&&"failed"!=e.video.status){var a="Queued"==e.original.status||"Ready"==e.original.status&&0===e.sources.length||_.any(e.sources,function(a){return"Queued"==a.status});a&&p()}},i.get("processingContentRefreshDelay"));e.$watch("video.key",function(a){a&&("processing"!=e.video.status&&"updating"!=e.video.status||t(),e.reupload=e.currentReuploads[e.video.key],e.currentReuploads.hasOwnProperty(e.video.key)||p())});var r,s,t=function(){r=b(function(){o.show(e.video.key,function(a){"ready"==a.status&&(e.video.status=a.status,b.cancel(r),o.resetCache(),a.error&&a.error.message?(e.sources=w,e.original=x):(p(),"updating"==e.video.status?m.update({video_key:e.video.key,thumbnail_index:1}).then(u):u())),a.status!=e.video.status&&e.updateVideoDetails(a)})},i.get("processingContentRefreshDelay"))},u=function(){s=b(function(){m.show({video_key:e.video.key}).then(function(a){"ready"==a.status&&(e.poster.url=e.base.protocol+i.get("overridePerEnvironment","contentLocation")+"/thumbs/"+e.video.key+".jpg?cachebreaker="+(new Date).getTime(),b.cancel(s))})},i.get("processingContentRefreshDelay"))},v=d.$on("upload:complete",function(a,b){e.reupload&&e.reupload.id==b&&(e.blockRefresh(!1),e.isReuploading=!1,e.video.status="updating",o.resetCache(),delete e.currentReuploads[e.video.key],t())});e.toggleLink=function(a){a.showLinks=!a.showLinks,e.sources.forEach(function(b){b!=a&&(b.showLinks=!1)})},e.clickReupload=function(){f(function(){a[0].getElementById("content-reupload").value=null,a[0].getElementById("content-reupload").click()})},e.togglePause=function(){e.reupload.paused?e.reupload.start():e.reupload.pause()};var w,x;e.cancel=function(){e.reupload.pause(),e.reupload=null,delete e.currentReuploads[e.video.key],e.isReuploading=!1,e.blockRefresh(!1),w&&x?(e.sources=w,e.original=x):p(),a[0].getElementById("content-reupload").value=""},e.initiateReupload=function(){var b=a[0].getElementById("content-reupload").files[0];b&&o.recreate(e.video.key,function(a){e.isReuploading=!0,e.blockRefresh(!0,"You have one or more uploads in progress. Refreshing will cancel them."),e.reupload=new h(b,a.uploadUrl,a.session_id,a.link.query.key),e.currentReuploads[e.video.key]=e.reupload,w=e.sources,x=e.original,e.sources=[],e.original={},e.reupload.start()})},e.$on("$destroy",function(){q&&b.cancel(q),r&&b.cancel(r),s&&b.cancel(s),v()})}])}(),function(){"use strict";angular.module("DashboardApp").controller("ContentDetailTagsController",["$q","$scope","ConfigService","SessionService","VirtualTagService",function(a,b,c,d,e){function f(){b.videoProperties.tags=_.sortBy(b.tags.added).join(","),b.tags.added&&b.tags.added.length?e.list({related:b.tags.added.join(","),limit:h,offset:0},function(a){b.tags.related=_.reject(a,function(a){return _.contains(b.tags.added,a)})}):e.list({limit:h,offset:0},function(a){b.tags.related=_.chain(a).sortBy(function(a){return-a.videos}).pluck("name").reject(function(a){return _.contains(b.tags.added,a)}).value()})}var g=c.get("content","tag","autocompleteLimit"),h=c.get("content","tag","suggestedLimit");b.tagSearchQuery="",b.tags={added:[],matched:[],related:[]},b.addTag=function(a){a&&!_.contains(b.tags.added,a)&&b.tags.added.push(a),b.tags.related=_.reject(b.tags.related,function(b){return b===a}),b.tagSearchQuery=void 0,f()},b.removeTag=function(a){b.tags.added.splice(b.tags.added.indexOf(a),1),f()},b.$watch("videoProperties.tags",function(a){a?(b.tags.added=a.split(","),f()):b.tags.added=[]}),b.getMatched=function(c){var d=a.defer();return e.list({search:c,limit:g,offset:0},function(a){var c=_.chain(a).sortBy(function(a){return-a.videos}).pluck("name").reject(function(a){return _.contains(b.tags.added,a)}).value();d.resolve(c)},function(a){d.reject(a)}),d.promise}}])}(),function(){"use strict";app.controller("ContentTagsListController",["$location","$route","$scope","$timeout","$window","DelayService","Tables","UrlService","VirtualTagService",function(a,b,c,d,e,f,g,h,i){function j(a,b){return b&&b!==a.name?void(l(b,a.name)&&!e.confirm(q)?(this.text=a.name,this.newText=a.name,this.editing=!0):n(a,b)):(this.text=a.name,void(this.newText=a.name))}function k(){var a={search:c.searchQuery,offset:(c.page-1)*g.getPageLength(),limit:g.getPageLength()};return c.table.sort.by&&("videos"===c.table.sort.by?a.order_by=c.table.sort.by+(c.table.sort.reverse?":asc,name:desc":":desc,name:asc"):a.order_by=c.table.sort.by+(c.table.sort.reverse?":desc":":asc")),a}function l(a,b){return _.chain(c.table.rows).reject(function(a){return a.name==b}).any(function(b){return b.name.toLowerCase()==a.toLowerCase()}).value()}function m(a){i.create(a,function(){b.reload()},function(a,d){a||"ItemAlreadyExists"!==d?c.handleNotification("There was an error creating this tag","failed"):(b.reload(),c.handleNotification("The tag was created successfully","success"))},function(){return{name:a.name,key:a.name+0,videos:0,playlists:0}})}function n(a,d){f.showDelayIndicator(p,o,f.UPDATING),i.update(a,{new_name:d},function(){i.resetCache(),f.cancelDelayIndicator(),c.handleNotification("The tag was successfully updated","success"),b.reload()},function(){f.cancelDelayIndicator(),c.handleNotification("There was an error updating the tag","failed")})}var o="tag",p="tag manager",q="A matching tag exists, and will be merged with this one. Are you sure you want to continue?",r="Are you sure you want to delete these tags? This action cannot be undone. The tags will no longer appear in associated videos.";c.$emit("viewLoaded"),c.numPages=1,c.totalItems=void 0,c.table={columns:[{key:"name",sortable:!0},{key:"videos",sortable:!0}],loading:!0,rows:[],minimumRows:function(){return g.DEFAULT_PAGE_LENGTH-!c.table.rows.length}},g.setScopePageVariables(c),g.setScopeSearchVariables(c),g.setTableSortVariables(c.table,"name"),i.list(k(),function(a,d){c.totalItems=d,c.numPages=g.getNumberOfPages(d),0===a.length&&c.page>1&&""===c.searchTerms.trim()&&(h.removeUrlParam("page"),b.reload()),c.table.loading=!1,c.table.rows=a,_.each(c.table.rows,function(a){a.callback=_.partial(j,a)})},function(){c.$emit("viewError")}),c.selectionCount=function(){return _.countBy(c.table.rows,"selected")["true"]||0},c.isSearch=function(){return a.search().search},c.deleteTags=function(){var a=_.filter(c.table.rows,"selected");e.confirm(r)&&i.bulkDelete(a,function(){c.handleNotification("Thetags were deleted successfully","success"),b.reload()},function(){c.handleNotification("There was an error deleting the tags","failed")})},c.showDeleteTags=function(){return c.selectionCount()>0},c.searchTermsChanged=function(){return c.searchQuery!==c.searchTerms},c.dispatchSearch=function(){h.removeUrlParam("tags"),h.addUrlParam("page",1),c.searchQuery.trim().length>0?h.addUrlParam("search",c.searchQuery):h.removeUrlParam("search")},c.createTag=function(a){var b={editing:!0,name:a,playlists:0,videos:0};m(b),c.table.rows.unshift(m)},c.onEditing=function(a){c.editingTag=a}}])}(),function(){"use strict";angular.module("DashboardApp").controller("ContentDetailTracksController",["$filter","$location","$scope","$timeout","$window","ConfigService","DnsMaskingService","PollingService","ThumbnailService","TrackService","TrackingService",function(a,b,c,d,e,f,g,h,i,j,k){function l(){c.$emit("viewError")}var m=f.get("processingTrackRefreshDelay"),n=function(){function a(a){var b={showLinks:!1,directLink:c.base.protocol+f.get("overridePerEnvironment","contentLocation")+"/strips/"+c.video.key+"-120.vtt",kind:"thumbnails",status:c.poster.strip_status,label:"Thumbnails",format:"vtt",immutable:!0};g.bulkDnsMaskUrls([b.directLink]).then(function(a){b.directLink=a[0]}),c.tracks=a,c.trackTypes=["captions","chapters","metadata"];var e,h=!0;c.doneProcessing=!1,c.fileType=".vtt,.srt,.dxfp",c.tracks.forEach(function(a){a.showLinks=!1,"updating"==a.status&&(c.updatingTrack=!0,e=a.link,g.bulkDnsMaskUrls([e.protocol+"://"+e.address+e.path]).then(function(b){a.directLink=b[0]}),"captions"!=a.kind||"vtt"!=a.format&&"srt"!=a.format||(a.editable=!0)),"ready"==a.status?(e=a.link,g.bulkDnsMaskUrls([e.protocol+"://"+e.address+e.path]).then(function(b){a.directLink=b[0]}),"captions"!=a.kind||"vtt"!=a.format&&"srt"!=a.format||(a.editable=!0)):h=!1}),h&&(o.stop(),c.doneProcessing=!0,d(function(){c.updatingTrack=!1},5e3)),c.tracks=[b].concat(c.tracks)}return j.list({video_key:c.video.key}).then(a,l)},o=new h(n,m,c);c.toggleLinks=function(a){a.showLinks=!a.showLinks,c.tracks.forEach(function(b){b!=a&&(b.showLinks=!1)})},o.start(),c.initiateUpload=function(a){function b(){o.start()}if(1==a.length){var d={label:a[0].name,kind:c.uploadKind,video_key:c.video.key};j.create.and.upload(d,a[0]).then(b,l)}},c.ToggleUploadSelect=function(){c.showUploadSelect=!c.showUploadSelect},c.setUpload=function(b){c.uploadType=" UPLOAD "+a("uppercase")(b)+" TRACK ",c.uploadKind=b,c.showUploadSelect=!1},c.setUpload("captions"),c.createNew=function(){k.ga("send","event","Content Section","Create New Caption Track"),b.url("/content/edit_track?video_key="+c.video.key)},c.navigateTrackEdit=function(a){b.url("/content/edit_track?key="+a.key+"&video_key="+c.video.key)},c.deleteTrack=function(a){function b(){o.start()}e.confirm("Are you sure you want to delete this content?")&&j["delete"]({track_key:a.key}).then(b,l)}}])}(),function(){"use strict";angular.module("DashboardApp").controller("FeedsListController",["$scope","$location","$window","Tables","ChannelService","UrlService","TrackingService",function(a,b,c,d,e,f,g){function h(){a.feeds.loading=!0;var b={types_filter:"feed",result_offset:(a.page-1)*d.getPageLength(),result_limit:d.getPageLength(),order_by:a.feeds.sort.by+(a.feeds.sort.reverse?":desc":":asc")};a.searchQuery&&(b.search=a.searchQuery),e.list(b).then(function(b){a.totalItems=b.total,a.numPages=d.getNumberOfPages(a.totalItems),a.feeds.rows=b.channels,a.feeds.loading=!1},function(){a.$emit("viewError")})}a.searchQuery=b.search().search||"",a.feeds={columns:[{key:"title",sortable:!0},{key:"type",sortable:!0}],loading:!0,rows:[],minimumRows:function(){return d.DEFAULT_PAGE_LENGTH-!a.feeds.rows.length}},d.setScopePageVariables(a),d.setTableSortVariables(a.feeds,"title"),h(),a.searchFeeds=function(){f.addUrlParam("page",1),a.searchQuery.trim().length>0?f.addUrlParam("search",a.searchQuery):f.removeUrlParam("search")},a.addFeed=function(){g.ga("send","event","Lists Section","Generate Feed"),e.create({type:"feed"}).then(function(a){b.url("/feeds/similar_detail?key="+a.key+"&new")},function(){a.$emit("viewError")})},a.selectionCount=function(){return _.countBy(a.feeds.rows,"selected")["true"]||0},a.deleteSelectedItems=function(){if(c.confirm("Are you sure you want to delete these feeds?")){var b="Feed successfully deleted";_.filter(a.feeds.rows,"selected").length>1&&(b="Feeds successfully deleted"),_.each(_.filter(a.feeds.rows,"selected"),function(c){e["delete"]({channel_key:c.key}).then(function(){h(),a.handleNotification(b,"success")})["catch"](function(){a.handleNotification("There was an error deleting the feeds","failed")})})}},a.$emit("viewLoaded")}])}(),function(){"use strict";angular.module("DashboardApp").controller("AlertDebugController",["$scope","AlertService",function(a,b){a.alertTypes=["danger","success","warning","info"],a.alertLevels=["Page","System-Wide"],a.displayFooterAlertDebugForm=!1,a.alertMessage="Example message",a.alertType=a.alertTypes[0],a.alertLevel=a.alertLevels[0],a.createAlert=function(){"Page"==a.alertLevel?b.createPageAlert(a.alertMessage,a.alertType):"System-Wide"==a.alertLevel&&b.createSystemWideAlert(a.alertMessage,a.alertType)}}])}(),function(){"use strict";angular.module("DashboardApp").controller("DefaultController",["$scope",function(a){a.$emit("viewLoaded")}])}(),function(){"use strict";angular.module("DashboardApp").controller("DelayModalController",["$scope","item","operation","title",function(a,b,c,d){a.item=b,a.operation=c,a.title=d}])}(),function(){"use strict";angular.module("DashboardApp").controller("DelegateLoginController",["$location","$window","ConfigService",function(a,b,c){"/logout"!==a.path()&&(b.location=c.get("overridePerEnvironment","communication","delegateLogoutUrl"))}])}(),function(){"use strict";angular.module("DashboardApp").controller("FooterController",["$scope",function(a){a.thisYear=(new Date).getFullYear()}])}(),function(){"use strict";angular.module("DashboardApp").controller("HeaderController",["$location","$rootScope","$scope","$window","$interval","$http","$document","$cookies","$timeout","$filter","AuthenticationService","ConfigService","SessionService","TrackingService",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){function o(){s=new Date,f.get("/update.txt").then(function(a){var b=parseInt(a.data);b&&(q&&b>q&&(c.showRefresh=!0),q=b)})["catch"](function(){e.cancel(t)})}c.supportGroupPages=[{link:"http://support.jwplayer.com/",selected:!1,name:"Support Site"},{link:" http://developer.jwplayer.com/",selected:!1,name:"Developer Site"},{link:"http://status.jwplayer.com/",selected:!1,name:"System Status"},{link:"https://support.jwplayer.com/customer/portal/questions/new",selected:!1,name:"Ask the Forums"},{link:l.get("supportEmailUrl"),selected:!1,name:"Contact Support",hidden:!1}];var p=function(){for(var a=0;a<c.supportGroupPages.length;a++)if("Contact Support"===c.supportGroupPages[a].name){c.supportGroupPages[a].hidden=!m.hasFeature("email_support");break}};m.getUser()&&p(),b.$on("session:created",function(){p(),c.userEmail=c.user().userEmail,c.userEmail.length>35&&(c.userEmail=c.userEmail.slice(0,35)+"..."),c.userRoles=j("lowercase")(m.getAccount().userRoles.join(", "))}),c.authorized=function(){return k.isAuthorized()},c.clickSupport=function(){n.ga("send","event","Navigation Bar","Click Support Link"),d.open("http://support.jwplayer.com/customer/portal/articles/1772740-dashboard-faq")},c.getSiteToken=m.getSiteToken,c.user=m.getUser;var q,r=6e4,s=new Date,t=e(o,r);d.addEventListener("focus",function(){new Date-s>=r&&o()}),c.refresh=function(){d.location.reload(!0)},c.hideRefresh=function(){c.showRefresh=!1},c.systemNotification=l.get("systemNotification"),c.removeSystemNotification=function(){h[dismissCookie]=l.get("systemNotification","name"),c.systemNotification.active=!1,c.sendGaEvent("Navigation","Click Notification Close")},c.migrationComplete="undefined"!=typeof h.jwplatformMigrationComplete,g[0].cookie="jwplatformMigrationComplete=;expires="+(new Date).toUTCString()+";path=/;domain=jwplayer.com;",c.removeUpgradeNotification=function(){c.migrationComplete=!1};var u=function(){var a=l.get("systemNotification","expiresOnTimestamp"),b=new Date;return void 0===a?!1:(a=new Date(1e3*a),b>=a)},v=function(){var a=l.get("systemNotification","targetEntitlements");return _.contains(a,c.entitlement)},w=function(){return _.some(l.get("systemNotification","targetFeatures"),function(a){return m.hasFeature(a)})};c.showNotification=function(){var a=l.get("systemNotification","name");return h[dismissCookie]!==a&&!u()&&v()&&w()},c.clickHeaderUpgrade=function(a){return b.sendGaEventLink(a,"Upgrades","Click Stream Warning Upgrade")},c.unifiedNotification="";var x;b.handleNotification=function(a,b){i.cancel(x),c.success=!1,c.failed=!1;var e="success"==b?3e3:8e3;c[b]=!0,c.unifiedNotification=a,"failed"==b&&d.scrollTo(0,0),c.unifiedNotificationShow=!0,x=i(function(){c.unifiedNotificationShow&&(c.unifiedNotificationShow=!1)},e)},c.logout=function(){var b=_.any(c.currentUploads,function(a){return!a.errored&&!a.isCompleted}),e=_.any(Object.keys(c.currentReuploads),function(a){return!c.currentReuploads[a].errored&&!c.currentReuploads[a].isCompleted});b&&e?d.confirm("You have one or more uploads in progress. Logging out will cancel them. Are you sure you want to continue?")&&(c.blockRefresh(!1),a.url("/logout")):a.url("/logout")},b.closeNotification=function(){c.unifiedNotificationState="",c.unifiedNotificationShow=!1}}])}(),function(){"use strict";angular.module("DashboardApp").controller("LogoutController",["$cookies","$document","$location","$scope","AuthenticationService","ConfigService",function(a,b,c,d,e,f){e.clearSignature(),delete a.isAdmin,b[0].location=f.get("overridePerEnvironment","communication","delegateLogoutUrl")+"?redirect="+c.absUrl().split("#")[0]}])}(),function(){"use strict";angular.module("DashboardApp").controller("PropertyNavigationController",["$scope","SessionService",function(a,b){a.multipleSites=function(){return b.getAccount()&&Object.keys(b.getAccount().sites).length>1},a.getSiteToken=b.getSiteToken,a.getSite=b.getSite,a.account=b.getAccount(),a.hasFeature=b.hasFeature,a.sites=[];for(var c in a.account.sites)a.sites[a.sites.length]={token:c,name:a.account.sites[c].name};a.sites.sort(function(a,b){return a.name.localeCompare(b.name)})}])}(),function(){"use strict";angular.module("DashboardApp").controller("AccountNavigationController",["$location","$scope","SessionService",function(a,b,c){b.logout=function(){var c=_.any(b.currentUploads,function(a){return!a.errored&&!a.isCompleted}),d=_.any(Object.keys(b.currentReuploads),function(a){return!b.currentReuploads[a].errored&&!b.currentReuploads[a].isCompleted});c&&d?$window.confirm("You have one or more uploads in progress. Logging out will cancel them. Are you sure you want to continue?")&&(b.blockRefresh(!1),a.url("/logout")):a.url("/logout")}}])}(),function(){"use strict";angular.module("DashboardApp").controller("AssetsListController",["$document","$location","$route","$routeParams","$scope","$window","ConfigService","DelayService","LocalStorageService","PollingService","Tables","UrlService","VirtualAssetService",function(a,b,c,d,e,f,g,h,i,j,k,l,m){function n(a,b,c,d){this.id=a,this.label=b,this.description=c,this.action=d}function o(a,b){h.showDelayIndicator(t,s,h.UPDATING),m.update(a,{name:b},function(){h.cancelDelayIndicator(),c.reload()},function(){h.cancelDelayIndicator(),e.$emit("viewError")})}function p(a){return _.every(a,function(a){return"ready"===a.status})}function q(a){var b={};_.each(a,function(a){b[a.key]=a}),_.each(e.table.rows,function(a){var c=b[a.key];c&&(a.status=c.status,a.link=c.link,a.preview="ready"!==a.status?null:m.createPreviewUrl(a),a.processing="ready"!==a.status,a.type=c.type)})}function r(){return{assetType:e.activeAssetType,searchQuery:e.searchQuery,offset:(e.page-1)*k.getPageLength(),limit:k.getPageLength(),sort:e.table.sort.by,sortReverse:e.table.sort.reverse}}var s="asset",t="asset manager";e.$emit("viewLoaded");var u;e.searchQuery=b.search().search||"",e.numPages=1,e.totalItems=void 0,e.totalItemsCaption=e.activeAssetType,e.table={columns:[{key:"name",sortable:!0},{key:"type",sortable:!0},{key:"preview"}],loading:!0,rows:[],minimumRows:function(){return k.DEFAULT_PAGE_LENGTH-!e.table.rows.length}},k.setScopePageVariables(e),k.setScopeSearchVariables(e),k.setTableSortVariables(e.table,"name"),n.Id={LOGO:"logo",SCREEN:"screen"},n.prototype.click=function(){e.newMenuAction=this,i.put(this.id,"asset","newMenuAction")},n.byId={},n.byId[n.Id.LOGO]=new n(n.Id.LOGO,"Logo","Add a Logo",function(){u="watermark",e.initiateUpload()}),n.byId[n.Id.SCREEN]=new n(n.Id.SCREEN,"Screen","Add a Screen",function(){u="screen",e.initiateUpload()}),e.newMenuItems=_.values(n.byId),e.newMenuAction=n.byId[i.get("asset","newMenuAction")]||e.newMenuItems[0],m.list(r(),function(a,b){e.totalItems=b,e.totalItemsCaption=1==b?e.singularActiveAssetType:e.activeAssetType,e.numPages=k.getNumberOfPages(b),0===a.length&&e.page>1&&""===e.searchTerms.trim()&&(l.removeUrlParam("page"),c.reload()),e.table.loading=!1,e.table.rows=a,_.each(e.table.rows,function(a){a.preview=m.createPreviewUrl(a),a.callback=_.partial(o,a)})},function(){e.$emit("viewError")}),new j(function(){e.table&&!p(e.table.rows)&&m.list(r(),q,function(){e.$emit("viewError")})},g.get("processingAssetsRefreshDelay"),e).start(),e.isActiveAssetType=function(a){return a===e.activeAssetType},e.selectionCount=function(){return _.countBy(e.table.rows,"selected")["true"]||0},e.isSearch=function(){return b.search().search},e.onEditing=function(a){e.editingAsset=a},e.deleteAssets=function(){var a=_.filter(e.table.rows,"selected");f.confirm("Are you sure you want to delete these assets? This action cannot be undone. The assets will no longer appear in associated players.")&&(h.showDelayIndicator(t,s,h.DELETING),m.bulkDelete(a,function(){h.cancelDelayIndicator(),c.reload()},function(){h.cancelDelayIndicator(),e.$emit("viewError")}))},e.showDeleteAssets=function(){return!e.editingAsset&&e.selectionCount()>0},e.replaceAsset=function(){e.assetToReplace=_.find(e.table.rows,"selected"),a[0].getElementById("reupload").value=null,a[0].getElementById("reupload").click()},e.showReplaceAsset=function(){var a=_.filter(e.table.rows,"selected");return!e.editingAsset&&1===a.length&&"ready"===a[0].status},e.initiateUpload=function(){a[0].getElementById("upload").value=null,a[0].getElementById("upload").click()},e.reuploadAsset=function(){var b=a[0].getElementById("reupload").files[0];b&&(h.showDelayIndicator(t,s,h.UPLOADING),m.recreate(e.assetToReplace,{assetFile:b},function(){h.cancelDelayIndicator(),c.reload()},function(){h.cancelDelayIndicator(),e.$emit("viewError")}))},e.uploadAsset=function(){var b=a[0].getElementById("upload").files[0];b&&(h.showDelayIndicator(t,s,h.UPLOADING),m.create({assetFile:b,assetType:u},function(){h.cancelDelayIndicator(),c.reload()},function(){h.cancelDelayIndicator(),e.$emit("viewError")}))},e.searchTermsChanged=function(){return e.searchQuery!==e.searchTerms},e.dispatchSearch=function(){l.removeUrlParam("tags"),l.addUrlParam("page",1),e.searchQuery.trim().length>0?l.addUrlParam("search",e.searchQuery):l.removeUrlParam("search")}}])}(),function(){"use strict";angular.module("DashboardApp").controller("PlayerBuilderController",["$cookies","$document","$interval","$location","$q","$rootScope","$route","$scope","$timeout","$window","BotrAccountService","CORSService","CacheService","ConfigService","DelayService","ModalService","SessionService","Templates","TrackingService","VirtualAssetService","VirtualPlayerService",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){function v(){h.isLoading=!1,h.isError=!1}function w(){h.isLoading=!1,h.isError=!0}function x(){y("Update",h.models.name).then(function(){return o.showDelayIndicator("player manager","player",o.UPDATING),u.update({key:h.playerKey},{version:n.get("publish","player","defaultVersion")},function(){o.cancelDelayIndicator(),g.reload()},function(){o.cancelDelayIndicator()})})}function y(a,b){return p.open({controller:"UpdateToJwplayer7Controller",resolve:{action:_.constant(a),playerName:_.constant(b)},templateUrl:n.get("overridePerEnvironment","baseDirectory")+"templates/modals/update-to-jwplayer7.html"}).result}function z(a){h.showRelated=a.botrAccount.restrictions.downloads.allow&&A(h.models.version,a.playerManifest.data.version),h.disableRelated=!q.hasFeature("recommendations"),h.showSharingSites=A(h.models.version,a.playerManifest.data.version)}function A(a,b){return a>7||7==a&&/^7\.[2-9]/.test(b)}function B(){e.all({botrAccount:k.get(!0),player:F.promise,playerManifest:l[h.models.release_channel+"Manifest"]}).then(z,function(){h.isError=!0})}var C,D={};h.group1=!0,delete a["jwplayer.mute"];var E=h.playerName="Untitled Player";h.buttonText="Save Changes",h.setupObject={},h.$emit("viewLoaded"),h.aspectRatios=n.get("aspectRatios"),h.isLoading=!0,h.collapseView=!0,h.isDirty=!1,h.isValid=!0,h.playerReady=!1,h.url=d.absUrl(),h.defaultSkins={},h.showAdsPane=q.hasFeature("ads"),h.showCasting=q.hasFeature("chromecast"),h.showGAPane=!0,h.showSharing=!0,h.showSharingSites=!0,h.showPremiumSkins="Free"!==q.determineEntitlement(),h.showCustomLogoOptions=!0,h.showAdvanced=!0,h.accountToken=q.getAccountToken(),h.chromecastReceiverUrl=n.get("chromecastReceiverUrl"),h.PRELOAD=["auto","metadata","none"],h.RELEASE_CHANNELS=["production","staging","beta"];var F=e.defer();F.promise.then(v,w),h.accordions={},h.$watch("accordions.group5",function(a){a&&h.sendGaEvent("Player Builder","Expand Advertising Menu")}),h.$watch("accordions.group8",function(a){a&&h.sendGaEvent("Player Builder","Expand Advanced Menu")}),h.updatePlayerToLatest=function(){if(h.isDirty){if(!j.confirm("We'll save your changes before updating. Continue?"))return;h.saveChanges().then(x)}else x()};var G=[{name:"email"},{name:"facebook"},{name:"googleplus"},{name:"linkedin"},{name:"pinterest"},{name:"reddit"},{name:"tumblr"},{name:"twitter"}];h.updateSharingSites=function(){h.models.sharingSites=_.pluck(h.sharingSites,"name"),h.update()},h.dragging=!1;var H=function(){C=angular.copy(h.models),D=angular.copy(h.models),h.$broadcast("player-builder:set-defaults"),h.sharingSites=_.map(h.models.sharingSites,function(a){return _.findWhere(G,{name:a})}),h.availableSharingSites=_.filter(G,function(a){return!_.contains(h.sharingSites,a)})};"player_key"in d.search()?(h.playerKey=d.search().player_key,u.show(h.playerKey,function(a){h.models=u.deserializeConfig(a),h.$broadcast("player-builder:deserialize"),h.models.preferFlash="flash"===h.models.primary,h.models.version=a.version,h.RELEASE_CHANNELS=_.union(h.RELEASE_CHANNELS,[h.models.release_channel]),B(),h.setupObject=u.modelToEmbedObject(h.models),E=h.playerName=h.models.playerName,H(),h.generateInputModel&&h.generateInputModel()},function(){delete h.playerKey}).then(function(){return u.getDefaultSkins(q.getSiteToken(),h.models.version)}).then(function(a){F.resolve(),h.defaultSkins=a},function(a){F.reject("Unable to load player"),h.isSuccess=!1,h.errorMessage="Unable to load player - "+a})):(i(function(){if(b[0].getElementById("player-title").select(),h.hasOwnProperty("generateInputModel"))h.generateInputModel();else{var a;a=c(function(){h.hasOwnProperty("generateInputModel")&&(h.generateInputModel(),c.cancel(a))},500)}},100),h.models=u.getDefaults(),B(),h.isPreviewMode()&&d.search().version?h.models.version=d.search().version:h.models.version=n.get("publish","player","defaultVersion"),u.getDefaultSkins(q.getSiteToken(),h.models.version).then(function(a){F.resolve(),h.defaultSkins=a},function(){F.reject("Unable to create new player"),h.isSuccess=!1,h.errorMessage="Unable to load default skins list"}),h.setupObject=u.modelToEmbedObject(h.models),H());var I=function(){return!(angular.equals(C,h.models)&&E==h.playerName)};b.ready(function(){h.forms=_.map(angular.element(b[0].querySelector("[forms-validator]")).find("form"),function(a){return angular.element(a)})});var J=function(a,b){b?a.addClass("panel-error"):a.removeClass("panel-error")},K=function(){_.each(h.forms,function(a){var b=a.parent().parent().parent();a.hasClass("invalid-form")&&!b.hasClass("open")?J(b,!0):J(b,!1)})};h.switchCallback=function(){h.update()},h.toggleAnalytics=function(){h.update()},h.toggleLogo=function(){h.update()},h.toggleSharing=function(){h.models.sharing=h.models.sharingEnabled?"screen-embed":"none",h.update()},h.toggleRelated=function(){h.models.related_enabled&&"none"===h.models.related_videos&&(h.models.related_videos="show"),h.models.related_enabled&&p.open({templateUrl:r.path("modals/related-content"),size:"md"}),h.update()},h.toggleChromecast=function(){h.update()},h.resetDefaults=function(){h.isSuccess=!1,h.isError=!1,h.models=angular.copy(C),D=angular.copy(C),h.$broadcast("player-builder:reset-defaults"),h.playerName=E,h.generateInputModel(),K(),h.isDirty=!1,h.setupObject=u.modelToEmbedObject(h.models)},h.sectionChange=function(a){if(a.toElement&&"accordion-toggle"===a.toElement.classList[0]){var b=a.toElement.parentElement.parentElement.parentElement;b.classList.contains("open")?J(angular.element(b),!1):K()}},h.update=function(a){if(h.isError=!1,h.isSuccess=!1,h.$broadcast("player-builder:update"),B(),a){var b=angular.element(a.target),c=b.controller("ngModel").$modelValue,d=b.attr("ng-model").split(".").slice(1),e=_.reduce(d,function(a,b){return a[b]},D);if(c==e&&void 0!==c)return}D=angular.copy(h.models),K(),h.isDirty=I(),h.playerReady=!1,h.models.skinKey="6"==h.models.version&&"six"==h.models.skin||"seven"==h.models.skin?h.defaultSkins["default"]:h.defaultSkins[h.models.skin],h.models.primary=h.models.preferFlash?"flash":"html5",h.setupObject=u.modelToEmbedObject(h.models),h.generateInputModel&&h.generateInputModel()},h.onPlayerReady=function(){h.playerReady=!0,h.isLoading=!1},h.nameChange=function(){h.isDirty=I()},h.$watch("setupObject",function(){u.getLibraryUrl(h.playerKey).then(function(a){h.libraryUrl=a[0]})},!0),h.$watch("isDirty",function(a){h.blockExit(a)}),h.saveChanges=function(){var a=e.defer();if(h.anyInvalid)return h.handleNotification("One or more errors in player configuration","failed"),h.verifyInputModel(),K(),h.$apply(),a.reject(),a.promise;h.buttonText="Saving Player...";var b,c=function(b){h.handleNotification("Player successfully saved","success"),h.buttonText="Save Changes",b.key&&(h.playerKey=b.key,u.getLibraryUrl(h.playerKey).then(function(a){h.libraryUrl=a[0]})),E=h.playerName,H(),h.isDirty=I(),a.resolve()},d=function(){h.handleNotification("Unable to save player","failed"),h.buttonText="Save Changes",a.reject()};if(h.playerKey){h.models.playerName=h.playerName,b=u.serializeConfig(h.models,!0);var f=c;h.publishModePlayerMatches({key:h.playerKey})&&(f=function(a){u.show(h.playerKey,h.updatePublishModePlayer,angular.noop),c(a)}),u.update({key:h.playerKey},b,f,d),u.resetCache()}else h.models.playerName=h.playerName,b=u.serializeConfig(h.models,!1),b.version=h.models.version,s.ga("send","event","Players Section","Create New Player"),u.create(b,c,d);return a.promise},h.deletePlayer=function(){j.confirm("Are you sure you want to delete this player? All existing instances will be deleted and your content will not play.")&&(h.isLoading=!0,F=e.defer(),F.promise.then(v,w),h.removePublishModePlayer({key:h.playerKey}),u["delete"]({key:h.playerKey},function(){F.resolve(),h.isSuccess=!0,h.successMessage="Player successfully deleted",i(function(){d.url("/players/list")},1e3)},function(){F.reject("Unable to delete player"),h.isSuccess=!1,h.errorMessage="Unable to delete player"}))},h.keyPress=function(a){13==a.which&&(a.target.blur(),h.focused=!1)},h.close=function(){d.url("/players/list")},h.openAddNewLogoModal=function(){p.open({templateUrl:r.path("modals/add-new-logo"),controller:"AddNewLogoFormCtrl",size:"md"})}}]),angular.module("DashboardApp").controller("AddNewLogoFormCtrl",["$scope",function(a){a.submitAddNewLogoForm=function(){}}])}(),function(){"use strict";angular.module("DashboardApp").controller("PlayerBuilderAdvertisingController",["$scope","AdSchedulesService","VirtualPlayerService",function(a,b,c){a.adClientURLs={vast:[""],vmap:[""],googima:[""]},a.vpaid=["Disabled","Enabled","Insecure"],a.vpaidMode={Disabled:"none",Enabled:"enabled",Insecure:"insecure"},b.list({result_limit:1e3}).then(function(b){a.schedules=b.schedules,_.findWhere(a.schedules,{key:a.models.advertising.scheduleKey})||(a.models.advertising.scheduleKey=a.schedules.length&&_.first(a.schedules).key||"vast");
}),a.$on("player-builder:set-defaults",function(){a.adClientURLs[a.models.advertising.client]=angular.copy(_.compact(a.models.advertising.url)),a.adClientURLs[a.models.advertising.client]<1&&a.adClientURLs[a.models.advertising.client].push("")}),a.$on("player-builder:reset-defaults",function(){a.adClientURLs[a.models.advertising.client]=angular.copy(_.compact(a.models.advertising.url))}),a.$on("player-builder:update",function(){a.models.advertising.url=_.compact(a.adClientURLs[a.models.advertising.client]),a.vpaidDisplay=d(a.models.vpaid_mode)}),a.$on("player-builder:deserialize",function(){a.showAdsPane||(a.models.advertising.enabled=!1),a.vpaidDisplay=d(a.models.vpaid_mode)});var d=function(a){return"none"==a?"Disabled":a};a.setVpaid=function(b){a.models.vpaid_mode=a.vpaidMode[b],a.vpaidDisplay=b,a.update()},a.toggleAdvertising=function(){a.models.advertising.isSkipOffset=!1,a.models.advertising.isCompanion=!1,a.models.advertising.enabled&&"none"===a.models.advertising.client&&(a.models.advertising.client="vast"),a.update()},a.toggleAdClient=function(b){a.models.advertising.client=b,"googima"==b&&(a.models.advertising.isSkipOffset=!1,a.vpaidDisplay=a.vpaidDisplay||"Insecure"),a.update()},a.canAddMoreAdClientUrls=function(){return a.models&&"vast"===a.models.advertising.client&&a.adClientURLs[a.models.advertising.client].length<c.maxWaterfallUrls},a.disableAddMoreAdClientUrls=function(){return!(a.models&&_.every(a.adClientURLs[a.models.advertising.client]))},a.removeAdClientUrl=function(b){a.adClientURLs[a.models.advertising.client][b]="",a.adClientURLs[a.models.advertising.client]=_.compact(a.adClientURLs[a.models.advertising.client]),a.update()},a.addAdClientUrl=function(){a.sendGaEvent("Player Builder","Click Add Waterfall"),a.adClientURLs[a.models.advertising.client].push(""),a.update()}}])}(),function(){"use strict";angular.module("DashboardApp").controller("PlayersDownloadsController",["$interpolate","$location","$q","$scope","CacheService","ConfigService","CORSService","DnsMaskingService","SessionService","TrackingService","VirtualPlayerService",function(a,b,c,d,e,f,g,h,i,j,k){function l(a){d.table.loading=!1,d.table.rows=[{name:r,gaName:s,version:a.player7.data.version,downloadUrl:u(a.player7.data),releaseDate:new Date(a.player7.headers(q)),licenseKey:i.getPlayerLicense("7")}],d.hasAndroid=i.hasFeature("sdk")||i.hasFeature("android_sdk"),d.hasIos=i.hasFeature("sdk")||i.hasFeature("ios_sdk"),d.hasAndroid?d.table.rows.push({name:m,gaName:n,version:a.sdks.data.Android.version,downloadUrl:a.sdks.data.Android.url,releaseDate:1e3*a.sdks.data.Android.release_date,licenseKey:i.getAndroidSDKLicense(a.sdks.data.Android.version)}):(d.androidSdkVersion=a.sdks.data.Android.version,d.androidSdkReleaseDate=1e3*a.sdks.data.Android.release_date),d.hasIos?d.table.rows.push({name:o,gaName:p,version:a.sdks.data.iOS.version,downloadUrl:a.sdks.data.iOS.url,releaseDate:1e3*a.sdks.data.iOS.release_date,licenseKey:i.getIosSDKLicense(a.sdks.data.iOS.version)}):(d.iosSdkVersion=a.sdks.data.iOS.version,d.iosSdkReleaseDate=1e3*a.sdks.data.iOS.release_date)}var m="Android SDK",n="Android SDK",o="iOS SDK",p="iOS SDK",q="last-modified",r="JW Player 7 (Self-Hosted)",s="JW7",t="https://ssl.p.jwpcdn.com/player/download/jwplayer-{{version}}.zip",u=a(t);d.hasAndroid=!1,d.hasIos=!1,d.baseUrl=d.base.protocol+f.get("overridePerEnvironment","contentLocation")+"/",h.bulkDnsMaskUrls([d.baseUrl]).then(function(a){d.baseUrl=a[0]}),d.table={loading:!0,columns:[{key:"name"},{display:"license key",key:"licenseKey"},{key:"version"},{display:"released",key:"releaseDate"},{display:"download",key:"downloadUrl"}]},d.changePlayer=function(a){d.currentPlayer=a},d.sendSDKDownloadEvent=function(a,c){j.ga("send","event","Players Section","Download"+a),b.url(c)},d.sendBuildPlayerEvent=function(){j.ga("send","event","Players Section","Click Build Player")},d.sendPlayerDownloadEvent=function(a){j.ga("send","event","Players Section","Download Web Player"),b.url(a)},d.upgradeSDK=function(){j.ga("send","event","Downloads","Click SDK Upgrade")},d.copyLibraryUrl=function(){j.ga("send","event","Downloads","Copy Player Library URL")},d.$emit("viewLoaded"),k.list({offset:0,limit:1e3},function(a){d.players=a,d.currentPlayer=a[0]},function(a){d.$emit("error")}),c.all({player7:g.standaloneManifest,sdks:g.SDKMobileManifest}).then(l)}])}(),function(){"use strict";angular.module("DashboardApp").controller("PlayersListController",["$location","$route","$scope","$window","ConfigService","DelayService","ModalService","SessionService","Tables","TrackingService","UrlService","UtilService","VirtualPlayerService",function(a,b,c,d,e,f,g,h,i,j,k,l,m){c.$emit("viewLoaded");var n="player",o="player manager",p={},q=function(a,b){return p[a][b.toLowerCase()]||p[a].custom};_.each(["6","7"],function(a){p[a]={},_.each(e.get("publish","player","skins",a),function(b){p[a][b.name]=b})}),c.totalPlayers=void 0,c.numPages=void 0,c.property=h.getSiteToken(),c.defaultVersion=e.get("publish","player","defaultVersion"),c.table={columns:[{key:"name",sortable:!0},{key:"skin"},{key:"size"},{key:"version"},{key:"embed"}],loading:!0,rows:[],minimumRows:function(){return i.DEFAULT_PAGE_LENGTH-!c.table.rows.length}},i.setScopePageVariables(c),i.setScopeSearchVariables(c),i.setTableSortVariables(c.table,"name"),m.list({searchQuery:c.searchTerms,offset:(c.page-1)*i.getPageLength(),limit:i.getPageLength(),sort:c.table.sort.by,sortReverse:!!c.table.sort.reverse},function(a,d){c.table.loading=!1,c.table.rows=a,c.totalPlayers=d,c.numPages=i.getNumberOfPages(d),0===c.table.rows.length&&c.page>1&&""===c.searchTerms.trim()&&(k.removeUrlParam("page"),b.reload())},function(a){c.$emit("viewError")}),c.skinImage=function(a,b){var c=q(a,b);return e.get("overridePerEnvironment","baseDirectory")+"images/"+c.thumbnail},c.isDeleteShown=function(){return c.selectionCount()>0},c.newPlayer=function(){j.ga("send","event","Players Section","Create New Player")},c.isDuplicateShown=function(){return 1===c.selectionCount()&&!c.isOldVersion(_.find(c.table.rows,"selected"))},c.isCloneToJw7Shown=function(){return 1===c.selectionCount()&&c.isOldVersion(_.find(c.table.rows,"selected"))},c.isSelectedIconShown=function(a,b){return c.publishMode.open?c.publishMode.player&&a.key===c.publishMode.player.key||!c.publishMode.player&&0===b:!1},c.isSelectButtonShown=function(a,b){return c.publishMode.open?c.publishMode.player&&a.key!==c.publishMode.player.key||!c.publishMode.player&&0!==b:!1},c.embedPlayer=function(a){m.show(a.key,function(a){c.setPublishModePlayer(a)},function(){c.$emit("viewError")})},c.selectionCount=function(){return _.countBy(c.table.rows,"selected")["true"]||0},c.isSearch=function(){return a.search().search},c.deletePlayer=function(){var a=_.filter(c.table.rows,"selected"),e=function(a){f.cancelDelayIndicator(),b.reload(),c.handleNotification("Successfully deleted players","success")},g=function(a){f.cancelDelayIndicator(),c.handleNotification("There was an error deleting the players","failed")},h="Are you sure you want to delete these players? All instances will be deleted and replaced with a system default player.";d.confirm(h)&&(f.showDelayIndicator(o,n,f.DELETING),_.each(a,function(a){c.removePublishModePlayer(a)}),m.bulkDelete(a,e,g))},c.updatePlayerToLatest=function(b){r("Update",b.name).then(function(){return f.showDelayIndicator(o,n,f.UPDATING),m.update(b,{version:c.defaultVersion},function(){f.cancelDelayIndicator(),a.url("players/basic_setup?player_key="+b.key)},function(){f.cancelDelayIndicator(),c.handleNotification("There was an error updating the players","failed")})})},c.isOldVersion=function(a){return parseFloat(a.version)<parseFloat(c.defaultVersion)},c.duplicatePlayer=function(){var a=_.find(c.table.rows,"selected");return f.showDelayIndicator(o,n,f.DUPLICATING),m.duplicate(a,function(){a.selected=!1,f.cancelDelayIndicator(),c.handleNotification("The duplication was successful","success"),b.reload()},function(){f.cancelDelayIndicator(),c.handleNotification("There was an error duplicating the players","failed")})};var r=function(a,b){return g.open({controller:"UpdateToJwplayer7Controller",resolve:{action:_.constant(a),playerName:_.constant(b)},templateUrl:e.get("overridePerEnvironment","baseDirectory")+"templates/modals/update-to-jwplayer7.html"}).result};c.duplicatePlayerToLatest=function(){var b=_.find(c.table.rows,"selected");r("Clone",b.name).then(function(){return f.showDelayIndicator(o,n,f.DUPLICATING),m.duplicate(b,function(b){return m.update(b,{version:c.defaultVersion},function(){f.cancelDelayIndicator(),a.url("players/basic_setup?player_key="+b.key)},function(){f.cancelDelayIndicator(),c.handleNotification("There was an error updating the players","failed")})},function(){f.cancelDelayIndicator(),c.handleNotification("There was an error duplicating the players","failed")})})},c.searchTermsChanged=function(){return c.searchQuery!==c.searchTerms},c.dispatchSearch=function(){k.addUrlParam("page",1),c.searchQuery.trim().length>0?k.addUrlParam("search",c.searchQuery):k.removeUrlParam("search")},c.sendGAEventBuildJW7=function(){j.ga("send","event","Player List","Click Build JW7")}}])}(),function(){"use strict";angular.module("DashboardApp").controller("AdBlockModal",["$modalInstance","$scope","$cookies",function(a,b,c){b.close=function(){b.disableNotification&&(c.disableAdBlockNotification=1),a.dismiss("closed")}}])}(),function(){"use strict";angular.module("DashboardApp").controller("PublishController",["$interpolate","$location","$q","$rootScope","$scope","$timeout","$window","ConfigService","ChannelService","DnsMaskingService","SessionService","SigningService","TrackingService","VirtualPlayerService","VirtualVideoService",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){var p=e.base.protocol+h.get("overridePerEnvironment","contentLocation")+"/previews/";e.closeOnRouteChange=!0,e.playerPreviewLoading=!1,e.setupObject={},e.playerId="publishWidgetPlayer",e.modalPlayerId="publishWidgetModalPlayer",e.inPlayerFullPreview=!1,e.embedCodeChangeClass="",e.queriedContent=!1,e.queriedPlayers=!1,e.includeSearchEngineOptimization=!1,e.showSEO=!1,e.active=n.EmbedType.JAVASCRIPT,e.model={inputVideoUrl:angular.copy(e.publishMode.videoUrl),inputImageUrl:angular.copy(e.publishMode.imageUrl)},e.isPublishModeWidgetInteriorShown=function(){return e.queriedContent&&e.queriedPlayers?e.contentToShow&&!e.publishMode.content?!1:!e.playerToShow||e.publishMode.player:!1},e.isAddContentButtonShown=function(){return!e.contentToShow},e.isCreatePlayerButtonShown=function(){return!e.playerToShow},e.isEmptyPreviewPlaceholderShown=function(){return e.isAddContentButtonShown()||e.isCreatePlayerButtonShown()},e.isMissingPlayerOrContent=function(){return!(e.publishMode.player&&e.publishMode.content)},e.onPlayerSetup=function(){e.playerPreviewLoading=!0},e.onPlayerReady=function(){e.playerPreviewLoading=!1};var q=function(){"blink-odd"==e.embedCodeChangeClass?e.embedCodeChangeClass="blink-even":e.embedCodeChangeClass="blink-odd"};e.useVideoUrl=function(){e.publishMode.videoUrl=e.model.inputVideoUrl,r()},e.useImageUrl=function(){e.publishMode.imageUrl=e.model.inputImageUrl,r()},e.$watch("includeSearchEngineOptimization",function(){q(),r()}),e.$watch("publishMode.player.key",function(a){a&&e.publishMode.content&&(q(),r())}),e.$watch("publishMode.content.key",function(a){e.publishMode.content&&e.publishMode.content.type?e.playlistContent=!0:e.playlistContent=!1,a&&e.publishMode.player&&(q(),r())}),e.$watch("publishMode.videoUrl",function(a,b){void 0!==a&&a!==b&&(e.model.inputVideoUrl=a,e.publishMode.videoUrl=a,e.publishMode.keepImageUrlOnce?(e.publishMode.keepImageUrlOnce=!1,e.model.inputImageUrl=e.publishMode.imageUrl):(e.publishMode.imageUrl="",e.model.inputImageUrl=""),q(),r())}),e.$watch("publishMode.open",function(a){a===!0?e.model.inputImageUrl=angular.copy(e.publishMode.imageUrl):(e.publishMode.focus="none",e.setupObject={})});var r=function(){var a={};if(!e.isMissingPlayerOrContent()){e.version=e.publishMode.player.version,e.publishModeType=b.path().split("/")[1],"content"==e.publishModeType?e.publishModeType="Video":"players"==e.publishModeType?e.publishModeType="Player":e.publishModeType="Player";var c=n.deserializeConfig(e.publishMode.player),d=angular.extend({},n.getDefaults(),c||{});e.publishMode.content?(d.playlist=e.base.protocol+h.get("overridePerEnvironment","contentLocation")+"/feeds/"+e.publishMode.content.key+".rss",d.playlist=d.playlist.replace(/feeds/,"jw6").replace(/rss$/,"xml")):d.file=e.publishMode.videoUrl||h.get("player","video"),l.bulkSignContentUrls([d.playlist,d.file]).then(function(b){d.playlist=b[0],d.file=b[1],e.setupObject=n.modelToEmbedObject(d),e.releaseChannel=d.release_channel,e.publishMode.content.mediatype?e.showSEO=!0:e.showSEO=!1,d.playlist?a.playlist=d.playlist:a.file=d.file,e.setupObject.related&&(e.setupObject.related.file="Enter your related xml file here")})}u().then(function(a){e.embedCodes=a})},s=function(){e.contentToShow=!!e.publishMode.content;var a=i.list({result_limit:2,result_offset:0}),b=c.defer();o.list({offset:0,limit:2,sort:"date",sortReverse:!0},function(a,c){b.resolve({videos:a,total:c})},angular.noop),c.all({playlists:a,videos:b.promise}).then(function(a){e.queriedContent=!0,a.playlists.total+a.videos.total>0?(e.contentToShow=!0,e.publishMode.content||(a.videos.total>0?o.show(a.videos.videos[0].key,function(a){e.publishMode.content=a},function(){e.$emit("viewError")}):a.playlists.total>0&&i.show({channel_key:a.playlists.channels[0].key}).then(function(a){e.publishMode.content=a},function(){e.$emit("viewError")}))):(e.publishMode.content=null,e.embedCode=null)},angular.noop)},t=function(){e.playerToShow=!!e.publishMode.player,n.list({offset:0,limit:2,sort:"name",sortReverse:!1},function(a,b){e.queriedPlayers=!0,b>0?(e.playerToShow=!0,e.publishMode.player||n.show(a[0].key,function(a){e.publishMode.player=a},function(){e.$emit("viewError")})):(e.publishMode.player=null,e.embedCode=null)},angular.noop)};e.$watch("publishMode.focus",function(a,b){"panel"===a&&(t(),s(),r())}),e.getPublishModeClass=function(){return e.publishMode.open?"panel"==e.publishMode.focus?"full":"focused":""},e.$on("$routeChangeSuccess",function(){var a=b.path().split("/");a={group:a[1],page:a[2]},"content"===a.group&&"list"===a.page||"players"===a.group&&"list"===a.page||("content"===a.group&&"playlists"===a.page?"/content/playlists/dynamic_detail"!==b.path()&&"/content/playlists/manual_detail"!==b.path()||e.closePublishMode():!e.closeOnRouteChange&&$route.current.publishWidget&&e.authorized()?e.publishMode.open===!0&&(e.publishMode.focus="panel"):e.closePublishMode()),e.closeOnRouteChange=!0}),e.removeControlFocus=function(){e.publishMode.focus="panel"},e.changePlayer=function(){m.ga("send","event","Publish Mode","Swap Player");var a="/players/list";b.path()!==a&&(e.closeOnRouteChange=!1,b.url(a)),e.publishMode.focus="player",g.jwplayer&&g.jwplayer(e.playerId).pause(!0),e.version=void 0},e.changeContent=function(){if(m.ga("send","event","Publish Mode","Swap Content"),"/content/playlists"===b.path()||"/content/playlists/dynamic_detail"===b.path()||"/content/playlists/manual_detail"===b.path())var a="/content/playlists";else var a="/content/list";b.path()!==a&&(e.closeOnRouteChange=!1,b.url(a)),e.publishMode.focus="content",g.jwplayer&&g.jwplayer(e.playerId).pause(!0)},e.selectType=function(a){e.active=a};var u=function(){if(e.publishMode.content&&e.publishMode.player)return n.getEmbedCodes(e.publishMode.content,e.publishMode.player,e.includeSearchEngineOptimization).then(function(a){_.each(a,function(a){a.active=e.active===a.type});var b=[];for(var c in a)b.push(a[c]);return b.reverse()});var a=c.defer();return a.resolve(_.map(n.EmbedType,function(a){return{active:a===e.active,type:a}})),a.promise};e.openFullView=function(){m.ga("send","event","Publish Mode","Open Preview Page"),l.bulkSignPlayerUrls([p+e.publishMode.content.key+"-"+e.publishMode.player.key]).then(function(a){g.open(a[0])})},e.onCopyMessage=function(){m.ga("send","event","Publish Mode","Copy Code"),e.showCopy=!0,f(function(){e.showCopy=!1},5e3)}}])}(),function(){"use strict";angular.module("DashboardApp").controller("ShellController",["$cookies","$document","$templateRequest","$filter","$location","$modal","$rootScope","$route","$routeParams","$scope","$timeout","$window","AuthenticationService","BrowserService","CacheService","ConfigService","AdBlockService","PollingBotrAccountService","SessionService","PermissionService","Tables","Templates","TitleService","TrackingService","ModalService",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y){function z(){var b,c;if(Object.keys(h.routes).some(function(a){var c=RegExp(h.routes[a].regexp);return c.test(e.path())?(b=h.routes[a],!0):void 0}),c=b?b.hasOwnProperty("preview")&&b.preview&&!s.previewMode()?!1:t.hasRouteAccess(b)?!b.hasOwnProperty("entitlement")||s.hasFeature(b.entitlement):!1:!1,s.getAccount()&&e.search().property)if(j.allowInvalidSite&&e.search().property==a.activeSite&&s.getSiteToken()!=s.getAccount().defaultSite){j.allowInvalidSite=!1;var d=!0}else var d=!!s.getAccount().sites[s.getSiteToken()];else var d=!0;j.isDenied=!c||!d}function A(){var a=e.path();j.isSuspended=s.suspendedAccount()&&"/account/billing"!=a&&"/logout"!=a}function B(){var a=b[0].getElementsByTagName("head")[0].getElementsByTagName("style"),c=b[0].getElementsByTagName("head")[0].getElementsByTagName("link");return _.map(a,angular.identity).concat(_.map(c,angular.identity))}function C(a,b){var c=b||e.path();return h.routes[c]&&_.contains(h.routes[c].requirements,a)}function D(a,b,c){var d="",e="";return b&&b.$$route&&b.$$route.originalPath&&(d=b.$$route.originalPath),a&&a.$$route&&a.$$route.originalPath&&(e=a.$$route.originalPath),h.routes[d]&&h.routes[d].shareParams==c&&h.routes[e]&&h.routes[e].shareParams==c&&e!=d}var E=!1,F=this;j.base={url:p.get("overridePerEnvironment","baseDirectory"),protocol:e.protocol()+"://"},j.viewLoaded=!1,j.viewError=!1,j.pageGroup=void 0,j.globals={},j.supportedBrowsers=p.get("supportedBrowsers"),j.unsupportedBrowsers=p.get("unsupportedBrowsers"),j.feedbackSurveyUrl=p.get("feedbackSurveyUrl"),j.supportEmailUrl=p.get("supportEmailUrl"),j.twitterFeed=p.get("twitterFeed"),j.useDelegateLogin=p.get("overridePerEnvironment","useDelegateLogin"),j.currentUploads=[],j.currentReuploads={},j.uploadErrors={anyErrors:!1,numErrors:0},j.numErrors=0,j.BotrAccount=r,j.navType="property",j.isPreviewMode=function(){return s.previewMode()},g.pricingLink=p.get("productPricingUrl"),g.contactLink=p.get("contactUrl"),h.current={},g.$on("session:created",function(){j.BotrAccount.startInterval(),j.isStreamingStopped=function(){return!j.BotrAccount.pending()&&!j.BotrAccount.get().can_stream&&j.BotrAccount.get().traffic.used>=j.BotrAccount.get().traffic.limit};encodeURIComponent(s.getUser().userEmail);g.pricingLink=p.get("productPricingUrl")+"?account="+s.getAccountToken()+"&utm_source=dashboard&utm_medium=CTA",g.contactLink=p.get("contactUrl")+"?account="+s.getAccountToken()+"&utm_source=dashboard&utm_medium=CTA",j.handleRouteRequirements(),o.has("user")&&(z(),A()),x.ga("create",p.get("overridePerEnvironment","ga","id"),{userId:s.getAccountToken()}),x.ga("set","dimension1",s.determineEntitlement()),s.hasFeature("ga_track_by_user_id")&&x.ga("set","dimension2",s.getAccountToken())});var G=function(){j.publishMode={open:!1,exiting:!1,focus:"none",keepImageUrlOnce:!1,playerKey:void 0,playerReplaced:!1,contentReplaced:!1,contentSaved:!1,videoUrl:p.get("publish","videoUrl"),imageUrl:p.get("publish","imageUrl")}};G(),j.closePublishMode=function(a){a&&x.ga("send","event","Publish Mode","Exit Publish Mode"),j.publishMode.open=!1,j.publishMode.focus="none",j.publishMode.exiting=!0},j.openPublishMode=function(a){var b=["QP URL","QP Upload","Content List","Content Detail","Players List","Playlist List","Playlist Detail","Manual"];a=b.indexOf(a)<0?"Undefined":a,x.ga("send","event","Publish Mode","Expand Publish Mode",a),j.publishMode.exiting=!1,j.publishMode.focus="panel",j.publishMode.open=!0,j.publishMode.playerReplaced=!1},j.setPublishModePlayer=function(a){j.openPublishMode("Players List"),j.publishMode.player=a,j.publishMode.playerReplaced=!0},j.publishModePlayerMatches=function(a){return a&&j.publishMode.player?a.key===j.publishMode.player.key:!1},j.removePublishModePlayer=function(a){j.publishModePlayerMatches(a)&&(j.publishMode.player=null)},j.updatePublishModePlayer=function(a){j.publishModePlayerMatches(a)&&(j.publishMode.player=a)},j.setPublishModeContent=function(a,b,c){j.publishMode.content=a,j.publishMode.contentReplaced=!0,j.publishMode.contentSaved=c,j.openPublishMode(b)},j.publishModeContentMatches=function(a){return a&&j.publishMode.content?a.key===j.publishMode.content.key:!1},j.updatePublishModeContent=function(a){j.publishModeContentMatches(a)&&(j.publishMode.content=a)},j.removePublishModeContent=function(a){j.publishModeContentMatches(a)&&(j.publishMode.content=null)},g.$on("upload:complete",function(a,b){k(function(){j.currentUploads=_.reject(j.currentUploads,function(a){return a.id==b}),0===j.currentUploads.length&&(j.allCompleted=!1,j.uploadErrors={anyErrors:!1,numErrors:0},j.blockRefresh(!1))},1500),j.allCompleted=_.all(j.currentUploads,function(a){return a.isCompleted})}),g.$on("upload:error",function(a,b){j.uploadErrors.anyErrors=!0,j.uploadErrors.numErrors=_.filter(j.currentUploads,function(a){return a.errored}).length}),j.$watch("publishMode.open",function(a){a&&l.scrollTo(0,0)}),j.$watch("publishMode.contentReplaced",function(a){a&&k(function(){j.publishMode.contentReplaced=!1,j.publishMode.contentSaved=!1},2e3)}),j.$watch("publishMode.playerReplaced",function(a){a&&k(function(){j.publishMode.playerReplaced=!1},2e3)}),g.$on("authorizationRevoked",function(){G(),j.currentUploads.forEach(function(a){a.pause()}),Object.keys(j.currentReuploads).forEach(function(a){j.currentReuploads[a].pause()}),j.globals={},g.$emit("globalsCleared"),j.viewLoaded=!1}),g.$on("authorizationChanged",function(){l.location.reload()}),j.openUploadModal=function(){F.uploadModalInstance=f.open({templateUrl:v.path("modals/upload-progress"),controller:"UploadsProgressModal",scope:j})},j.setSortParams=function(a,b){j.page=/^\d+$/.test(e.search().page)?parseInt(e.search().page):1,j.sort=e.search().sort||a,j.sortReverse="true"===e.search().sortReverse,j.pageLength=b,j.searchTerms=e.search().search||""},j.appReady=function(){return s.initialized()},j.viewReady=function(){return j.appReady()&&j.viewLoaded&&!j.viewError},j.allowPublishWidget=function(){return h.current.publishWidget&&j.authorized()},j.needsAuthentication=function(){return h.current.noAuth!==!0},j.authorized=function(){return m.isAuthorized()&&void 0!==s.getUser()},j.browserName=n.getBrowserName(),j.currentSupportedBrowser=n.getCurrentSupportedBrowser(),j.isBrowserOutdated=n.isBrowserOutdated(),j.isBrowserUnsupported=n.isBrowserUnsupported(),j.widePage=function(){return h.current.widePage===!0||!j.authorized()},j.fullPage=function(){return h.current.fullPage===!0},j.go=function(a){var b=s.getAccount();b&&!b.sites[s.getSiteToken()]&&s.setSiteToken(b.defaultSite),e.url(a)};var H,I,J=function(){I&&(I(),I=null)},K=function(){H&&(l.removeEventListener("beforeunload",H),H=null)};g.$on("authorizationRevoked",function(){F.uploadModalInstance&&F.uploadModalInstance.close(),J(),K()});var L=!1;j.blockExit=function(a){if(void 0!==a)if(!a||I&&H)J(),K(),L=!1;else{var b="You have unsaved work on this page. Abandon changes?";J(),I=j.$on("$locationChangeStart",function(a,c,d){if(L)L=!1;else{var f=d.split("?")[0].split("#")[1],g=h.routes[e.path()]||h.routes[h.current.$$route.originalPath],i=g.reloadOnSearch||g.originalPath!==f;i&&!l.confirm(b)&&(a.preventDefault(),j.$emit("viewLoaded"))}}),K(),H=function(a){return a=a||l.event,a&&(a.returnValue=b),b},l.addEventListener("beforeunload",H)}};var M,N=0;j.blockRefresh=function(a,b){a?(M||(M=function(a){return H?void 0:(a=a||l.event,a&&(a.returnValue=b),b)},l.addEventListener("beforeunload",M)),N++):(N--,0===N&&l.removeEventListener("beforeunload",M))},j.getGlobal=function(a){return j.globals[a]},j.setGlobal=function(a,b){j.globals[a]=b},j.clearGlobal=function(a){j.globals[a]=void 0},j.allowInvalidSite=!1,g.$watch(function(){return a.unifiedDashboardAuth},function(b,c){void 0===c&&b&&a.activeSite&&(j.allowInvalidSite=!0)}),j.$on("$routeChangeStart",function(a,b,c){return c&&b&&c.$$route==b.$$route&&c.params&&b.params&&c.params.key&&!b.params.key?void a.preventDefault():(c&&b.$$route==c.$$route?j.preventReload||(j.preventReload=!0,h.reload()):j.viewLoaded=!1,j.closeNotification&&j.closeNotification(),j.viewError=!1,j.handleRouteRequirements(b,c),void(o.has("user")&&(z(),A())))}),j.$on("viewLoaded",function(a){if(j.viewLoaded=!0,j.preventReload=!1,o.has("user")){A(),z(),j.entitlement=s.determineEntitlement(),j.disableBilling=s.disableBilling(),j.isFree="Free"===j.entitlement,j.isDirectSold=-1!==["Ads","Enterprise"].indexOf(j.entitlement);var b=h.routes[e.path()].ga_name||d("menuTitle")(e.path().split("/").join(" "));w.setTitle(a.currentScope,b+" | JW Player Dashboard"),x.sendPageViewEvent()}}),j.$on("viewLoading",function(){j.viewLoaded=!1}),j.$on("viewError",function(){j.viewError=!0}),j.$on("$routeChangeSuccess",function(){j.blockExit(!1);var a=e.path().split&&e.path().split("/");a=a.length>1&&a[1]||"",j.navType="account"===a?a:"property"}),j.$on("$routeChangeError",function(){j.viewError=!0}),j.selectText=function(a){E&&a.target.select()};var O=B();if(j.cleanUpPlayerStyles=function(){_.chain(B()).reject(function(a){return _.contains(O,a)}).each(function(a){a.remove()})},j.handleRouteRequirements=function(a,b){var c=null,d=i;a&&a.$$route&&(c=a.$$route.originalPath,d=a.params||{}),C("property",c)&&(d.property&&s.getAccount()&&s.getAccount().sites[d.property]?s.setSiteToken(d.property):d.property&&s.getAccount()?s.setSiteToken(d.property):s.getAccount()&&(d.property=s.getSiteToken())),p.get("SharedParamsGroups").forEach(function(c){D(a,b,c)&&p.get(c+"SharedParams").forEach(function(a){b.params[a]&&(d[a]=b.params[a])})}),C("pageLength",c)&&(d.pageLength||(d.pageLength=u.getPageLength())),_.isEqual(e.search(),d)||(L=!0,a&&(!b||a.$$route&&b.$$route&&a.$$route.originalPath!=b.$$route.originalPath)&&e.search(d))},g.sendGaEvent=function(a,b){x.ga("send","event",a,b)},j.sendGaEvent=g.sendGaEvent,g.sendGaEventLink=function(a,b,c){a.stopPropagation(),a.preventDefault(),x.ga("send","event",b,c,{hitCallback:function(){l.location=a.target.href||a.target.parentNode.href}})},j.sendGaEventLink=g.sendGaEventLink,j.clickUpgrade=function(a){return g.sendGaEventLink(a,"Upgrades","Click Storage Warning")},!a.disableAdBlockNotification){var P=j.$watch(function(){return s.getAccount()&&q.isBlocked()},function(a){a&&(P(),q.isBlocked()&&y.open({templateUrl:v.path("modals/ad-block"),controller:"AdBlockModal"}))});q.testBlocker()}j.canViewProperties=function(){return t.hasAccountAction("properties","edit")},j.canViewUsers=function(){return t.hasAccountAction("users","view")},j.canViewUsage=function(){return t.hasSiteAction("usage","view")},j.canViewBilling=function(){return t.hasAccountAction("billing","view")},j.canViewAds=function(){return t.hasSiteAction("ads","view")&&s.hasFeature("ads")},j.canViewFeeds=function(){return t.hasSiteAction("lists","view")&&s.hasFeature("feeds_beta")},j.canViewRightNow=function(){return t.hasSiteAction("analytics","view")&&s.hasFeature("right_now")},j.canEditBilling=function(){return t.hasAccountAction("billing","edit")},j.canEditUsers=function(){return t.hasAccountAction("users","edit")},j.canCreateContent=function(){return t.hasSiteAction("content","create")},j.canCreateLists=function(){return t.hasSiteAction("lists","create")},j.canDeleteAccount=function(){return t.hasAccountAction("account","delete")},j.isSiteView=function(){return C("property")||h.routes[e.path()]&&h.routes[e.path()].detailList},j.changeSite=function(a){s.setSiteToken(a),j.publishMode.content=!1,j.publishMode.player=!1,j.closePublishMode(),h.routes[e.path()].detailList?e.url(h.routes[e.path()].detailList):j.isSiteView()&&(i.property=a,e.search(i))},j.hasPaymentID=function(){return s.getAccount().paymentProvider.merchantID}}])}(),function(){"use strict";angular.module("DashboardApp").controller("UpdateToJwplayer7Controller",["$scope","action","playerName",function(a,b,c){a.action=b,a.playerName=c}])}(),function(){"use strict";angular.module("DashboardApp").controller("WelcomeController",["$document","$location","$scope","$window","ConfigService","MathService","PollingBotrAccountService","RSSService","PromoService","SessionService","TrackingService","UrlVideoObject","UtilService","VirtualVideoService",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){var o=135;h.get("https://www.jwplayer.com/feed/").then(function(a){c.posts=[];for(var b=0;5>b&&b<a.length;b++){var d=a[b];d.description=d.description||"",d.description=d.description.replace(/<^![CDATA[/, '').replace(/]]>$/,"").replace(/<.*?>/g,""),d.description=d.description.substring(0,d.description.lastIndexOf(" ",o)),d.description+=" ...",c.posts.push(d)}}),i.getPromo().then(function(a){a.promo.promoImage="/static/promo/"+a.promo.promoImage,c.promo=a.promo})["catch"](function(){c.promo={promoImage:e.get("overridePerEnvironment","baseDirectory")+"images/apple-tv-hp-promo.png",promoTitle:"JW Player for Apple TV",promoDescription:"Build your own app and easily curate your content in the dashboard to reach more viewers. This software is free and open source.",promoLink:"https://github.com/jwplayer/appletv",promoButtonLabel:"Get the code"}}),c.canViewUsage()&&g.addCallback("AccountUsageController",function(a){c.hasStorageLimit=a.storage.limit>-1,c.storageLimit=m.normalizeFileSize(a.storage.limit),c.storageUsed=m.normalizeFileSize(a.storage.used);var b=Math.min(1,a.storage.used/a.storage.limit);c.storagePercent=(100*b).toFixed(2)+"%",c.hasStreamingLimit=a.traffic.limit>-1,c.streamingLimit=m.normalizeFileSize(a.traffic.limit),c.streamingUsed=m.normalizeFileSize(a.traffic.used);var d=Math.min(1,a.traffic.used/a.traffic.limit);c.streamingPercent=(100*d).toFixed(2)+"%",c.storageLimitReached=c.hasStorageLimit&&a.storage.used>=a.storage.limit,c.streamingLimitReached=c.hasStreamingLimit&&a.traffic.used>=a.traffic.limit}),c.clickDownload=function(){k.ga("send","event","Welcome Page","Click Download Link")},c.isNotUnlimited=function(){return c.hasStorageLimit&&c.hasStreamingLimit&&"Unlimited"!=c.entitlement},c.isUnlimited=function(){return"Unlimited"==c.entitlement||!c.hasStorageLimit&&!c.hasStreamingLimit},c.clickPromo=function(a){a.stopPropagation(),a.preventDefault(),k.ga("send","event","Welcome Page","Click Promo CTA","appletv",{hitCallback:function(){d.location=a.target.href}})},c.clickSupport=function(a){k.ga("send","event","Welcome Page","Click Email Support"+a)},c.clickFeedback=function(){k.ga("send","event","Welcome Page","Click Give Feedback")},c.quickPublishUrl=new l,c.quickPublish=function(){k.ga("send","event","Welcome Page","Quick Publish URL"),c.quickPublishUrl.save().then(function(a){c.quickPublishUrl=new l(c.quickPublishUrl.sourceurl),n.show(a.key,function(a){c.setPublishModeContent(a,"QP URL",!0)},function(){c.$emit("viewError")})},function(){c.$emit("viewError")})},c.$emit("viewLoaded")}])}(),function(){"use strict";angular.module("DashboardApp").directive("acquireFocusIf",["$timeout",function(a){return{restrict:"A",link:function(b,c,d){b.$watch(d.acquireFocusIf,function(b){b&&a(function(){c[0].focus(),c[0].select&&c[0].select()})})}}}])}(),function(){"use strict";angular.module("DashboardApp").directive("alertUser",[function(){return{restrict:"AE",template:["<div class='panel-body' ng-class='{","message_success: isSuccess,","message_caution: isCaution,","message_error: isError,","}' ng-show='isSuccess || isCaution || isError' ng-transclude></div>"].join(""),replace:!0,transclude:!0,scope:{isError:"=?",isCaution:"=?",isSuccess:"=?"}}}])}(),function(){"use strict";angular.module("DashboardApp").directive("jwNav",["$compile","$location",function(a,b){
return{restrict:"A",link:function(c,d){var e=d[0].getElementsByTagName("a");[].forEach.call(e,function(d){d.setAttribute("ng-class","{'selected':isSelected()}");var e=c.$new();e.target=d.href.split("#")[1],e.isSelected=function(){var a=b.path().split("/");return"detail"==a[2]||"basic_setup"==a[2]?a[2]="list":(4==a.length&&"playlists"==a[2]||3==a.length&&"feeds"==a[1]||4==a.length&&"analytics"==a[1]&&"content"==a[2])&&(a=a.slice(0,-1)),a=a.join("/"),this.target===a},a(d)(e)})}}}])}(),function(){"use strict";angular.module("DashboardApp").directive("jwChartBar",["ChartDirectiveService","d3",function(a,b){return angular.extend(a.generateDirective(),{drawGraph:function(c,d,e,f,g){var h=30,i=1,j=c.data,k=b.select(e).append("svg").style("width","100%").style("height","100%"),l=parseInt(k.style("width")),m=parseInt(k.style("height")),n=k.append("g").attr("class","bars").classed("recency",c.recency);if(c.recency)var o=k.append("g").attr("class","lines");k=n;var p=b.scale.ordinal().rangeRoundBands([0,l],.03,0).domain(j.map(function(a){return a.date})),q=b.scale.linear().range([m,0]).domain([0,b.max(j,function(a){return a.uniques})]),r=b.time.format("%b %-d, %Y"),s=j.length<h?10:0,t=p.rangeBand()-s;if(1>t&&(t=1),c.empty){var u=b.scale.linear().domain([0,Math.floor(j.length/2),j.length]).range(["#D9DDE6","#C2C9D7","#AAB4C8"]);k.selectAll(".bar").data(j).enter().append("rect").attr("class","bar").attr("width",t).attr("height",function(a){var b=m-q(a.uniques);return i>b&&(b=i),b}).attr("x",function(a){return p(a.date)+s}).attr("y",function(a){var b=q(a.uniques);return b==m&&(b=m-i),b}).attr("fill",function(a,b){return u(b)})}else{var u=b.scale.linear().domain([0,Math.floor(j.length/2),j.length]).range(["#B0DEFF","#2994FF","#0A417C"]),v=g(function(d){return{dependentVariableValue:a.tooltipFormat.number(d.uniques),independentVariableValue:r(Date.parse(d.date+" -0500")),dependentVariable:"UNIQUES",today:c.recency&&d.date==b.max(j,function(a){return a.date})}}).offset([0,40]);k.call(v),k.selectAll(".bar").data(j).enter().append("rect").attr("class","bar").attr("width",t).attr("height",function(a){var b=m-q(a.uniques);return i>b&&(b=i),b}).attr("x",function(a){return p(a.date)+s}).attr("y",function(a){var b=q(a.uniques);return b==m&&(b=m-i),b}).attr("fill",function(a,b){return u(b)}).on("mouseover",v.show).on("mouseout",v.hide)}c.recency&&o.selectAll("line").data([j[j.length-1]]).enter().append("line").attr("x1",function(a){return p(a.date)+s}).attr("x2",function(a){return p(a.date)+s+t}).attr("y1",function(a){return q(a.uniques)}).attr("y2",function(a){return q(a.uniques)})},zeroData:{data:[{uniques:40,date:"2015-11-11"},{uniques:20,date:"2015-11-12"},{uniques:30,date:"2015-11-13"},{uniques:20,date:"2015-11-14"},{uniques:46,date:"2015-11-15"},{uniques:56,date:"2015-11-16"},{uniques:24,date:"2015-11-17"}],empty:!0}})}])}(),function(){"use strict";angular.module("DashboardApp").directive("jwChartGeography",["ChartDirectiveService","Colorscales","ConfigService","Templates","d3",function(a,b,c,d,e){var f,g={left:-75,top:0},h={};return angular.extend(a.generateDirective(),{drawGraph:function(a,b,c,d,i){var j=a.data[0];a.data=a.data.slice(1);var k=e.geo.kavrayskiy7(),l=e.geo.path().projection(k),m=e.max(a.data,function(a){return a.uniques}),n=e.scale.threshold().domain([1,m/3,2*m/3,m+1]).range(["#D9DDe6","#7CC8FF","#2995FF","#0A559F"]),o=e.select(c);if(h[c])var p=o.select("svg"),q=p.select("g");else{var p=e.select(c).append("svg").style("width","100%").style("height","100%"),q=p.append("g").attr("transform","translate("+g.left+", "+g.top+")"),r=e.svg.axis().scale(e.scale.linear().range([20,120])).orient("bottom").ticks(7).tickSize(-30,0,0).tickFormat("");e.select(j).append("g").call(r).classed("x axis",!0).attr("transform","translate(0,10)");f=i(function(a){return{dependentVariableValue:a.uniques||"0",independentVariableValue:a.properties.name}},"-geo").offset([3,0]),p.call(f),h[c]=1}var s;a.data.forEach(function(b){s=_.findIndex(a.countries,function(a){return a.properties.name==b.country}),-1!=s&&(a.countries[s].uniques=b.uniques)});var t=q.selectAll(".country");t[0]&&t[0].length?t.data(a.countries).style("fill",function(a){return n(a.uniques)}):t.data(a.countries).enter().insert("path",".graticule").attr("class","country").attr("d",l).style("fill",function(a){return n(a.uniques)}).on("mouseover",f.show).on("mouseout",f.hide)},hasData:function(a){return!!a.data},cleanup:function(){h={}}})}])}(),function(){"use strict";angular.module("DashboardApp").directive("jwChartLine",["ChartDirectiveService","Colorscales","ConfigService","Templates","d3","$filter","TimeService",function(a,b,c,d,e,f,g){function h(a){for(var b=[],c=0;7>c;c++){var d={dependentVariableValue:10*Math.random(),independentVariableValue:new Date(Date.now()+86400*(c+1)),series:a};b.push(d)}return b}var i={top:10,right:0,bottom:10,left:0},j=["k","M","G","T","P","E","Z","Y"],k=2,l=[{dependentVariable:"embeds",independentVariable:"date"},{dependentVariable:"plays",independentVariable:"date"},{dependentVariable:"completes",independentVariable:"date"}];l.forEach(function(a){a.values=h(a),a.group=l});for(var m=[{dependentVariable:"embeds",label:"Embeds",dependentVariableValue:0,show:!0,previous:0,percentChange:0},{dependentVariable:"plays",label:"Plays",dependentVariableValue:0,show:!0,percentChange:0,previous:0},{dependentVariable:"completes",label:"Completes",dependentVariableValue:0,show:!0,percentChange:0,previous:0}],n=0;3>n;n++)l[n]&&(l[n].legend=m[n],l[n].fullData=l);l.dependentVariables=["embeds","plays","completes"];var o={dateRange:7,data:[l],legends:m,totals:{Plays:0,Embeds:0,Completes:0},toggleLabel:"Show Complete Rates",recency:!1,empty:!0};return _.extend(a.generateDirective(),{drawGraph:function(c,d,h,l,m){function n(a){var b=e.formatPrefix(a);return _.contains(j,b.symbol)?b.scale(a).toFixed(0)+b.symbol:a}function o(){var b=[0,0],d=[s,t];if(F)var f=[g.parseTimeToString,n];else var f=[n];var h=[function(a){return a.ticks(5).tickFormat(f[0])},function(a){return a.ticks(5).tickFormat(f[1])}],i=[a.tooltipFormat.number,E],j=[],k=[],l=[];c.data[0].forEach(function(a){a.legend.show&&(j.push([a]),a.group=j[j.length-1],"timewatched"==a.dependentVariable?l=l.concat(a.values):k=k.concat(a.values))});var m=e.scale.linear().domain(d[0](k)).range([x,0]),o=e.scale.linear().domain(d[0](l)).range([x,0]);_.each(j,function(a,c){a.axisOffset=b[0],a.tickFormat=f[0],a.tooltipFormat=i[0],a.y="timewatched"==a[0].dependentVariable?o:m,a.yAxis=h[0](e.svg.axis().scale(o).orient("right")),F?(a.yAxis=h[0](e.svg.axis().scale(o).orient("right")),a.yAxisRight=h[1](e.svg.axis().scale(m).orient("left"))):a.yAxis=h[0](e.svg.axis().scale(m).orient("right"))}),_.each(c.legends,function(a,b){a.format=f[0]}),q(j),r(j)}function p(a,b){return"translate("+a+","+b+")"}function q(a){var b=e.svg.line().x(function(a){return z(a.independentVariableValue)}).y(function(a){return a.series.group.y(a.dependentVariableValue)}),f=H.selectAll(".seriesGroup").data([]);f.exit().remove();var f=H.selectAll(".seriesGroup").data(a);f.enter().append("g").classed("seriesGroup",!0);for(var g=f.selectAll("path").data(angular.identity),h=!0,j=0;3>j;j++){var l=c.data[0][j];1!==l.values.length&&(h=!1)}if(h){var m=!a.some(function(b){return b[0].values[0].dependentVariableValue!=a[0][0].values[0].dependentVariableValue});g.enter().append("g").classed("series",!0).append("circle").attr("r",5).attr("cx",function(a){return z(a.values[0].independentVariableValue)}).attr("cy",function(a){return m?x/2:a.group.y(a.values[0].dependentVariableValue)}).attr("class",function(a){return A(a.dependentVariable)})}else g.enter().append("g").classed("series",!0).append("path").attr("d",function(a){return b(a.values)}).attr("class",function(a){return A(a.dependentVariable)}).attr("style",function(a){if(c.recency&&a.values.length>1){for(var b=a.values[a.values.length-2],d=a.values[a.values.length-1],e=z(d.independentVariableValue)-z(b.independentVariableValue),f=a.group.y(d.dependentVariableValue)-a.group.y(b.dependentVariableValue),g=Math.sqrt(Math.pow(e,2)+Math.pow(f,2)),h=this.getTotalLength()-g,i=0;i<Math.ceil(g/k);i++)h+=","+k;return"stroke-dasharray: "+h}});d.empty||g.append("g").classed("grid-tooltip",!0).selectAll("rect").data(function(a){return a.values}).enter().append("rect").attr("x",function(a){return z(a.independentVariableValue)-C/2}).attr("y",-i.top).attr("width",C).attr("height",x+i.top+i.bottom-1).on("mouseover",G.show).on("mouseout",G.hide)}function r(a){if(!d.empty){var b=H.selectAll(".y.axis").data([]);b.exit().remove();var b=H.selectAll(".y.axis").data([a[0]]);b.enter().append("g").classed("y axis",!0).attr("transform",function(a){return p((a&&a.axisOffset||0)-i.left,0)}).call(function(a){a.data().forEach(function(b){b.yAxis(a)})}),F&&(b=H.selectAll(".y.axis.right").data([a[0]]),b.enter().append("g").classed("y axis right",!0).attr("transform",function(a){return p(y+i.right+a.axisOffset,0)}).call(function(a){a.data().forEach(function(b){b.yAxisRight(a)})}))}}function s(a){return[e.min(a,function(a){return a.dependentVariableValue}),e.max(a,function(a){return a.dependentVariableValue})]}function t(a){return[0,e.max([1,e.max(a,function(a){return e.max(a.values,function(a){return a.dependentVariableValue})})])]}d.rightLegendToggleLabel=c.toggleLabel,d.empty=c.empty,d.legends=c.legends,d.totals=c.totals;var u=e.select(h).select(".chart-line-content").append("svg").classed("chart-line",!0).style("width","100%").style("height","100%"),v=parseInt(u.style("height")),w=parseInt(u.style("width")),x=v-i.top-i.bottom,y=c.empty?w:w-i.left-i.right,z=e.time.scale().range([0,y]).nice(e.time.day);if(d.empty)var A=b().color().stroke().fill().chart("greyscale",5);else var A=b().color().stroke().fill().chart("line",5);var B=z.ticks(c.dateRange),C=Math.ceil(Math.abs(z.range()[0]-z.range()[1])/(B.length-1)+5)||1;i.left=i.right=C/2,y=c.empty?w:w-i.left-i.right,z.range([0,y]),z.domain(e.extent(c.data[0][0].values,function(a){return a.independentVariableValue})),B=z.ticks(c.dateRange),A.domain(c.data[0].dependentVariables);var D=e.time.format("%b %-d, %Y"),E=(e.format(".0%"),e.format(".2%")),F=!!c.legends.find(function(a){return"timewatched"==a.dependentVariable});if(!d.empty){var G=m(function(a){var b=a.series.fullData;b.forEach(function(a){"timewatched"==a.dependentVariable?a.filter=g.parseTimeToString:a.filter=f("number")});var d={independentVariableValue:D(a.independentVariableValue),dataIndex:a.series.values.indexOf(a),fullData:b,legends:c.legends,today:c.recency&&a.independentVariableValue==a.series.values[a.series.values.length-1].independentVariableValue,color:A};return d},"-line");G.offset([x,0]),G.attr("class","d3-tip "+h.className),u.call(G)}e.select(h).select(".chart-line-legend");if(c.empty)var H=u.append("g").attr("transform",p(0,i.top));else var H=u.append("g").attr("transform",p(i.left,i.top));H.append("g").classed("grid",!0).selectAll("line").data(B).enter().append("line").attr("x1",function(a){return z(a)}).attr("x2",function(a){return z(a)}).attr("y1",-i.top).attr("y2",x+i.top+i.bottom-1),d.$watch("legends",o,!0)},hasData:function(a){return a&&a.data&&a.data.length&&a.data[0].length&&a.data[0][0].values.length},zeroData:o,template:null,templateUrl:d.path("directives/analytics/chart-line")})}])}(),function(){"use strict";angular.module("DashboardApp").directive("jwChartSparkLine",["ConfigService","ChartDirectiveService","d3",function(a,b,c){var d=2,e={top:1,left:0,bottom:1},f=c.time.format("%Y-%m-%d").parse;return _.extend(b.generateDirective(),{drawGraph:function(a,b,f,g,h){if(!a.empty)var i=a.data[0];var j=a.data.slice(1),k=c.select(f).append("svg").style("width","100%").style("height","100%"),l=parseInt(k.style("height"))-e.top-e.bottom,m=parseInt(k.style("width")),n=c.time.scale().range([0,m]),o=c.scale.linear().range([l,0]);n.domain(c.extent(j,function(a){return a.xdata})),o.domain(c.extent(j,function(a){return a.ydata}));var p=c.svg.line().x(function(a){return n(a.xdata)}).y(function(a){return o(a.ydata)}),q=k.append("g").attr("transform","translate("+e.left+", "+e.top+")"),r=1===j.length;if(r||q.append("path").datum(j).attr("class","line").attr("d",p).attr("style",function(b){if(a.recency){for(var c=b[b.length-2],e=b[b.length-1],f=n(e.xdata)-n(c.xdata),g=o(e.ydata)-o(c.ydata),h=Math.sqrt(Math.pow(f,2)+Math.pow(g,2)),i=this.getTotalLength()-h,j=0;j<Math.ceil(h/d);j++)i+=","+d;return"stroke-dasharray: "+i}}),!a.empty){var s=h(function(b){return{dependentVariableValue:b.tipData,independentVariableValue:b.xdata.toDateString(),dependentVariable:i,today:a.recency&&b==j[j.length-1]}}).offset([3,0]);q.call(s),r?q.selectAll("circle").data(j).enter().append("circle").attr("r",5).attr("cx",function(a){return m/2}).attr("cy",function(a){return l/2}).attr("class","single").on("mouseover",s.show).on("mouseout",s.hide):q.selectAll("circle").data(j).enter().append("circle").attr("r",10).attr("cx",function(a){return n(a.xdata)}).attr("cy",function(a){return o(a.ydata)}).on("mouseover",s.show).on("mouseout",s.hide)}},hasData:function(a){return a.data&&a.data.length>1},zeroData:{data:[{ydata:40*Math.random(),xdata:f("2015-11-11")},{ydata:20*Math.random(),xdata:f("2015-11-12")},{ydata:30*Math.random(),xdata:f("2015-11-13")},{ydata:20*Math.random(),xdata:f("2015-11-14")},{ydata:46*Math.random(),xdata:f("2015-11-15")},{ydata:56*Math.random(),xdata:f("2015-11-16")},{ydata:24*Math.random(),xdata:f("2015-11-17")}],empty:!0}})}])}(),function(){"use strict";angular.module("DashboardApp").directive("jwChartSparkLineBeta",["ConfigService","ChartDirectiveService","d3",function(a,b,c){var d=2,e=c.time.format("%Y-%m-%d").parse;return _.extend(b.generateDirective(),{drawGraph:function(a,b,e,f,g){if(!a.empty){a.data[0]}var h=a.data.slice(1),i=c.select(e).append("svg").style("width","100%").style("height","100%"),j=parseInt(i.style("height"))-1,k=parseInt(i.style("width")),l=c.time.scale().range([0,k]),m=c.scale.linear().range([j,0]);l.domain(c.extent(h,function(a){return a.xdata})),m.domain(c.extent(h,function(a){return a.ydata}));var n=c.svg.line().x(function(a){return l(a.xdata)}).y(function(a){return m(a.ydata)});i.append("path").datum(h).attr("class","line").attr("d",n).attr("style",function(b){if(a.recency){for(var c=b[b.length-2],e=b[b.length-1],f=l(e.xdata)-l(c.xdata),g=m(e.ydata)-m(c.ydata),h=Math.sqrt(Math.pow(f,2)+Math.pow(g,2)),i=this.getTotalLength()-h,j=0;j<Math.ceil(h/d);j++)i+=","+d;return"stroke-dasharray: "+i}})},hasData:function(a){return a.data&&a.data.length>0},zeroData:{data:[{ydata:40*Math.random(),xdata:e("2015-11-11")},{ydata:20*Math.random(),xdata:e("2015-11-12")},{ydata:30*Math.random(),xdata:e("2015-11-13")},{ydata:20*Math.random(),xdata:e("2015-11-14")},{ydata:46*Math.random(),xdata:e("2015-11-15")},{ydata:56*Math.random(),xdata:e("2015-11-16")},{ydata:24*Math.random(),xdata:e("2015-11-17")}],empty:!0}})}])}(),function(){"use strict";angular.module("DashboardApp").directive("jwChartSnakeLine",["ConfigService","ChartDirectiveService","d3",function(a,b,c){var d;return angular.extend(b.generateDirective(),{drawGraph:function(a,b,e,f,g){if(!a.empty)var h=a.data[0];var i=a.data.slice(1),j=c.select(e);j.selectAll("path").remove(),j.selectAll("circle").remove(),j.selectAll("g").remove(),j=j.select("svg").remove();var k=c.select(e).append("svg").style("width","100%").style("height","100%"),l=parseInt(k.style("height"))-20,m=parseInt(k.style("width"))-20,n=c.scale.linear().range([m,0]),o=c.scale.linear().range([l,0]);n.domain(c.extent(i,function(a){return a.xdata})),o.domain([0,c.max(i,function(a){return a.ydata})]);var p=c.svg.axis().scale(n).orient("bottom").ticks(i.length).tickSize(-30,0,0).tickFormat(""),q=(k.append("g").call(p).classed("x axis",!0).attr("transform","translate(0,"+l+")"),p.ticks()[0]);k.selectAll("g.x.axis g.tick line").attr("y2",function(a){return 0==a||a==q-1||a==Math.floor(q/2)?-30:-15});var r=c.svg.line().x(function(a){return n(a.xdata)}).y(function(a){return o(a.ydata)}),s=k.append("path").datum(i).attr("class","line").attr("d",r).attr("style",function(b){if(a.recency){for(var c=b[b.length-2],d=b[b.length-1],e=n(d.xdata)-n(c.xdata),f=o(d.ydata)-o(c.ydata),g=Math.sqrt(Math.pow(e,2)+Math.pow(f,2)),h=this.getTotalLength()-g,i=0;i<Math.ceil(g/RECENCY_DASH_SIZE);i++)h+=","+RECENCY_DASH_SIZE;return"stroke-dasharray: "+h}});if(!a.empty){d&&(d=d.destroy());var t=g(function(a){return{dependentVariableValue:a.ydata,independentVariableValue:a==i[0]?"RIGHT NOW":10*a.xdata+" SECONDS AGO",dependentVariable:h}},"-snake").offset([3,0]);d=t,k.call(t);var u=k.selectAll("circle").data(i).enter().append("circle").attr("r",5).attr("cx",function(a){return n(a.xdata)}).attr("cy",function(a){return o(a.ydata)}).on("mouseover",t.show).on("mouseout",t.hide)}b.$parent.animateNewValue=function(a,b){if(b){var d=i[0].ydata,e=c.max(i.slice(1),function(a){return a.ydata});a>e&&(e=a)}else{i=[{xdata:-1,ydata:a}].concat(i),i.forEach(function(a){a.xdata++});var e=c.max(i.slice(0,-1),function(a){return a.ydata})}var f=o.domain()[1];k.transition().duration(1e3).tween("yAxis",function(c,g){return function(c){b&&(i[0].ydata=d+c*(a-d)),o.domain([0,f+c*(e-f)]),s.attr("d",r(i)),u.attr("d",r(i)).attr("cy",function(a){return o(a.ydata)})}}),b||(s.attr("transform","translate("+n(n.domain()[1]-1)+")").attr("d",r(i)).transition().ease("linear").duration(1e3).attr("transform","translate("+n(n.domain()[1])+")"),u.attr("d",r(i)).attr("cy",function(a){return o(a.ydata)}).transition().ease("linear").duration(1e3).attr("transform","translate("+n(n.domain()[1]+1)+")"))}},hasData:function(a){return a.data&&a.data.length>0}})}])}(),function(){"use strict";angular.module("DashboardApp").directive("jwChartStackedArea",["ChartDirectiveService","Colorscales","d3",function(a,b,c){return a.generateDirective(function(a,d,e,f,g){d.empty=a.empty,a=a.data;var h=[1,.75,.5,.25,0],i=[0,.2,.4,.6,.8],j=(c.select(e).append("ul").attr("class","yAxis").selectAll("li").data(h).enter().append("li").text(function(a){return 100*a+"%"}),c.select(e).append("div").attr("id","chart")),k=j[0][0].clientWidth,l=j[0][0].clientHeight;if(d.empty)var m=75;else{if(!d.$parent.video)return;var m=parseFloat(d.$parent.video.duration)}if(d.empty)var n=b().stroke().chart("grey",4),o=b().fill().chart("grey",4),p=b().color().fill().chart("grey",4);else var n=b().stroke().chart("stacked-area-line",4),o=b().fill().chart("stacked-area-fill",4),p=b().color().fill().chart("stacked-area-line",4);for(var q=[],r=0,s=-1,t=0,u=0;u<a.length;u++){a[u].i=u,a[u].total=0;for(var v=0;v<a[u].values.length;v++){var w=a[u].values[v];w.dependentVariable>a[u].total&&(a[u].total=w.dependentVariable),(w.independentVariable<s||-1==s)&&(s=w.independentVariable),w.independentVariable>t&&(t=w.independentVariable),w.y=q[v]?q[v]:0,"undefined"==typeof q[v]?q[v]=w.dependentVariable:q[v]+=w.dependentVariable,w.i=v,w.series=a[u]}r+=a[u].total}var x=c.scale.linear().rangeRound([0,k]).domain([s,t]),y=c.scale.linear().rangeRound([l,0]).domain([0,r]),z=c.format("02d"),A=function(a){var b=Math.floor(a/60);return a=Math.round(a-60*b),z(b)+":"+z(a)},B=j.append("svg").attr("width",k).attr("height",l),C=c.svg.area().x(function(a){return x(a.independentVariable)}).y0(function(a){return y(a.y)}).y1(function(a){return y(a.y+a.dependentVariable)}),D=c.svg.line().x(function(a){return x(a.independentVariable)}).y(function(a){return y(a.y+a.dependentVariable)}),E=c.layout.stack().values(function(a){return a.values}),F=E(a);B.append("g").classed("grid",!0).selectAll("line").data(i).enter().append("line").attr("x1",function(a){return x(a)}).attr("x2",function(a){return x(a)}).attr("y1",0).attr("y2",l),B.append("g").classed("grid",!0).selectAll("line").data(h).enter().append("line").attr("y1",function(a){return y(a*r)}).attr("y2",function(a){return y(a*r)}).attr("x1",0).attr("x2",k);var G=B.selectAll(".dataType").data(F).enter().append("g").attr("class","dataType"),H=g(function(a){return{color:p(a.series.i),dependentVariableValue:Math.floor(100*a.dependentVariable/(r||1))+" %",independentVariableValue:A(a.independentVariable*m),dependentVariable:a.series.label}},"-engagement").attr("class","d3-tip "+e.className).style("height",l+"px");B.call(H),G.append("path").attr("d",function(a){return C(a.values)}).attr("class",function(a){return"fill "+o(a.i)}),G.append("path").attr("d",function(a){return D(a.values)}).attr("class",function(a){return"line "+n(a.i)});c.select(e).append("ul").attr("class","xAxis").selectAll("li").data(i).enter().append("li").text(function(a){return A(a*m)});d.empty||B.selectAll(".hover").data(F).enter().append("g").classed("hover",!0).selectAll("circle").data(function(a){return a.values}).enter().append("circle").attr("class",function(a){return p(a.series.i)}).attr("cx",function(a){return x(a.independentVariable)}).attr("cy",function(a){return y(a.y+a.dependentVariable)}).attr("r",5).on("mouseover",H.show).on("mouseout",H.hide)})}])}(),function(){"use strict";angular.module("DashboardApp").directive("jwStackedBar",["ChartDirectiveService","Colorscales","d3",function(a,b,c){return angular.extend(a.generateDirective(),{drawGraph:function(d,e,f,g,h){if(0===d.data.length){var i={};i[d.labelKey]="Unknown",i[d.valueKey]=0,i.percentage=1,i.y0=0,i.y1=i.percentage,d.data.push(i);var j=!0}else var j=!1;var k=0,l=0;if(d.data.forEach(function(a){k+=a[d.valueKey],a.i=l,l++}),!j){var m=0;d.data.forEach(function(a){a.y0=m,a.percentage=k?a[d.valueKey]/k:0,a.y1=a.y0+a.percentage,m=a.y1})}var n=c.select(f).selectAll(".detail").data(d.data).enter().append("div").attr("class","detail");n.append("div").attr("class","label").text(function(a){return a[d.labelKey]}),d.empty||n.append("div").attr("class","percentage").text(function(a){return Math.floor(1e3*a.percentage)/10+" %"});var o=(f.parentNode.clientWidth,f.clientHeight),p=c.scale.linear().rangeRound([0,o]).domain([0,1]);if(d.empty)var q=b().color().fill().chart("greyscale",5);else var q=b().color().fill().chart("stacked-bar",5);var r=c.select(f).append("svg").attr("height",o).append("g");if(!d.empty){var s=h(function(b){return{color:q(b.i),dependentVariableValue:a.tooltipFormat.number(b[d.valueKey]),independentVariableValue:b[d.labelKey],dependentVariable:"Plays"}});r.call(s),s.direction("e"),s.offset([0,20])}d.empty?r.selectAll("rect").data(d.data).enter().append("rect").attr("width","100%").attr("y",function(a){return p(a.y0)}).attr("height",function(a){var b=p(a.y1)-p(a.y0)-1;return 0>b&&(b=0),b}).attr("class",function(a){return q(a.i)}):r.selectAll("rect").data(d.data).enter().append("rect").attr("width","100%").attr("y",function(a){return p(a.y0)}).attr("height",function(a){var b=p(a.y1)-p(a.y0)-1;return 0>b&&(b=0),b}).attr("class",function(a){return q(a.i)}).on("mouseover",s.show).on("mouseout",s.hide)},hasData:function(a){if(a&&a.data&&a.data.length)for(var b in a.data)if(a.data[b][a.valueKey])return!0;return!1},zeroData:{labelKey:"device",valueKey:"plays",empty:!0,data:[{plays:40,device:" "},{plays:30,device:" "},{plays:20,device:" "},{plays:10,device:" "},{plays:0,device:" "}]}})}])}(),function(){"use strict";angular.module("DashboardApp").directive("jwAssetPicker",["$document","$timeout","ConfigService","Templates","VirtualAssetService",function(a,b,c,d,e){function f(c,d,f){function g(){c.jwDisabled||(c.jwModel=null,c.jwPreview=null,b(c.jwOnUpdate))}function h(){b(function(){a[0].getElementById(c.jwId).value=null,a[0].getElementById(c.jwId).click()})}function i(){var d=a[0].getElementById(c.jwId).files[0];d&&(c.uploading=!0,c.jwModel=null,c.jwOnUpdate(),e.create({assetFile:d,assetType:c.jwAssetType},function(a){c.uploading=!1,c.jwPreview=e.createPreviewUrl(a),c.jwModel=a.key,b(c.jwOnUpdate)},function(){c.uploading=!1,c.$emit("viewError")},function(a,b){return _.extend({},a,{type:b.assetType})}))}c.uploading=!1,c.clearAsset=g,c.initiateUpload=h,c.uploadAsset=i}return{link:f,restrict:"E",scope:{jwAssetType:"@",jwDisabled:"=",jwId:"@",jwLabel:"@",jwModel:"=",jwOnUpdate:"&",jwPreview:"=",jwRequired:"@"},templateUrl:d.path("directives/asset-picker")}}])}(),function(){"use strict";angular.module("DashboardApp").directive("jwAsyncClick",["$parse",function(a){return{restrict:"A",link:function(b,c,d){var e,f,g,h=a(d.jwAsyncClick);e=function(){c[0].disabled=!0},f=g=function(){c[0].disabled=!1},c.on("click",function(a){var c=h(b,{$event:a});c&&c.then&&(e(),c.then(f,g))})}}}])}(),function(){"use strict";angular.module("DashboardApp").directive("jwClickToEdit",["$location","$timeout","ConfigService","Templates",function(a,b,c,d){return{restrict:"E",scope:{callback:"=",defaultText:"=",editable:"=",editing:"=",onCancel:"&",onEditing:"&",text:"="},templateUrl:d.path("directives/click-to-edit"),link:function(c,d){c.editing=c.editing||!1,c.tagsFlag="tags"===a.path().slice(-4),c.cancel=function(a){c.editing&&(c.editing=!1,c.onCancel())},c.edit=function(a){c.editable&&!c.editing&&(c.editing=!0)},c.keypress=function(a){13===a.keyCode&&c.save(a)},c.keyup=function(a){27===a.keyCode&&c.cancel(a)},c.save=function(a){c.editing&&(a.stopPropagation(),c.text=c.newText||c.defaultText,c.editing=!1,c.callback(c.text))},c.$watch("editing",function(a){if(c.editing){c.newText=c.text;var e=d.find("input")[0];b(function(){e.focus(),e.select()})}c.onEditing({$editing:a})})}}}])}(),function(){"use strict";angular.module("DashboardApp").directive("jwColorpicker",["ConfigService","Templates",function(a,b){return{restrict:"E",scope:{jwDisabled:"=",jwActive:"=",jwId:"@",jwLabel:"@",jwModel:"=",jwOnUpdate:"&"},templateUrl:b.path("directives/colorpicker"),link:function(a,b,c){a.preventEnter=function(a){13==a.keyCode&&(a.preventDefault(),a.stopPropagation())},a.$watch("jwActive",function(b,c){b===c||b||(a.jwModel="")}),a.$watch("jwModel",function(b,c){!a.jwDisabled&&b!==c&&a.colorpickerForm.$dirty&&a.jwOnUpdate()})}}}])}(),function(){"use strict";angular.module("DashboardApp").directive("jwCopyClipboard",["$document","$timeout","$window","BrowserService",function(a,b,c,d){return{restrict:"A",scope:{jwCopyClipboard:"@",jwCopyClipboardSuccess:"&"},link:function(e,f){function g(){var b;return b=e.jwCopyClipboard?a[0].getElementById(e.jwCopyClipboard):f[0].previousElementSibling}if(d.isSafari()){var h=new ZeroClipboard(f[0]);h.on("ready",function(){h.on("copy",function(a){var b=g();b.select(),a.clipboardData.setData("text/plain",b.value),e.jwCopyClipboardSuccess(),e.$apply()}),h.on("aftercopy",function(){g().select()})}),h.on("error",function(a){f.bind("click",function(){g().select(),f.addClass("tooltip"),f.append(angular.element('<span class="tooltip-content top-center small">Press ⌘ + C to copy</span>')),b(function(){f.removeClass("tooltip"),f.children().remove()},3e3)})}),e.$on("$destroy",function(){h.destroy(),h=null})}else f.bind("click",function(){var b=g();b.select(),c.clipboardData&&c.clipboardData.setData?c.clipboardData.setData("Text",b.value):a[0].execCommand("copy"),e.jwCopyClipboardSuccess(),e.$apply()})}}}])}(),function(){"use strict";angular.module("DashboardApp").directive("jwDatepickerRange",["$timeout",function(a){return{restrict:"E",scope:{jwDatepickerRangeStart:"=",jwDatepickerRangeEnd:"=",jwDatepickerRange:"=",jwDatepickerPickingStatus:"="},link:function(b,c,d){var e,f=b.jwDatepickerRangeStart,g=b.jwDatepickerRangeEnd,h=b.jwDatepickerRange;b.jwDatepickerPickingStatus={start:!0,end:!1};var i,j,k=b.jwDatepickerPickingStatus,l=function(c,d){c.registerDate=function(){var a=h[0]>h[1]?1:0,c=1===h.length?0:1*!a;f=h[a],g=h[c],b.jwDatepickerRangeStart=f,b.jwDatepickerRangeEnd=g},c.isStart=function(a){return f&&a.date.getTime()==f||!f&&g&&a.date.getTime()==g},c.isEnd=function(a){return g&&a.date.getTime()==g||!g&&f&&a.date.getTime()==f},c.inRange=function(a){return(f||a==g)&&(g||a==f)&&a.date>=f&&a.date<=g},c.inMonth=function(a){return!a.secondary};var l=new Date(c.$parent[d.attr("min-date")]),m=new Date(c.$parent[d.attr("max-date")]);l.setMonth(l.getMonth()+1),l.setHours(0,0,0,0,0),m.setHours(0,0,0,0,0),l.setDate(1),m.setDate(1),e=new Date,e.setDate(1),e.setHours(0,0,0,0,0),c.updateMonth=function(){c.lastMonth=e.getTime()==m.getTime(),c.firstMonth=e.getTime()==l.getTime()},c.updateMonth(),c.singleMove=c.move,c.move=function(a){c.firstMonth&&-1==a||c.lastMonth&&1==a||(e.setMonth(e.getMonth()+a),i.updateMonth(),j.updateMonth(),i.singleMove(a),j.singleMove(a))};var n=c.select;c.select=function(b){var d=b.getMonth();if(c.rightPicker||(d+=1),e.setFullYear(b.getFullYear()),e.setMonth(d),n(b),c.rightPicker)var f=i,g=-1;else var f=j,g=1;a(function(){f.singleMove(g)}),k.start=!k.start,k.end=!k.end}};b.$watch(function(){return c[0].getElementsByClassName("jw-datepicker-start")[0].nodeName},function(b,d){if("DIV"==b){var e=angular.element(c[0].getElementsByClassName("jw-datepicker-start")[0]);i=e.isolateScope(),i.leftPicker=!0,a(function(a){i.singleMove(-1)}),l(i,e)}}),b.$watch(function(){return c[0].getElementsByClassName("jw-datepicker-end")[0].nodeName},function(a,b){if("DIV"==a){var d=angular.element(c[0].getElementsByClassName("jw-datepicker-end")[0]);j=d.isolateScope(),j.rightPicker=!0,l(j,d)}})}}}])}(),function(){"use strict";angular.module("DashboardApp").directive("digits",[function(){return{require:"ngModel",link:function(a,b,c,d){d.$parsers.push(function(a){if("undefined"==typeof a)return"";var b=a.replace(/[^0-9]/g,"");return b!==a&&(d.$setViewValue(b),d.$render(),a=b),a})}}}])}(),function(){"use strict";angular.module("DashboardApp").directive("download",["$document","$window","ConfigService","Templates",function(a,b,c,d){return{restrict:"E",replace:!0,templateUrl:d.path("directives/download"),scope:{jwLabel:"=?",jwLoadingLabel:"=?",jwXhr:"=",jwGetData:"=?",jwFilename:"=",jwDataType:"="},link:function(c){function d(){c._disabled=!0,c._label=i,c.jwXhr(f,g)}function e(){c._disabled=!1,c._label=h,c._onclick=d}function f(d){c.$emit("download-success");var e=j(d),f=new Blob([e],{type:c.jwDataType}),g=URL.createObjectURL(f);if(b.navigator.msSaveOrOpenBlob)b.navigator.msSaveOrOpenBlob(f,c.jwFilename);else{var h=a[0].createElement("a");a[0].body.appendChild(h),h.href=g,h.download=c.jwFilename,h.click()}}function g(a,b){c.$emit("download-error",b)}var h=angular.copy(c.jwLabel)||"Export",i=angular.copy(c.jwLoadingLabel)||"Loading",j=angular.copy(c.jwGetData)||function(a){return a.data};e(),c.$on("reset-download",e)}}}])}(),function(){"use strict";angular.module("DashboardApp").directive("jwFollowScroll",["$document","$window","AnimationFrameService","MathService",function(a,b,c,d){var e={AFFIXED:0,BOTTOM:1,TOP:2};return{restrict:"A",scope:{jwFollowScroll:"@",jwWidthRatio:"="},link:function(d,f,g){function h(){l=e.AFFIXED,f[0].style.position="fixed",f[0].style.top="0px"}function i(a){l=e.BOTTOM,f[0].style.position="absolute",f[0].style.top=a.getClientRects()[0].bottom+b.pageYOffset-f[0].getClientRects()[0].height+"px"}function j(a){l=e.TOP,f[0].style.position="absolute",f[0].style.top=a.getClientRects()[0].top+b.pageYOffset+20+"px"}function k(){var g=a[0].getElementById(d.jwFollowScroll),o=f[0].getClientRects()[0],p=g.getClientRects()[0];angular.isUndefined(l)?j(g):e.TOP===l&&o.top<0?h():e.AFFIXED===l&&p.bottom<o.bottom?i(g):e.AFFIXED===l&&o.top<p.top?j(g):e.BOTTOM===l&&o.top>0?h():e.BOTTOM===l&&i(g),f[0].style.width=g.getClientRects()[0].width*m+"px",f[0].style.right=b.innerWidth-(g.getClientRects()[0].right+(e.AFFIXED!==l)*b.pageXOffset)+"px",n=c.requestAnimationFrame(k)}var l,m=d.jwWidthRatio||1,n=c.requestAnimationFrame(k);d.$on("$destroy",function(){c.cancelAnimationFrame(n)})}}}])}(),function(){"use strict";angular.module("DashboardApp").directive("formsValidator",["$document","$timeout",function(a,b){return{restrict:"AE",link:function(c,d,e){var f=c.form,g=function(){c.hasOwnProperty("form")||(f=[],_.each(d.find("form"),function(a){var b=angular.element(a).controller("form");b&&f.push(b)})),c.anyInvalid=!0,_.each(d.find("input"),function(a){a.hasAttribute("ng-model")&&angular.element(a).attr("ng-model-options","{updateOn: 'blur'}")}),_.each(f,function(b){b.element=a[0].querySelector("form[name='"+b.$name+"']");
});var e=function(a,b){return function(b,d){var e=b.target,g=angular.element(b.target);if(g.hasClass("ng-invalid"))(g.hasClass("ng-dirty")||d===!0)&&(g.addClass("invalid-input"),angular.element(a.element).addClass("invalid-form")),e.isInvalid=!0,a.isInvalid=!0,c.anyInvalid=!0,b.type&&c.$apply(c.anyInvalid);else{e.isInvalid=!1,g.removeClass("invalid-input");var h=_.reduce(a.inputs,function(a,b){var c=angular.element(b);return a||(d||c.hasClass("ng-dirty"))&&c.hasClass("ng-invalid")},!1);a.isInvalid=_.reduce(a.inputs,function(a,b){return a||b.isInvalid},!1),h||angular.element(a.element).removeClass("invalid-form"),c.anyInvalid=_.reduce(f,function(a,b){return a||b.isInvalid},!1),b.type&&c.$apply(c.anyInvalid)}}},g=function(){_.each(f,function(b){b.inputs=Array.prototype.slice.call(a[0].querySelectorAll("form[name='"+b.$name+"'] input[ng-model]"),0),b.isInvalid=!1;for(var c=b.inputs.length-1;c>=0;--c){var d=b.inputs[c],f=angular.element(d);d.blurHandler=d.blurHandler||e(b,d),d.addEventListener("blur",d.blurHandler),void 0!==f.attr("disabled")||f.hasClass("ng-hide")?(f.removeClass("invalid-input"),b.inputs.splice(c,1)):f.hasClass("ng-invalid")?(d.isInvalid=!0,b.isInvalid=!0):d.isInvalid=!1}})};c.verifyInputModel=function(){_.each(f,function(a){0===a.inputs.length&&angular.element(a.element).removeClass("invalid-form"),_.each(a.inputs,function(a){a.blurHandler({target:a},!0)})})},c.generateInputModel=function(a,d){c.anyInvalid=!0,b(function(){g(),_.each(f,function(a){0===a.inputs.length&&angular.element(a.element).removeClass("invalid-form"),_.each(a.inputs,function(a){a.blurHandler({target:a},d)})})},a||100)},c.generateInputModel()};a.ready(g)}}}]).directive("validationErrorMessage",[function(){return{restrict:"A",link:function(a,b,c){var d="<span>"+c.validationErrorMessage+"</span>";b.wrap("<div class='error-message'></div>"),b.bind("click",function(a){var b=angular.element(a.target);b.parent().removeClass("has-errors").find("span").remove()}),b.bind("blur",function(a){var b=angular.element(a.target);b.hasClass("ng-invalid")?0===b.parent().find("span").length&&b.parent().addClass("has-errors").append(d):b.parent().removeClass("has-errors").find("span").remove()})}}}]).directive("validateLuhnCheck",[function(){return{require:"ngModel",restrict:"A",link:function(a,b,c,d){function e(a){if(!a)return!1;for(var b=a.length,c=0,d=[[0,1,2,3,4,5,6,7,8,9],[0,2,4,6,8,1,3,5,7,9]],e=0;b--;)e+=d[c][parseInt(a.charAt(b),10)],c^=1;return e%10===0&&e>0}d.$parsers.unshift(function(a){var b=e(a);return d.$setValidity("validateLuhnCheck",b),b?a:void 0}),d.$formatters.unshift(function(a){return d.$setValidity("validateLuhnCheck",e(a)),a})}}}])}(),function(){"use strict";angular.module("DashboardApp").directive("jwIcon",["ConfigService","Templates",function(a,b){return{restrict:"E",replace:!0,scope:{jwType:"@"},templateUrl:b.path("directives/icon")}}])}(),function(){"use strict";angular.module("DashboardApp").directive("jwImagePreview",["$compile","ConfigService",function(a,b){var c=b.get("overridePerEnvironment","baseDirectory")+"images/transparent-background.png",d='<div ng-if="jwImagePreview" class="tooltip-content medium" ng-class="direction" style="border: 1px solid #aab4c8; border-radius: 0;background-color: white; background-image: url(\''+c+'\');width: auto;"><img style="height: auto; width: auto; max-height: 320px; max-width: 480px;" ng-src="{{jwImagePreview}}"></img></div>';return{restrict:"A",scope:{jwImagePreview:"="},link:function(b,c,e){b.direction=e.jwDirection||"right-top";var f=angular.element(d);a(f)(b),c.append(f)}}}])}(),function(){"use strict";angular.module("DashboardApp").controller("FullPlayerViewController",["$document","$modalInstance","$timeout","$scope","ConfigService",function(a,b,c,d,e){c(function(){var b=angular.copy(d.setup);d.setMedia(b),a[0].querySelector(".modal-dialog").style.width=b.width+30+"px",jwplayer("full-preview").setup(b)},500),d.close=function(){b.close()}}]),angular.module("DashboardApp").directive("jwplayer",["$location","$modal","$sce","$timeout","$window","CacheService","ConfigService","CORSService","MathService","SessionService","Templates","UtilService",function(a,b,c,d,e,f,g,h,i,j,k,l){return{restrict:"E",scope:{setup:"=",maxHeight:"=",playerId:"=?",fullPreview:"=?",onReady:"&",onSetup:"&",modal:"=?",resizeParent:"=?",version:"=",videoKey:"=?",cleanUpPlayerStyles:"="},templateUrl:k.path("directives/player"),link:function(f,m,n){function o(b){var d=h[f.setup.release_channel+"Manifest"]||h.standaloneManifest;d.then(function(d){var e=d.data,h="http"==a.protocol()?"http://":"https://ssl.";h+="7"===b?"p.jwpcdn.com/player/v/"+e.version+"/jwplayer.js":g.get("publish","player","cdnHostedVersions",b)+"/jwplayer.js",h=c.trustAsResourceUrl(h),p(),f.playerUrls.push(h)})}function p(){try{jwplayer(f.playerId).stop(),jwplayer(f.playerId).remove(),delete e.jwplayer,f.cleanUpPlayerStyles()}catch(a){}}f.playerUrls=[],f.$watch("version",function(a){a&&o(a)}),f.$watch("setup.release_channel",function(){o(f.version)}),f.playerId=f.playerId||"player"+l.randomString(12),f.fullPreview=void 0===f.fullPreview?!0:f.fullPreview,f.setMedia=function(a){void 0!==a.playlist||void 0!==a.file&&-1!==a.file.indexOf("http")||(a.playlist=g.get("player","playlist")),a.related&&(a.related.file=g.get("player","related")),void 0!==a.image&&-1===a.image.indexOf("http")&&(a.image=void 0),a.hasOwnProperty("advertising")&&("vast"===a.advertising.client?a.advertising.hasOwnProperty("schedule")?""!==a.advertising.schedule&&void 0!==a.advertising.schedule&&(a.advertising.schedule=g.get("player","vmapURL")):""!==a.advertising.tag&&void 0!==a.advertising.tag&&(a.advertising.tag=g.get("player","vastURL")):"googima"===a.advertising.client&&""!==a.advertising.tag&&void 0!==a.advertising.tag&&(a.advertising.tag=g.get("player","googimaURL")))},f.$on("$destroy",p),f.onScriptLoad=function(){jwplayer.key=j.getPlayerLicense(f.version),q(),f.$apply()};var q=function(){var a;f.element=m,f.isScaled=!1,f.openFullView=function(){jwplayer().play(!1),b.open({templateUrl:k.path("modals/player-preview"),controller:"FullPlayerViewController",scope:f})},f.CONTAINER_HEIGHT=f.maxHeight;var c=function(b,c){if(0!==Object.keys(b).length){d.cancel(a);var e=angular.copy(f.setup)||{};f.setMedia(e);var g=e.width,h=e.height;if(f.isScaled=!1,f.CONTAINER_WIDTH||(f.CONTAINER_WIDTH=angular.element(f.element).parent()[0].offsetWidth),e.hasOwnProperty("aspectratio")){var j=e.aspectratio.split(":");if(j=parseFloat(j[0])/parseFloat(j[1]),f.CONTAINER_WIDTH/j>f.CONTAINER_HEIGHT-(e.hasOwnProperty("listbar")&&"bottom"==e.listbar.position?e.listbar.size:0)){if(e.hasOwnProperty("listbar")&&"bottom"==e.listbar.position){var k=i.min(f.CONTAINER_WIDTH/j,f.CONTAINER_HEIGHT);e.listbar.size=f.CONTAINER_HEIGHT*e.listbar.size/(k+e.listbar.size);var l=f.CONTAINER_HEIGHT-e.listbar.size;e.width=i.floor(l*j/f.CONTAINER_WIDTH*100)+"%",f.isScaled=!0}else e.width=i.floor(f.CONTAINER_HEIGHT*j/f.CONTAINER_WIDTH*100)+"%";h=f.CONTAINER_HEIGHT}else if(e.hasOwnProperty("listbar")&&"right"==e.listbar.position){var m=i.min(f.CONTAINER_HEIGHT*j,f.CONTAINER_WIDTH);e.listbar.size=f.CONTAINER_WIDTH*e.listbar.size/(m+e.listbar.size),e.width="100%",f.isScaled=!0}else e.width="100%",h=f.CONTAINER_WIDTH/j,e.hasOwnProperty("listbar")&&"bottom"==e.listbar.position?h+=parseInt(e.listbar.size):e.hasOwnProperty("listbar")&&"right"==e.listbar.position&&(h=(f.CONTAINER_WIDTH-e.listbar.size)/j)}else if(g>f.CONTAINER_WIDTH||h>f.CONTAINER_HEIGHT){f.isScaled=!0;var o=i.min(f.CONTAINER_HEIGHT/h,f.CONTAINER_WIDTH/g);e.width=g*o,e.height=h*=o,e.hasOwnProperty("listbar")&&(e.listbar.size*=o)}var p=function(){f.onReady(),f.$parent.$apply(),f.setup.autostart===!0&&(a=d(function(){jwplayer(f.playerId).play()},100))};f.onSetup(),f.adPlaying&&f.last_client&&("googima"==f.last_client?jwplayer(f.playerId).pauseAd(!0):"vast"==f.last_client&&jwplayer(f.playerId).play()),f.resizeParent&&f.element.parent().eq(0).css("height",(f.isScaled?h+32:h)+"px"),f.last_client=e.advertising&&e.advertising.client,n.modal||(e.autostart=!1,jwplayer(f.playerId).setup(e).onSetupError(p).onPlaylist(p).onAdPlay(function(){f.adPlaying=!0}).onAdComplete(function(){f.adPlaying=!1})),f.adPlaying=!1}};f.$watch("setup",c,!0)}}}}])}(),function(){"use strict";angular.module("DashboardApp").directive("script",["$document","$timeout",function(a,b){return{restrict:"E",scope:{onLoad:"&"},link:function(c,d,e){if("text/javascript-lazy"===e.type){var f=function(){var b=a[0].createElement("script");b.type="text/javascript";var f=e.src;if("undefined"!=typeof f)b.src=f;else{var g=d.text();b.text=g}b.onload=function(){c.onLoad()},d.replaceWith(b)};b(f,0)}}}}])}(),function(){"use strict";angular.module("DashboardApp").directive("jwMatchHeightOf",["$document","AnimationFrameService","MathService",function(a,b,c){return{restrict:"A",scope:{jwMatchHeightOf:"@"},link:function(c,d,e){b.requestAnimationFrame(function(){var b=a[0].getElementById(c.jwMatchHeightOf).getClientRects()[0].height;d[0].style.height=b+"px"})}}}])}(),function(){"use strict";angular.module("DashboardApp").directive("ngError",["$parse",function(a){return{restrict:"A",compile:function(b,c){var d=a(c.ngError);return function(a,b){b.on("error",function(b){a.$apply(function(){d(a,{$event:b})})})}}}}])}(),function(){"use strict";angular.module("DashboardApp").directive("jwPaginator",["$anchorScroll","$location","$timeout","ConfigService","Tables","Templates","TrackingService","UrlService",function(a,b,c,d,e,f,g,h){return{restrict:"E",scope:{change:"&",gaEventCategory:"@",jwSelectPageLength:"@",numPages:"=",page:"=",urlParam:"@"},templateUrl:f.path("directives/paginator"),link:function(b,d,f){function i(d,e){j(e,d);var g=parseInt(d);isNaN(g)||1>g?g=1:(a.yOffset=0,a()),g>b.numPages&&(g=b.numPages),b.page=g,f.change?c(function(){b.change()}):h.addUrlParam(b.urlParam,g.toString())}function j(a,c){b.gaEventCategory&&a&&c>0&&c<=b.numPages&&g.ga("send","event",b.gaEventCategory,a,n+c)}var k="Jump to Page",l="Page Forward",m="Page Back",n="page=";b.KEY_CODE_ENTER=13,b.PAGE_LENGTHS=e.VALID_PAGE_LENGTHS,b.value=e.getPageLength(),"undefined"==typeof f.urlParam&&(b.urlParam="page"),b.selectAll=function(a){a.target.select()},b.setPageLength=function(a){e.setPageLength(a),g.ga("send","event","Paginator","Change Page Length",a)},b.goToNextPage=function(){i(b.page+1,l)},b.goToPreviousPage=function(){i(b.page-1,m)},b.goToPage=function(a){i(a,k)}}}}])}(),function(){"use strict";function a(a){var b=a.type.split("/")[0];return"video"==b||"audio"==b}angular.module("DashboardApp").directive("jwDropzone",["ConfigService","Templates",function(b,c){return{restrict:"A",templateUrl:c.path("directives/dropzone"),link:function(b,c){var d=0,e={ready:"Drag & drop a file, or click to browse",hover:"Drop file to upload & embed",invalid:"Invalid file format",toomany:"Sorry, bulk content uploading must be done via the Content list."};b.quickPublishHint=e.ready,c.bind("drop",function(f){d+=1,f.dataTransfer&&1!=f.dataTransfer.files.length?(c.addClass("data-transfer-invalid"),b.quickPublishHint=e.toomany):f.dataTransfer&&!a(f.dataTransfer.files[0])?(c.addClass("data-transfer-invalid"),b.quickPublishHint=e.invalid):(c.removeClass("data-transfer-invalid"),b.quickPublishHint=e.hover),b.$apply()}),c.bind("dragleave",function(){d-=1,0===d&&(c.removeClass("data-transfer-invalid"),b.quickPublishHint=e.ready),b.$apply()})}}}]),angular.module("DashboardApp").directive("quickPublish",["$rootScope","$window","$timeout","ChunkedUploader","ConfigService","TurboService","SessionService","Templates","TrackingService","UrlVideoObject","VirtualVideoService",function(b,c,d,e,f,g,h,i,j,k,l){return{replace:!0,restrict:"E",scope:{blockRefresh:"=",canStore:"=",currentUploads:"=",setPublishModeContent:"="},templateUrl:i.path("directives/quick-publish"),link:function(i,m){function n(){i.quickPublishStatus="",i.quickPublishUpload=!1}function o(){i.quickPublishStatus="Quick Publish failed!"}function p(){i.quickPublishStatus="Quick Publish succeeded!"}function q(a){i.quickPublishType=a}function r(a){l.show(a,function(a){l.insert(a),l.resetCache();var b="external"==i.quickPublishType?"QP URL":"QP Upload";i.setPublishModeContent(a,b,!0)},angular.noop)}var s={};i.entitlement=h.determineEntitlement(),i.clearStatus=n,i.isValid=a,i.setQuickPublishType=q,i.supportedFiletypes=k.supportedFiletypes,i.urlHelpMessages=k.urlHelpMessages,i.updateState=function(a,b,c){a&&a.$dirty&&(a.$setValidity("protocol",c.isSupportedProtocol()),b&&b.$setAttempted(!0))},q("local"),i.initiateUpload=function(c,d){if(n(),s.file=c[0],!i.quickPublishUpload&&1==c.length&&0===d.length&&a(s.file)&&(!f.get("s3Turbo")||s.file.size>5e9))l.create({title:s.file.name,resumable:!0},function(a){i.quickPublishUpload=new e(s.file,a.uploadUrl,a.session_id,a.link.query.key),i.blockRefresh(!0,"You have one or more uploads in progress. Refreshing will cancel them."),i.quickPublishUpload.start(),s.id=i.quickPublishUpload.id,s.key=a.media.key,i.currentUploads.push(i.quickPublishUpload)},function(){b.$emit("upload:error",s.id)});else if(!i.quickPublishUpload&&1==c.length&&0===d.length&&a(s.file)&&f.get("s3Turbo")){var j=s.file;l.createTurbo(h.getAccountToken(),h.getSiteToken(),{videoType:j.type,title:j.name}).then(function(a){i.isError=!1,a.uploadUrl+="&AWSAccessKeyId="+a.results.link.query.AWSAccessKeyId,a.uploadUrl+="&Expires="+a.results.link.query.Expires,a.uploadUrl+="&Signature="+encodeURIComponent(a.results.link.query.Signature),s.id=a.results.media.key,s.key=a.results.media.key,s.turbo=!0,i.quickPublishUpload={file:j,turbo:!0,key:a.results.media.key,id:a.results.media.key},g.sendVideo(a.uploadUrl,j,i.quickPublishUpload,function(a){i.$apply(function(){a.progress=a.progress})}),i.blockRefresh(!0,"You have one or more uploads in progress. Refreshing will cancel them."),i.currentUploads.push(i.quickPublishUpload)})["catch"](function(){i.$emit("viewError")})}},i.quickPublishUrl=new k,i.quickPublishSubmit=function(a,b){function c(a){i.quickPublishUrl=new k,b.setTriggered(!1),b.updateInitial(),p(),r(a.key)}return n(),"direct"==a?i.quickPublishUrl.save().then(c,o):"upload"==a?i.quickPublishUrl.upload().then(c,o):void 0},i.$on("upload:complete",function(a,b){var c=s.file.size>1e8?1e4:5e3;if(b===s.id){if(n(),s.turbo){var e=s.key;d(function(){r(e)},c)}else r(s.key);s={}}}),i.$on("upload:cancel",function(a,b){b===s.id&&(n(),s={})}),i.$on("upload:error",function(a,b){b===s.id&&(s={},o())}),i.sendGaEventLink=function(a,b,d){a.stopPropagation(),a.preventDefault(),j.ga("send","event",b,d,{hitCallback:function(){c.location=a.target.href}})}}}}])}(),function(){"use strict";angular.module("DashboardApp").directive("jwSearch",["Templates","UrlService",function(a,b){function c(a,c,d){a.KEY_CODE_ENTER=13,a.clearSearchResults=function(){b.removeUrlParam("page"),b.removeUrlParam("search","")}}return{link:c,restrict:"E",scope:{jwId:"@",jwDispatchSearch:"&",jwPlaceholder:"@",jwSearchQuery:"=",jwSearchTerms:"="},templateUrl:a.path("directives/search")}}])}(),function(){"use strict";angular.module("DashboardApp").directive("pageSection",["$timeout","$document","ConfigService","Templates",function(a,b,c,d){return{restrict:"E",transclude:!0,scope:{heading:"@",tip:"@",sideHeading:"@",pullMiscLeft:"=","class":"@",tooltipClass:"@",tooltipContent:"@",formId:"@",buttonText:"@",buttonTextAction:"@",buttonFunction:"&",loading:"&",submitting:"&",loadingFailed:"=",errorMessage:"=?",successMessage:"=?",warningMessage:"=?",mode:"@",pageSelectModel:"=",pageSelectModelProperty:"@",pageSelectChange:"=",pageSelectShow:"=",pageSelectOptions:"=",table:"="},templateUrl:d.path("directives/section"),link:function(c,d,e,f,g){c.mode="undefined"==typeof c.mode?"form":c.mode,c.successMessage=c.successMessage||{success:void 0},c.pageSelectModelProperty||(c.pageSelectModelProperty="name"),c.getButtonText=function(){return"undefined"==typeof c.buttonText?"Save":c.buttonText},c.getButtonTextAction=function(){return"undefined"==typeof c.buttonTextAction?"Saving":c.buttonTextAction},c._buttonText=c.getButtonText(),c.submitForm=function(){c.errorMessage=void 0,c.successMessage.success=void 0,e.formId?b[0].getElementById(e.formId).jwSubmit():c.buttonFunction()},c.loadingError=function(){return"undefined"!=typeof c.loadingFailed?c.loadingFailed:!1},c.showWarning=function(){return"undefined"!=typeof c.warningMessage&&""!==c.warningMessage},c.showError=function(){return"undefined"!=typeof c.errorMessage&&""!==c.errorMessage},c.showSuccess=function(){return!!c.successMessage.success},c.contentLoading=function(){var a=c.loading();return"undefined"==typeof a?!1:a},c.showButton=function(){return"form"===c.mode?d.find("form").length>0:"modal"===c.mode},c.$watch("successMessage.success",function(b,d){""!==b&&a(function(){c.successMessage.success=""},3e3)}),c.$watch(function(){return c.submitting()},function(a,b){a===!0&&b===!1?c._buttonText=c.getButtonTextAction():a===!1&&b===!0&&(c._buttonText=c.getButtonText())}),c.isFormButtonDisabled=function(){if("form"===c.mode&&c.showButton()){var a=d.find("form").controller("form");return a.$pristine||c.submitting()}return"modal"===c.mode,!1},g(c.$parent,function(a,b){var c=d.find("transclude");c.append(a)})}}}])}(),function(){"use strict";angular.module("DashboardApp").directive("jwSubmit",["$parse",function(a){return{restrict:"A",require:["jwSubmit","?form"],controller:["$scope",function(a){this.attempted=!1;var b=null,c=function(a,b){return _.isString(b)&&(b=b.split(",")),_.any(b,function(b){return a.$error[b]})};this.setAttempted=function(){this.attempted=!0},this.setFormController=function(a){b=a},this.needsAttention=function(a,d){if(!b)return!1;var e=a||b,f=d?c(e,d):e.$invalid;return f&&(e.$attempted||this.attempted)}}],compile:function(b,c,d){var e=function(a){var b=[];return a.attr("ng-model")&&b.push(a),_.each(a.children(),function(a){b=b.concat(e(angular.element(a)))}),b},f=function(a,b,c){_.each(b,function(b){var d=b.controller("ngModel");d.$attempted=!1;var e=b.bind("blur",function(){b.hasClass("ng-pristine")||a.$apply(function(){d.$attempted=!0,b.addClass("jw-attempted"),b.unbind("blur",e)})});b.bind("keyup",function(){d.$viewValue&&a.$apply(function(){c.$setDirty()})})})};return{pre:function(a,b,c,d){var e=d[0],f=d.length>1?d[1]:null;e.setFormController(f),a.jw=a.jw||{},a.jw[c.name]=e},post:function(b,c,d,g){var h=g[0],i=g.length>1?g[1]:null,j=a(d.jwSubmit),k=e(c),l=function(){return h.setAttempted(),b.$$phase||b.$apply(),i.$valid?void j(b,{}):!1};c.bind("submit",l),c[0].jwSubmit=l,b.$watch(function(){return i.$pristine},function(a){a&&f(b,k,i)})}}}}}])}(),function(){"use strict";angular.module("DashboardApp").directive("a",["$timeout","CommunicationService",function(a,b){return{restrict:"E",link:function(c,d,e){var f,g;f=/^http[s]{0,1}:\/\/support\.jwplayer\.com/i,e.href&&e.href.match(f)&&(g=e.href,b.get("/account/support/"+btoa(g)+"/").then(function(b){d.on("click contextmenu",function(c){d.attr("href",b.multipass),a(function(){d.attr("href",g)},1e3)})}),d.attr("target","_blank"))}}}])}(),function(){"use strict";angular.module("DashboardApp").directive("switch",["$timeout","ConfigService","Templates",function(a,b,c){return{restrict:"E",require:"^form",scope:{onLabel:"=?",offLabel:"=?",on:"=?",callback:"&",readonly:"=?"},templateUrl:c.path("directives/switch"),link:function(b,c,d,e){var f=function(){e.$pristine=!1};"undefined"==typeof d.on&&(b.on=!1),"undefined"==typeof d.onLabel&&(b.onLabel="on"),"undefined"==typeof d.offLabel&&(b.offLabel="off"),b.onClick=function(){d.disabled||b.readonly||d.disabled||(b.on=!b.on,f(),a(function(){b.callback()}))}}}}])}(),function(){"use strict";angular.module("DashboardApp").directive("jwTable",["$compile",function(a){function b(b,d){function e(a,b,c){function d(a){return a&&a.sort}function e(a){return a&&a.sortable}function m(b){_.chain(a.jwTable.columns).filter(function(a){return a.sortable&&b!==a}).each(function(a){delete a.sort});var c=!1;c=null!==q&&b!==q?!1:b.sort?!b.sort.reverse:a.jwTable.sort.reverse,b.sort={reverse:c},q=b}function n(b){d(a.jwTable)&&e(b)&&(m(b),a.jwTable.sort.callback(b))}function o(a){return a.sort?a.sort.reverse?"collapse":"expand":"sort"}function p(){_.each(b.find("tbody").find("tr"),function(b){var c=angular.element(b).find("td").find("input");c[0]&&(c.scope().jwSelectable.selected=a.selected)})}a.isColumnSortable=e,a.isTableSortable=d,a.sortBy=n,a.sortType=o,a.toggleAllSelected=p,a.hasSelectableRows=f,a.extraRowsRange=function(){if(!a.jwTable)return[];var b=0;return angular.isNumber(a.jwTable.minimumRows)?b=a.jwTable.minimumRows:angular.isFunction(a.jwTable.minimumRows)&&(b=a.jwTable.minimumRows()),_.range(b-(a.jwTable.rows||[]).length)};var q=null;if(j(a),k(a),l(a),b.prepend(h),b.prepend(g),b.find("tbody").append(i),d(a.jwTable)){var r=_.findWhere(a.jwTable.columns,{key:a.jwTable.sort.by});e(r)&&m(r)}f&&a.$watch("jwTable.rows",function(c,d){var e=_.pluck(c,"selected");a.selected=c&&c.length&&_.every(e),b.find("thead").find("th").find("input")[0].indeterminate=_.some(e)&&!a.selected},!0)}var f=!!b.find("tbody").find("tr").find("td").attr("jw-selectable"),g=angular.element(c.colgroup),h=angular.element(c.thead),i=angular.element(c.tr);f&&(g.prepend(angular.element(c.col)),h.find("tr").prepend(angular.element(c.th)));var j=a(g),k=a(h),l=a(i);return e}var c={col:'<col class="selectable" />',colgroup:["<colgroup>",'<col ng-repeat="column in jwTable.columns track by $index" ng-class="column.key" />',"</colgroup>"].join(""),th:'<th><input type="checkbox" class="selectable" ng-model="selected" ng-change="toggleAllSelected()" /></th>',thead:["<thead>","<tr>",'<th ng-repeat="column in jwTable.columns track by $index"','class="{{column.key}}"','ng-class="{',"hover: isTableSortable(jwTable) && isColumnSortable(column),",'}"','ng-click="sortBy(column)">',"{{column.display || column.key}}",'<jw-icon class="icon-xs"','jw-type="{{sortType(column)}}"','ng-show="isTableSortable(jwTable) && isColumnSortable(column)">',"</jw-icon>",'<span class="tooltip" ng-if="column.tooltip">','<svg class="icon-med icon-info">','<use xlink:href="#icon-info"></use>',"</svg>",'<span class="tooltip-content bottom-center small">',"{{column.tooltip}}","</span>","</span>","</th>","</tr>","</thead>"].join(""),tr:['<tr ng-repeat="i in extraRowsRange()">','<td colspan="{{hasSelectableRows + jwTable.columns.length}}"></td>',"</tr>"].join("")};return{compile:b,restrict:"A",scope:{jwTable:"="}}}]).directive("jwSelectable",["$compile",function(a){return{restrict:"A",scope:{jwSelectable:"="},template:'<input type="checkbox" class="selectable" ng-model="jwSelectable.selected" />'}}])}(),function(){"use strict";angular.module("DashboardApp").filter("range",[function(){return function(a,b){b=parseInt(b);for(var c=0;b>c;c++)a.push(c);return a}}]),angular.module("DashboardApp").filter("capitalize",[function(){return function(a){return _.isNull(a)||_.isUndefined(a)||!_.isString(a)?void 0:a.charAt(0).toUpperCase()+a.substring(1)}}]),angular.module("DashboardApp").filter("zeroPad",[function(){return function(a,b){if("undefined"!=typeof a){b="number"==typeof b?b:2;for(var c=a.toString();c.length<b;)c="0"+c;return c}return""}}]),angular.module("DashboardApp").filter("menuTitle",[function(){return function(a,b){a=a||"";var c=a.trim();return c=c.replace("_"," "),c=c.replace("-"," "),c=c.replace(/\s+/g," "),b?c=c.toUpperCase():(c=c.replace(/^\w/g,function(a){return a.charAt(0).toUpperCase()}),c=c.replace(/\s\w/g,function(a){return" "+a.charAt(1).toUpperCase()})),c}}]),angular.module("DashboardApp").filter("smartTruncate",[function(){return function(a,b,c,d){b="number"==typeof b?parseInt(b,10):30,c="number"==typeof c?parseInt(b,10):10,d="string"==typeof d?d:"…";var e,f,g=b+c;if(a.length>g){if(e=a.indexOf(" ",b),e>g&&a.indexOf(" ")<b)for(f=b;(f-=1)&&(e=a.indexOf(" ",f),!(e>0&&g>e)););else(e>g||0>e)&&(e=b);return a.substring(0,e)+d}return a}}]),angular.module("DashboardApp").filter("holderOnEmpty",[function(){return function(a,b){return"undefined"==typeof a||null===a||"string"==typeof a&&(""===a.trim()||"null"===a.trim())?b:a}}]),angular.module("DashboardApp").filter("unitConversion",["$interpolate","MathService",function(a,b){return function(a,b){return angular.isDefined(a)?a*b:void 0}}]),angular.module("DashboardApp").filter("bytesToGibibytes",["MathService","unitConversionFilter",function(a,b){var c=1/a.pow(1024,3);return function(a){return b(a,c)}}]),angular.module("DashboardApp").filter("bytesToGigabytes",["MathService","unitConversionFilter",function(a,b){var c=1e-9;return function(a){return b(a,c)}}]),angular.module("DashboardApp").filter("units",["numberFilter",function(a){return function(b){return b>=1e6?a(b/1e6)+"M":a(b/1e3)+"K"}}]),angular.module("DashboardApp").filter("usageLimit",["unitsFilter","numberFilter",function(a,b){return function(c,d){return null!==c&&null!==d?"Ads"===d?a(1e3*c)+" Ad Impressions":b(c)+" "+d:void 0}}]),angular.module("DashboardApp").filter("overageRate",["currencyFilter",function(a){return function(b){return b.overagePrice>0?"Ad"==b.typeSingular?a(b.overagePrice)+" cpm":a(b.overagePrice)+" / "+b.typeSingular:void 0}}]),angular.module("DashboardApp").filter("shortDate",["zeroPadFilter",function(a){return function(b){if("number"==typeof b){var c=new Date(1e3*b);return c.toString().split(" ")[1]+" "+a(c.getDate())}return b}}]),angular.module("DashboardApp").filter("longDate",["dateFilter",function(a){return function(b){return"number"==typeof b?a(1e3*b,"yyyy-MM-dd"):b}}]),angular.module("DashboardApp").filter("humanDate",[function(){return function(a){if("number"==typeof a){var b=new Date(1e3*a);return b.toDateString()}return a}}]),angular.module("DashboardApp").filter("timestampToDate",["zeroPadFilter",function(a){return function(b){if("number"==typeof b){var c=new Date(1e3*b);return c.getUTCFullYear()+"/"+a(c.getUTCMonth()+1)+"/"+a(c.getUTCDate())}return b}}]),angular.module("DashboardApp").filter("timestampToTime",["zeroPadFilter",function(a){return function(b){if("number"==typeof b){var c=new Date(1e3*b);return a(c.getUTCHours())+":"+a(c.getUTCMinutes())+":"+a(c.getUTCSeconds())}return b}}]),angular.module("DashboardApp").filter("readableDuration",["MathService","zeroPadFilter",function(a,b){return function(c,d){var e=parseInt(a.round(parseFloat(c)),10),f=0,g=e%60,h=e-g;return 0!==e||d?(h>0&&(h%=3600,f=(e-(g+h))/3600,h/=60),b(f)+":"+b(h)+":"+b(g)):"N/A"}}]),angular.module("DashboardApp").filter("productList",[function(){return function(a){return a.join(" + ")}}]),angular.module("DashboardApp").filter("paymentMethodDisplay",[function(){return function(a){return"CreditCard"==a?"Credit Card":a}}]),angular.module("DashboardApp").filter("transactionCycle",["MathService",function(a){return function(b){if("string"!=typeof b){var c=a.round((b.periodEnd-b.periodStart)/86400);return[28,29,30,31].indexOf(c)>-1?"Monthly":[364,365,366].indexOf(c)>-1?"Annual":c+" Days"}return"Month"===b?"Monthly":"Year"===b?"Annual":void 0}}])}(),function(){"use strict";angular.module("DashboardApp").constant("_localconfig",{overridePerEnvironment:{autoPlayer:"http://content.jwplatform.com/libraries/",baseDirectory:"/64/",communication:{apiRootUrl:"https://api.jwplayer.com/v2",delegateLogoutUrl:"https://account.jwplayer.com/logout/delegate",delegateLoginUrl:"https://account.jwplayer.com/sign-in"},contentLocation:"content.jwplatform.com",recurlyKey:"sjc-S2SZyP2fw79Q63ubyPne3Z",hostedPlayer:"https://jwpsrv.com/library/",ga:{id:"UA-42148455-3"},useDelegateLogin:!0,CORSService:{SDKMobileManifest:"https://ssl.p.jwpcdn.com/sdks/mobile_version_manifest.json",standaloneManifest:"https://ssl.p.jwpcdn.com/player/channel/production/package.json",productionManifest:"https://ssl.p.jwpcdn.com/player/channel/production/package.json",stagingManifest:"https://ssl.p.jwpcdn.com/player/channel/staging/package.json",previousManifest:"https://ssl.p.jwpcdn.com/player/channel/previous/package.json",betaManifest:"https://ssl.p.jwpcdn.com/player/channel/beta/package.json"},realtimeAPI:"rt-api.jwplayer.com"}})}(),function(){"use strict";angular.module("ui.bootstrap.override",["template/datepicker/datepicker.html","template/datepicker/day.html"]).run(["$templateCache",function(a){a.put("template/datepicker/datepicker.html",'<div ng-switch="datepickerMode" role="application" ng-keydown="keydown($event)">\n  <daypicker ng-switch-when="day" tabindex="0"></daypicker>\n</div>'),a.put("template/datepicker/day.html",'<table role="grid" aria-labelledby="{{uniqueId}}-title" aria-activedescendant="{{activeDateId}}">\n  <thead>\n    <tr>\n      <th><button type="button" class="btn btn-default btn-sm pull-left jw-datepicker" ng-click="move(-1)" ng-show="leftPicker && !firstMonth" tabindex="-1"><jw-icon jw-type="arrow-left" class="icon-sm"></jw-icon></button></th>\n      <th colspan="5" class="text-center jw-datepicker"><strong>{{title}}</strong></th>\n      <th><button type="button" class="btn btn-default btn-sm pull-right jw-datepicker" ng-click="move(1)" ng-show="rightPicker && !lastMonth" tabindex="-1"><jw-icon jw-type="arrow-right" class="icon-sm"></jw-icon></i></button></th>\n    </tr>\n    <tr>\n      <th ng-repeat="label in labels track by $index" class="text-center jw-datepicker"><small aria-label="{{label.full}}">{{label.abbr}}</small></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr ng-repeat="row in rows track by $index">\n      <td ng-repeat="dt in row track by dt.date" class="text-center jw-datepicker" role="gridcell" id="{{dt.uid}}" aria-disabled="{{!!dt.disabled}}">\n        <button type="button" style="width:100%;" class="btn btn-default btn-sm jw-datepicker" ng-class="{\'btn-info\': dt.selected, active: isActive(dt), start: isStart(dt), end: isEnd(dt), range: inRange(dt), outsideMonth: !inMonth(dt)}" ng-click="select(dt.date); registerDate(dt)" ng-disabled="dt.disabled" tabindex="-1"><span ng-class="{\'text-muted\': dt.secondary, \'text-info\': dt.current}">{{dt.label}}</span></button>\n      </td>\n    </tr>\n  </tbody>\n</table>\n')}])}(),function(){"use strict";angular.module("DashboardApp").factory("AccountService",["CommunicationService",function(a){function b(a){angular.extend(this,a)}function c(a){return new b(a)}function d(b,c){return a.post("/account/accounts/"+b+"/",c)}function e(b,c){return a.get("/account/accounts/"+b+"/users_and_invites/",c)}function f(b,c){return a["delete"]("/account/accounts/"+b+"/users/"+c+"/")}function g(b,c){return a.get("/account/accounts/"+b+"/sites/",c)}function h(b,c,d,e,f){var g={accountRole:d};return"MANAGER"==d.toUpperCase()&&(g.siteTokens=e,g.siteRoles=f),a.post("/account/accounts/"+b+"/users/"+c+"/roles/",g)}function i(b){return a.post("/payments/accounts/"+b+"/cancel/")}function j(b,c){return a.put("/payments/accounts/"+b+"/feedback/cancel/",{feedback:c})}return{create:c,deleteAccount:d,getAccountUsersAndInvites:e,deleteAccountUser:f,swapAccountRoles:h,getAccountSites:g,cancelSubscription:i,sendCancelFeedback:j}}])}(),function(){"use strict";angular.module("DashboardApp").factory("AdBreaksService",["$q","CommunicationService","SessionService",function(a,b,c){function d(a){return i(a,k,angular.identity).promise}function e(a){return i(a,l,angular.noop).promise}function f(a){return i(a,m,angular.identity).promise}function g(a){return i(a,n,angular.identity).promise}function h(a){return i(a,o,angular.identity).promise}function i(d,e,f){var g=a.defer(),h={site_token:c.getSiteToken()};return angular.extend(h,d),b.botr(e,h,function(a){g.resolve(f(a))},function(a){g.reject(a)}),g}var j="/advertising/schedules/adbreaks",k=j+"/create",l=j+"/delete",m=j+"/list",n=j+"/show",o=j+"/update";return{create:d,"delete":e,list:f,show:g,update:h}}])}(),function(){"use strict";angular.module("DashboardApp").factory("AdTagsService",["$q","CommunicationService","SessionService",function(a,b,c){function d(a){return i(a,k,angular.identity).promise}function e(a){return i(a,l,angular.noop).promise}function f(a){return i(a,m,angular.identity).promise}function g(a){return i(a,n,angular.identity).promise;
}function h(a){return i(a,o,angular.identity).promise}function i(d,e,f){var g=a.defer(),h={site_token:c.getSiteToken()};return angular.extend(h,d),b.botr(e,h,function(a){g.resolve(f(a))},function(a){g.reject(a)}),g}var j="/advertising/adtags",k=j+"/create",l=j+"/delete",m=j+"/list",n=j+"/show",o=j+"/update";return{create:d,"delete":e,list:f,show:g,update:h}}])}(),function(){"use strict";angular.module("DashboardApp").factory("AdSchedulesService",["$q","CommunicationService","SessionService",function(a,b,c){function d(a){return i(a,k,angular.identity).promise}function e(a){return i(a,l,angular.noop).promise}function f(a){return i(a,m,angular.identity).promise}function g(a){return i(a,n,angular.identity).promise}function h(a){return i(a,o,angular.identity).promise}function i(d,e,f){var g=a.defer(),h={site_token:c.getSiteToken()};return angular.extend(h,d),b.botr(e,h,function(a){g.resolve(f(a))},function(a){g.reject(a)}),g}var j="/advertising/schedules",k=j+"/create",l=j+"/delete",m=j+"/list",n=j+"/show",o=j+"/update";return{create:d,"delete":e,list:f,show:g,update:h}}])}(),function(){"use strict";angular.module("DashboardApp").config(["$httpProvider",function(a){a.interceptors.push("AdBlockInterceptor")}]),angular.module("DashboardApp").factory("AdBlockInterceptor",["AdBlockBaseService",function(a){return{responseError:function(b){return".html"===b.config.url.slice(-5)&&_.any(["ads","advertising"],function(a){return-1!==b.config.url.indexOf(a)})&&a.handleBlock(),b}}}]),angular.module("DashboardApp").factory("AdBlockBaseService",function(){var a=!1;return{isBlocked:function(){return a},handleBlock:function(){a=!0}}}),angular.module("DashboardApp").factory("AdBlockService",["$templateRequest","$route","AdBlockBaseService",function(a,b,c){function d(){a(b.routes["/ads/list"].templateUrl,!0)}return angular.extend(c,{testBlocker:d})}])}(),function(){"use strict";angular.module("DashboardApp").factory("AnalyticsService",["$filter","$interpolate","$routeParams","CommunicationService","ConfigService","SessionService",function(a,b,c,d,e,f){function g(a,b,c,e,f){return d.get(a(i(b,c)),{},e,f,!1,j())}function h(b){if("custom"!=b.dateRange&&!b.endDate&&!b.startDate){var c=parseInt(b.dateRange.slice(0,-1)),d=(new Date).getTime(),e=d-864e5*c;b.endDate=a("date")(d,"yyyy-MM-dd"),b.startDate=a("date")(e,"yyyy-MM-dd")}return b}function i(a,b){a&&a.dateRange&&angular.extend(a,h(a)),a&&!a.dateRange&&(a.dateRange=c.dateRange);var d=a||{},e=_.extend(d,b&&_.keys(b).length&&{query:"%3F"+_.toQuery(b)});return"undefined"==typeof e.accountToken&&(e.accountToken=f.getSiteSlug()),e}function j(){return{Authorization:f.getAnalyticsSignature()}}var k="/accounts/{{accountToken}}",l="/countries",m="/devices",n="/engagement",o="/domains",p="/mediaid/{{mediaId}}",q="/topvideos",r="/multiplemedias/{{mediaIds}}",s="/last_updation_time",t="/user_alert",u="/v2",v="/non-media",w="/start-date/{{startDate}}",x="/end-date/{{endDate}}",y="/start_date/{{startDate}}",z="/end_date/{{endDate}}",A={getLastUpdateTime:s,getMetrics:u+k,getMetricsByDateRange:u+k+y+z,getMetricsByMediaId:u+k+p,getMetricsByMediaIdByDateRange:u+k+p+y+z,getMetricsByDevice:u+k+m,getMetricsByDeviceByDateRange:u+k+m+y+z,getMetricsByMediaIdByDevice:u+k+p+m,getMetricsByMediaIdByDeviceByDateRange:u+k+p+m+y+z,getMetricsByTopVideos:u+k+q+y+z,getMetricsByTopVideosByDateRange:u+k+q+y+z,getMetricsByDomains:u+k+o+y+z,getMetricsByDomainsByDateRange:u+k+o+y+z,getMetricsByMediaIdByDomains:u+k+p+o,getMetricsByMediaIdByDomainsByDateRange:u+k+p+o+y+z,getMetricsByMediaIdByEngagement:u+k+p+n,getMetricsByMediaIdByEngagementByDateRange:u+k+p+n+y+z,getMetricsByCountry:u+k+l,getMetricsByCountryByDateRange:u+k+l+y+z,getMetricsByMediaIdByCountry:u+k+p+l,getMetricsByMediaIdByCountryByDateRange:u+k+p+l+y+z,getMetricsByMultipleMediaIdsByDateRange:u+k+r+y+z,getUsageMetrics:"/v1"+v+k+w+x,getUserAlert:u+t},B="/proxy/analytics",C="{{query}}",D=_.mapObject(A,function(a){return b(B+a+"/"+C)});return _.mapObject(D,function(a){return _.partial(g,a)})}])}(),function(){"use strict";angular.module("DashboardApp").factory("AnalyticsRealtimeService",["$interpolate","$http","CommunicationService","ConfigService","SessionService","$q",function(a,b,c,d,e,f){function g(a,c,d){c=c||{},"undefined"==typeof c.accountToken&&(c.accountToken=e.getAnalyticsSignature()),c.query=d&&"?"+_.toQuery(d)||"";var g=f(function(d,e){var f={method:"GET",url:q+a(c),timeout:g};b(f).then(function(a){d(a.data)})["catch"](function(){e.apply(this,arguments)})});return g}var h="/account/{{accountToken}}",i="/global",j="/device",k="/domain",l="/mediaid",m="/v2/rt",n="https",o={getMetrics:h,getMediaMetrics:h+l,getDeviceMetrics:h+j,getDomainMetrics:h+k,getGlobalMetrics:h+i},p="{{query}}",q=n+"://"+d.get("overridePerEnvironment","realtimeAPI")+m,r=_.mapObject(o,function(b){return a(b+"/"+p)});return _.mapObject(r,function(a){return _.partial(g,a)})}])}(),function(){"use strict";angular.module("DashboardApp").factory("AnalyticsReportService",["CommunicationService",function(a){var b={overview:0,content:1,domain:2,contentDetail:3},c=function(c){return c.type&&!Number.isInteger(c.type)&&(c.type=b[c.type]),a.put("/analytics/reports/",c)},d=function(c){return c.type&&!Number.isInteger(c.type)&&(c.type=b[c.type]),a.get("/analytics/reports/",c)};return{createReport:c,downloadReport:d}}])}(),function(){"use strict";angular.module("DashboardApp").factory("VirtualAssetService",["AssetService","VirtualizeService",function(a,b){return b.virtualize(a,"AssetService")}]).factory("AssetService",["$http","CacheService","CommunicationService","ConfigService","LocalStorageService","SessionService",function(a,b,c,d,e,f){function g(a,b,d){var e=_.pluck(a,"key").join(",");c.botr(x,{site_token:f.getSiteToken(),image_key:e},b,d)}function h(a,c,f){var g,h;g=d.get("maxSmallAssetCacheSize"),a.size<g?(h=new FileReader,h.onloadend=function(){b.put(h.result,u,c),e.put(h.result,u,c),(f||angular.noop)(h.result)},h.readAsDataURL(a)):(f||angular.noop)(null)}function i(a,b,d){var e=this;c.botr(w,{name:a.assetFile.name||"Unnamed",type:a.assetType,site_token:f.getSiteToken()},function(c){e.cacheAsset(a.assetFile,c.media.key);var f=e.createUploadUrl(c);e.uploadAssetToUrl(a.assetFile,f,_.partial(b,{name:a.assetFile.name,key:c.media.key}),d)},d)}function j(a){return a&&a.link?["//",a.link.address,a.link.path].join(""):null}function k(a){return b.has(u,a.key)?b.get(u,a.key):e.has(u,a.key)?e.get(u,a.key):this.createAssetUrl(a)}function l(a){if(a&&"success"==a.status&&a.link){var b,c=a.link;return b="//"+c.address+c.path+"?api_format=json",b=b+"&key="+c.query.key+"&token="+c.query.token}return null}function m(a,b,d){this.purgeCachedAsset(a),c.botr(x,{site_token:f.getSiteToken(),image_key:a.key},b,d)}function n(a){return b.has(u,a.key)||e.has(u,a.key)}function o(a,b,d){var e=a.sortReverse?"desc":"asc",g={order_by:a.sort+":"+e,result_limit:a.limit,result_offset:a.offset,site_token:f.getSiteToken()};a.searchQuery&&(g.search=a.searchQuery);var h=this;return c.botr(y,g,function(a){_.each(a.images,function(a){"ready"===a.status&&h.purgeCachedAsset(a)}),b(a.images,a.total)},d)}function p(a){b.remove(u,a.key),e.remove(u,a.key)}function q(a,b,c,d){function e(a){f.cacheAsset(b.assetFile,a.media.key);var e=f.createUploadUrl(a);f.uploadAssetToUrl(b.assetFile,e,c,d)}var f=this;return this.update(a,{status:"updating",type:b.assetType,update_file:"True"},e,d)}function r(a,b,d){a&&c.botr(z,{site_token:f.getSiteToken(),image_key:a},b,d)}function s(a,b,d,e){c.botr(A,_.extend({site_token:f.getSiteToken(),image_key:a.key},b),d,e)}function t(b,c,d,e){var f=new FormData;f.append("file",b),a.post(c,f,{transformRequest:angular.identity,headers:{"Content-Type":void 0}}).then(function(a){"function"==typeof d&&d(a.data)})["catch"](function(a){"function"==typeof e&&e(a)})}var u="small-asset",v="/accounts/images",w=v+"/create",x=v+"/delete",y=v+"/list",z=v+"/show",A=v+"/update";return{bulkDelete:g,cacheAsset:h,create:i,createAssetUrl:j,createPreviewUrl:k,createUploadUrl:l,"delete":m,isAssetCached:n,list:o,purgeCachedAsset:p,recreate:q,show:r,update:s,uploadAssetToUrl:t}}])}(),function(){"use strict";angular.module("DashboardApp").factory("AuthenticationService",["$cookies","$document","$location","$rootScope","$routeParams","$timeout",function(a,b,c,d,e,f){function g(b){return void 0!==a[b]&&null!==a[b]}function h(){return g(p)}function i(){return a[p]}function j(){delete a[p]}function k(){return q}function l(a,b){return a.split(".")[0]===b.split(".")[0]}function m(b){a.unifiedDashboardAuth=b}function n(){if(g(q)){m(a[q]),delete a[q];var d=c.host(),f=d.substring(d.lastIndexOf(".",d.lastIndexOf(".")-1)+1);return b[0].cookie=q+"=; expires=Thu, 01 Jan 1970 00:00:01 GMT; domain=."+f+"; path=/",!0}return e[q]?(m(e[q]),!0):!1}function o(){var a=i().split(".");return a[0]}var p="unifiedDashboardAuth",q=p+"Redirect";return d.$watch(function(){return a.unifiedDashboardAuth},function(a,b){void 0!==b&&void 0===a?d.$emit("authorizationRevoked"):void 0===b&&void 0!==a?d.$emit("authorizationGranted"):b!==a&&(l(b,a)||d.$emit("authorizationChanged"))}),{isAuthorized:h,getSignature:i,setSignature:m,clearSignature:j,getUserToken:o,applyRedirectAuth:n,getAuthRedirect:k}}])}(),function(){"use strict";angular.module("DashboardApp").factory("PollingBotrAccountService",["$location","AuthenticationService","BotrAccountService","PollingService","SessionService",function(a,b,c,d,e){function f(){c.get(!1).then(function(a){_.isEqual(a,j)||_.each(_.keys(g),function(b){g[b](a)}),j=a,h=!1})["catch"](function(c){c.data&&"PermissionError"==c.data.code&&(e.getSiteToken()==e.getAccount().defaultSite?b.clearSignature():(e.setSiteToken(e.getAccount().defaultSite),a.search({property:e.getAccount().defaultSite}),e.refreshSession(),i.restart()))})}var g,h,i,j;return j={},i=new d(f,3e5),h=!0,g={},{addCallback:function(a,b){g[a]=b,h||b(j)},canStore:function(){return j.can_store},canStream:function(){return j.can_stream},get:function(){return j},pending:function(){return h},resetInterval:function(){i.restart()},startInterval:function(){i.start()}}}]),angular.module("DashboardApp").factory("BotrAccountService",["$q","AuthenticationService","CacheService","CommunicationService","MathService","SessionService",function(a,b,c,d,e,f){function g(a){angular.extend(this,a),this.storage.percent=100*e.min(this.storage.used/this.storage.limit,1),this.traffic.percent=100*e.min(this.traffic.used/this.traffic.limit,1),this.contactUs=!(this.can_store&&this.can_stream)}function h(a){return new g(a)}function i(b,e){var g=e&&e.siteToken||f.getSiteToken();return a(b&&c.has(l,g)?function(a){a(c.get(l,g))}:function(a,b){d.botr("/accounts/show",{site_token:g}).then(function(b){var d=h(b.account);c.put(d,l,g),a(d,!1)})["catch"](b)})}function j(a){var b={site_token:f.getSiteToken()};return angular.extend(b,a),d.botr("/accounts/update",b).then(function(){return i(!1,{siteToken:b.site_token})})}function k(a){return i(!0).then(function(b){var c={site_token:f.getSiteToken(),account_key:b.key,include_empty_days:!0,start_date:f.getAccount().createDate||0};return a.siteToken&&(c.site_token=a.siteToken),a.accountKey&&(c.account_key=a.accountKey),d.botr("/accounts/usage/show",c)})}var l="botr-account";return g.prototype={$canStream:function(){try{return this.can_stream}catch(a){}return!1},$canStore:function(){try{return this.can_store}catch(a){}return!1},$secureEmbeds:function(){try{return!this.restrictions.embeds.allow}catch(a){}return!1},$secureUrls:function(){try{return!this.restrictions.downloads.allow}catch(a){}return!1}},{create:h,get:i,getUsage:k,update:j}}])}(),function(){"use strict";angular.module("DashboardApp").factory("PromoService",["CommunicationService",function(a){function b(){return a.get("/account/promos/")}return{getPromo:b}}])}(),function(){"use strict";angular.module("DashboardApp").factory("ChartService",["$rootScope","$filter",function(a,b){function c(c,d,g){var h=[],i=g?a.trendingStartTime:a.dateRangeStart;0===new Date(i).getHours()&&(i+=e/2);for(var j=a.dateRangeEnd+e,k=i;j>k;k+=e){var l=b("date")(k,f);if(c[l])h.push(c[l]);else{var m={};angular.extend(m,d),m.date=l,h.push(m)}}return h}function d(a,b,c){var d=c||d3.keys(_.first(b)).filter(function(b){return a!==b}),e=[];return d.forEach(function(c){var d={group:e,dependentVariable:c,independentVariable:a};d.values=b.map?b.map(function(b){return{series:d,dependentVariableValue:b[c],independentVariableValue:Date.parse(b[a])}}):[],e.push(d)}),e.dependentVariables=d,e.independentVariable=a,e}var e=864e5,f="yyyy-MM-dd";return{padDateData:c,groupDataIntoSeries:d}}])}(),function(){"use strict";angular.module("DashboardApp").factory("ChartDirectiveService",["$compile","$filter","$interpolate","$templateRequest","ConfigService","d3","Templates",function(a,b,c,d,e,f,g){function h(b,h){"undefined"==typeof h&&(h=function(a){return a&&(a.length||a.data&&a.data.length)});var i={link:function(j,k,l){j.loading=!0,d(e.get("overridePerEnvironment","baseDirectory")+"templates/directives/analytics/chart-loading.html").then(function(b){b=angular.element(b),k.append(b),a(b)(j)}),i.onLink&&i.onLink.apply(this,arguments),j.$on("$destroy",i.cleanup||angular.noop),j.getZeroData=function(a){a(i.zeroData||[])},j.jwDataFunction&&j.jwDataFunction(function(m){function n(a,b){var e=f.tip().attr("class","d3-tip"),h=e.show;e.show=function(){return(j.jwOnShowTooltip||angular.noop)(),h.apply(e,arguments)},b||(b="");var i="directives/analytics/chart"+b+"-tooltip";return d(g.path(i)).then(function(b){e.html(function(d){var e=a(d);return e.today&&(e.independentVariableValue+=" (Today)"),e.fullData&&e.legends.forEach(function(a,b){e.fullData.some(function(c){return c.dependentVariable==a.dependentVariable?(e["data"+b+"name"]=c.dependentVariable,e["data"+b+"value"]=c.filter(c.values[e.dataIndex].dependentVariableValue),e["color"+b]=e.color(c.dependentVariable),!0):void 0})}),c(b)(e)})}),j.$on("$destroy",_.bind(e.destroy,e)),e}j.loading=!1,(i.hasData||h)(m)?((i.drawGraph||b)(m,j,k[0],l,n),j.jwReadyFunction&&j.jwReadyFunction()):d(e.get("overridePerEnvironment","baseDirectory")+"templates/directives/analytics/chart-no-data-"+m.type+".html").then(function(b){b=angular.element(b),k.html(""),k.append(b),a(b)(j)})},function(){j.loading=!1,d(e.get("overridePerEnvironment","baseDirectory")+"templates/directives/analytics/chart-error.html").then(function(b){b=angular.element(b),k.html(""),k.append(b),a(b)(j)})})},restrict:"E",scope:{jwDataFunction:"=",jwReadyFunction:"=",jwOnShowTooltip:"&"}};return i}return{generateDirective:h,tooltipFormat:{number:function(a){return b("number")(a)}}}}])}(),function(){"use strict";angular.module("DashboardApp").factory("ChartLoaderService",["$timeout",function(a){function b(a){i=a,f=0,g=[],h=!1}function c(){f++}function d(){f--,0===f&&(i&&i.$emit("viewLoaded"),a(function(){if(!h){h=!0;for(var a in g)g[a][0](g[a][1])}}))}function e(a,b){h?a(b):g.push([a,b])}var f,g,h,i;return b(),{init:b,started:c,finished:d,callback:e}}])}(),function(){"use strict";angular.module("DashboardApp").factory("ChunkedUploader",["$http","$rootScope","MathService","VirtualVideoService",function(a,b,c,d){var e=2097152,f=0;return function(g,h,i,j){var k=this;k.key=j,k.id=f++,k.file=g,k.file_size=g.size,k.offset=0,k.isCompleted=!1,k.progress=this.offset/this.file_size,k.num_attempts=0;var l=g.name.replace(/[\u0080-\uffff]/g,"?"),m=encodeURIComponent(g.name);k.uploadNextChunk=function(){k.end_range=c.min(k.offset+e,k.file_size);var f=this.file.slice(k.offset,k.end_range,"application/octet-stream"),g=this.end_range-1;a.post(h,f,{headers:{"Content-Type":"application/octet-stream","Content-Disposition":'attachment; filename="'+l+"\"; filename*=UTF-8''\""+m+'"',"X-Content-Range":"bytes "+k.offset+"-"+g+"/"+k.file_size,"X-Session-ID":i}}).then(function(){k.offset=k.end_range,k.progress=c.round((k.offset+1)/k.file_size*100),k.num_attempts=0,k.end_range===k.file_size?k.isCompleted||(k.isCompleted=!0,d.resetCache(),b.$broadcast("upload:complete",k.id)):k.paused||k.uploadNextChunk(),b.$broadcast("upload:chunk",k.id)})["catch"](function(){k.num_attempts++,3==k.num_attempts?(k.errored=!0,b.$broadcast("upload:error",k.id)):k.uploadNextChunk()})},k.start=function(){k.isCompleted||(k.paused=!1,k.uploadNextChunk())},k.pause=function(){k.isCompleted||(k.paused=!0)}}}])}(),function(){"use strict";angular.module("DashboardApp").factory("Colorscales",["d3",function(a){function b(){function b(a){return h(a)}function f(){return _.map(c,function(a){return _.map(i,function(b){return b+"-"+a+"-"+d}).join(" ")})}function g(a){return _.map(e,function(b){return _.map(i,function(c){return c+"-"+a+"-"+b}).join(" ")})}var h=a.scale.ordinal(),i=[];return b.domain=function(a){return h.domain(a),b},b.bg=function(){return i=_.union(i,["bg"]),b},b.color=function(){return i=_.union(i,["color"]),b},b.fill=function(){return i=_.union(i,["fill"]),b},b.stroke=function(){return i=_.union(i,["stroke"]),b},b.contrasting15=function(){return h.range(f()),b},b.teal7=function(){return h.range(g("teal")),b},b.blue7=function(){return h.range(g("blue")),b},b.indigo7=function(){return h.range(g("indigo")),b},b.pink7=function(){return h.range(g("pink")),b},b.gold7=function(){return h.range(g("gold")),b},b.chart=function(a,c){for(var d=[],e=0;c>e;e++)d.push(_.map(i,function(b){return b+"-"+a+"-"+e}).join(" "));return h.range(d),b},b}var c=["teal","blue","indigo","pink","gold","lavender","light-green","rose","dark-green","orange","taupe","cerulean","sky","dark-red","violet"],d=3,e=[0,1,2,3,4,5,6];return b}])}(),function(){"use strict";angular.module("DashboardApp").factory("CORSService",["$http","ConfigService",function(a,b){return _.mapObject(b.get("overridePerEnvironment","CORSService"),function(b){return a.get(b)})}])}(),function(){"use strict";angular.module("DashboardApp").factory("CountryService",["ConfigService",function(a){function b(a){return c[a]||"Unknown"}var c=_.chain(a.get("countries")).map(function(a){return[a.code,a.name]}).object().value();return{getCountrybyCountryCode:b}}])}(),function(){"use strict";angular.module("DashboardApp").factory("d3",["$window",function(a){return a.d3}])}(),function(){"use strict";angular.module("DashboardApp").factory("DelayService",["$timeout","ConfigService","ModalService","Templates",function(a,b,c,d){function e(){a.cancel(h),h=null,g&&g.dismiss(),g=null}function f(b,e,f){h=a(function(){g=c.open({backdrop:"static",controller:"DelayModalController",keyboard:!1,resolve:{item:_.constant(e),operation:_.constant(f),title:_.constant(b)},templateUrl:d.path("modals/delay")})},i)}var g,h,i=b.get("uploadDialogDelay"),j="deleting",k="duplicating",l="updating",m="uploading";return{DELETING:j,DUPLICATING:k,UPDATING:l,UPLOADING:m,cancelDelayIndicator:e,showDelayIndicator:f}}])}(),function(){"use strict";function a(){}angular.module("DashboardApp").service("DependencyService",a),a.prototype.assign=function(a,b,c){_.each(b,function(b,d){a[b]=c[d]})}}(),function(){"use strict";angular.module("DashboardApp").factory("DnsMaskingService",["$document","$q","$window","BotrAccountService",function(a,b,c,d){function e(a){return d.get(!0).then(_.partial(f,a))}function f(a,b){return b.dns_masks.content?_.map(a,_.partial(g,b.dns_masks.content)):a}function g(a,b){var c=h(b);return["http://",a,c.pathname,c.hash,c.search].join("")}function h(b){if(/^\/\//.test(b)&&(b="http:"+b),c.URL&&c.URL.prototype.hasOwnProperty("hostname"))return new c.URL(b);var d=a[0].createElement("a");return d.href=b,d}return{bulkDnsMaskUrls:e}}])}(),function(){"use strict";angular.module("DashboardApp").factory("DownloadService",["$document","$window",function(a,b){function c(c,d,e){if("application/pdf"==e){for(var f=atob(c),g=new Uint8Array(new ArrayBuffer(f.length)),h=0;h<f.length;h++)g[h]=f.charCodeAt(h);c=g}var i=new Blob([c],{type:e}),j=URL.createObjectURL(i);if(b.navigator.msSaveOrOpenBlob)b.navigator.msSaveOrOpenBlob(i,d);else{var k=a[0].createElement("a");a[0].body.appendChild(k),k.href=j,k.download=d,k.click()}}function d(a,d,f){(b.navigator.userAgent.toLowerCase().indexOf("firefox")>-1||b.navigator.userAgent.toLowerCase().indexOf("msie")>-1||b.navigator.userAgent.toLowerCase().indexOf("trident")>-1)&&(d+=".csv"),c(e(a,f),d,"text/csv")}function e(a,b){return b.map(function(a){return a.label}).join(",")+"\r\n"+a.map(function(a){return b.map(function(b){return a[b.key]}).join(",")}).join("\r\n")}return{startDownload:c,exportCSV:d}}])}(),function(){"use strict";angular.module("DashboardApp").factory("GeoBlockingService",["$q","CommunicationService","ConfigService",function(a,b,c){function d(c){return a(function(a,d){h.hasOwnProperty(c)?h[c]?a(h[c]):d(h[c]):b.botr("/accounts/protectionrules/list",{site_token:c}).then(function(b){if(0==b.protectionrules.length)h[c]=null;else if(1==b.protectionrules.length)h[c]=b.protectionrules[0];else{for(var e in b.protectionrules)if(e.name==g){h[c]=e;break}h[c]||(h[c]=b.protectionrules[0])}h[c]?a(h[c]):d(h[c])})["catch"](function(a){d(a)})})}function e(c,e){return a(function(a,f){"undefined"==typeof e.site_token&&(e.site_token=c),d(c).then(function(d){"undefined"==typeof e.protectionrule_key&&(e.protectionrule_key=d.key),b.botr("/accounts/protectionrules/update",e).then(function(b,d){e.geo_country_list=e.geo_country_list&&e.geo_country_list.split(",")||[],_.extend(h[c],e),a(d)})["catch"](function(a){f(a)})},function(d){"undefined"==typeof e.name&&(e.name=g),""===e.geo_country_list&&delete e.geo_country_list,b.botr("/accounts/protectionrules/create",e).then(function(b,d){e.geo_country_list=e.geo_country_list&&e.geo_country_list.split(",")||[],h[c]=e,h[c].key=b.protectionrule.key,a(d)})["catch"](function(a){f(a)})})})}function f(a,b,d){if(""===a||"undefined"==typeof a)return[];"undefined"==typeof b&&(b=5),a=a.toLowerCase();var e=0,f=1,g=2,h=[[],[],[]],i=c.get("countries");for(var j in i){var k=i[j];if(-1===d.indexOf(k)&&(-1!==k.code.toLowerCase().indexOf(a)?h[e].push(k):0===k.name.toLowerCase().indexOf(a)&&h[f].length<b?h[f].push(k):-1!==k.name.toLowerCase().indexOf(a)&&h[g].length<b&&h[g].push(k),h[e].length>=b))break}var l=[];return h.forEach(function(a){for(var c=0;c<a.length&&l.length<b;c++)l.push(a[c])}),l}var g="JW Player Dashboard",h={};return{getRule:d,updateRule:e,searchRegions:f}}])}(),function(){"use strict";angular.module("DashboardApp").factory("InviteService",["CommunicationService","TrackingService",function(a,b){function c(b){return a.get("/account/invites/"+b+"/")}function d(b){return a.put("/account/invites/",{inviteeEmail:b})}function e(c){b.ga("send","event","Account Settings","Create New User");var d={inviteeEmail:c.inviteeEmail,inviterEmail:c.inviterEmail,role:c.accountRole.toUpperCase(),sendEmail:c.sendEmail};return c.siteTokens&&(d.sites=c.siteTokens.toUpperCase()),c.siteRoles&&(d.siteRoles=c.siteRoles),a.put("/account/accounts/"+c.accountToken+"/invites/",d)}function f(b){return a["delete"]("/account/invites/"+b+"/")}return{getInvite:c,createFreeInvite:d,createAccountInvite:e,deleteInvite:f}}])}(),function(){"use strict";angular.module("DashboardApp").factory("ModalService",["$modal","$rootScope",function(a,b){var c=angular.copy(a);return c.open=function(){var d=a.open.apply(c,arguments);return _.each(["$routeChangeSuccess","authorizationRevoked","authorizationChanged"],function(a){var c=b.$on(a,function(){d.dismiss(),c()})}),d},c}])}(),function(){"use strict";angular.module("DashboardApp").factory("ParserService",[function(){function a(a){return a.replace(/^\s+|\s+$/g,"")}function b(a){if(_.isNumber(a))return a;a=a.replace(",",".");var b=a.split(":"),c=0;return"s"===a.slice(-1)?c=parseFloat(a):"m"===a.slice(-1)?c=60*parseFloat(a):"h"===a.slice(-1)?c=3600*parseFloat(a):b.length>1?(c=parseFloat(b[b.length-1]),c+=60*parseFloat(b[b.length-2]),3===b.length&&(c+=3600*parseFloat(b[b.length-3]))):c=parseFloat(a),c}function c(b){var c=[];b=a(b);var e=b.split("\r\n\r\n");1===e.length&&(e=b.split("\n\n"));for(var f=0;f<e.length;f++)if("WEBVTT"!==e[f]){var g=d(e[f]);g.text&&c.push(g)}return c}function d(a){var c={},d=a.split("\r\n");1===d.length&&(d=a.split("\n")),""==d[0]&&(d=d.slice(1));var e=1;if(d[0].indexOf(" --> ")>0&&(e=0),d.length>e+1&&d[e+1]){var f=d[e],g=f.indexOf(" --> ");g>0&&(c.begin=b(f.substr(0,g)),c.end=b(f.substr(g+5)),c.text=d.slice(e+1).join("\n"))}return c}return{parseCaption:c,trim:a,seconds:b}}])}(),function(){"use strict";angular.module("DashboardApp").factory("PaymentService",["$location","CacheService","CommunicationService","UtilService",function(a,b,c,d){return{getAccount:function(a){return c.get("/payments/accounts/"+a+"/")},getAccountInvoice:function(a,b,d){return c.get("/payments/accounts/"+a+"/invoices/"+d+"/",{autoBillID:b})},getAccountTransaction:function(a,b){return c.get("/payments/accounts/"+a+"/transactions/"+b+"/")},getFuture:function(a){return c.get("/payments/accounts/"+a+"/future/")},getHistory:function(a,b,d,e,f){return c.get("/payments/accounts/"+a+"/history/")},getUpdateSession:function(b,d){var e=a.absUrl().split("?");return c.get("/payments/accounts/"+b+"/session/",{type:"cc_update",paymentMethodVid:d,successCallbackUrl:e[0]+"?code=1",errorCallbackUrl:e[0]+"?code=2"})},updateAccount:function(a,d){return $q(function(e,f){c.post("/payments/accounts/"+a+"/",{email:d}).then(function(c){b.remove("/payments/accounts/"+a+"/"),e()})["catch"](function(){f.apply(this,arguments)})})},finalizeUpdateWebSession:function(a,d){return $q(function(e,f){c.post("/payments/accounts/"+a+"/session/",{sessionID:d}).then(function(c){b.remove("/payments/accounts/"+a+"/"),e(c.finalized)})["catch"](function(){f.apply(this,arguments)})})}}}])}(),function(){"use strict";angular.module("DashboardApp").constant("PlayerConstants",{CAST_SERIALIZE_PROPERTIES:["cast_appid","cast_endscreen_key","cast_loadscreen_key","cast_logo_key","cast_railcolor"],CAST_DESERIALIZE_PROPERTIES:["appid","endscreen","loadscreen","logo","railcolor"],CAST_ASSET_PROPERTIES:["endscreen","loadscreen","logo"],CAST_COLOR_PROPERTIES:["cast_railcolor","railcolor"],JWP7_COLOR_PROPERTIES:["skin_active","skin_background","skin_inactive"]})}(),function(){"use strict";function a(a){a.assign(this,b,arguments)}angular.module("DashboardApp").service("PlayerDefaultsService",a);var b=["DependencyService","ConfigService","PlayerFeaturesService"];a.$inject=b,a.prototype.getDefaults=function(){var a=this.ConfigService.get("publish","player","defaultVersion"),b={aspectratio:"16:9",autostart:!1,controls:!0,dimensions:"responsive",displaydescription:!0,displaytitle:!0,enable_ga:!1,height:270,mute:!1,preload:"none",primary:"html5",related_enabled:!1,has_related_autoplaymessage:!1,related_autoplaymessage:"",related_autoplaytimer:10,related_heading:"",related_onclick:"play",related_videos:"none",release_channel:"production",repeat:!1,skin:"seven",version:a,visualplaylist:!0,vpaid_mode:"insecure",watermark_margin:10,watermark_position:"top-right",watermark_hide:!0,width:480};return this.PlayerFeaturesService.advertising(a).defaults(b),this.PlayerFeaturesService.sharing(a).defaults(b),b}}(),function(){"use strict";function a(a){a.assign(this,b,arguments),this.defaults=this.PlayerDefaultsService.getDefaults()}angular.module("DashboardApp").service("PlayerDeserializerService",a);var b=["DependencyService","PlayerConstants","PlayerDefaultsService","PlayerFeaturesService","VirtualAssetService"];a.$inject=b,a.prototype.deserialize=function(a){var b=this.PlayerDefaultsService.getDefaults();return"7"===a.version&&(b.skin="seven",this.setValueOrDefault("displaydescription",a,b),this.setValueOrDefault("visualplaylist",a,b),this.setValueOrDefault("release_channel",a,b),a.advertising&&"googima"==a.advertising.client&&(b.vpaid_mode=a.advertising.vpaidmode),b.related_enabled="none"!==a.related_videos,b.has_related_autoplaymessage=!!a.related_autoplaymessage,this.setValueOrDefault("related_videos",a,b),a.related_heading&&(b.related_heading=a.related_heading),"autoplay"===a.related_videos&&(b.related_autoplaymessage=a.related_autoplaymessage,b.related_autoplaytimer=a.related_autoplaytimer),this.setValueOrDefault("preload",a,b),a.skin&&_.chain(this.PlayerConstants.JWP7_COLOR_PROPERTIES).filter(function(b){var c=b.split(/_/);return!!a.skin[c[1]]}).each(function(c){var d=c.split(/_/);b[c]="#"+a.skin[d[1]],b["has_"+c]=!!b[c]})),b.version=a.version,b.playerName=a.name,a.aspectratio?b.aspectratio=a.aspectratio:(b.dimensions="fixed",b.height=a.height||this.defaults.height,b.width=a.width||this.defaults.width),a.skin&&"Default"!==a.skin.name?b.skin=a.skin.name.toLowerCase():"6"===a.version&&(b.skin="six"),b.skinKey=a.skin&&a.skin.key,b.controls="none"!=a.controlbar,this.setValueOrDefault("autostart",a,b),this.setValueOrDefault("primary",a,b),b.displaytitle=a.displaytitle,b.mute=a.mute,b.repeat="none"!==a.repeat,this.PlayerFeaturesService.advertising(a.version).deserialize(a,b),this.PlayerFeaturesService.sharing(a.version).deserialize(a,b),b.enable_ga=!(!a.ga_web_property_id||""===a.ga_web_property_id),a.watermark&&(b.watermark_enabled=!0,b.watermark=this.VirtualAssetService.createAssetUrl(a.watermark),b.watermark_key=a.watermark.key,b.watermark_margin=a.watermark.margin,b.watermark_position=a.watermark.position,b.watermark_show=!a.watermark.hide,a.watermark.clicklink&&(b.has_watermark_clicklink=!0,b.watermark_clicklink=a.watermark.clicklink)),a.cast&&(_.chain(this.PlayerConstants.CAST_DESERIALIZE_PROPERTIES).filter(function(b){return!!a.cast[b]}).each(_.bind(function(c){_.contains(this.PlayerConstants.CAST_ASSET_PROPERTIES,c)?(b["cast_"+c+"_key"]=a.cast[c].key,b["cast_"+c]=this.VirtualAssetService.createAssetUrl(a.cast[c])):_.contains(this.PlayerConstants.CAST_COLOR_PROPERTIES,c)?(b["cast_"+c]="#"+a.cast[c],b["has_cast_"+c]=!0):b["cast_"+c]=a.cast[c]},this)),b.cast_enabled=_.chain(this.PlayerConstants.CAST_DESERIALIZE_PROPERTIES).map(function(a){return!!b["cast_"+a]}).some().value()),a.custom&&"true"===a.custom.hlshtml&&(b.hlsHtml=!0),b},a.prototype.setValueOrDefault=function(a,b,c){var d=null===b[a]?this.defaults[a]:b[a];return c[a]=d,d}}(),function(){"use strict";function a(a){a.assign(this,b,arguments),this.defaults=this.PlayerDefaultsService.getDefaults()}angular.module("DashboardApp").service("PlayerEmbedService",a);var b=["DependencyService","PlayerConstants","PlayerDefaultsService","PlayerFeaturesService"];a.$inject=b,a.prototype.setup=function(a){var b={};return"7"===a.version&&(this.defaults.displaydescription!==a.displaydescription&&(b.displaydescription=a.displaydescription),this.defaults.visualplaylist!==a.visualplaylist&&(b.visualplaylist=a.visualplaylist),b.release_channel=a.release_channel,a.related_enabled&&(b.related={heading:a.related_heading,onclick:"play",oncomplete:a.related_videos},"autoplay"===a.related_videos&&(a.has_related_autoplaymessage&&(b.related.autoplaymessage=a.related_autoplaymessage),b.related.autoplaytimer=a.related_autoplaytimer)),b.preload=a.preload,b.skin={name:a.skin},_.chain(this.PlayerConstants.JWP7_COLOR_PROPERTIES).filter(function(b){return a["has_"+b]}).each(function(c){var d=c.split(/_/);b.skin[d[1]]=a[c]})),a.playlist?b.playlist=a.playlist:b.file=a.file||"Insert video URL here",b.key=a.key,""!==a.image&&(b.image=a.image),"responsive"===a.dimensions?(b.width="100%",b.aspectratio=a.aspectratio):"fixed"===a.dimensions&&(b.width=parseInt(a.width)||this.defaults.width,b.height=parseInt(a.height)||this.defaults.height),this.defaults.primary!=a.primary&&(b.primary=a.primary),this.defaults.autostart!=a.autostart&&(b.autostart=a.autostart),this.defaults.repeat!=a.repeat&&(b.repeat=a.repeat),this.defaults.displaytitle!=a.displaytitle&&(b.displaytitle=a.displaytitle),this.defaults.mute!=a.mute&&(b.mute=a.mute),this.defaults.controls!=a.controls&&(b.controls=a.controls),"6"==a.version&&"six"!=a.skin&&(b.skin=a.skin),this.PlayerFeaturesService.advertising(a.version).setup(a,b),this.PlayerFeaturesService.sharing(a.version).setup(a,b),a.enable_ga?b.ga={idstring:"title"}:delete b.ga,a.cast_enabled&&(b.cast={},_.chain(this.PlayerConstants.CAST_DESERIALIZE_PROPERTIES).filter(function(b){
return!!a["cast_"+b]}).each(function(c){b.cast[c]=a["cast_"+c]})),a.watermark_enabled&&(b.logo={},a.watermark&&(b.logo.file=a.watermark),a.watermark_margin&&(b.logo.margin=a.watermark_margin),a.watermark_clicklink&&(b.logo.link=a.watermark_clicklink),a.watermark_position&&(b.logo.position=a.watermark_position),b.logo.hide=!a.watermark_show),b}}(),function(){"use strict";angular.module("DashboardApp").factory("PlayerFeaturesService",["PlayerAdvertisingFeatureService","Player6SharingFeatureService","Player7SharingFeatureService",function(a,b,c){var d={6:{advertising:a,sharing:b},7:{advertising:a,sharing:c}};return _.mapObject(_.extend({},d[6],d[7]),function(a,b){return function(a){return a=a||"7",d[a][b]}})}])}(),function(){"use strict";function a(a){a.assign(this,b,arguments)}angular.module("DashboardApp").service("PlayerSerializerService",a);var b=["DependencyService","PlayerConstants","PlayerFeaturesService"];a.$inject=b,a.prototype.serialize=function(a,b){var c={};return"7"===a.version&&(c.displaydescription=a.displaydescription,c.visualplaylist=a.visualplaylist,c.release_channel=a.release_channel,a.related_enabled?(c.related_heading=a.related_heading||"",c.related_videos=a.related_videos,c.related_onclick="play","autoplay"===a.related_videos?(a.has_related_autoplaymessage&&a.related_autoplaymessage?c.related_autoplaymessage=a.related_autoplaymessage:b&&(c.related_autoplaymessage=""),c.related_autoplaytimer=a.related_autoplaytimer):b&&(c.related_autoplaymessage="",c.related_autoplaytimer="")):b?(c.related_onclick="",c.related_autoplaymessage="",c.related_autoplaytimer="",c.related_heading="",c.related_videos="none"):c.related_videos="none",c.preload=a.preload,_.chain(this.PlayerConstants.JWP7_COLOR_PROPERTIES).filter(function(b){return!a["has_"+b]}).each(function(b){delete a[b]}),_.chain(this.PlayerConstants.JWP7_COLOR_PROPERTIES).filter(function(b){return!!a[b]}).each(function(b){c[b]=a[b].substring(1)}),b&&_.chain(this.PlayerConstants.JWP7_COLOR_PROPERTIES).filter(function(b){return!a[b]}).each(function(a){c[a]=""})),c.name=a.playerName,"responsive"===a.dimensions?(c.responsive=!0,c.aspectratio=a.aspectratio):(c.responsive=!1,c.width=a.width,c.height=a.height),c.skin_key=a.skinKey,c.primary=a.primary,c.displaytitle=a.displaytitle?a.displaytitle:!1,c.mute=a.mute?a.mute:!1,c.controlbar=a.controls?"bottom":"none",c.autostart=a.autostart,c.repeat=a.repeat?"always":"none",this.PlayerFeaturesService.advertising(a.version).serialize(b,a,c),this.PlayerFeaturesService.sharing(a.version).serialize(b,a,c),a.watermark_enabled?(c.watermark_key=a.watermark_key,a.watermark_margin&&(c.watermark_margin=a.watermark_margin),a.watermark_position&&(c.watermark_position=a.watermark_position),a.has_watermark_clicklink?c.watermark_clicklink=a.watermark_clicklink:b&&(c.watermark_clicklink=""),c.watermark_hide=!a.watermark_show):b&&(c.watermark_key="",c.watermark_clicklink=""),c.ga_web_property_id=a.enable_ga?"UA-000000-00":"",a.cast_enabled?(_.chain(this.PlayerConstants.CAST_SERIALIZE_PROPERTIES).filter(function(b){return!!a[b]}).each(_.bind(function(b){_.contains(this.PlayerConstants.CAST_COLOR_PROPERTIES,b)?c[b]=a[b].substring(1):c[b]=a[b]},this)),b&&_.chain(this.PlayerConstants.CAST_SERIALIZE_PROPERTIES).filter(function(b){return!a[b]}).each(function(a){c[a]=""})):b&&_.chain(this.PlayerConstants.CAST_SERIALIZE_PROPERTIES).filter(function(b){return!!a[b]}).each(function(a){c[a]=""}),a.hlsHtml?c["custom.hlshtml"]="true":b&&(c["custom.-hlshtml"]="true"),c}}(),function(){"use strict";function a(a){a.assign(this,b,arguments)}angular.module("DashboardApp").service("PlayerAdvertisingFeatureService",a);var b=["DependencyService"];a.$inject=b;var c={admessage:"",client:"none",companiondiv:{height:250,id:"",width:300},enabled:!1,isSkipOffset:!1,skipoffset:5,url:[""]},d=3;a.prototype.defaults=function(a){a.advertising=angular.copy(c)},a.prototype.deserialize=function(a,b){a.advertising&&"googima"==a.advertising.client&&(b.vpaid_mode=a.advertising.vpaidmode),a.advertising&&a.advertising.client&&("none"!==a.advertising.client||a.advertising_schedule_key)&&(b.advertising.enabled=!0,a.advertising.schedule?(b.advertising.client="vmap",b.advertising.url=[a.advertising.schedule]):a.advertising.tag?(b.advertising.client=a.advertising.client,b.advertising.url=[a.advertising.tag],a.advertising.tag_1&&b.advertising.url.push(a.advertising.tag_1),a.advertising.tag_2&&b.advertising.url.push(a.advertising.tag_2)):a.advertising_schedule_key&&(b.advertising.client="jwplayer",b.advertising.scheduleKey=a.advertising_schedule_key),a.advertising.skipoffset&&(b.advertising.isSkipOffset=!0,b.advertising.skipoffset=a.advertising.skipoffset,"7"===a.version&&a.advertising.skipmessage&&(b.advertising.skipmessage=a.advertising.skipmessage)),"7"===a.version&&a.advertising.cuetext&&(b.advertising.cuetext=a.advertising.cuetext),a.advertising.admessage&&(b.advertising.admessage=a.advertising.admessage),a.advertising.companiondiv&&(b.advertising.isCompanion=!0,b.advertising.companiondiv.id=a.advertising.companiondiv.id,b.advertising.companiondiv.width=a.advertising.companiondiv.width,b.advertising.companiondiv.height=a.advertising.companiondiv.height))},a.prototype.serialize=function(a,b,c){if("googima"==b.advertising.client&&"7"===b.version&&(c.advertising_vpaidmode=b.vpaid_mode),b.advertising.enabled){if("vmap"===b.advertising.client)c.advertising_client="vast",c.advertising_schedule=b.advertising.url[0];else if("jwplayer"==b.advertising.client)c.advertising_schedule_key=b.advertising.scheduleKey,c.advertising_client="none",a&&(c.advertising_schedule="",c.advertising_tag="",c.advertising_tag_1="",c.advertising_tag_2="");else{if(c.advertising_client=b.advertising.client,c.advertising_tag=b.advertising.url[0],"vast"===b.advertising.client)for(var e=1;d>e;e++)c["advertising_tag_"+e]=b.advertising.url[e]||"";a&&(c.advertising_schedule="")}c.advertising_skipoffset=b.advertising.isSkipOffset?parseInt(b.advertising.skipoffset):0,"7"===b.version&&(b.advertising.cuetext?c.advertising_cuetext=b.advertising.cuetext:a&&(c.advertising_cuetext=""),b.advertising.isSkipOffset&&b.advertising.skipmessage?c.advertising_skipmessage=b.advertising.skipmessage:a&&(c.advertising_skipmessage="")),b.advertising.isCompanion&&b.advertising.companiondiv.id?(c.advertising_companiondiv_id=b.advertising.companiondiv.id,c.advertising_companiondiv_width=b.advertising.companiondiv.width,c.advertising_companiondiv_height=b.advertising.companiondiv.height):a&&(c.advertising_companiondiv_id="",c.advertising_companiondiv_height=0,c.advertising_companiondiv_width=0),b.advertising.admessage?c.advertising_admessage=b.advertising.admessage:a&&(c.advertising_admessage="")}else a?(c.advertising_admessage="",c.advertising_client="none",c.advertising_companiondiv_id="",c.advertising_companiondiv_height=0,c.advertising_companiondiv_width=0,"7"===b.version&&(c.advertising_cuetext="",c.advertising_skipmessage="",c.advertising_vpaidmode="insecure"),c.advertising_skipoffset=0,c.advertising_schedule="",c.advertising_schedule_key="",c.advertising_tag="",c.advertising_tag_1="",c.advertising_tag_2=""):c.advertising_client="none"},a.prototype.setup=function(a,b){a.advertising.enabled&&(b.advertising={},b.advertising.client=a.advertising.client,"vmap"===a.advertising.client?(b.advertising.schedule=a.advertising.url[0],b.advertising.client="vast"):"vast"===a.advertising.client?b.advertising.tag=a.advertising.url:b.advertising.tag=a.advertising.url[0],"7"===a.version&&"googima"==a.advertising.client&&(b.advertising.vpaidmode=a.vpaid_mode),a.advertising.cuetext&&(b.advertising.cuetext=a.advertising.cuetext),a.advertising.isSkipOffset&&(b.advertising.skipoffset=parseInt(a.advertising.skipoffset),a.advertising.skipmessage&&(b.advertising.skipmessage=a.advertising.skipmessage)),c.admessage!=a.advertising.admessage&&(b.advertising.admessage=a.advertising.admessage),c.companiondiv.id!=a.advertising.companiondiv.id&&(b.advertising.companiondiv={},b.advertising.companiondiv.id=a.advertising.companiondiv.id,b.advertising.companiondiv.width=a.advertising.companiondiv.width,b.advertising.companiondiv.height=a.advertising.companiondiv.height))}}(),function(){"use strict";angular.module("DashboardApp").factory("Player6SharingFeatureService",[function(){function a(a){a.sharingEnabled=!1,a.sharing="none",a.sharingHeading="",a.sharingSites=["facebook","twitter","email"]}function b(a,b){b.sharingEnabled="none"!==a.sharing,b.sharing=a.sharing,b.sharingHeading=a.sharing_heading||""}function c(a,b,c){(a?e:d)(b,c)}function d(a,b,c){return a.sharingEnabled?(b.sharing=a.sharing||"none",angular.isUndefined(a.sharingHeading)||""===a.sharingHeading||(b.sharing_heading=a.sharingHeading)):b.sharing="none",a.sharingEnabled}function e(a,b){a.sharingEnabled?(b.sharing=a.sharing||"none",b.sharing_heading=a.sharingHeading):(b.sharing="none",b.sharing_heading="")}function f(a,b){a.sharingEnabled&&(b.sharing={},a.sharingHeading&&(b.sharing.heading=a.sharingHeading),"screen-embed"===a.sharing&&(b.sharing.code="<!-- Embed code will render in this space when this player is live on your website. -->"))}return{defaults:a,deserialize:b,serialize:c,serializeCreate:d,serializeUpdate:e,setup:f}}]).factory("Player7SharingFeatureService",["Player6SharingFeatureService",function(a){function b(b){a.defaults(b)}function c(b,c){if(a.deserialize(b,c),c.sharingEnabled)try{c.sharingSites=JSON.parse(b.sharing_sites)}catch(d){c.sharingSites=[]}}function d(a,b,c){(a?f:e)(b,c)}function e(b,c){return a.serializeCreate(b,c),b.sharingEnabled&&b.sharingSites&&b.sharingSites.length&&(c.sharing_sites=JSON.stringify(b.sharingSites)),b.sharingEnabled}function f(b,c){a.serializeUpdate(b,c),b.sharingEnabled?c.sharing_sites=JSON.stringify(b.sharingSites||[]):c.sharing_sites=""}function g(b,c){a.setup(b,c),b.sharingEnabled&&(c.sharing.sites=null===b.sharingSites?[]:b.sharingSites)}return{defaults:b,deserialize:c,serialize:d,serializeCreate:e,serializeUpdate:f,setup:g}}])}(),function(){"use strict";angular.module("DashboardApp").factory("VirtualPlayerService",["PlayerService","VirtualizeService",function(a,b){return b.virtualize(a,"PlayerService")}]).factory("PlayerService",["$filter","$interpolate","$q","$sanitize","CommunicationService","ConfigService","DnsMaskingService","PlayerDefaultsService","PlayerDeserializerService","PlayerEmbedService","PlayerSerializerService","SessionService","SigningService","UtilService","VirtualAssetService","VirtualVideoService",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){function q(a){angular.extend(this,a)}function r(){return h.getDefaults()}function s(a,b){return k.serialize(a,b)}function t(a){return i.deserialize(a)}function u(a){return j.setup(a)}function v(a,b,c){var d={site_token:l.getSiteToken()};if(a.sort){var f=a.sortReverse?"desc":"asc";d.order_by=a.sort+":"+f}return"undefined"!=typeof a.offset&&(d.result_offset=a.offset),"undefined"!=typeof a.limit&&(d.result_limit=a.limit),a.searchQuery&&(d.search=a.searchQuery),e.botr(J,d,function(a){var c=_.map(a.players,function(a){return new q(a)});b(c,a.total)},function(a,b){c(b)})}function w(a,b,c){function d(a){f.show(a.player.key,b,c)}a.site_token=l.getSiteToken(),""===a.ga_web_property_id&&delete a.ga_web_property_id;var f=this;e.botr(H,a,d,c)}function x(a,b,c,d){return b.player_key=a.key,b.site_token=l.getSiteToken(),e.botr(L,b,c,d)}function y(a,b,d){var f=c.defer();return e.botr(K,{site_token:l.getSiteToken(),player_key:a},function(a){f.resolve(),void 0!==b&&b(a.player)},function(a){f.reject(a),void 0!==d&&d(a)}),f.promise}function z(a,b,c){var d=this;return this.show(a.key,function(e){var f=d.serializeConfig(d.deserializeConfig(e),!1);f.name="Copy of "+f.name,f.version=a.version,d.create(f,b,c)},c)}function A(a,b,c){var d=_.pluck(a,"key").join();e.botr(I,{site_token:l.getSiteToken(),player_key:d},b,c)}function B(a,b,c){e.botr(I,{site_token:l.getSiteToken(),player_key:a.key},b,c)}function C(a,b){var d=c.defer();return e.botr("/accounts/skins/list",{site_token:a,player_version:b},function(a){var b={};_.each(a.skins,function(a){var c=a.name.toLowerCase();"built-in"===a.type&&(b[c]=a.key)}),d.resolve(b)},function(a){d.reject(a)},!0),d.promise}function D(a){var b=f.get("overridePerEnvironment","autoPlayer")+a+".js";return g.bulkDnsMaskUrls([b])}function E(a){var c='<div itemscope itemtype="http://schema.org/VideoObject">';return a.content&&(a.content.title&&(c+='<meta itemprop="name" content="{{content.title}}" />'),a.content.description&&(c+='<meta itemprop="description" content="{{content.description}}" />')),a.conversion&&(a.conversion.imageLink&&(c+='<meta itemprop="thumbnailUrl" content="{{conversion.imageLink}}" />'),a.conversion.directLink&&(c+='<meta itemprop="contentUrl" content="{{conversion.directLink}}" />')),c+="{{embedCodeScript}}",c+="</div>",(c=b(c))(a)}function F(a,b,e){var h="//"+f.get("overridePerEnvironment","contentLocation"),i={description:d(a.description),key:a.key,title:d(a.title)},j=g.bulkDnsMaskUrls(_.map(["html","js"],function(a){var c=R({content:i,extension:a,location:h,player:b});return c})).then(m.bulkSignPlayerUrls).then(function(a){var c={};return c[O.IFRAME]={code:P({height:b.responsive?N:b.height,src:a[0],width:b.responsive?M:b.width}),type:O.IFRAME},c[O.JAVASCRIPT]={code:Q({src:a[1]}),type:O.JAVASCRIPT},c});return e?j.then(function(b){var d;return d="url"!==a.sourcetype?c(function(b,c){p.getConversions(l.getSiteToken(),a.key,function(d,e){var f=_.chain(d).reject(function(a){return"Original"===a.template.name}).where({mediatype:"video",status:"Ready"}).sortBy("width").last().value();f&&f.link?(f.directLink=f.link.protocol+"://"+f.link.address+f.link.path,f.imageLink=f.link.protocol+"://"+f.link.address+"/thumbs/"+a.key+"-"+f.width+".jpg",b(f)):c()},c)}).then(function(a){return g.bulkDnsMaskUrls([a.directLink,a.imageLink]).then(function(a){return m.bulkSignContentUrls([a[0]]).then(function(b){return[b[0],a[1]]})})}):c.when([a.sourceurl,a.posterUrl]),d.then(function(a){var c={directLink:a[0],imageLink:a[1]};return b[O.IFRAME]={code:E({content:i,conversion:c,embedCodeScript:b[O.IFRAME].code}),type:O.IFRAME},b[O.JAVASCRIPT]={code:E({content:i,conversion:c,embedCodeScript:b[O.JAVASCRIPT].code}),type:O.JAVASCRIPT},b})}):j}var G="/players",H=G+"/create",I=G+"/delete",J=G+"/list",K=G+"/show",L=G+"/update",M=480,N=270,O={IFRAME:"iframe",JAVASCRIPT:"javascript"};q.prototype={};var P=b(f.get("embedTypes").iframe),Q=b(f.get("embedTypes").script),R=b("{{location}}/players/{{content.key}}-{{player.key}}.{{extension}}");return{EmbedType:O,bulkDelete:A,create:w,"delete":B,deserializeConfig:t,duplicate:z,getDefaultSkins:C,getDefaults:r,getEmbedCodes:F,getLibraryUrl:D,list:v,maxWaterfallUrls:3,modelToEmbedObject:u,serializeConfig:s,show:y,update:x}}])}(),function(){"use strict";angular.module("DashboardApp").factory("RecurlyService",["CommunicationService",function(a){function b(b,c,d){return a.post("/payments/accounts/"+b+"/recurly_account/"+c+"/",d)}function c(b,c,d){return a.post("/payments/accounts/"+b+"/recurly_account/"+c+"/cc_info/",d)}function d(b,c,d){return a.post("/payments/accounts/"+b+"/recurly_account/"+c+"/paypal_info/",d)}function e(b,c,d){return a.post("/payments/accounts/"+b+"/recurly_account/"+c+"/subscription/",d)}return{updateRecurlyEmail:b,updateRecurlyCC:c,updateRecurlyPaypal:d,reactivateSubscription:e}}])}(),function(){"use strict";angular.module("DashboardApp").factory("RequestService",["CommunicationService","UserService","$q",function(a,b,c){function d(b){return a.put("/account/requests/",{userEmail:b})}function e(b){return c(function(c,d){a.get("/account/requests/"+b+"/").then(function(a){c(a.request)})["catch"](function(){d.apply(this,arguments)})})}function f(d,e,f){return c(function(c,g){a.post("/account/requests/"+d+"/",{signature:e,"new":f}).then(function(a){c(b.create(a.user))})["catch"](function(){g.apply(this,arguments)})})}return{createRequest:d,getRequest:e,useRequest:f}}])}(),function(){"use strict";angular.module("DashboardApp").factory("RSSService",["$http","$q",function(a,b){function c(c,d){var e=b.defer();return a({method:"GET",url:c}).then(function(a,b,c,f){if(500==b||404==b)return void e.reject(a);var g=new DOMParser;if(a&&a.data)var h=g.parseFromString(a.data,"text/xml");else{d&&(a=a?a.replace(/&/g,"&amp;"):"");var h=g.parseFromString(a,"text/xml")}if(h&&h.getElementsByTagName&&h.getElementsByTagName("channel")[0]){var i=[];_.forEach(h.getElementsByTagName("channel")[0].getElementsByTagName("item"),function(a){if(d)i.push(a);else{var b={};_.forEach(a.children,function(a){b[a.tagName.toLowerCase()]=a.textContent}),i.push(b)}}),e.resolve(i)}else e.reject()})["catch"](function(a,b,c,d){0!==b&&e.reject([a,b,c,d])}),e.promise}return{get:c}}])}(),function(){"use strict";angular.module("DashboardApp").factory("SessionService",["$cookies","$location","$rootScope","$timeout","AccountService","AuthenticationService","CacheService","CommunicationService","ConfigService","PaymentService","UserService","UtilService","VirtualizeService",function(a,b,c,d,e,f,g,h,i,j,k,l,m){function n(){for(var a in g.get(K))return g.get(K)[a]}function o(){return 2==n().accountStateID}function p(){return n().legacy}function q(){for(var a in g.get(K))return a}function r(){return w().slug}function s(a){var b=w()["playerLicenseV"+a];if(b)return b;throw"Undefined license for version="+a}function t(a){return"1"!=a[0]||"."!=a[1]}function u(a){return t(a)?w().androidSdkLicense:s("6")}function v(a){return t(a)?w().iosSdkLicense:s("6")}function w(){return n().sites&&y()&&n().sites[y()]?n().sites[y()]:{}}function x(b){I!=b&&m.resetAllCaches(),I=b,a.activeSite=I}function y(){return I}function z(){return w().analyticsSignature}function A(b,d,e,i,j){function l(b){if(O=void 0!==a.preview,j=void 0===j?!1:j,j&&!g.has(J))i("cannot replace session, there is no current user");else if(j&&g.get(J).userToken!==b.user.userToken)i("cannot replace session, current user is not the same as new user");else if(!j&&g.has(J))i("cannot replace session, replace must be explicitly set");else{g.put(k.create(b.user),J),g.put(b.accounts,K);var d=n();x(y()||a.activeSite||d.defaultSite),f.setSignature(b.signature),M=!0,C(),c.$emit("session:created"),"undefined"!=typeof e&&e()}}function m(a){N=!0,M=!0,f.clearSignature(),"undefined"!=typeof i&&i(a)}N=!1;var o="/account/sessions/start/",p={};"undefined"!=typeof b&&"undefined"!=typeof d?(p={userEmail:b,userPassword:d},h.post(o,p,l,m)):h.get(o,p,l,m)}function B(){A(void 0,void 0,void 0,void 0,!0)}function C(){void 0!==H&&d.cancel(H),H=d(function(){B()},L)}function D(a){var b=g.get(J);"undefined"!=typeof b&&(angular.forEach(a,function(c,d){b[d]!==a[d]&&(b[d]=a[d])}),g.put(b,J))}function E(a){return n().features.indexOf(a)>-1}function F(){var a=n().playerEdition;return a.charAt(0).toUpperCase()+a.slice(1)}function G(){var a=!n().paymentProvider.nameToken||!n().paymentProvider.merchantID;return a}var H,I,J="user",K="accounts",L=33e5,M=!1,N=!1,O=!1;return f.applyRedirectAuth(),f.isAuthorized()?A(void 0,void 0,function(){M=!0},function(){M=!0}):M=!0,c.$on("authorizationGranted",function(){g.has(J)||A(void 0,void 0,function(){},function(){})}),{createSession:A,refreshSession:B,getAccount:n,getAccountToken:q,getMigrated:p,getSiteSlug:r,getPlayerLicense:s,getAndroidSDKLicense:u,getIosSDKLicense:v,setSiteToken:x,getSiteToken:y,getAnalyticsSignature:z,hasFeature:E,disableBilling:G,getUser:function(){return g.get(J)},initialized:function(){return M},loadErrored:function(){return N},previewMode:function(){return O},updateUser:D,determineEntitlement:F,getSite:w,suspendedAccount:o}}])}(),function(){"use strict";angular.module("DashboardApp").factory("PermissionService",["SessionService",function(a){function b(a,b){if(void 0===b)return!1;var c=!0;return Object.keys(a).forEach(function(d){a[d].forEach(function(a){b.hasOwnProperty(d)&&-1!==b[d].indexOf(a)||(c=!1)})}),c}function c(c){return b(c,a.getAccount().permissions)}function d(c){return b(c,a.getSite().permissions)}function e(a,b){var d={};return d[a]=[b],c(d)}function f(a,b){var c={};return c[a]=[b],d(c)}function g(a){return d(h(a,"site"))&&c(h(a,"account"))}function h(a,b){return a.hasOwnProperty("permissions")&&a.permissions.hasOwnProperty(b)?a.permissions[b]:{}}return{hasAccountPermission:c,hasSitePermission:d,hasAccountAction:e,hasSiteAction:f,hasRouteAccess:g}}])}(),function(){"use strict";angular.module("DashboardApp").factory("SigningService",["$interpolate","$q","BotrAccountService","CommunicationService","SessionService",function(a,b,c,d,e){function f(a){return c.get(!0).then(_.partial(k,a,i))}function g(a){return c.get(!0).then(_.partial(k,a,j))}function h(a,c){return b.all({content:f(a),player:g(c)})}function i(a){return a.restrictions.downloads.allow}function j(a){return a.restrictions.embeds.allow}function k(a,c,d){return c(d)?a:b(_.partial(l,a))}function l(a,b,c){d.post(n({accountToken:e.getAccountToken(),siteToken:e.getSiteToken()}),{urls:a}).then(function(a){b(a.signedUrls)})["catch"](c)}var m="/account/accounts/{{accountToken}}/sites/{{siteToken}}/signing/",n=a(m);return{bulkSignContentUrls:f,bulkSignPlayerUrls:g,bulkSignUrls:h}}])}(),function(){"use strict";angular.module("DashboardApp").factory("Tables",["$cookies","$location","$rootScope","$route","UtilService",function(a,b,c,d,e){function f(a){var b=parseInt(a);return _.contains(q,b)||(b=p),b}function g(a){return e.numberPages(a,h())}function h(){return b.search().pageLength?f(b.search().pageLength):c.pageLength}function i(a){c.pageLength=a,j(a),b.search("page",null)}function j(c){b.search("pageLength",c),a.dashboardPageLength=c}function k(d){d.page=parseInt(b.search().page)||o,b.search().pageLength&&(c.pageLength=f(b.search().pageLength),a.dashboardPageLength=c.pageLength)}function l(a){a.searchQuery=a.searchTerms=b.search().search||""}function m(a,c){a.sort={reverse:b.search().reverse,by:b.search().sort||c,callback:_.partial(n,a)}}function n(a,c){b.search().sort=c.key,c.key!==a.sort.by||a.sort.reverse?b.search("reverse",null):b.search("reverse",!0),b.search("page",null),d.reload()}var o=1,p=10,q=[p,25,50];return c.pageLength=f(a.dashboardPageLength),{DEFAULT_PAGE_LENGTH:p,VALID_PAGE_LENGTHS:q,getNumberOfPages:g,getPageLength:h,setPageLength:i,setScopePageVariables:k,setScopeSearchVariables:l,setTableSortVariables:m}}])}(),function(){"use strict";angular.module("DashboardApp").factory("SiteService",["CommunicationService",function(a){function b(b,c){return a.put("/account/accounts/"+b+"/sites/",{siteName:c})}function c(b,c,d){return a.put("/account/accounts/"+b+"/sites/"+c+"/videos/",d)}function d(b){return a.get("/account/sites/"+b+"/")}function e(b,c){return a["delete"]("/account/accounts/"+b+"/sites/"+c+"/")}function f(b,c,d){return a.post("/account/accounts/"+b+"/sites/"+c+"/",{siteName:d})}return{create:b,"delete":e,update:f,show:d,copyVideo:c}}])}(),function(){"use strict";angular.module("DashboardApp").factory("SubSystemService",["CommunicationService","$q",function(a,b){function c(a){angular.extend(this,a)}function d(d){return b(function(b,e){a.get("/account/sites/"+d+"/subsystems/").then(function(a){for(var d=[],e=0;e<a.subsystems.length;e++)d.push(new c(a.subsystems[e]));b(d)})["catch"](function(){e.apply(this,arguments)})})}return{getSubSystems:d}}])}(),function(){"use strict";angular.module("DashboardApp").factory("VirtualTagService",["TagService","VirtualizeService",function(a,b){return b.virtualize(a,"TagService")}]).factory("TagService",["CommunicationService","SessionService",function(a,b){function c(c,d,e){var f=_.chain(c).pluck("name").value().join(",");return a.botr(k,{name:f,site_token:b.getSiteToken()},d,e)}function d(c,d,e,f){return a.botr(j,{name:c.name,site_token:b.getSiteToken()},d,e)}function e(c,d,e){return a.botr(k,{name:c.name,site_token:b.getSiteToken()},d,e)}function f(c,d,e){var f={result_limit:c.limit,result_offset:c.offset,site_token:b.getSiteToken()};return c.order_by&&(f.order_by=c.order_by),c.search&&(f.search=c.search),c.related&&(f.related=c.related),a.botr(l,f,function(a){_.each(a.tags,function(a){_.isObject(a)&&(a.key=a.name)}),d(a.tags,a.total)},e)}function g(c,d,e){return a.botr(m,{name:c,site_token:b.getSiteToken()},d,e)}function h(c,d,e,f,g){return a.botr(n,_.extend(d,{name:c.name,site_token:b.getSiteToken()}),e,f)}var i="/accounts/tags",j=i+"/create",k=i+"/delete",l=i+"/list",m=i+"/show",n=i+"/update";return{bulkDelete:c,create:d,"delete":e,list:f,show:g,update:h}}])}(),function(){"use strict";angular.module("DashboardApp").factory("Templates",["ConfigService",function(a){function b(b){return a.get("overridePerEnvironment","baseDirectory")+b}function c(a){return b("templates/"+a+".html")}return{path:c,addBase:b}}])}(),function(){"use strict";angular.module("DashboardApp").factory("ThumbnailService",["$http","$q","CommunicationService","SessionService",function(a,b,c,d){function e(a,e){var f=b.defer();return c.botr(m,{video_key:e,site_token:d.getSiteToken()},function(b){j(a,h(b),f)},function(a){f.reject(a)}),f.promise}function f(a){return i(a,l).promise}function g(a){return i(a,m).promise}function h(a){if(a&&"success"==a.status&&a.link){var b,c=a.link;return b="//"+c.address+c.path+"?api_format=json",b=b+"&key="+c.query.key+"&token="+c.query.token}return null}function i(a,e){var f=b.defer(),g={site_token:d.getSiteToken()};return angular.extend(g,a),c.botr(e,g,function(a){f.resolve(a.thumbnail)},function(a){f.reject(a)}),f}function j(b,c,d){var e=new FormData;e.append("file",b),a.post(c,e,{transformRequest:angular.identity,headers:{"Content-Type":void 0}}).then(function(a){d.resolve(a.data)})["catch"](function(a){d.reject(a)})}var k="/videos/thumbnails",l=k+"/show",m=k+"/update";return{create:e,show:f,update:g}}])}(),function(){"use strict";angular.module("DashboardApp").factory("TimeService",["$filter",function(a){function b(b){var c=Math.floor(b/60);b=Math.floor(b%60);var d=Math.floor(c/60);return c=Math.floor(c%60),10>b&&(b="0"+b),d>0?(d=a("number")(d),10>c&&(c="0"+c),d+":"+c+":"+b):c+":"+b}return{parseTimeToString:b}}])}(),function(){"use strict";angular.module("DashboardApp").factory("TitleService",["$document",function(a){function b(b,c){var d=a[0].title;a[0].title=c,b.$on("$destroy",function(){a[0].title=d})}return{setTitle:b}}])}(),function(){"use strict";angular.module("DashboardApp").factory("TrackService",["$q","CommunicationService","SessionService","Upload","UploadUrl",function(a,b,c,d,e){function f(a){return l(a,q,o).promise}function g(a){return l(a,r,angular.noop).promise}function h(a){return l(a,s,m).promise}function i(a){return l(a,t,n).promise}function j(a){return l(a,u,o).promise}function k(a,b){return d.upload({url:b,file:a,transformRequest:angular.identity,headers:{"Content-Type":void 0}})}function l(d,e,f){var g=a.defer(),h={site_token:c.getSiteToken()};return angular.extend(h,d),b.botr(e,h,function(a){g.resolve(f(a))},function(a){g.reject(a)}),g}function m(a){return a.tracks}function n(a){return a.track}function o(a){return e.create(a)}var p="/videos/tracks",q=p+"/create",r=p+"/delete",s=p+"/list",t=p+"/show",u=p+"/update";return f.and={upload:function(a,b){return f(a).then(_.partial(k,b))}},j.and={upload:function(a,b){return j(a).then(_.partial(k,b))}},{create:f,"delete":g,list:h,show:i,update:j,upload:k}}]),angular.module("DashboardApp").factory("UploadUrl",[function(){function a(a){if(a&&"success"==a.status&&a.link){var b=a.link;return"//"+b.address+b.path+"?api_format=json&key="+b.query.key+"&token="+b.query.token}return null}return{create:a}}])}(),function(){"use strict";angular.module("DashboardApp").factory("TrackingService",["$location","$route","$cookies","SessionService","GoogleAnalyticsService",function(a,b,c,d,e){function f(){c.isAdmin&&c.isAdmin==d.getUser().userEmail||(c.isAdmin&&delete c.isAdmin,e.ga.apply(null,arguments))}function g(){b.routes[a.path()].hasOwnProperty("ga_name")&&f("send","pageview",b.routes[a.path()].ga_name)}return{ga:f,sendPageViewEvent:g}}])}(),function(){"use strict";angular.module("DashboardApp").factory("TurboService",["$rootScope","$timeout","$route","VirtualVideoService","SessionService",function(a,b,c,d,e){function f(e,f,g,h){var i;if(f.type||".flv"!==f.name.slice(-4)){f.type}else;var j=f.size>1e8?1e4:5e3;i=new FormData,i.append("file",f);var k=new XMLHttpRequest;k.upload.addEventListener("progress",function(e){g.progress=f.progress=Math.ceil(e.loaded/e.total*100),e.loaded==e.total&&(g.isCompleted=!0,a.$broadcast("upload:complete",g.id),b(function(){d.resetCache(),g.isCompleted=!0,c.reload()},j)),h(g)},!1),k.open("PUT",e),k.setRequestHeader("Content-Disposition",'attachment; filename="'+encodeURIComponent(f.name)+'"'),k.setRequestHeader("Content-Type",f.type),k.send(f)}return{sendVideo:f}}])}(),function(){"use strict";angular.module("DashboardApp").factory("AccountUsageService",["$filter",function(a){var b=function(b){for(var c=[],d=0;d<b.length;++d){var e=b[d],f=a("date")(new Date(e.date.year,e.date.month-1,e.date.day),"MMMM yyyy");c.length>0&&c[0].date==f?(c[0].streaming+=e.traffic,c[0].storage=Math.max(c[0].storage,e.content)):c.unshift({date:f,streaming:e.traffic,storage:e.content})}return c},c=function(b,c,d,e){if(e)var f=[["Date","Max Stored (bytes)","Total Delivered (bytes)","Total Plays","Total Ad Impressions"]];else var f=[["Date","Max Stored (bytes)","Total Delivered (bytes)","Total Plays"]];for(var g,h,i,j=!1,k=0;k<c.length;++k){var l=c[k],m=a("date")(new Date(l.date.year,l.date.month-1,l.date.day),"MMMM yyyy");if(b==m){if(j=!0,g=a("date")(new Date(l.date.year,l.date.month-1,l.date.day),"yyyy-MM-dd"),d[g]?(h=d[g].ad_impressions,i=d[g].plays):(h=0,i=0),e)var n=[a("date")(new Date(l.date.year,l.date.month-1,l.date.day),"MM/dd/yyyy"),l.content,l.traffic,i,h];else var n=[a("date")(new Date(l.date.year,l.date.month-1,l.date.day),"MM/dd/yyyy"),l.content,l.traffic,i];f.push(n)}else if(j)break}return f.join("\n")};return{aggregateUsage:b,serializeMonthUsage:c}}])}(),function(){"use strict";angular.module("DashboardApp").factory("UserService",["$cookies","CommunicationService","$q",function(a,b,c){function d(a){angular.extend(this,a)}function e(a){return new d(a)}function f(d,f){return c(function(c,g){b.put("/account/users/",{inviteToken:d,userPassword:f,marketoId:a._mkto_trk}).then(function(a){c(e(a.user))})["catch"](function(){g.apply(this,arguments)})})}function g(a,d){return c(function(c,f){b.post("/account/users/"+a+"/",d).then(function(a){c(e(a.user))})["catch"](function(){f.apply(this,arguments)})})}function h(a,c,d){return b.post("/account/users/"+a+"/password/",{current:c,"new":d})}function i(a,c,d){return b.put("/account/users/"+a+"/requests/",{userEmail:d,password:c})}function j(a,d){return c(function(c,e){b.post("/account/requests/"+a+"/",{signature:d}).then(function(a){c(a.user)})["catch"](function(){e.apply(this,arguments)})})}return d.prototype={$canEditFeature:function(a){try{return this.permissions.features[a].edit}catch(b){}return!1},$canViewFeature:function(a){try{return this.permissions.features[a].view}catch(b){}return!1},$canViewPage:function(a,b){try{return-1===this.permissions.hiddenPages[a].indexOf(b)}catch(c){}return!0}},{create:e,createUser:f,updateUser:g,updateUserPassword:h,requestEmailChange:i,updateUserEmail:j}}])}(),function(){"use strict";angular.module("DashboardApp").factory("VirtualVideoService",["VideoService","VirtualizeService",function(a,b){return b.virtualize(a,"VideoService","date",{ignoreCreate:!0})}]).factory("VideoService",["$location","$q","ConfigService","CommunicationService","SessionService",function(a,b,c,d,e){function f(a,b){return b+c.get("overridePerEnvironment","contentLocation")+"/videos/"+a.key+".mp4"}function g(b){return a.protocol()+"://"+b.link.address+b.link.path+"?api_format=json&key="+b.link.query.key}function h(a,c,e){return b(function(b,f){d.post("/account/accounts/"+a+"/sites/"+c+"/videos/",e).then(function(a){a.results.link.query.key=a.results.media.key,a.results.link&&(a.uploadUrl=g(a.results)),b(a)})["catch"](function(){f.apply(this,arguments)})})}function i(a,c,f){
var h=b.defer();return d.botr(w,_.extend(a,{site_token:e.getSiteToken()}),function(a){a.link&&(a.uploadUrl=g(a)),c&&c(a),h.resolve(a.video)},function(a,b){f&&f(a,b),h.reject(b)}),h.promise}function j(a,b,c){return this.resetCache(),this.create({sourceformat:b,sourcetype:"url",sourceurl:a,title:c})}function k(a,b,c){return d.botr(A,{site_token:e.getSiteToken(),update_file:!0,resumable:!0,video_key:a},function(a){a.uploadUrl=g(a),b(a)},c)}function l(a,b,c){var f=_.pluck(a,"key").join(",");return d.botr(x,{site_token:e.getSiteToken(),video_key:f},b,c)}function m(a,c,d,e,f){var g=b.defer();if(c.length!=d.length)throw new Error("number of video keys must equal number of tag strings");var h=[],i=this;return c.forEach(function(a,c){var e=b.defer();h.push(e.promise),i.update({key:a},{tags:d[c]},function(){e.resolve(a)},function(){e.reject()})}),b.all(h).then(function(a){g.resolve(),e&&e()},function(a){g.reject(a),f&&f(a)}),g.promise}function n(a,b,c){return d.botr(x,{site_token:e.getSiteToken(),video_key:a.key},b,c)}function o(a,b,c,e){return d.botr("/videos/conversions/list/",{site_token:a,video_key:b},function(a){c(a.conversions,a.total)},function(a,b){"function"==typeof e&&e(b)})}function p(a,b,c){var f=a.sortReverse?"desc":"asc",g={result_offset:a.offset,result_limit:a.limit,order_by:a.sort+":"+f,site_token:e.getSiteToken()};return a.searchQuery&&(g.search=a.searchQuery),a.tags&&(g.tags=a.tags.join(",")),a.tagMode&&(g.tags_mode=a.tagMode),a.statuses_filter&&(g.statuses_filter=a.statuses_filter),a.videoKeys&&(g.video_keys_filter=a.videoKeys),d.botr(y,g,function(a){b(a.videos,a.total)},c)}function q(a,b){var c={statuses_filter:"ready,failed",site_token:e.getSiteToken()};return d.botr(y,c,function(b){a(b.videos,b.total)},b)}function r(a,b,c){return d.botr(z,{site_token:e.getSiteToken(),video_key:a},function(a){b(a.video)},c)}function s(a,b,c){var f={site_token:e.getSiteToken()};return angular.extend(f,a),d.botr(B,f,b,c)}function t(a,b,c,f){return angular.forEach(b,function(a,c){angular.isArray(a)&&(a=a.join(",")),null!==a&&(b[c]=a)}),b.video_key=a.key,b.site_token=e.getSiteToken(),d.botr(A,b,c,f)}function u(a,c,f,g){var h=b.defer();return d.botr(A,{site_token:e.getSiteToken(),sourceformat:f,sourcetype:"url",sourceurl:c,title:g,video_key:a},function(a){h.resolve(a.video)},function(a,b){h.reject(b)}),h.promise}var v="/videos",w=v+"/create",x=v+"/delete",y=v+"/list",z=v+"/show",A=v+"/update",B=v+"/views/list";return{bulkDelete:l,bulkTagVideos:m,create:i,createTurbo:h,createExternal:j,"delete":n,getConversions:o,list:p,listCompleted:q,recreate:k,show:r,update:t,updateExternal:u,createContentURL:f,viewsList:s}}])}(),function(){"use strict";angular.module("DashboardApp").factory("VirtualizeService",["CacheService","MathService",function(a,b){function c(){}function d(){k.forEach(function(b){a.remove(b)})}function e(c,d,e,l){function m(a,b,d){return u(a),c.bulkDelete(a,b,d)}function n(a,b,d,e){function f(c){t(e?e(c,a):c),I(),b(c)}return c.create(a,l&&l.ignoreCreate?b:f,d)}function o(a,b,d){return D(a),c["delete"](a,b,d)}function p(a,d,h){function i(b){return function(c,d){E(c),G(d),F(n),b&&b(H(a.offset,a.limit,n),d)}}var j=a.limit*f;if(j>g)return c.list(a,d,h);var k=y()?v().length:0,l=w()+k,m=b.min(a.offset+a.limit,x()),n=b.max(a.offset-a.limit,0),o=angular.copy(a);delete o.offset,delete o.limit,K=C(o),e=a.sort,L=a.sortReverse;var p=_.extend({},a,{offset:n,limit:j});return v()&&x()>-1&&w()<=a.offset&&l>=m&&a.forceRequest!==!0?(d(H(a.offset,a.limit,w()),x()),J=c.list(p,i(),angular.noop)):c.list(p,i(d),h)}function q(a,b,d){return c.show(a,b,d)}function r(a,b,d,e,f){var g=angular.copy(a);return z(a,b,f),c.update(g,b,d,e)}function s(a){t(a),I()}function t(a){v().unshift(a),G(x()+1),B()}function u(a){var b=_.chain(a).pluck("key").object([]).value(),c=v().length;E(_.reject(v(),function(a){return a.key in b})),G(x()+v().length-c),B()}function v(){return a.get(d,K,h)||[]}function w(){return a.get(d,K,i)||0}function x(){var b=a.get(d,K,j);return void 0===b||null===b?-1:b}function y(){return a.has(d,K,h)}function z(a,b,c){c=c||_.extend;var d=_.findWhere(v(),{key:a.key});d&&(c(d,b),I()),B()}function A(){a.remove(d)}function B(){var b=v(),c=w(),e=x();a.remove(d),E(b),F(c),G(e)}function C(a){return _.map(a,function(a,b){return b+":"+a}).sort().join()}function D(a){var b=v().length;E(_.reject(v(),function(b){return a.key===b.key})),G(x()+v().length-b),B()}function E(b){a.put(b,d,K,h)}function F(b){a.put(b,d,K,i)}function G(b){a.put(b,d,K,j)}function H(a,b,c){return v().slice(a-c,a-c+b)}function I(){E(_.sortBy(v(),function(a){return"string"==typeof a[e]?a[e].toLowerCase():a[e]})),L&&v().reverse()}var J={resolve:angular.noop},K="";e=e||"name";var L=!1;return k.push(d),_.extend({},c,{bulkDelete:m,create:n,"delete":o,list:p,show:q,update:r,insert:s,resetCache:A})}var f=3,g=150,h="items",i="startIndex",j="totalItems";c.prototype.bulkDelete=function(a,b,c){},c.prototype.create=function(a,b,c,d){},c.prototype["delete"]=function(a,b,c){},c.prototype.list=function(a,b,c){},c.prototype.show=function(a,b,c){},c.prototype.update=function(a,b,c,d,e){};var k=[];return{virtualize:e,resetAllCaches:d}}])}(),function(){"use strict";angular.module("DashboardApp").factory("ChannelService",["$q","CommunicationService","SessionService",function(a,b,c){function d(a){return a}function e(a){return a.channel}function f(a){return a.videos}function g(a){return a.video}function h(a){return r(a,u,e).promise}function i(a){return r(a,v,angular.noop).promise}function j(a){return r(a,w,d).promise}function k(a){return r(a,x,e).promise}function l(a){return r(a,y,angular.noop).promise}function m(a){return r(a,z,g).promise}function n(a){return r(a,A,angular.noop).promise}function o(a){return r(a,B,f).promise}function p(a){return r(a,C,g).promise}function q(a){return r(a,D,angular.noop).promise}function r(d,e,f){var g=a.defer(),h={site_token:c.getSiteToken()};return angular.extend(h,d),b.botr(e,h,function(a){g.resolve(f(a))},function(a){g.reject(a)}),g}var s="/channels",t="/channels/videos",u=s+"/create",v=s+"/delete",w=s+"/list/",x=s+"/show",y=s+"/update",z=t+"/create",A=t+"/delete",B=t+"/list/",C=t+"/show",D=t+"/update";return{create:h,"delete":i,list:j,show:k,update:l,createVideo:m,deleteVideo:n,listVideo:o,showVideo:p,updateVideo:q}}])}();